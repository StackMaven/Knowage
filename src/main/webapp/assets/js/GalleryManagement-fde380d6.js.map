{"version":3,"file":"GalleryManagement-fde380d6.js","sources":["../../../../modules/managers/galleryManagement/GalleryManagement.vue"],"sourcesContent":["<template>\r\n    <div class=\"kn-page\">\r\n        <div class=\"kn-page-content p-grid p-m-0\">\r\n            <div class=\"p-col-4 p-sm-4 p-md-3 p-p-0 kn-page\">\r\n                <Toolbar class=\"kn-toolbar kn-toolbar--primary\">\r\n                    <template #start>\r\n                        {{ $t('managers.widgetGallery.title') }}\r\n                    </template>\r\n                    <template #end>\r\n                        <FabButton icon=\"fas fa-plus\" @click=\"toggleAdd\" />\r\n                        <Menu ref=\"menu\" :model=\"addMenuItems\" popup=\"true\" />\r\n                    </template>\r\n                </Toolbar>\r\n                <KnInputFile label=\"\" :changeFunction=\"uploadTemplate\" accept=\"application/json,application/zip\" :triggerInput=\"triggerInput\" />\r\n                <ProgressBar mode=\"indeterminate\" class=\"kn-progress-bar\" v-if=\"loading\" />\r\n                <KnListBox :options=\"galleryTemplates\" :settings=\"typeDescriptor.knListSettings\" @delete=\"deleteTemplate($event, item)\"></KnListBox>\r\n            </div>\r\n            <div class=\"p-col-8 p-sm-8 p-md-9 p-p-0 p-m-0 kn-router-view\">\r\n                <router-view @saved=\"savedElement\" />\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { defineComponent } from 'vue'\r\nimport { AxiosResponse } from 'axios'\r\nimport FabButton from '@/components/UI/KnFabButton.vue'\r\nimport KnInputFile from '@/components/UI/KnInputFile.vue'\r\nimport { IGalleryTemplate } from './GalleryManagement'\r\nimport Menu from 'primevue/menu'\r\nimport galleryDescriptor from './GalleryManagementDescriptor.json'\r\nimport KnListBox from '@/components/UI/KnListBox/KnListBox.vue'\r\nimport mainStore from '../../../App.store'\r\n\r\nexport default defineComponent({\r\n    name: 'gallery-management',\r\n    components: {\r\n        FabButton,\r\n        KnInputFile,\r\n        KnListBox,\r\n        Menu\r\n    },\r\n    data() {\r\n        return {\r\n            galleryTemplates: [] as Array<IGalleryTemplate>,\r\n            loading: false,\r\n            typeDescriptor: galleryDescriptor,\r\n            triggerInput: false,\r\n            addMenuItems: [\r\n                { label: this.$t('managers.widgetGallery.newTemplate'), icon: 'fas fa-plus', command: () => this.newTemplate() },\r\n                {\r\n                    label: this.$t('managers.widgetGallery.importTemplate'),\r\n                    icon: 'fas fa-file-import',\r\n                    command: () => {\r\n                        this.triggerInputFile(true)\r\n                    }\r\n                }\r\n            ],\r\n            importingTemplate: {} as string | ArrayBuffer\r\n        }\r\n    },\r\n    setup() {\r\n        const store = mainStore()\r\n        return { store }\r\n    },\r\n    created() {\r\n        this.loadAllTemplates()\r\n    },\r\n    methods: {\r\n        triggerInputFile(value) {\r\n            this.triggerInput = value\r\n        },\r\n        loadAllTemplates(): void {\r\n            this.loading = true\r\n            this.axios\r\n                .get(import.meta.env.VITE_API_PATH + '1.0/widgetgallery')\r\n                .then((response: AxiosResponse<any>) => {\r\n                    this.galleryTemplates = response.data.map((item) => {\r\n                        // TODO remove after backend implementation\r\n                        item.label = item.label || item.name\r\n                        return item\r\n                    })\r\n                })\r\n                .catch((error) => console.error(error))\r\n                .finally(() => (this.loading = false))\r\n        },\r\n        deleteTemplate(e, templateId): void {\r\n            e.preventDefault()\r\n            if (e.item && e.item.id) templateId = e.item.id\r\n            this.$confirm.require({\r\n                message: this.$t('managers.widgetGallery.templateDoYouWantToDeleteTemplate'),\r\n                header: this.$t('managers.widgetGallery.deleteTemplate'),\r\n                icon: 'pi pi-exclamation-triangle',\r\n                accept: () => {\r\n                    this.axios\r\n                        .delete(import.meta.env.VITE_API_PATH + '1.0/widgetgallery/' + templateId)\r\n                        .then(() => {\r\n                            this.store.setInfo({ title: this.$t('managers.widgetGallery.deleteTemplate'), msg: this.$t('managers.widgetGallery.templateSuccessfullyDeleted') })\r\n                            this.loadAllTemplates()\r\n                            if (templateId === this.$route.params.id) this.$router.push('/gallery-management')\r\n                        })\r\n                        .catch((error) => console.error(error))\r\n                }\r\n            })\r\n        },\r\n        newTemplate() {\r\n            this.$router.push('/gallery-management/new-template')\r\n        },\r\n        savedElement() {\r\n            this.loadAllTemplates()\r\n        },\r\n        toggleAdd(event) {\r\n            // eslint-disable-next-line\r\n            // @ts-ignore\r\n            this.$refs.menu.toggle(event)\r\n            this.triggerInputFile(false)\r\n        },\r\n        uploadTemplate(event): void {\r\n            var reader = new FileReader()\r\n            reader.onload = this.onReaderLoad\r\n            reader.readAsText(event.target.files[0])\r\n            this.triggerInputFile(false)\r\n            event.target.value = ''\r\n        },\r\n        onReaderLoad(event) {\r\n            let json = JSON.parse(event.target.result)\r\n            if (json.id) {\r\n                this.importWidget(json)\r\n            } else {\r\n                this.$confirm.require({\r\n                    message: this.$t('importExport.import.itemWithoutIdConfirm'),\r\n                    header: this.$t('common.import'),\r\n                    icon: 'pi pi-exclamation-triangle',\r\n                    accept: () => {\r\n                        json.id = ''\r\n                        this.importWidget(json)\r\n                    }\r\n                })\r\n            }\r\n        },\r\n        importWidget(json: JSON) {\r\n            this.$http.post(import.meta.env.VITE_API_PATH + '1.0/widgetgallery/import', json).then(() => {\r\n                this.store.setInfo({ title: this.$t('managers.widgetGallery.uploadTemplate'), msg: this.$t('managers.widgetGallery.templateSuccessfullyUploaded') })\r\n\r\n                this.loadAllTemplates()\r\n            })\r\n        }\r\n    }\r\n})\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.kn-list-column {\r\n    border-right: 1px solid #ccc;\r\n}\r\n</style>\r\n"],"names":["FabButton","Menu","mainStore","_openBlock","_createElementBlock","_createElementVNode","_createVNode","_withCtx","_createBlock","_createCommentVNode"],"mappings":"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"}