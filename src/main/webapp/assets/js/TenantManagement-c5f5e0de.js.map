{"version":3,"file":"TenantManagement-c5f5e0de.js","sources":["../../../../modules/managers/tenantManagement/TenantManagement.vue"],"sourcesContent":["<template>\r\n    <div class=\"kn-page\">\r\n        <div class=\"kn-page-content p-grid p-m-0\">\r\n            <div class=\"kn-list--column p-col-4 p-sm-4 p-md-3 p-p-0\">\r\n                <Toolbar class=\"kn-toolbar kn-toolbar--primary\">\r\n                    <template #start>\r\n                        {{ $t('managers.tenantManagement.title') }}\r\n                    </template>\r\n                    <template #end>\r\n                        <FabButton icon=\"fas fa-plus\" @click=\"showForm\" data-test=\"open-form-button\" />\r\n                    </template>\r\n                </Toolbar>\r\n                <ProgressBar mode=\"indeterminate\" class=\"kn-progress-bar\" v-if=\"loading\" data-test=\"progress-bar\" />\r\n                <Listbox\r\n                    v-if=\"!loading\"\r\n                    class=\"kn-list--column\"\r\n                    :options=\"multitenants\"\r\n                    :filter=\"true\"\r\n                    :filterPlaceholder=\"$t('common.search')\"\r\n                    optionLabel=\"name\"\r\n                    filterMatchMode=\"contains\"\r\n                    :filterFields=\"tenantsDescriptor.filterFields\"\r\n                    :emptyFilterMessage=\"$t('common.info.noDataFound')\"\r\n                    @change=\"showForm\"\r\n                    data-test=\"tenants-list\"\r\n                >\r\n                    <template #empty>{{ $t('common.info.noDataFound') }}</template>\r\n                    <template #option=\"slotProps\">\r\n                        <div class=\"kn-list-item\" data-test=\"list-item\">\r\n                            <div class=\"kn-list-item-text\">\r\n                                <span>{{ slotProps.option.MULTITENANT_NAME }}</span>\r\n                                <span class=\"kn-list-item-text-secondary\">{{ slotProps.option.MULTITENANT_THEME }}</span>\r\n                            </div>\r\n                            <Button icon=\"far fa-trash-alt\" class=\"p-button-text p-button-rounded p-button-plain\" @click.stop=\"deleteTenantConfirm(slotProps.option)\" data-test=\"delete-button\" />\r\n                        </div>\r\n                    </template>\r\n                </Listbox>\r\n            </div>\r\n\r\n            <div class=\"p-col-8 p-sm-8 p-md-9 p-p-0 p-m-0\">\r\n                <router-view :selectedTenant=\"selTenant\" :licenses=\"listOfavailableLicenses\" @touched=\"touched = true\" @closed=\"onFormClose\" @inserted=\"pageReload\" />\r\n                <KnHint :title=\"'managers.tenantManagement.hintTitle'\" :hint=\"'managers.tenantManagement.hint'\" v-if=\"hintVisible\" />\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { defineComponent } from 'vue'\r\nimport { iMultitenant } from './TenantManagement'\r\nimport { AxiosResponse } from 'axios'\r\nimport tenantsDescriptor from './TenantManagementDescriptor.json'\r\nimport FabButton from '@/components/UI/KnFabButton.vue'\r\nimport Listbox from 'primevue/listbox'\r\nimport KnHint from '@/components/UI/KnHint.vue'\r\nimport mainStore from '../../../App.store'\r\n\r\nexport default defineComponent({\r\n    name: 'tenant-management',\r\n    components: {\r\n        FabButton,\r\n        Listbox,\r\n        KnHint\r\n    },\r\n    data() {\r\n        return {\r\n            multitenants: [] as iMultitenant[],\r\n            selTenant: {} as iMultitenant,\r\n            listOfThemes: [] as any,\r\n            listOfDataSources: [] as any,\r\n            listOfProductTypes: [] as any,\r\n            listOfavailableLicenses: [] as any,\r\n            tenantsDescriptor,\r\n            loading: false,\r\n            touched: false,\r\n            hintVisible: true\r\n        }\r\n    },\r\n    setup() {\r\n        const store = mainStore()\r\n        return { store }\r\n    },\r\n    async created() {\r\n        await this.loadTenants()\r\n        await this.getLicences()\r\n    },\r\n    methods: {\r\n        loadData(dataType: string) {\r\n            return this.$http.get(import.meta.env.VITE_RESTFUL_SERVICES_PATH + `multitenant${dataType}`).finally(() => (this.loading = false))\r\n        },\r\n        async getLicences() {\r\n            return this.$http\r\n                .get(import.meta.env.VITE_RESTFUL_SERVICES_PATH + `1.0/license`)\r\n                .then((response: AxiosResponse<any>) => {\r\n                    var host = response.data.hosts[0].hostName\r\n                    var licenses = response.data.licenses[host]\r\n                    this.listOfavailableLicenses = licenses\r\n                })\r\n                .finally(() => (this.loading = false))\r\n        },\r\n        async loadTenants() {\r\n            this.loading = true\r\n            await this.loadData('').then((response: AxiosResponse<any>) => {\r\n                this.multitenants = response.data.root\r\n            })\r\n            this.loading = false\r\n        },\r\n        deleteTenantConfirm(selectedTenant: Object) {\r\n            this.$confirm.require({\r\n                message: this.$t('common.toast.deleteMessage'),\r\n                header: this.$t('common.toast.deleteTitle'),\r\n                icon: 'pi pi-exclamation-triangle',\r\n                accept: () => this.deleteTenant(selectedTenant)\r\n            })\r\n        },\r\n        async deleteTenant(selectedTenant: Object) {\r\n            let url = import.meta.env.VITE_RESTFUL_SERVICES_PATH + 'multitenant'\r\n            await this.$http.delete(url, { data: selectedTenant }).then(() => {\r\n                this.store.setInfo({\r\n                    title: this.$t('common.toast.deleteTitle'),\r\n                    msg: this.$t('common.toast.deleteSuccess')\r\n                })\r\n                this.$router.push('/tenants-management')\r\n                this.pageReload()\r\n            })\r\n        },\r\n        showForm(event: any) {\r\n            const path = event.value ? `/tenants-management/${event.value.MULTITENANT_ID}` : '/tenants-management/new-tenant'\r\n            this.hintVisible = false\r\n\r\n            if (!this.touched) {\r\n                this.$router.push(path)\r\n                this.selTenant = event.value\r\n            } else {\r\n                this.$confirm.require({\r\n                    message: this.$t('common.toast.unsavedChangesMessage'),\r\n                    header: this.$t('common.toast.unsavedChangesHeader'),\r\n                    icon: 'pi pi-exclamation-triangle',\r\n                    accept: () => {\r\n                        this.touched = false\r\n                        this.$router.push(path)\r\n                        this.selTenant = event.value\r\n                    }\r\n                })\r\n            }\r\n        },\r\n        pageReload() {\r\n            this.touched = false\r\n            this.hintVisible = true\r\n            this.loadTenants()\r\n        },\r\n        onFormClose() {\r\n            this.touched = false\r\n            this.hintVisible = true\r\n        }\r\n    }\r\n})\r\n</script>\r\n"],"names":["FabButton","Listbox","mainStore","_openBlock","_createElementBlock","_createElementVNode","_createVNode","_withCtx","_createBlock","_createCommentVNode","_toDisplayString"],"mappings":"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"}