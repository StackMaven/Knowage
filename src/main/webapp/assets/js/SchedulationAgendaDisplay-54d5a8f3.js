import{_ as L,d as I,ad as _,k as E,l as z,n as N,a6 as y,ae as A,W as j,r as h,o as u,c as g,a as i,f as l,D as m,B,C as S,h as T,w as f,t as v,A as w,g as D}from"./index-1e676509.js";import{s as R}from"./selectbutton.esm-1085ac65.js";import{s as $}from"./SchedulationAgendaDescriptor-311b564c.js";const U=I({name:"schedulation-agenda-display",components:{Card:_,Badge:E,Column:z,DataTable:N,SelectButton:R},props:{itemList:Array},data(){return{selectedItem:{},displayMode:"time",expandedRows:[],schedulationAgendaDescriptor:$,dataItemList:[],groupedItemList:[],colorDictionary:{},selectedDisplayMode:null,displayModes:[{name:this.$t("managers.schedulationAgendaManagement.detail.time"),code:"time"},{name:this.$t("managers.schedulationAgendaManagement.detail.package"),code:"package"},{name:this.$t("managers.schedulationAgendaManagement.detail.document"),code:"document"}]}},watch:{itemList(){this.dataItemList=this.itemList,this.displayMode&&this.updateDisplayData(this.displayMode)},selectedDisplayMode(){this.selectedDisplayMode&&(this.displayMode=this.selectedDisplayMode.code,this.updateDisplayData(this.displayMode))}},methods:{updateDisplayData(t){this.runDisplay(t)},runDisplay(t){switch(this.groupedItemList=[],this.displayMode=t,t){case"time":this.groupedItemList=this.createTimeItemList();break;case"package":this.groupedItemList=this.createPackageItemList();break;case"document":this.groupedItemList=this.createDocumentItemList();break}},openRedirection(t){t&&this.$router.push(`/scheduler/edit-package-schedule?id=${t}&clone=false`)},getRandomColor(t){let o=this.colorDictionary[t];if(!o){for(var a="0123456789ABCDEF",e="#",r=0;r<6;r++)e+=a[Math.floor(Math.random()*16)];o=e,this.colorDictionary[t]=o}return o},createDocumentItemList(){let t=0;const o=[];for(let a=0;a<this.dataItemList.length;a++)if(this.dataItemList[a].triggers&&this.dataItemList[a].triggers[0].executions)for(let e=0;e<this.dataItemList[a].triggers.length;e++)for(let r=0;r<this.dataItemList[a].triggers[e].executions.length;r++)for(let d=0;d<this.dataItemList[a].triggers[e].documents.length;d++){let c=o.find(p=>p.document===this.dataItemList[a].triggers[e].documents[d]);c||(c={jobName:"",color:"red",document:this.dataItemList[a].triggers[e].documents[d],executions:[]},o.push(c));let n=c.executions.find(p=>p.date==new Date(this.dataItemList[a].triggers[e].executions[r]));n||(n={id:t++,date:this.formatDateTime(this.dataItemList[a].triggers[e].executions[r]),jobName:this.dataItemList[a].triggers[e].jobName,numberOfDocuments:this.dataItemList[a].triggers[e].documents.length,documents:this.dataItemList[a].triggers[e].documents},c.executions.push(n))}return o},createPackageItemList(){let t=0;const o=[];for(let a=0;a<this.dataItemList.length;a++)if(this.dataItemList[a].triggers&&this.dataItemList[a].triggers[0].executions){let e={jobName:this.dataItemList[a].name,color:"red",document:"",executions:[]};for(let r=0;r<this.dataItemList[a].triggers.length;r++)for(let d=0;d<this.dataItemList[a].triggers[r].executions.length;d++){let c={id:t++,rawDate:new Date(this.dataItemList[a].triggers[r].executions[d]),date:this.formatDateTime(this.dataItemList[a].triggers[r].executions[d]),jobName:this.dataItemList[a].triggers[r].jobName,numberOfDocuments:this.dataItemList[a].triggers[r].documents.length,documents:this.dataItemList[a].triggers[r].documents};const n=y(c.rawDate),p=e.executions.findIndex(b=>n.isBefore(b.rawDate));p>=0?e.executions.splice(p,0,c):e.executions.push(c)}o.push(e)}return o},createTimeItemList(){let t=0;const o=[];for(let a=0;a<this.dataItemList.length;a++)if(this.dataItemList[a].triggers&&this.dataItemList[a].triggers[0].executions)for(let e=0;e<this.dataItemList[a].triggers.length;e++)for(let r=0;r<this.dataItemList[a].triggers[e].executions.length;r++){let d=o.find(b=>y(b.date).isSame(this.dataItemList[a].triggers[e].executions[r],"day"));if(!d){d=this.createTimeGrupItem(this.dataItemList[a].triggers[e].executions[r]);const b=y(d.rawDate),x=o.findIndex(M=>b.isBefore(M.rawDate));x>=0?o.splice(x,0,d):o.push(d)}let c={id:t++,rawDate:new Date(this.dataItemList[a].triggers[e].executions[r]),date:this.dataItemList[a].triggers[e].executions[r],jobName:this.dataItemList[a].triggers[e].jobName,numberOfDocuments:this.dataItemList[a].triggers[e].documents.length,documents:this.dataItemList[a].triggers[e].documents};const n=y(c.rawDate),p=d.executions.findIndex(b=>n.isBefore(b.rawDate));p>=0?d.executions.splice(p,0,c):d.executions.push(c)}return o},createTimeGrupItem(t){return{jobName:"",color:"red",rawDate:new Date(t),date:A(t),dayOfWeek:A(t,{weekday:"long"}),monthName:A(t,{month:"long"}),year:new Date(t).getFullYear(),day:new Date(t).getDate(),document:"",executions:[]}},returnTime(t){var o=new Date(t);if(o)return o.toLocaleTimeString(navigator.language,{hour:"2-digit",minute:"2-digit"})},formatDateTime(t){return j(t,"DD/MM/YYYY HH:MM")}}}),O={class:"parent-card p-d-flex p-flex-column"},V={class:"flex-grow overflow-auto"},Y={class:"p-grid p-m-0"},X={class:"p-col-3"},Q={key:0,class:"p-d-flex p-jc-center p-ai-center"},F={class:"p-d-flex p-mx-3"},G={class:"p-text-bold p-text-center p-large"},J={class:"p-d-flex p-flex-column p-t-2"},W={class:"p-text-left p-text-bold p-m-1"},H={class:"p-text-left p-m-1"},K={key:1,class:"p-d-flex p-jc-center p-ai-center"},Z={class:"p-d-flex"},q={key:2,class:"p-d-flex p-jc-center p-ai-center"},P={class:"p-d-flex"},tt={class:"p-col-9"};function at(t,o,a,e,r,d){const c=h("SelectButton"),n=h("Column"),p=h("Badge"),b=h("Button"),x=h("DataTable"),M=h("Card");return u(),g("div",O,[i("span",{class:"p-d-flex flex-no-grow p-mx-2",style:m(t.schedulationAgendaDescriptor.span.style)},[l(c,{class:"p-m-1",modelValue:t.selectedDisplayMode,"onUpdate:modelValue":o[0]||(o[0]=k=>t.selectedDisplayMode=k),options:t.displayModes,optionLabel:"name","data-test":"select-button"},null,8,["modelValue","options"])],4),i("div",V,[(u(!0),g(B,null,S(t.groupedItemList,k=>(u(),T(M,{key:k,class:"p-mx-3 p-my-1"},{content:f(()=>[i("div",Y,[i("div",X,[t.displayMode==="time"?(u(),g("div",Q,[i("div",F,[i("p",G,v(k.day),1)]),i("div",J,[i("p",W,v(k.dayOfWeek),1),i("p",H,v(k.monthName+" "+k.year),1)])])):w("",!0),t.displayMode==="package"?(u(),g("div",K,[i("div",Z,[i("h2",null,v(k.jobName),1)])])):w("",!0),t.displayMode==="document"?(u(),g("div",q,[i("div",P,[i("h2",null,v(k.document),1)])])):w("",!0)]),i("div",tt,[l(x,{value:k.executions,expandedRows:t.expandedRows,"onUpdate:expandedRows":o[1]||(o[1]=s=>t.expandedRows=s),class:"custom-row-border p-datatable-sm kn-table",dataKey:"id",rows:10,rowClass:t.rowClass,responsiveLayout:"stack",breakpoint:"960px","data-test":"data-table"},{empty:f(()=>[D(v(t.$t("common.info.noDataFound")),1)]),expansion:f(s=>[i("div",null,[l(x,{value:s.data.documents},{default:f(()=>[l(n,null,{body:f(()=>[l(b,{icon:"pi pi-book",class:"p-button-link"})]),_:1}),l(n,{style:m(t.schedulationAgendaDescriptor.table.iconColumn.style)},{body:f(()=>[l(b,{icon:"pi pi-document",class:"p-button-link"})]),_:1},8,["style"]),l(n,null,{body:f(C=>[D(v(C.data),1)]),_:2},1024)]),_:2},1032,["value"])])]),default:f(()=>[l(n,{field:"date",style:m(t.schedulationAgendaDescriptor.table.dateColumn.style)},{body:f(s=>[t.displayMode=="time"?(u(),g("div",{key:0,class:"p-pl-1 color-left-border",style:m({borderLeftColor:t.getRandomColor(s.data.jobName)})},v(new Date(s.data.date).getHours()+":"+new Date(s.data.date).getMinutes()),5)):w("",!0),t.displayMode=="package"||t.displayMode=="document"?(u(),g("div",{key:1,class:"p-pl-1 color-left-border",style:m({borderLeftColor:t.getRandomColor(s.data.jobName)})},v(s.data.date),5)):w("",!0)]),_:1},8,["style"]),l(n,{field:"jobName"}),l(n,{field:"numberOfDocuments",style:m(t.schedulationAgendaDescriptor.table.badgeColumn.style)},{body:f(s=>[l(p,{value:s.data.numberOfDocuments},null,8,["value"])]),_:1},8,["style"]),l(n,{style:m(t.schedulationAgendaDescriptor.table.rowExpanderColumn.style),expander:!0},null,8,["style"]),l(n,{style:m(t.schedulationAgendaDescriptor.table.iconColumn.style)},{body:f(s=>[l(b,{icon:"pi pi-pencil",class:"p-button-link",onClick:C=>t.openRedirection(s.data.jobName),"data-test":"action-button"},null,8,["onClick"])]),_:1},8,["style"])]),_:2},1032,["value","expandedRows","rowClass"])])])]),_:2},1024))),128))])])}var dt=L(U,[["render",at],["__scopeId","data-v-5f7dc89c"]]);export{dt as default};
//# sourceMappingURL=SchedulationAgendaDisplay-54d5a8f3.js.map
