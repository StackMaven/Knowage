import{d as w,ad as I,a5 as O,_ as M,r as d,o as s,h as R,w as S,a as n,t as r,f as l,G as D,D as u,z as v,Y as f,c as o,A as k,B as g,C as T}from"./index-1e676509.js";import{s as P}from"./calendar.esm-60a451ba.js";import{s as U}from"./checkbox.esm-fa6c8259.js";import{s as A}from"./inputswitch.esm-80317a38.js";import{k as E}from"./KnCronDescriptor-98645843.js";import{s as L}from"./multiselect.esm-ce4000f7.js";const B=w({name:"frequency-card",components:{Calendar:P,Card:I,Checkbox:U,Dropdown:O,InputSwitch:A,MultiSelect:L},props:{frequency:{type:Object,required:!0}},emits:["touched","cronValid"],data(){return{knCronDescriptor:E,currentFrequency:{},startDate:null,endDate:null,startTime:null,endTime:null,repeatInterval:null,parameter:null,parameterOptions:[],simpleMonth:!0,simpleDay:!0,parameterMonth:null,parameterDay:null,dayOptions:[],selectedDays:[],selectedMonths:[],simpleDayParameter:null}},computed:{validDates(){let e=!0;const t=this.currentFrequency.startDate,p=new Date,i=this.currentFrequency.endDate;return i&&i.valueOf()<p.valueOf()&&(e=!1),i&&t&&i.valueOf()<t.valueOf()&&(e=!1),this.$emit("cronValid",e&&this.validInterval),e},validInterval(){const e=!!this.repeatInterval;return this.$emit("cronValid",e&&this.validDates),e}},watch:{repeatInterval(){switch(this.repeatInterval){case"minute":this.fillParameterOptions(60);break;case"hour":this.fillParameterOptions(24);break;case"day":this.fillParameterOptions(31);break;case"week":this.selectedDays=[];break;case"month":this.fillParameterOptions(12),this.fillDayOptions(),this.selectedDays=[]}this.parameter="1",this.simpleDayParameter="1"},simpleMonth(e){e?(this.fillParameterOptions(12),delete this.currentFrequency.cron.parameter.months,this.parameter="1",this.updateCronSimpleMonthRepetition(!1)):(this.parameterOptions=this.knCronDescriptor.monthOptions,delete this.currentFrequency.cron.parameter.numRepetition,this.parameter=null,this.updateCronAdvancedMonthRepetition(!1))},simpleDay(e){e?(this.fillDayOptions(),delete this.currentFrequency.cron.parameter.weeks,delete this.currentFrequency.cron.parameter.days,this.updateCronSimpleDayRepetition(!1)):(this.dayOptions=this.knCronDescriptor.weeklyOptions,delete this.currentFrequency.cron.parameter.dayRepetition,this.updateCronAdvancedDayRepetition(!1))},frequency(){!this.frequency||this.loadFrequency()}},async created(){this.loadFrequency()},methods:{loadFrequency(){switch(this.currentFrequency=this.frequency,this.startDate=new Date(this.currentFrequency.startDate),this.startTime=new Date(this.currentFrequency.startDate),this.startDate.setHours(0),this.startDate.setMinutes(0),this.currentFrequency.endDate?(this.endDate=new Date(this.currentFrequency.endDate),this.endTime=new Date(this.currentFrequency.endDate),this.endDate.setHours(0),this.endDate.setMinutes(0)):(this.endDate=null,this.endTime=null),this.currentFrequency.startTime="",this.currentFrequency.endTime="",this.currentFrequency.cron||(this.currentFrequency.cron={type:"minute",parameter:{numRepetition:"1"}}),this.repeatInterval=this.currentFrequency.cron.type,this.repeatInterval){case"minute":case"hour":case"day":this.parameter=""+this.currentFrequency.cron.parameter.numRepetition;break;case"week":this.selectedDays=[],this.currentFrequency.cron.parameter.days.forEach(e=>this.selectedDays.push(e));break;case"month":this.currentFrequency.cron.parameter.months?(this.selectedMonths=[],this.currentFrequency.cron.parameter.months.forEach(e=>{this.selectedMonths.push(e)}),this.simpleMonth=!1):this.parameter=this.currentFrequency.cron.parameter.numRepetition,this.currentFrequency.cron.parameter.weeks?(this.selectedDays=[],this.currentFrequency.cron.parameter.days.forEach(e=>this.selectedDays.push(""+e)),this.parameterDay=this.currentFrequency.cron.parameter.weeks,this.simpleDay=!1):this.simpleDayParameter=this.currentFrequency.cron.parameter.dayRepetition}},fillParameterOptions(e){this.parameterOptions=[];for(let t=1;t<=e;t++)this.parameterOptions.push({name:t,value:""+t})},fillDayOptions(){this.dayOptions=[];for(let e=1;e<=31;e++)this.dayOptions.push({name:e,value:""+e})},updateCronInterval(){switch(this.currentFrequency.cron?this.currentFrequency.cron.type=this.repeatInterval:this.currentFrequency.cron={type:this.repeatInterval},this.repeatInterval){case"minute":case"hour":case"day":this.currentFrequency.cron={type:this.currentFrequency.cron.type,parameter:{numRepetition:this.parameter}};break;case"week":this.currentFrequency.cron={type:this.currentFrequency.cron.type,parameter:{days:this.selectedDays.map(e=>e)}};break;case"month":this.currentFrequency.cron={type:this.currentFrequency.cron.type,parameter:{numRepetition:this.parameter,dayRepetition:this.simpleDayParameter}}}this.$emit("touched")},updateCronNumberOfRepetition(){this.currentFrequency.cron={type:this.currentFrequency.cron.type,parameter:{numRepetition:this.parameter}},this.$emit("touched")},updateCronDays(){setTimeout(()=>{this.currentFrequency.cron={type:this.currentFrequency.cron.type,parameter:{days:this.selectedDays}},this.$emit("touched")},50)},updateCronSimpleMonthRepetition(e){this.currentFrequency.cron.parameter.numRepetition=this.parameter,e&&this.$emit("touched")},updateCronSimpleDayRepetition(e){this.currentFrequency.cron.parameter.dayRepetition=this.simpleDayParameter,e&&this.$emit("touched")},updateCronAdvancedMonthRepetition(e){this.currentFrequency.cron.parameter.months=this.selectedMonths,e&&this.$emit("touched")},updateCronAdvancedDayRepetition(e){this.currentFrequency.cron.parameter.weeks=this.parameterDay,this.currentFrequency.cron.parameter.days=this.selectedDays,e&&this.$emit("touched")},setDate(e){var h,y;const t=e==="startDate"?(h=this.startDate)==null?void 0:h.valueOf():(y=this.endDate)==null?void 0:y.valueOf(),p=e==="startDate"?this.startTime:this.endTime;let i=0;p&&p instanceof Date&&(i=p.getHours()*60*60*1e3+p.getMinutes()*60*1e3),t&&(this.currentFrequency[e]=t+i),this.$emit("touched")},clearEndDate(){this.currentFrequency.endDate=null}}}),N={class:"p-d-flex p-ai-center p-mt-2"},z={class:"p-d-flex p-flex-row p-col-5"},H={for:"startDate",class:"kn-material-input-label p-m-2"},K={class:"p-error p-grid"},j={class:"p-col-12"},G={class:"p-col-4 p-d-flex p-ai-center"},W={for:"startTime",class:"kn-material-input-label p-m-2"},Y={class:"p-d-flex p-ai-center p-mt-3"},J={class:"p-d-flex p-flex-row p-col-5"},Q={for:"endDate",class:"kn-material-input-label p-m-2"},X={class:"p-error p-grid"},Z={class:"p-col-12"},_={key:0,class:"p-col-6 p-d-flex p-ai-center"},x={for:"endTime",class:"kn-material-input-label p-m-2"},ee={class:"p-d-flex p-flex-row"},te={class:"p-d-flex p-flex-row p-mt-5"},ae={class:"p-d-flex p-flex-row p-mr-4"},ne={class:"kn-material-input-label p-m-2"},re={class:"p-error"},se={class:"p-col-12"},le={key:0,class:"p-d-flex p-flex-row"},oe={for:"parameter",class:"kn-material-input-label p-m-2"},ie={key:1,class:"p-d-flex p-flex-row p-m-2"},pe={class:"p-m-1"},ue={key:2,class:"p-d-flex p-flex-row"},de={class:"p-m-2"},me={class:"p-mr-2"},ce={key:0,class:"p-d-flex p-flex-row p-mt-2"},he={for:"parameterMonth",class:"kn-material-input-label p-m-2"},ye={for:"parameterMonth",class:"kn-material-input-label p-m-2"},De={key:1,class:"p-d-flex p-flex-row p-mt-2"},ve={class:"kn-material-input-label p-m-2"},fe={class:"p-m-2"},ke={class:"p-mr-2"},Ce={key:0,class:"p-d-flex p-flex-row p-mt-2"},qe={for:"parameterDay",class:"kn-material-input-label p-m-2"},Ve={key:1,class:"p-d-flex p-flex-row p-mt-2"},Fe={for:"parameterDay",class:"kn-material-input-label p-m-2"},$e={for:"parameterDay",class:"kn-material-input-label p-m-2"},be={key:3,for:"parameter",class:"kn-material-input-label p-m-2"},we={key:4,for:"parameter",class:"kn-material-input-label p-m-2"},Ie={key:5,for:"parameter",class:"kn-material-input-label p-m-2"};function Oe(e,t,p,i,h,y){const c=d("Calendar"),m=d("Dropdown"),V=d("Checkbox"),C=d("InputSwitch"),q=d("MultiSelect"),F=d("Card");return s(),R(F,{style:u(e.knCronDescriptor.style.cardContainer)},{content:S(()=>[n("div",N,[n("div",z,[n("label",H,r(e.$t("cron.startDate")+":"),1),n("span",null,[l(c,{id:"startDate",class:D(["kn-material-input",{"p-invalid":!e.validDates}]),style:u(e.knCronDescriptor.style.calendarInput),modelValue:e.startDate,"onUpdate:modelValue":t[0]||(t[0]=a=>e.startDate=a),showIcon:!0,manualInput:!0,onChange:t[1]||(t[1]=a=>e.setDate("startDate")),onDateSelect:t[2]||(t[2]=a=>e.setDate("startDate"))},null,8,["style","modelValue","class"]),v(n("div",K,[n("small",j,r(e.$t("kpi.kpiScheduler.dateError")),1)],512),[[f,!e.validDates]])])]),n("div",G,[n("label",W,r(e.$t("cron.startTime")+":"),1),n("span",null,[l(c,{id:"startTime",style:u(e.knCronDescriptor.style.timePicker),class:"kn-material-input custom-timepicker",modelValue:e.startTime,"onUpdate:modelValue":t[3]||(t[3]=a=>e.startTime=a),manualInput:!0,timeOnly:!0,hourFormat:"24",onChange:t[4]||(t[4]=a=>e.setDate("startDate")),onDateSelect:t[5]||(t[5]=a=>e.setDate("startDate"))},null,8,["style","modelValue"])])])]),n("div",Y,[n("div",J,[n("label",Q,r(e.$t("cron.endDate")+":"),1),n("span",null,[l(c,{id:"endDate",class:D(["kn-material-input p-ml-2",{"p-invalid":!e.validDates}]),style:u(e.knCronDescriptor.style.calendarInput),modelValue:e.endDate,"onUpdate:modelValue":t[6]||(t[6]=a=>e.endDate=a),showIcon:!0,manualInput:!0,showButtonBar:!0,onChange:t[7]||(t[7]=a=>e.setDate("endDate")),onDateSelect:t[8]||(t[8]=a=>e.setDate("endDate")),onClearClick:e.clearEndDate},null,8,["style","modelValue","class","onClearClick"]),v(n("div",X,[n("small",Z,r(e.$t("kpi.kpiScheduler.dateError")),1)],512),[[f,!e.validDates]])])]),e.endDate?(s(),o("div",_,[n("label",x,r(e.$t("cron.endTime")+":"),1),n("span",null,[l(c,{id:"endTime",style:u(e.knCronDescriptor.style.timePicker),class:"kn-material-input p-ml-2 custom-timepicker",modelValue:e.endTime,"onUpdate:modelValue":t[9]||(t[9]=a=>e.endTime=a),manualInput:!0,timeOnly:!0,hourFormat:"24",onChange:t[10]||(t[10]=a=>e.setDate("endDate")),onDateSelect:t[11]||(t[11]=a=>e.setDate("endDate"))},null,8,["style","modelValue"])])])):k("",!0)]),n("div",ee,[n("div",te,[n("div",ae,[n("label",ne,r(e.$t("cron.repeatInterval")+":")+" *",1),n("span",null,[l(m,{id:"repeatInterval",class:D(["kn-material-input",{"p-error":!e.validInterval}]),style:u(e.knCronDescriptor.style.intervalInput),optionLabel:"name",optionValue:"value",modelValue:e.repeatInterval,"onUpdate:modelValue":t[12]||(t[12]=a=>e.repeatInterval=a),options:e.knCronDescriptor.intervals,onChange:e.updateCronInterval},null,8,["class","style","modelValue","options","onChange"]),v(n("div",re,[n("small",se,r(e.$t("cron.repeatInterval")+" is required!"),1)],512),[[f,!e.validInterval]])])]),e.repeatInterval==="minute"||e.repeatInterval==="hour"||e.repeatInterval==="day"?(s(),o("div",le,[n("label",oe,r(e.$t("kpi.kpiScheduler.every")),1),n("span",null,[l(m,{id:"parameter",class:"kn-material-input",optionLabel:"name",optionValue:"value",modelValue:e.parameter,"onUpdate:modelValue":t[13]||(t[13]=a=>e.parameter=a),options:e.parameterOptions,onChange:e.updateCronNumberOfRepetition},null,8,["modelValue","options","onChange"])])])):e.repeatInterval==="week"?(s(),o("div",ie,[(s(!0),o(g,null,T(e.knCronDescriptor.weeklyOptions,(a,$)=>(s(),o("div",{key:$},[n("span",pe,r(a.name+":"),1),l(V,{value:a.value,modelValue:e.selectedDays,"onUpdate:modelValue":t[14]||(t[14]=b=>e.selectedDays=b),onClick:e.updateCronDays},null,8,["value","modelValue","onClick"])]))),128))])):e.repeatInterval==="month"?(s(),o("div",ue,[n("div",de,[n("div",null,[n("span",me,r(e.$t("cron.advanced")),1),l(C,{class:"p-mr-2",modelValue:e.simpleMonth,"onUpdate:modelValue":t[15]||(t[15]=a=>e.simpleMonth=a)},null,8,["modelValue"]),n("span",null,r(e.$t("cron.simple")),1)]),e.simpleMonth?(s(),o("div",ce,[n("label",he,r(e.$t("kpi.kpiScheduler.every")),1),l(m,{class:"kn-material-input",optionLabel:"name",optionValue:"value",modelValue:e.parameter,"onUpdate:modelValue":t[16]||(t[16]=a=>e.parameter=a),options:e.parameterOptions,onChange:t[17]||(t[17]=a=>e.updateCronSimpleMonthRepetition(!0))},null,8,["modelValue","options"]),n("label",ye,r(e.$t("cron.months")),1)])):(s(),o("div",De,[n("label",ve,r(e.$t("cron.inMonth")),1),l(q,{class:"kn-material-input",optionLabel:"name",optionValue:"value",modelValue:e.selectedMonths,"onUpdate:modelValue":t[18]||(t[18]=a=>e.selectedMonths=a),options:e.parameterOptions,onChange:t[19]||(t[19]=a=>e.updateCronAdvancedMonthRepetition(!0))},null,8,["modelValue","options"])]))]),n("div",fe,[n("span",ke,r(e.$t("cron.advanced")),1),l(C,{class:"p-mr-2",modelValue:e.simpleDay,"onUpdate:modelValue":t[20]||(t[20]=a=>e.simpleDay=a)},null,8,["modelValue"]),n("span",null,r(e.$t("cron.simple")),1),e.simpleDay?(s(),o("div",Ce,[n("label",qe,r(e.$t("cron.theDay")),1),l(m,{class:"kn-material-input",optionLabel:"name",optionValue:"value",modelValue:e.simpleDayParameter,"onUpdate:modelValue":t[21]||(t[21]=a=>e.simpleDayParameter=a),options:e.dayOptions,onChange:t[22]||(t[22]=a=>e.updateCronSimpleDayRepetition(!0))},null,8,["modelValue","options"])])):(s(),o("div",Ve,[n("label",Fe,r(e.$t("cron.theWeek")),1),l(m,{class:"kn-material-input",style:u(e.knCronDescriptor.style.advancedDayDropdown),optionLabel:"name",optionValue:"value",modelValue:e.parameterDay,"onUpdate:modelValue":t[23]||(t[23]=a=>e.parameterDay=a),options:e.knCronDescriptor.dayOptions,onChange:t[24]||(t[24]=a=>e.updateCronAdvancedDayRepetition(!0))},null,8,["style","modelValue","options"]),n("label",$e,r(e.$t("cron.inDay")),1),l(q,{class:"kn-material-input",optionLabel:"name",optionValue:"value",modelValue:e.selectedDays,"onUpdate:modelValue":t[25]||(t[25]=a=>e.selectedDays=a),options:e.knCronDescriptor.weeklyOptions,onChange:e.updateCronAdvancedDayRepetition},null,8,["modelValue","options","onChange"])]))])])):k("",!0),e.repeatInterval==="minute"?(s(),o("label",be,r(e.$t("cron.minutes")),1)):e.repeatInterval==="hour"?(s(),o("label",we,r(e.$t("cron.hours")),1)):e.repeatInterval==="day"?(s(),o("label",Ie,r(e.$t("cron.days")),1)):k("",!0)])])]),_:1},8,["style"])}var Ue=M(B,[["render",Oe]]);export{Ue as K};
//# sourceMappingURL=KnCron-7fa39115.js.map
