import{d as M,ad as z,_ as S,r as n,o as p,h as f,w as r,f as t,g as A,t as d,a as o,c as C,C as L,B as U,A as w,l as K,n as V,i as I,W as N,D as x,a5 as O,a7 as B,G as E,p as X,b as j,m as Y,s as F}from"./index-1e676509.js";import{s as R}from"./radiobutton.esm-c3e6fa9b.js";import{f as T}from"./filterHelper-a723991a.js";import{s as G}from"./checkbox.esm-fa6c8259.js";import{s as q}from"./colorpicker.esm-423214e6.js";const W=[{label:"common.list",value:"list"},{label:"common.widget",value:"widget"}];var Z={documentTypeOptions:W};const H=M({name:"kpi-document-designer-document-type-card",components:{Card:z,RadioButton:R},props:{propChart:{type:Object}},emits:["documentTypeChanged"],data(){return{kpiDocumentDesignerDocumentTypeCardDescriptor:Z,chart:null}},watch:{propChart(){this.loadChart()}},created(){this.loadChart()},methods:{loadChart(){this.chart=this.propChart}}}),P={class:"p-d-flex p-flex-row"},ee=["for"];function ae(e,a,b,h,y,$){const v=n("Toolbar"),u=n("RadioButton"),s=n("Card");return e.chart?(p(),f(s,{key:0,class:"p-m-2"},{header:r(()=>[t(v,{class:"kn-toolbar kn-toolbar--secondary"},{start:r(()=>[A(d(e.$t("kpi.kpiDocumentDesigner.typeOfDocument")),1)]),_:1})]),content:r(()=>[o("div",P,[(p(!0),C(U,null,L(e.kpiDocumentDesignerDocumentTypeCardDescriptor.documentTypeOptions,(c,i)=>(p(),C("div",{class:"field-radiobutton p-mx-2",key:i},[t(u,{id:c.value,value:c.value,modelValue:e.chart.model,"onUpdate:modelValue":a[0]||(a[0]=k=>e.chart.model=k),onChange:a[1]||(a[1]=k=>e.$emit("documentTypeChanged"))},null,8,["id","value","modelValue"]),o("label",{for:c.value,class:"p-ml-2"},d(e.$t(c.label)),9,ee)]))),128))])]),_:1})):w("",!0)}var oe=S(H,[["render",ae]]);const te={flex:1},re=[{field:"name",header:"common.name",style:{flex:1}},{field:"category",header:"common.category",style:{flex:1}}],ne={contentStyle:{"padding-left":"1rem","padding-top":"1rem"},style:{height:"60%","max-height":"60%","max-width":"60%","min-width":"60%"}},ie=["name","category"],le={flex:.5,"justify-content":"end"},de=[{label:"kpi.kpiDocumentDesigner.suffix",value:"true"},{label:"kpi.kpiDocumentDesigner.prefix",value:"false"}],se=["name","category.valueCd","author"],ce=[{label:"kpi.kpiDocumentDesigner.speedometer",value:"speedometer"},{label:"kpi.kpiDocumentDesigner.kpiCard",value:"kpicard"}];var Q={columnStyle:te,columns:re,dialog:ne,globalFilterFields:ie,iconColumnStyle:le,prefixSuffixOptions:de,selectKpiGlobalFilterFields:se,viewAsOptions:ce};const pe=M({name:"kpi-edit-kpi-select-dialog",components:{Column:K,DataTable:V,Dialog:I},props:{visible:{type:Boolean},kpiList:{type:Array},data:{type:Object,required:!0}},emits:["close","kpiSelected"],data(){return{kpiDocumentDesignerKpiListCardDescriptor:Q,filters:{global:[T]},selectedKpiAssociations:[]}},watch:{visible(){this.setSelectedKpiAssociations()}},async created(){this.setSelectedKpiAssociations()},methods:{getFormattedDate(e){return N(e)},setSelectedKpiAssociations(){var e;this.selectedKpiAssociations=[],this.data.kpi&&((e=this.kpiList)==null||e.forEach(a=>{this.data.kpi.findIndex(h=>a.name===h.name)!==-1&&this.selectedKpiAssociations.push(a)}))},closeKpiAssociations(){this.selectedKpiAssociations=[],this.$emit("close")},addKpiAssociations(){this.$emit("kpiSelected",this.selectedKpiAssociations)}}}),be={class:"table-header p-d-flex"},ke={class:"p-input-icon-left p-mr-3"},ue=o("i",{class:"pi pi-search"},null,-1);function me(e,a,b,h,y,$){const v=n("Toolbar"),u=n("InputText"),s=n("Column"),c=n("DataTable"),i=n("Button"),k=n("Dialog");return p(),f(k,{id:"kpi-edit-kpi-select-dialog",class:"p-fluid kn-dialog--toolbar--primary",style:x(e.kpiDocumentDesignerKpiListCardDescriptor.dialog.style),contentStyle:e.kpiDocumentDesignerKpiListCardDescriptor.dialog.contentStyle,visible:e.visible,modal:!0,closable:!1},{header:r(()=>[t(v,{class:"kn-toolbar kn-toolbar--primary p-p-0 p-m-0 p-col-12"},{start:r(()=>[A(d(e.$t("kpi.kpiDocumentDesigner.kpiList")),1)]),_:1})]),footer:r(()=>[t(i,{class:"kn-button kn-button--primary",label:e.$t("common.close"),onClick:e.closeKpiAssociations},null,8,["label","onClick"]),t(i,{class:"kn-button kn-button--primary",label:e.$t("common.save"),onClick:e.addKpiAssociations},null,8,["label","onClick"])]),default:r(()=>[t(c,{value:e.kpiList,selection:e.selectedKpiAssociations,"onUpdate:selection":a[1]||(a[1]=g=>e.selectedKpiAssociations=g),class:"p-datatable-sm kn-table",dataKey:"id",filters:e.filters,"onUpdate:filters":a[2]||(a[2]=g=>e.filters=g),kpiDocumentDesignerKpiListCardDescriptor:e.kpiDocumentDesignerKpiListCardDescriptor.selectKpiGlobalFilterFields,responsiveLayout:"stack",breakpoint:"960px",scrollable:!0,scrollHeight:"80vh"},{header:r(()=>[o("div",be,[o("span",ke,[ue,t(u,{class:"kn-material-input",modelValue:e.filters.global.value,"onUpdate:modelValue":a[0]||(a[0]=g=>e.filters.global.value=g),type:"text",placeholder:e.$t("common.search"),"data-test":"filterInput"},null,8,["modelValue","placeholder"])])])]),empty:r(()=>[A(d(e.$t("common.info.noDataFound")),1)]),default:r(()=>[t(s,{selectionMode:"multiple",headerStyle:"width: 3em"}),t(s,{class:"kn-truncated",field:"name",header:e.$t("kpi.kpiScheduler.kpiName"),key:"name",sortable:!0},null,8,["header"]),t(s,{class:"kn-truncated",field:"category.valueCd",header:e.$t("common.category"),key:"category.valueCd",sortable:!0},null,8,["header"]),t(s,{class:"kn-truncated",field:"dateCreation",header:e.$t("kpi.kpiScheduler.kpiName"),key:"dateCreation",sortable:!0},{body:r(g=>[o("span",null,d(e.getFormattedDate(g.data.dateCreation)),1)]),_:1},8,["header"]),t(s,{class:"kn-truncated",field:"author",header:e.$t("common.author"),key:"author",sortable:!0},null,8,["header"])]),_:1},8,["value","selection","filters","kpiDocumentDesignerKpiListCardDescriptor"])]),_:1},8,["style","contentStyle","visible"])}var ge=S(pe,[["render",me]]);const ve=M({name:"kpi-edit-kpi-list-card",components:{Card:z,Column:K,DataTable:V,Dropdown:O,KpiDocumentDesignerKpiSelectDialog:ge},props:{propData:{type:Object},kpiList:{type:Array},documentType:{type:String}},data(){return{KpiDocumentDesignerKpiListCardDescriptor:Q,data:{kpi:[]},filters:{global:[T]},addKpiAssociationVisible:!1,showSaveAsColumn:!1}},watch:{propData(){this.loadData()},documentType(){this.setShowSaveAsColumn()}},created(){this.loadData()},methods:{loadData(){this.data={kpi:[]},this.propData&&(this.data=Array.isArray(this.propData.kpi)?this.propData:{kpi:[this.propData.kpi]},this.setShowSaveAsColumn())},setShowSaveAsColumn(){this.showSaveAsColumn=this.documentType==="widget"},onKpiSelected(e){const a=B(this.data.kpi);this.data.kpi=[],e.forEach(b=>{const h=a.findIndex(y=>y.name===b.name);h!==-1?this.data.kpi.push(a[h]):this.data.kpi.push({isSuffix:"false",name:b.name,prefixSuffixValue:"",rangeMaxValue:"",rangeMinValue:"",vieweas:"Speedometer",category:b.category?b.category.valueName:""})}),this.addKpiAssociationVisible=!1},deleteKpiAssociationConfirm(e){this.$confirm.require({message:this.$t("common.toast.deleteMessage"),header:this.$t("common.toast.deleteTitle"),icon:"pi pi-exclamation-triangle",accept:()=>{this.deleteKpiAssociation(e)}})},deleteKpiAssociation(e){const a=this.data.kpi.findIndex(b=>b.name===e.name);a!==-1&&this.data.kpi.splice(a,1)}}}),_=e=>(X("data-v-479b4a06"),e=e(),j(),e),he={class:"table-header p-d-flex p-ai-center"},fe={id:"search-container",class:"p-input-icon-left p-mr-3"},we=_(()=>o("i",{class:"pi pi-search"},null,-1)),xe={key:0},ye={class:"p-d-flex p-flex-row p-ai-center"},De=_(()=>o("i",{class:"pi pi-pencil edit-icon kn-flex"},null,-1)),Ce={class:"p-d-flex p-flex-row p-ai-center"},Ae=_(()=>o("i",{class:"pi pi-pencil edit-icon kn-flex"},null,-1)),Me={class:"p-d-flex p-flex-row p-ai-center"},Se=_(()=>o("i",{class:"pi pi-pencil edit-icon kn-flex"},null,-1)),$e={key:0};function ze(e,a,b,h,y,$){const v=n("Toolbar"),u=n("InputText"),s=n("Button"),c=n("Column"),i=n("Dropdown"),k=n("DataTable"),g=n("KpiDocumentDesignerKpiSelectDialog"),D=n("Card");return e.data?(p(),f(D,{key:0,class:"p-m-2"},{header:r(()=>[t(v,{class:"kn-toolbar kn-toolbar--secondary"},{start:r(()=>[A(d(e.$t("kpi.kpiDocumentDesigner.kpiList")),1)]),_:1})]),content:r(()=>[o("div",null,[t(k,{value:e.data.kpi,class:"p-datatable-sm kn-table",dataKey:"name",filters:e.filters,"onUpdate:filters":a[2]||(a[2]=l=>e.filters=l),globalFilterFields:e.KpiDocumentDesignerKpiListCardDescriptor.globalFilterFields,responsiveLayout:"stack",breakpoint:"960px",scrollable:!0,"scroll-height":"60vh"},{header:r(()=>[o("div",he,[o("span",fe,[we,t(u,{class:"kn-material-input",modelValue:e.filters.global.value,"onUpdate:modelValue":a[0]||(a[0]=l=>e.filters.global.value=l),type:"text",placeholder:e.$t("common.search"),"data-test":"filterInput"},null,8,["modelValue","placeholder"])]),t(s,{id:"kpi-edit-add-kpi-associations-button",class:"kn-button kn-button--primary",label:e.$t("kpi.kpiScheduler.addKpiAssociation"),onClick:a[1]||(a[1]=l=>e.addKpiAssociationVisible=!0)},null,8,["label"])])]),empty:r(()=>[A(d(e.$t("common.info.noDataFound")),1)]),default:r(()=>[(p(!0),C(U,null,L(e.KpiDocumentDesignerKpiListCardDescriptor.columns,l=>(p(),f(c,{class:"kn-truncated",field:l.field,header:e.$t(l.header),key:l.field,style:x(l.style),sortable:!0},null,8,["field","header","style"]))),128)),e.showSaveAsColumn?(p(),f(c,{field:"vieweas",header:e.$t("kpi.kpiDocumentDesigner.viewAs"),key:"vieweas",sortable:!0,style:x(e.KpiDocumentDesignerKpiListCardDescriptor.columnStyle)},{body:r(l=>[t(i,{class:"kpi-edit-kpi-list-card-dropdown",modelValue:l.data[l.column.props.field],"onUpdate:modelValue":m=>l.data[l.column.props.field]=m,options:e.KpiDocumentDesignerKpiListCardDescriptor.viewAsOptions,optionValue:"value",placeholder:e.$t("kpi.kpiDocumentDesigner.viewAsPlaceholder")},{value:r(m=>[m.value?(p(),C("div",xe,[o("span",null,d(m.value==="speedometer"?e.$t("kpi.kpiDocumentDesigner.speedometer"):e.$t("kpi.kpiDocumentDesigner.kpiCard")),1)])):w("",!0)]),option:r(m=>[o("span",null,d(e.$t(m.option.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","placeholder"])]),_:1},8,["header","style"])):w("",!0),t(c,{field:"rangeMinValue",header:e.$t("kpi.kpiDocumentDesigner.rangeMinValue"),key:"rangeMinValue",sortable:!0,style:x(e.KpiDocumentDesignerKpiListCardDescriptor.columnStyle)},{body:r(l=>[o("div",ye,[t(u,{class:E(["kn-material-input p-mr-2 kn-flex",{"p-invalid":!l.data[l.column.props.field]}]),type:"number",modelValue:l.data[l.column.props.field],"onUpdate:modelValue":m=>l.data[l.column.props.field]=m},null,8,["modelValue","onUpdate:modelValue","class"]),De])]),_:1},8,["header","style"]),t(c,{field:"rangeMaxValue",header:e.$t("kpi.kpiDocumentDesigner.rangeMaxValue"),key:"rangeMaxValue",sortable:!0,style:x(e.KpiDocumentDesignerKpiListCardDescriptor.columnStyle)},{body:r(l=>[o("div",Ce,[t(u,{class:E(["kn-material-input p-mr-2 kn-flex",{"p-invalid":!l.data[l.column.props.field]}]),type:"number",modelValue:l.data[l.column.props.field],"onUpdate:modelValue":m=>l.data[l.column.props.field]=m},null,8,["modelValue","onUpdate:modelValue","class"]),Ae])]),_:1},8,["header","style"]),t(c,{field:"prefixSuffixValue",header:e.$t("kpi.kpiDocumentDesigner.prefixSuffixLabel"),key:"prefixSuffixValue",sortable:!0,style:x(e.KpiDocumentDesignerKpiListCardDescriptor.columnStyle)},{body:r(l=>[o("div",Me,[t(u,{class:"kn-material-input p-mr-2 kn-flex",modelValue:l.data[l.column.props.field],"onUpdate:modelValue":m=>l.data[l.column.props.field]=m,maxLength:"3"},null,8,["modelValue","onUpdate:modelValue"]),Se])]),_:1},8,["header","style"]),t(c,{field:"isSuffix",header:e.$t("kpi.kpiDocumentDesigner.showLabelAs"),key:"isSuffix",sortable:!0,style:x(e.KpiDocumentDesignerKpiListCardDescriptor.columnStyle)},{body:r(l=>[t(i,{modelValue:l.data[l.column.props.field],"onUpdate:modelValue":m=>l.data[l.column.props.field]=m,options:e.KpiDocumentDesignerKpiListCardDescriptor.prefixSuffixOptions,optionValue:"value"},{value:r(m=>[m.value?(p(),C("div",$e,[o("span",null,d(m.value==="true"?e.$t("kpi.kpiDocumentDesigner.suffix"):e.$t("kpi.kpiDocumentDesigner.prefix")),1)])):w("",!0)]),option:r(m=>[o("span",null,d(e.$t(m.option.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options"])]),_:1},8,["header","style"]),t(c,{style:x(e.KpiDocumentDesignerKpiListCardDescriptor.iconColumnStyle)},{body:r(l=>[t(s,{icon:"pi pi-trash",class:"p-button-link",onClick:m=>e.deleteKpiAssociationConfirm(l.data)},null,8,["onClick"])]),_:1},8,["style"])]),_:1},8,["value","filters","globalFilterFields"])]),t(g,{kpiList:e.kpiList,visible:e.addKpiAssociationVisible,data:e.data,onClose:a[3]||(a[3]=l=>e.addKpiAssociationVisible=!1),onKpiSelected:e.onKpiSelected},null,8,["kpiList","visible","data","onKpiSelected"])]),_:1})):w("",!0)}var Ee=S(ve,[["render",ze],["__scopeId","data-v-479b4a06"]]);const Ke=[{label:"cron.day",value:"day"},{label:"cron.week",value:"week"},{label:"cron.month",value:"month"},{label:"cron.quarter",value:"quarter"},{label:"cron.year",value:"year"}];var Ve={unitsOptions:Ke};const Te=M({name:"kpi-edit-options-card",components:{Card:z,Checkbox:G,Dropdown:O},props:{propOptions:{type:Object,required:!0}},data(){return{KpiDocumentDesignerOptionsCardDescriptor:Ve,options:null}},wacth:{propOptions(){this.loadOptions()}},created(){this.loadOptions()},methods:{loadOptions(){this.options=this.propOptions,this.options.showtarget=this.options.showtarget==="true",this.options.showtargetpercentage=this.options.showtargetpercentage==="true",this.options.showthreshold=this.options.showthreshold==="true",this.options.showvalue=this.options.showvalue==="true"}}}),_e={class:"p-grid p-m-1"},Le={class:"p-col-6"},Ue={class:"p-col-6"},Ie={class:"p-col-6"},Ne={class:"p-col-6"},Oe={class:"p-field p-col-6"},Fe={class:"p-float-label p-m-2"},Be={class:"kn-material-input-label"},Xe={class:"p-col-6 p-fluid"},je={class:"p-float-label p-m-2"},Re={key:0},Qe={class:"kn-material-input-label"};function Je(e,a,b,h,y,$){const v=n("Toolbar"),u=n("Checkbox"),s=n("InputText"),c=n("Dropdown"),i=n("Card");return e.options?(p(),f(i,{key:0,class:"p-m-2"},{header:r(()=>[t(v,{class:"kn-toolbar kn-toolbar--secondary"},{start:r(()=>[A(d(e.$t("common.options")),1)]),_:1})]),content:r(()=>[o("div",_e,[o("div",Le,[t(u,{class:"p-mr-2",modelValue:e.options.showvalue,"onUpdate:modelValue":a[0]||(a[0]=k=>e.options.showvalue=k),binary:!0},null,8,["modelValue"]),o("label",null,d(e.$t("kpi.kpiDocumentDesigner.showValue")),1)]),o("div",Ue,[t(u,{class:"p-mr-2",modelValue:e.options.showtarget,"onUpdate:modelValue":a[1]||(a[1]=k=>e.options.showtarget=k),binary:!0},null,8,["modelValue"]),o("label",null,d(e.$t("kpi.kpiDocumentDesigner.showTarget")),1)]),o("div",Ie,[t(u,{class:"p-mr-2",modelValue:e.options.showtargetpercentage,"onUpdate:modelValue":a[2]||(a[2]=k=>e.options.showtargetpercentage=k),binary:!0},null,8,["modelValue"]),o("label",null,d(e.$t("kpi.kpiDocumentDesigner.showPercentage")),1)]),o("div",Ne,[t(u,{class:"p-mr-2",modelValue:e.options.showthreshold,"onUpdate:modelValue":a[3]||(a[3]=k=>e.options.showthreshold=k),binary:!0},null,8,["modelValue"]),o("label",null,d(e.$t("kpi.kpiDocumentDesigner.showThreshold")),1)]),o("div",Oe,[o("span",Fe,[t(s,{class:E(["kn-material-input",{"p-invalid":+e.options.history.size<0}]),type:"number",modelValue:e.options.history.size,"onUpdate:modelValue":a[4]||(a[4]=k=>e.options.history.size=k),min:"0"},null,8,["modelValue","class"]),o("label",Be,d(e.$t("kpi.kpiDocumentDesigner.precision")),1)])]),o("div",Xe,[o("span",je,[t(c,{class:"kn-material-input",modelValue:e.options.history.units,"onUpdate:modelValue":a[5]||(a[5]=k=>e.options.history.units=k),options:e.KpiDocumentDesignerOptionsCardDescriptor.unitsOptions,optionValue:"value"},{value:r(k=>[k.value?(p(),C("div",Re,[o("span",null,d(k.value),1)])):w("",!0)]),option:r(k=>[o("span",null,d(e.$t(k.option.label)),1)]),_:1},8,["modelValue","options"]),o("label",Qe,d(e.$t("kpi.kpiDocumentDesigner.units")),1)])])])]),_:1})):w("",!0)}var Ye=S(Te,[["render",Je]]);const Ge=[{label:"kpi.kpiDocumentDesigner.fontFamily.roboto",value:"roboto"},{label:"kpi.kpiDocumentDesigner.fontFamily.arial",value:"arial"},{label:"kpi.kpiDocumentDesigner.fontFamily.courierNew",value:"courier-new"},{label:"kpi.kpiDocumentDesigner.fontFamily.tahoma",value:"tahoma"},{label:"kpi.kpiDocumentDesigner.fontFamily.timesNewRoman",value:"times-new-roman"},{label:"kpi.kpiDocumentDesigner.fontFamily.verdana",value:"verdana"}],qe=[{label:"kpi.kpiDocumentDesigner.font.xsmall",value:"8px"},{label:"kpi.kpiDocumentDesigner.font.small",value:"10px"},{label:"kpi.kpiDocumentDesigner.font.medium",value:"14px"},{label:"kpi.kpiDocumentDesigner.font.extended",value:"16px"},{label:"kpi.kpiDocumentDesigner.font.large",value:"18px"},{label:"kpi.kpiDocumentDesigner.font.xlarge",value:"24px"},{label:"kpi.kpiDocumentDesigner.font.xxlarge",value:"40px"}],We=[{label:"kpi.kpiDocumentDesigner.fontWeight.normal",value:"normal"},{label:"kpi.kpiDocumentDesigner.fontWeight.bold",value:"bold"},{label:"kpi.kpiDocumentDesigner.fontWeight.light",value:"lighter"}];var Ze={fontFamilyOptions:Ge,fontSizeOptions:qe,fontWeightOptions:We};const He=M({name:"kpi-edit-style-card",components:{Card:z,ColorPicker:q,Dropdown:O},props:{propStyle:{type:Object,required:!0}},data(){return{KpiDocumentDesignerStyleCardDescriptor:Ze,font:null}},watch:{propStyle(){this.loadFont()}},created(){this.loadFont()},methods:{loadFont(){var e;this.font=(e=this.propStyle)==null?void 0:e.font},getDropdownValueLabel(e,a){for(let b=0;b<a.length;b++)if(a[b].value===e)return this.$t(a[b].label)}}}),Pe={class:"p-grid"},ea={class:"p-col-6 p-fluid"},aa={class:"p-float-label p-m-2"},oa={key:0},ta={class:"kn-material-input-label"},ra={class:"p-col-6 p-fluid"},na={class:"p-float-label p-m-2"},ia={key:0},la={class:"kn-material-input-label"},da={class:"p-col-6 p-fluid"},sa={class:"p-float-label p-m-2"},ca={key:0},pa={class:"kn-material-input-label"},ba={class:"p-col-6"},ka={class:"p-d-flex p-flex-column p-m-2"},ua={class:"kn-material-input-label"};function ma(e,a,b,h,y,$){const v=n("Toolbar"),u=n("Dropdown"),s=n("ColorPicker"),c=n("Card");return e.font?(p(),f(c,{key:0,class:"p-m-2"},{header:r(()=>[t(v,{class:"kn-toolbar kn-toolbar--secondary"},{start:r(()=>[A(d(e.$t("common.style")),1)]),_:1})]),content:r(()=>[o("div",Pe,[o("div",ea,[o("span",aa,[t(u,{class:"kn-material-input",modelValue:e.font.size,"onUpdate:modelValue":a[0]||(a[0]=i=>e.font.size=i),options:e.KpiDocumentDesignerStyleCardDescriptor.fontSizeOptions,optionValue:"value"},{value:r(i=>[i.value?(p(),C("div",oa,[o("span",null,d(e.getDropdownValueLabel(i.value,e.KpiDocumentDesignerStyleCardDescriptor.fontSizeOptions)),1)])):w("",!0)]),option:r(i=>[o("span",{style:x("font-size: "+i.option.value)},d(e.$t(i.option.label)),5)]),_:1},8,["modelValue","options"]),o("label",ta,d(e.$t("kpi.kpiDocumentDesigner.fontSize")),1)])]),o("div",ra,[o("span",na,[t(u,{class:"kn-material-input",modelValue:e.font.fontFamily,"onUpdate:modelValue":a[1]||(a[1]=i=>e.font.fontFamily=i),options:e.KpiDocumentDesignerStyleCardDescriptor.fontFamilyOptions,optionValue:"value"},{value:r(i=>[i.value?(p(),C("div",ia,[o("span",null,d(e.getDropdownValueLabel(i.value,e.KpiDocumentDesignerStyleCardDescriptor.fontFamilyOptions)),1)])):w("",!0)]),option:r(i=>[o("span",{style:x("font-family: "+i.option.value)},d(e.$t(i.option.label)),5)]),_:1},8,["modelValue","options"]),o("label",la,d(e.$t("kpi.kpiDocumentDesigner.fontSize")),1)])]),o("div",da,[o("span",sa,[t(u,{class:"kn-material-input",modelValue:e.font.fontWeight,"onUpdate:modelValue":a[2]||(a[2]=i=>e.font.fontWeight=i),options:e.KpiDocumentDesignerStyleCardDescriptor.fontWeightOptions,optionValue:"value"},{value:r(i=>[i.value?(p(),C("div",ca,[o("span",null,d(e.getDropdownValueLabel(i.value,e.KpiDocumentDesignerStyleCardDescriptor.fontWeightOptions)),1)])):w("",!0)]),option:r(i=>[o("span",{style:x("font-weight: "+i.option.value)},d(e.$t(i.option.label)),5)]),_:1},8,["modelValue","options"]),o("label",pa,d(e.$t("kpi.kpiDocumentDesigner.fontWeight.title")),1)])]),o("div",ba,[o("div",ka,[o("label",ua,d(e.$t("kpi.kpiDocumentDesigner.color")),1),t(s,{modelValue:e.font.color,"onUpdate:modelValue":a[3]||(a[3]=i=>e.font.color=i),format:"rgb",inline:!1},null,8,["modelValue"])])])])]),_:1})):w("",!0)}var ga=S(He,[["render",ma]]);const va=[{label:"common.kpi",value:"kpi"},{label:"kpi.kpiDocumentDesigner.scorecard",value:"scorecard"}];var ha={typeOptions:va};const fa=M({name:"kpi-document-designer-type-card",components:{Card:z,RadioButton:R},props:{chartType:{type:String}},emits:["typeChanged"],data(){return{KpiDocumentDesignerTypeCardDescriptor:ha,type:"kpi"}},watch:{chartType(){this.loadType()}},created(){this.loadType()},methods:{loadType(){this.type=this.chartType},onTypeChange(){this.$emit("typeChanged",this.type)}}}),wa={class:"p-d-flex p-flex-row"},xa=["for"];function ya(e,a,b,h,y,$){const v=n("RadioButton"),u=n("Card");return p(),f(u,{class:"p-m-2"},{content:r(()=>[o("div",wa,[(p(!0),C(U,null,L(e.KpiDocumentDesignerTypeCardDescriptor.typeOptions,(s,c)=>(p(),C("div",{class:"field-radiobutton p-mx-2",key:c},[t(v,{id:s.value,value:s.value,modelValue:e.type,"onUpdate:modelValue":a[0]||(a[0]=i=>e.type=i),onChange:e.onTypeChange},null,8,["id","value","modelValue","onChange"]),o("label",{for:s.value,class:"p-ml-2"},d(e.$t(s.label)),9,xa)]))),128))])]),_:1})}var Da=S(fa,[["render",ya]]);const Ca={contentStyle:{padding:"1rem"},style:{height:"40%","max-height":"40%","max-width":"40%","min-width":"40%"}};var Aa={dialog:Ca};const Ma=M({name:"kpi-edit-save-dialog",components:{Dialog:I},props:{visible:{type:Boolean}},emits:["close","saveKpi"],data(){return{KpiDocumentDesignerSaveDialogDescriptor:Aa,kpiName:""}},computed:{saveButtonDisabled(){return this.kpiName.length===0}},created(){},methods:{close(){this.kpiName="",this.$emit("close")},saveKpi(){this.$emit("saveKpi",this.kpiName)}}}),Sa={class:"p-field"},$a={class:"p-float-label"},za={class:"kn-material-input-label"};function Ea(e,a,b,h,y,$){const v=n("Toolbar"),u=n("InputText"),s=n("Button"),c=n("Dialog");return p(),f(c,{id:"kpi-edit-save-dialog",class:"p-fluid kn-dialog--toolbar--primary",style:x(e.KpiDocumentDesignerSaveDialogDescriptor.dialog.style),contentStyle:e.KpiDocumentDesignerSaveDialogDescriptor.dialog.contentStyle,visible:e.visible,modal:!0,closable:!1},{header:r(()=>[t(v,{class:"kn-toolbar kn-toolbar--primary p-p-0 p-m-0 p-col-12"},{start:r(()=>[A(d(e.$t("kpi.kpiDocumentDesigner.saveDialogTitle")),1)]),_:1})]),footer:r(()=>[t(s,{class:"kn-button kn-button--primary",label:e.$t("common.close"),onClick:e.close},null,8,["label","onClick"]),t(s,{class:"kn-button kn-button--primary",label:e.$t("common.save"),disabled:e.saveButtonDisabled,onClick:e.saveKpi},null,8,["label","disabled","onClick"])]),default:r(()=>[o("div",null,[o("h2",null,d(e.$t("kpi.kpiDocumentDesigner.saveTitle")),1),o("h4",null,d(e.$t("kpi.kpiDocumentDesigner.saveSubheader")),1),o("div",Sa,[o("span",$a,[t(u,{class:E(["kn-material-input",{"p-invalid":e.kpiName.length===0}]),modelValue:e.kpiName,"onUpdate:modelValue":a[0]||(a[0]=i=>e.kpiName=i)},null,8,["modelValue","class"]),o("label",za,d(e.$t("kpi.kpiDocumentDesigner.kpiName")),1)])])])]),_:1},8,["style","contentStyle","visible"])}var Ka=S(Ma,[["render",Ea]]);const Va=[{field:"name",header:"common.name",style:{flex:1}},{field:"creationDate",header:"common.creationDate",style:{flex:1}}],Ta={contentStyle:{"padding-left":"1rem","padding-top":"1rem"},style:{height:"60%","max-height":"60%","max-width":"60%","min-width":"60%"}},_a=["name"],La={flex:.5,"justify-content":"end"},Ua={flex:.2},Ia=["name"];var J={columns:Va,dialog:Ta,globalFilterFields:_a,iconColumnStyle:La,selectColumnStyle:Ua,selectScorecardGlobalFilterFields:Ia};const Na=M({name:"kpi-edit-scorecard-select-dialog",components:{Column:K,DataTable:V,Dialog:I},props:{visible:{type:Boolean},scorecardList:{type:Array},dataScorecards:{type:Array,required:!0}},emits:["close","scorecardSelected"],data(){return{KpiDocumentDesignerScorecardsListCardDescriptor:J,filters:{global:[T]},selectedScorecard:null}},watch:{visible(){this.setSelectedKpiAssociations()}},async created(){this.setSelectedKpiAssociations()},methods:{getFormattedDate(e){return N(e)},setSelectedKpiAssociations(){if(this.dataScorecards[0]&&this.scorecardList){const e=this.scorecardList.findIndex(a=>a.name===this.dataScorecards[0].name);e!==-1&&(this.selectedScorecard=this.scorecardList[e])}else this.selectedScorecard=null},closeScorecardAssociations(){this.selectedScorecard=null,this.$emit("close")},addScorecardAssociations(){this.$emit("scorecardSelected",this.selectedScorecard)}}}),Oa={class:"table-header p-d-flex"},Fa={class:"p-input-icon-left p-mr-3"},Ba=o("i",{class:"pi pi-search"},null,-1);function Xa(e,a,b,h,y,$){const v=n("Toolbar"),u=n("InputText"),s=n("Column"),c=n("DataTable"),i=n("Button"),k=n("Dialog");return p(),f(k,{id:"kpi-edit-scorecard-select-dialog",class:"p-fluid kn-dialog--toolbar--primary",style:x(e.KpiDocumentDesignerScorecardsListCardDescriptor.dialog.style),contentStyle:e.KpiDocumentDesignerScorecardsListCardDescriptor.dialog.contentStyle,visible:e.visible,modal:!0,closable:!1},{header:r(()=>[t(v,{class:"kn-toolbar kn-toolbar--primary p-p-0 p-m-0 p-col-12"},{start:r(()=>[A(d(e.$t("kpi.kpiDocumentDesigner.scorecardList")),1)]),_:1})]),footer:r(()=>[t(i,{class:"kn-button kn-button--primary",label:e.$t("common.close"),onClick:e.closeScorecardAssociations},null,8,["label","onClick"]),t(i,{class:"kn-button kn-button--primary",label:e.$t("common.save"),onClick:e.addScorecardAssociations},null,8,["label","onClick"])]),default:r(()=>[t(c,{value:e.scorecardList,selection:e.selectedScorecard,"onUpdate:selection":a[1]||(a[1]=g=>e.selectedScorecard=g),class:"p-datatable-sm kn-table",dataKey:"id",filters:e.filters,"onUpdate:filters":a[2]||(a[2]=g=>e.filters=g),KpiDocumentDesignerKpiListCardDescriptor:e.KpiDocumentDesignerScorecardsListCardDescriptor.selectScorecardGlobalFilterFields,responsiveLayout:"stack",breakpoint:"960px",scrollable:!0,scrollHeight:"80vh"},{header:r(()=>[o("div",Oa,[o("span",Fa,[Ba,t(u,{class:"kn-material-input",modelValue:e.filters.global.value,"onUpdate:modelValue":a[0]||(a[0]=g=>e.filters.global.value=g),type:"text",placeholder:e.$t("common.search"),"data-test":"filterInput"},null,8,["modelValue","placeholder"])])])]),empty:r(()=>[A(d(e.$t("common.info.noDataFound")),1)]),default:r(()=>[t(s,{selectionMode:"single",headerStyle:e.KpiDocumentDesignerScorecardsListCardDescriptor.selectColumnStyle,style:x(e.KpiDocumentDesignerScorecardsListCardDescriptor.selectColumnStyle)},null,8,["headerStyle","style"]),t(s,{class:"kn-truncated",field:"name",header:e.$t("common.name"),key:"name",sortable:!0},null,8,["header"]),t(s,{class:"kn-truncated",field:"creationDate",header:e.$t("common.creationDate"),key:"dateCreation",sortable:!0},{body:r(g=>[o("span",null,d(e.getFormattedDate(g.data.creationDate)),1)]),_:1},8,["header"])]),_:1},8,["value","selection","filters","KpiDocumentDesignerKpiListCardDescriptor"])]),_:1},8,["style","contentStyle","visible"])}var ja=S(Na,[["render",Xa]]);const Ra=M({name:"kpi-edit-scorecards-list-card",components:{Card:z,Column:K,DataTable:V,KpiDocumentDesignerScorecardSelectDialog:ja},props:{propData:{type:Object},scorecardList:{type:Array}},emits:["scorecardChanged"],data(){return{KpiDocumentDesignerScorecardsListCardDescriptor:J,scorecards:[],filters:{global:[T]},addScorecardVisible:!1}},watch:{propData(){this.loadScorecard()}},created(){this.loadScorecard()},methods:{loadScorecard(){var e;(e=this.propData)!=null&&e.scorecard&&(this.scorecards=[this.propData.scorecard])},onScorecardSelected(e){this.scorecards[0]=e,this.$emit("scorecardChanged",this.scorecards[0]),this.addScorecardVisible=!1},deleteScorecardConfirm(){this.$confirm.require({message:this.$t("common.toast.deleteMessage"),header:this.$t("common.toast.deleteTitle"),icon:"pi pi-exclamation-triangle",accept:()=>{this.scorecards=[],this.$emit("scorecardChanged",null)}})},getFormattedDate(e){return N(e)}}}),Qa=e=>(X("data-v-78ae636a"),e=e(),j(),e),Ja={class:"table-header p-d-flex p-ai-center"},Ya={id:"search-container",class:"p-input-icon-left p-mr-3"},Ga=Qa(()=>o("i",{class:"pi pi-search"},null,-1));function qa(e,a,b,h,y,$){const v=n("Toolbar"),u=n("InputText"),s=n("Button"),c=n("Column"),i=n("DataTable"),k=n("KpiDocumentDesignerScorecardSelectDialog"),g=n("Card");return p(),f(g,null,{header:r(()=>[t(v,{class:"kn-toolbar kn-toolbar--secondary"},{start:r(()=>[A(d(e.$t("kpi.kpiDocumentDesigner.scorecardList")),1)]),_:1})]),content:r(()=>[o("div",null,[t(i,{value:e.scorecards,class:"p-datatable-sm kn-table",dataKey:"name",filters:e.filters,"onUpdate:filters":a[2]||(a[2]=D=>e.filters=D),globalFilterFields:e.KpiDocumentDesignerScorecardsListCardDescriptor.globalFilterFields,responsiveLayout:"stack",breakpoint:"960px",scrollable:!0,"scroll-height":"60vh"},{header:r(()=>[o("div",Ja,[o("span",Ya,[Ga,t(u,{class:"kn-material-input",modelValue:e.filters.global.value,"onUpdate:modelValue":a[0]||(a[0]=D=>e.filters.global.value=D),type:"text",placeholder:e.$t("common.search")},null,8,["modelValue","placeholder"])]),t(s,{id:"kpi-edit-add-scorecard-association-button",class:"kn-button kn-button--primary",label:e.$t("kpi.kpiDocumentDesigner.addScorecardAssociation"),onClick:a[1]||(a[1]=D=>e.addScorecardVisible=!0)},null,8,["label"])])]),empty:r(()=>[A(d(e.$t("common.info.noDataFound")),1)]),default:r(()=>[t(c,{class:"kn-truncated",field:"name",header:e.$t("common.name"),key:"name",sortable:!0},null,8,["header"]),t(c,{class:"kn-truncated",field:"creationDate",header:e.$t("common.creationDate"),key:"dateCreation",sortable:!0},{body:r(D=>[o("span",null,d(e.getFormattedDate(D.data.creationDate)),1)]),_:1},8,["header"]),t(c,{style:x(e.KpiDocumentDesignerScorecardsListCardDescriptor.iconColumnStyle)},{body:r(D=>[t(s,{icon:"pi pi-trash",class:"p-button-link",onClick:l=>e.deleteScorecardConfirm(D.data)},null,8,["onClick"])]),_:1},8,["style"])]),_:1},8,["value","filters","globalFilterFields"])]),t(k,{scorecardList:e.scorecardList,visible:e.addScorecardVisible,dataScorecards:e.scorecards,onClose:a[3]||(a[3]=D=>e.addScorecardVisible=!1),onScorecardSelected:e.onScorecardSelected},null,8,["scorecardList","visible","dataScorecards","onScorecardSelected"])]),_:1})}var Wa=S(Ra,[["render",qa],["__scopeId","data-v-78ae636a"]]);const Za=M({name:"kpi-document-designer",components:{KpiDocumentDesignerDocumentTypeCard:oe,KpiDocumentDesignerKpiListCard:Ee,KpiDocumentDesignerOptionsCard:Ye,KpiDocumentDesignerStyleCard:ga,KpiDocumentDesignerTypeCard:Da,KpiDocumentDesignerSaveDialog:Ka,KpiDocumentDesignerScorecardsListCard:Wa},props:{id:{type:String}},data(){return{kpiDesigner:null,kpiList:[],scorecards:[],saveDialogVisible:!1,loading:!1}},watch:{async id(){await this.loadKpi()}},computed:{...Y(F,{user:"user"}),showScorecards(){return this.store.$state.user.functionalities.includes("ScorecardsManagement")},saveButtonDisabled(){return this.kpiDesigner!==null&&(this.kpiDesigner.chart.type==="kpi"&&this.kpiTypeInvalid()||this.kpiDesigner.chart.type==="scorecard"&&this.scorecardTypeInvalid())}},setup(){return{store:F()}},async created(){await this.loadPage()},methods:{async loadPage(){var h,y;this.loading=!0;let e={headers:{Accept:"application/json, text/plain, */*"}},a=(h=this.user.locale)==null?void 0:h.split("_")[0],b=(y=this.user.locale)==null?void 0:y.split("_")[1];await this.$http.get(`/knowagekpiengine/restful-services/1.0/pages/edit?SBI_LANGUAGE=${a}&SBI_COUNTRY=${b}&user_id=${this.user.userUniqueIdentifier}&document=${this.id}`,e).then(()=>{}),await this.loadKpi(),await this.loadKpiList(),await this.loadScorecards(),this.loading=!1},async loadKpiList(){await this.$http.get("/knowage/restful-services/1.0/kpi/listKpi").then(e=>this.kpiList=e.data)},async loadScorecards(){await this.$http.get("/knowage/restful-services/1.0/kpiee/listScorecard").then(e=>this.scorecards=e.data)},async loadKpi(){this.loading=!0,this.id?await this.$http.post("/knowagekpiengine/restful-services/1.0/kpisTemplate/getKpiTemplate",{id:this.id}).then(e=>{this.kpiDesigner=e.data.templateContent?JSON.parse(e.data.templateContent):e.data,this.kpiDesigner&&!this.kpiDesigner.chart&&(this.kpiDesigner=this.initializeKpiDesigner())}).catch(()=>{}):this.kpiDesigner=this.initializeKpiDesigner(),this.loading=!1},initializeKpiDesigner(){return{chart:{type:"kpi",model:"widget",data:{kpi:[]},style:{font:{color:"rgb(14,13,13)",fontFamily:"roboto",fontWeight:"normal",size:"8px"}},options:{showtarget:!0,showtargetpercentage:!1,showthreshold:!0,showvalue:!0,vieweas:"",history:{size:1,units:"month"}}}}},onTypeChanged(e){this.kpiDesigner&&(this.kpiDesigner.chart.type=e)},kpiTypeInvalid(){var e;return this.kpiDesigner&&(((e=this.kpiDesigner.chart.data.kpi)==null?void 0:e.length)===0||this.kpiMissingRequiredField())},kpiMissingRequiredField(){if(!this.kpiDesigner||!this.kpiDesigner.chart.data.kpi)return!1;let e=!1;for(let a=0;a<this.kpiDesigner.chart.data.kpi.length;a++){const b=this.kpiDesigner.chart.data.kpi[a];if(!b.rangeMinValue||!b.rangeMaxValue){e=!0;break}}return e},scorecardTypeInvalid(){var e;return!this.kpiDesigner||!((e=this.kpiDesigner.chart.data.scorecard)!=null&&e.name)},onScorecardChanged(e){!this.kpiDesigner||(e?this.kpiDesigner.chart.data.scorecard={name:e.name}:this.kpiDesigner.chart.data.scorecard={name:""})},saveKpi(){this.id?this.onKpiSave(""):this.saveDialogVisible=!0},async onKpiSave(e){this.loading=!0,this.id?await this.updateKpi():await this.saveNewKpi(e),this.loading=!1},async saveNewKpi(e){const a={document:{name:e,label:e,description:"",type:"KPI"},customData:{templateContent:this.getFormattedKpiDesigner()},action:"DOC_SAVE"};await this.$http.post("/knowage/restful-services/2.0/saveDocument",a).then(b=>{this.store.setInfo({title:this.$t("common.toast.createTitle"),msg:this.$t("common.toast.success")}),this.$router.push(`/kpi-edit/${b.data.id}?from=${this.$route.query.from}`)}).catch(()=>{}).finally(()=>this.saveDialogVisible=!1),this.loading=!1},async updateKpi(){const e=new URLSearchParams;e.append("docLabel",this.id),e.append("jsonTemplate",JSON.stringify(this.getFormattedKpiDesigner())),await this.$http.post("/knowage/restful-services/1.0/documents/saveKpiTemplate",e,{headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json, text/plain, */*"}}).then(()=>{this.store.setInfo({title:this.$t("common.toast.updateTitle"),msg:this.$t("common.toast.success")})}).catch(()=>{})},getFormattedKpiDesigner(){const e=B(this.kpiDesigner);if(!!e)return e.chart.type==="kpi"?delete e.chart.data.scorecard:(delete e.chart.data.kpi,delete e.chart.options),e},closeKpi(){const e=this.$route.query.from==="documentDetail"?`/document-browser/document-details/${this.id}`:"/workspace/analysis";this.$router.push(e)}}}),Ha={class:"kn-page"},Pa={class:"kn-page-content p-grid p-m-0 p-p-0"},eo={class:"kn-page-content p-grid p-m-0"},ao={class:"p-col-12 p-p-0"},oo={key:1,class:"p-d-flex p-flex-column p-m-0"},to={class:"p-d-flex p-flex-row kn-flex p-p-0 p-m-0"};function ro(e,a,b,h,y,$){const v=n("Button"),u=n("Toolbar"),s=n("ProgressBar"),c=n("KpiDocumentDesignerTypeCard"),i=n("KpiDocumentDesignerDocumentTypeCard"),k=n("KpiDocumentDesignerKpiListCard"),g=n("KpiDocumentDesignerScorecardsListCard"),D=n("KpiDocumentDesignerStyleCard"),l=n("KpiDocumentDesignerOptionsCard"),m=n("KpiDocumentDesignerSaveDialog");return p(),C("div",Ha,[o("div",Pa,[o("div",eo,[o("div",ao,[t(u,{class:"kn-toolbar kn-toolbar--primary"},{start:r(()=>[A(d(e.$t("kpi.kpiDocumentDesigner.title")),1)]),end:r(()=>[t(v,{icon:"pi pi-save",class:"p-button-text p-button-rounded p-button-plain",disabled:e.saveButtonDisabled,onClick:e.saveKpi},null,8,["disabled","onClick"]),t(v,{icon:"pi pi-times",class:"p-button-text p-button-rounded p-button-plain",onClick:e.closeKpi},null,8,["onClick"])]),_:1}),e.loading?(p(),f(s,{key:0,class:"kn-progress-bar",mode:"indeterminate","data-test":"progress-bar"})):w("",!0),e.kpiDesigner?(p(),C("div",oo,[e.showScorecards?(p(),f(c,{key:0,class:"kn-flex",chartType:e.kpiDesigner.chart.type,onTypeChanged:e.onTypeChanged},null,8,["chartType","onTypeChanged"])):w("",!0),e.kpiDesigner.chart.type==="kpi"?(p(),f(i,{key:1,class:"kn-flex",propChart:e.kpiDesigner.chart},null,8,["propChart"])):w("",!0),e.kpiDesigner.chart.type==="kpi"?(p(),f(k,{key:2,class:"kn-flex",propData:e.kpiDesigner.chart.data,kpiList:e.kpiList,documentType:e.kpiDesigner.chart.model},null,8,["propData","kpiList","documentType"])):(p(),f(g,{key:3,class:"kn-flex",propData:e.kpiDesigner.chart.data,scorecardList:e.scorecards,onScorecardChanged:e.onScorecardChanged},null,8,["propData","scorecardList","onScorecardChanged"])),o("div",to,[t(D,{class:"kn-flex",propStyle:e.kpiDesigner.chart.style},null,8,["propStyle"]),e.kpiDesigner.chart.type==="kpi"?(p(),f(l,{key:0,class:"kn-flex",propOptions:e.kpiDesigner.chart.options},null,8,["propOptions"])):w("",!0)])])):w("",!0)])])]),t(m,{visible:e.saveDialogVisible,onClose:a[0]||(a[0]=no=>e.saveDialogVisible=!1),onSaveKpi:e.onKpiSave},null,8,["visible","onSaveKpi"])])}var bo=S(Za,[["render",ro]]);export{bo as default};
//# sourceMappingURL=KpiDocumentDesigner-3b77ccc2.js.map
