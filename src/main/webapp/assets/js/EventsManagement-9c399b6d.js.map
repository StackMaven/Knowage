{"version":3,"file":"EventsManagement-9c399b6d.js","sources":["../../../../modules/managers/eventsManagement/EventsManagement.vue"],"sourcesContent":["<template>\r\n    <div class=\"kn-page\">\r\n        <ProgressSpinner class=\"kn-progress-spinner\" v-if=\"loading\" data-test=\"progress-spinner\" />\r\n        <div class=\"p-d-flex p-flex-column kn-flex\">\r\n            <Toolbar class=\"kn-toolbar kn-toolbar--primary\">\r\n                <template #start>\r\n                    {{ $t('managers.eventsManagement.title') }}\r\n                </template>\r\n            </Toolbar>\r\n            <div id=\"input-container\" class=\"p-d-flex p-flex-column kn-flex\">\r\n                <Card class=\"p-m-2 events-input-card\">\r\n                    <template #content>\r\n                        <form class=\"p-fluid p-formgrid p-grid p-m-1\">\r\n                            <div class=\"p-float-label p-col\">\r\n                                <Calendar ref=\"test\" id=\"startDate\" class=\"kn-material-input\" v-model=\"startDate\" :showIcon=\"true\" @date-select=\"setFocusOnSearchButton\" />\r\n                                <label for=\"endDate\" class=\"kn-material-input-label\"> {{ $t('kpi.targetDefinition.startDate') }} </label>\r\n                            </div>\r\n                            <div class=\"p-float-label p-col\">\r\n                                <Calendar id=\"endDate\" class=\"kn-material-input\" v-model=\"endDate\" :showIcon=\"true\" @date-select=\"setFocusOnSearchButton\" />\r\n                                <label for=\"endDate\" class=\"kn-material-input-label\"> {{ $t('kpi.targetDefinition.endDate') }} </label>\r\n                            </div>\r\n                            <span class=\"p-field p-float-label p-col\">\r\n                                <Dropdown id=\"eventModel\" class=\"kn-material-input\" v-model=\"selectedEventModel\" :options=\"eventModel\" @change=\"setFocusOnSearchButton\" />\r\n                                <label for=\"eventModel\" class=\"kn-material-input-label\"> {{ $t('managers.eventsManagement.eventModel') }} </label>\r\n                            </span>\r\n                            <Button ref=\"search-button\" id=\"search-button\" icon=\"pi pi-search\" class=\"p-button-text kn-button thirdButton\" @click=\"onSearchClicked\" data-test=\"search-button\" />\r\n                        </form>\r\n                    </template>\r\n                </Card>\r\n                <Card class=\"domainCard\" style=\"height: calc(100vh - 125px)\">\r\n                    <template #content>\r\n                        <DataTable\r\n                            class=\"p-datatable-sm kn-table\"\r\n                            v-model:first=\"first\"\r\n                            :value=\"events\"\r\n                            dataKey=\"id\"\r\n                            :paginator=\"true\"\r\n                            :lazy=\"true\"\r\n                            :totalRecords=\"lazyParams.size\"\r\n                            paginatorTemplate=\"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink\"\r\n                            :currentPageReportTemplate=\"$t('common.table.footer.paginated', { first: '{first}', last: '{last}', totalRecords: '{totalRecords}' })\"\r\n                            :rows=\"20\"\r\n                            responsiveLayout=\"stack\"\r\n                            breakpoint=\"960px\"\r\n                            :scrollable=\"true\"\r\n                            scrollHeight=\"flex\"\r\n                            :stripedRows=\"true\"\r\n                            v-model:filters=\"filters\"\r\n                            :globalFilterFields=\"globalFilterFields\"\r\n                            @page=\"onPage($event)\"\r\n                        >\r\n                            <template #header>\r\n                                <div class=\"table-header p-d-flex p-ai-center\">\r\n                                    <span id=\"search-container\" class=\"p-input-icon-left p-mr-3\">\r\n                                        <i class=\"pi pi-search\" />\r\n                                        <InputText class=\"kn-material-input\" v-model=\"filters['global'].value\" :placeholder=\"$t('common.search')\" />\r\n                                    </span>\r\n                                </div>\r\n                            </template>\r\n                            <template #loading>\r\n                                {{ $t('common.info.dataLoading') }}\r\n                            </template>\r\n                            <template #empty>\r\n                                <div id=\"noDatasetsFound\">\r\n                                    {{ $t('common.info.noDataFound') }}\r\n                                </div>\r\n                            </template>\r\n                            <Column field=\"user\" class=\"kn-truncated\" :header=\"$t('managers.eventsManagement.user')\" :sortable=\"true\"></Column>\r\n                            <Column field=\"formattedDate\" class=\"kn-truncated\" :header=\"$t('cron.date')\" :sortable=\"true\"></Column>\r\n                            <Column field=\"type\" class=\"kn-truncated\" :header=\"$t('common.type')\" :sortable=\"true\"></Column>\r\n                            <Column :header=\"$t('common.description')\" class=\"kn-truncated\" :sortable=\"true\">\r\n                                <template #body=\"slotProps\">\r\n                                    <span class=\"kn-truncated\" v-tooltip.top=\"slotProps.data.desc\"> {{ slotProps.data.desc }}</span>\r\n                                </template>\r\n                            </Column>\r\n                        </DataTable>\r\n                    </template>\r\n                </Card>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n<script lang=\"ts\">\r\nimport { defineComponent } from 'vue'\r\nimport { AxiosResponse } from 'axios'\r\nimport { filterDefault } from '@/helpers/commons/filterHelper'\r\nimport moment from 'moment'\r\nimport descriptor from './EventsManagementDescriptor.json'\r\nimport ProgressSpinner from 'primevue/progressspinner'\r\nimport Card from 'primevue/card'\r\nimport Dropdown from 'primevue/dropdown'\r\nimport Calendar from 'primevue/calendar'\r\nimport DataTable from 'primevue/datatable'\r\nimport Column from 'primevue/column'\r\n\r\nexport default defineComponent({\r\n    name: 'events-management',\r\n    components: { ProgressSpinner, Card, Dropdown, Calendar, DataTable, Column },\r\n    data() {\r\n        return {\r\n            descriptor,\r\n            loading: false,\r\n            events: [] as any,\r\n            eventModel: descriptor.eventModel,\r\n            startDate: null as any,\r\n            endDate: null as any,\r\n            selectedEventModel: '' as String,\r\n            filters: { global: [filterDefault] } as Object,\r\n            globalFilterFields: ['user', 'type'],\r\n            lazyParams: { size: 20, paginationStart: 0 } as any,\r\n            first: 0\r\n        }\r\n    },\r\n    created() {\r\n        this.getEvents()\r\n    },\r\n    methods: {\r\n        async getEvents() {\r\n            this.loading = true\r\n            let url = import.meta.env.VITE_RESTFUL_SERVICES_PATH + `2.0/events/?fetchsize=${this.lazyParams.size}&offset=${this.lazyParams.paginationStart}`\r\n            this.selectedEventModel != '' ? (url += `&type=${this.selectedEventModel}`) : ''\r\n            this.startDate ? (url += `&startDate=${encodeURIComponent(moment(this.startDate).format('YYYY-MM-DD+HH:mm:ss'))}`) : ''\r\n            this.endDate ? (url += `&endDate=${encodeURIComponent(moment(this.endDate).format('YYYY-MM-DD+HH:mm:ss'))}`) : ''\r\n            await this.$http\r\n                .get(url)\r\n                .then((response: AxiosResponse<any>) => {\r\n                    this.events = response.data.results\r\n                    this.lazyParams.size = response.data.total\r\n                    this.lazyParams.paginationStart = response.data.start\r\n                })\r\n                .finally(() => (this.loading = false))\r\n        },\r\n        async onPage(event: any) {\r\n            this.lazyParams = { paginationStart: event.first, paginationLimit: event.rows, paginationEnd: event.first + event.rows, size: this.lazyParams.size }\r\n            await this.getEvents()\r\n        },\r\n        async onSearchClicked() {\r\n            this.first = 0\r\n            this.lazyParams = { size: 20, paginationStart: 0 }\r\n            await this.getEvents()\r\n        },\r\n        setFocusOnSearchButton() {\r\n            this.$nextTick(() => {\r\n                const searchButton = this.$refs['search-button'] as any\r\n                searchButton.$el.focus()\r\n            })\r\n        }\r\n    }\r\n})\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.domainCard {\r\n    &:deep(.p-card-body) {\r\n        height: calc(100% - 35px);\r\n        .p-card-content {\r\n            height: 100%;\r\n            padding-bottom: 0;\r\n            .p-paginator-bottom {\r\n                border: none;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n.thirdButton:focus {\r\n    color: #c2c2c2 !important;\r\n}\r\n</style>\r\n"],"names":["ProgressSpinner","Card","Dropdown","Calendar","DataTable","Column","moment","_pushScopeId","_popScopeId","_createElementVNode","_openBlock","_createElementBlock","_createBlock","_createCommentVNode","_createVNode","_withCtx","_toDisplayString","_createTextVNode"],"mappings":"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"}