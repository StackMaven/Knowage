import{_ as x,d as y,X as M,a4 as C,W as A,s as E,r,o as b,c as z,a as e,f as n,w as i,g as s,t as d,h as p,A as k,V as v}from"./index-1e676509.js";const $=["name"];var _={filterFields:$};const T=y({name:"target-definition",components:{KnFabButton:M,Listbox:C},data(){return{targetList:[],loading:!1,touched:!1,targetDefinitionDecriptor:_,formatDate:A}},setup(){return{store:E()}},async created(){await this.loadAllMetadata()},methods:{async loadAllMetadata(){this.loading=!0,await this.$http.get("/knowage/restful-services/1.0/kpiee/listTarget").then(t=>this.targetList=t.data.map(a=>({id:a.id,name:a.name,startValidity:new Date(a.startValidity),endValidity:new Date(a.endValidity),author:a.author,values:a.values,category:a.category}))).finally(()=>this.loading=!1)},showForm(t,a){const l=t?`/target-definition/edit?id=${t.id}&clone=${a}`:"/target-definition/new-target-definition";this.touched?this.$confirm.require({message:this.$t("common.toast.unsavedChangesMessage"),header:this.$t("common.toast.unsavedChangesHeader"),icon:"pi pi-exclamation-triangle",accept:()=>{this.touched=!1,this.$router.push(l)}}):this.$router.push(l)},deleteTargetConfirm(t){this.$confirm.require({message:this.$t("common.toast.deleteMessage"),header:this.$t("common.toast.deleteTitle"),icon:"pi pi-exclamation-triangle",accept:()=>this.deleteTarget(t)})},async deleteTarget(t){await this.$http.delete("/knowage/restful-services/1.0/kpiee/"+t+"/deleteTarget").then(()=>{this.store.setInfo({title:this.$t("common.toast.deleteTitle"),msg:this.$t("common.toast.deleteSuccess")}),this.closeForm(),this.loadAllMetadata()})},cloneTargetConfirm(t){this.$confirm.require({header:this.$t("common.toast.cloneConfirmTitle"),accept:()=>this.showForm(t,!0)})},closeForm(){this.touched?this.$confirm.require({message:this.$t("common.toast.unsavedChangesMessage"),header:this.$t("common.toast.unsavedChangesHeader"),icon:"pi pi-exclamation-triangle",accept:()=>{this.touched=!1,this.handleClose()}}):this.handleClose()},handleClose(){this.$router.replace("/target-definition")},reloadMetadata(t){this.$router.replace(`/target-definition/edit?id=${t}&clone=${!1}`),this.touched=!1,this.loadAllMetadata()}}}),F={class:"kn-page"},D={class:"kn-page-content p-grid p-m-0"},B={class:"kn-list--column p-col-4 p-sm-4 p-md-3 p-p-0"},N={class:"kn-list-item","data-test":"list-item"},V={class:"kn-list-item-text"},S={class:"kn-list-item-text-secondary"},I={class:"p-col-8 p-sm-8 p-md-9 p-p-0 p-m-0 kn-router-view"};function L(t,a,l,U,X,Q){const m=r("KnFabButton"),u=r("Toolbar"),g=r("ProgressBar"),c=r("Button"),h=r("Listbox"),f=r("router-view");return b(),z("div",F,[e("div",D,[e("div",B,[n(u,{class:"kn-toolbar kn-toolbar--primary"},{start:i(()=>[s(d(t.$t("kpi.targetDefinition.title")),1)]),end:i(()=>[n(m,{icon:"fas fa-plus",onClick:a[0]||(a[0]=o=>t.showForm(null,!1)),"data-test":"open-form-button"})]),_:1}),t.loading?(b(),p(g,{key:0,mode:"indeterminate",class:"kn-progress-bar","data-test":"progress-bar"})):k("",!0),t.loading?k("",!0):(b(),p(h,{key:1,class:"kn-list--column",options:t.targetList,filter:!0,filterPlaceholder:t.$t("common.search"),optionLabel:"name",filterMatchMode:"contains",filterFields:t.targetDefinitionDecriptor.filterFields,emptyFilterMessage:t.$t("common.info.noDataFound"),onChange:a[1]||(a[1]=o=>t.showForm(o.value,!1)),"data-test":"target-list"},{empty:i(()=>[s(d(t.$t("common.info.noDataFound")),1)]),option:i(o=>[e("div",N,[e("div",V,[e("span",null,d(o.option.name),1),e("span",S,d(t.formatDate(o.option.startValidity))+" - "+d(t.formatDate(o.option.endValidity)),1)]),n(c,{icon:"far fa-copy",class:"p-button-text p-button-rounded p-button-plain",onClick:v(w=>t.cloneTargetConfirm(o.option),["stop"]),"data-test":"clone-button"},null,8,["onClick"]),n(c,{icon:"far fa-trash-alt",class:"p-button-text p-button-rounded p-button-plain",onClick:v(w=>t.deleteTargetConfirm(o.option.id),["stop"]),"data-test":"delete-button"},null,8,["onClick"])])]),_:1},8,["options","filterPlaceholder","filterFields","emptyFilterMessage"]))]),e("div",I,[n(f,{onClose:t.closeForm,onTouched:a[2]||(a[2]=o=>t.touched=!0),onSaved:t.reloadMetadata},null,8,["onClose","onSaved"])])])])}var K=x(T,[["render",L],["__scopeId","data-v-6b9430d9"]]);export{K as default};
//# sourceMappingURL=TargetDefinition-10d7b0e1.js.map
