{"version":3,"file":"RolesManagement-4ff4f3e1.js","sources":["../../../../modules/managers/rolesManagement/RolesManagement.vue"],"sourcesContent":["<template>\r\n    <div class=\"kn-page\">\r\n        <div class=\"kn-page-content p-grid p-m-0\">\r\n            <div class=\"kn-list--column p-col-4 p-sm-4 p-md-3 p-p-0\">\r\n                <Toolbar class=\"kn-toolbar kn-toolbar--primary\">\r\n                    <template #start>\r\n                        {{ $t('managers.rolesManagement.title') }}\r\n                    </template>\r\n                    <template #end>\r\n                        <FabButton icon=\"fas fa-plus\" @click=\"showForm\" data-test=\"open-form-button\" />\r\n                    </template>\r\n                </Toolbar>\r\n                <ProgressBar mode=\"indeterminate\" class=\"kn-progress-bar\" v-if=\"loading\" data-test=\"progress-bar\" />\r\n                <KnListBox class=\"kn-height-full\" :options=\"roles\" :settings=\"rolesDecriptor.knListSettings\" @click=\"showForm\" @delete.stop=\"deleteRoleConfirm\"></KnListBox>\r\n            </div>\r\n\r\n            <div class=\"p-col-8 p-sm-8 p-md-9 p-p-0 p-m-0 kn-router-view\">\r\n                <router-view :publicRole=\"publicRole\" @touched=\"touched = true\" @closed=\"touched = false\" @inserted=\"pageReload\" />\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { defineComponent } from 'vue'\r\nimport { iRole } from './RolesManagement'\r\nimport { AxiosResponse } from 'axios'\r\nimport rolesDecriptor from './RolesManagementDescriptor.json'\r\nimport FabButton from '@/components/UI/KnFabButton.vue'\r\nimport KnListBox from '@/components/UI/KnListBox/KnListBox.vue'\r\nimport mainStore from '../../../App.store'\r\n\r\nexport default defineComponent({\r\n    name: 'roles-management',\r\n    components: { FabButton, KnListBox },\r\n    data() {\r\n        return {\r\n            roles: [] as iRole[],\r\n            loading: false,\r\n            touched: false,\r\n            rolesDecriptor: rolesDecriptor,\r\n            hiddenForm: false,\r\n            dirty: false,\r\n            publicRole: null as any\r\n        }\r\n    },\r\n    setup() {\r\n        const store = mainStore()\r\n        return { store }\r\n    },\r\n    async created() {\r\n        await this.loadAllRoles()\r\n    },\r\n    methods: {\r\n        async loadAllRoles() {\r\n            this.loading = true\r\n            await this.$http\r\n                .get(import.meta.env.VITE_RESTFUL_SERVICES_PATH + '2.0/roles')\r\n                .then((response: AxiosResponse<any>) => {\r\n                    this.roles = response.data\r\n                    this.checkAllRolesForPublicRole()\r\n                })\r\n                .finally(() => (this.loading = false))\r\n        },\r\n        checkAllRolesForPublicRole() {\r\n            this.publicRole = null\r\n            this.roles.forEach((role) => {\r\n                if (role.isPublic) {\r\n                    this.publicRole = role\r\n                }\r\n            })\r\n        },\r\n        showForm(event: any) {\r\n            const path = event.item ? `/roles-management/${event.item.id}` : '/roles-management/new-role'\r\n\r\n            if (!this.touched) {\r\n                this.$router.push(path)\r\n            } else {\r\n                this.$confirm.require({\r\n                    message: this.$t('common.toast.unsavedChangesMessage'),\r\n                    header: this.$t('common.toast.unsavedChangesHeader'),\r\n                    icon: 'pi pi-exclamation-triangle',\r\n                    accept: () => {\r\n                        this.touched = false\r\n                        this.$router.push(path)\r\n                    }\r\n                })\r\n            }\r\n        },\r\n        deleteRoleConfirm(event: any) {\r\n            if (!event.item) return\r\n            this.$confirm.require({\r\n                message: this.$t('common.toast.deleteMessage'),\r\n                header: this.$t('common.toast.deleteTitle'),\r\n                icon: 'pi pi-exclamation-triangle',\r\n                accept: () => this.deleteRole(event.item.id)\r\n            })\r\n        },\r\n        async deleteRole(roleId: number) {\r\n            await this.$http\r\n                .delete(import.meta.env.VITE_RESTFUL_SERVICES_PATH + '2.0/roles/' + roleId, { headers: { 'X-Disable-Errors': 'true' } })\r\n                .then(() => {\r\n                    this.store.setInfo({\r\n                        title: this.$t('common.toast.deleteTitle'),\r\n                        msg: this.$t('common.toast.deleteSuccess')\r\n                    })\r\n                    this.$router.push('/roles-management')\r\n                    this.loadAllRoles()\r\n                })\r\n                .catch((error) => {\r\n                    if (error) {\r\n                        this.store.setError({\r\n                            title: this.$t('common.toast.deleteTitle'),\r\n                            msg: this.$t('common.error.deleting')\r\n                        })\r\n                    }\r\n                })\r\n        },\r\n        pageReload() {\r\n            this.touched = false\r\n            this.loadAllRoles()\r\n        }\r\n    }\r\n})\r\n</script>\r\n"],"names":["FabButton","mainStore","_openBlock","_createElementBlock","_createElementVNode","_createVNode","_withCtx","_createBlock","_createCommentVNode","_withModifiers"],"mappings":"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"}