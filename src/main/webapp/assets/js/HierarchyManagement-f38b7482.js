import{d as E,i as B,_ as T,r as i,o as b,h as y,w as s,f as n,g as D,t as k,c as x,B as H,C as V,a as r,A as M,D as z,l as O,n as j,y as X,V as N,z as C,G as K,a5 as S,a4 as te,Y as I,s as L,a6 as A,ad as R,a7 as U,a1 as F,bf as oe,aj as re,v as ae,u as ne}from"./index-1e676509.js";import{s as _}from"./calendar.esm-60a451ba.js";import{f as q}from"./filterHelper-a723991a.js";import{s as Y}from"./checkbox.esm-fa6c8259.js";import{s as ie}from"./tree.esm-837306a6.js";const le={style:{height:"60%","max-height":"60%","max-width":"60%","min-width":"60%"}},de={width:"5%"};var G={dialog:le,smallIconColumn:de};const se=E({name:"hierarchy-management-dimension-info-dialog",components:{Dialog:B},props:{visible:{type:Boolean},selectedItem:{type:Array}},emits:["close"],data(){return{hierarchyManagementDimensionsTableDescriptor:G}},watch:{nodeMetadata(){this.loadNodeData()}},async created(){this.loadNodeData()},methods:{loadNodeData(){},save(){},close(){this.$emit("close")}}}),ce={key:0,class:"marginated-form p-fluid p-formgrid p-grid kn-flex p-m-2"},be={class:"p-float-label"},pe={class:"kn-material-input-label"};function ke(e,t,o,a,h,w){const m=i("Toolbar"),c=i("InputText"),u=i("Button"),f=i("Dialog");return b(),y(f,{id:"hierarchy-management-dimension-info-dialog",class:"p-fluid kn-dialog--toolbar--primary",visible:e.visible,modal:!0,closable:!1,style:z(e.hierarchyManagementDimensionsTableDescriptor.dialog.style)},{header:s(()=>[n(m,{class:"kn-toolbar kn-toolbar--primary"},{start:s(()=>[D(k(e.$t("common.details")),1)]),_:1})]),footer:s(()=>[n(u,{class:"kn-button kn-button--primary",label:e.$t("common.ok"),onClick:e.close},null,8,["label","onClick"])]),default:s(()=>[e.selectedItem?(b(),x("form",ce,[(b(!0),x(H,null,V(e.selectedItem,(l,p)=>(b(),x("div",{class:"p-field p-col-12 p-md-6 p-lg-4",key:p},[r("span",be,[n(c,{class:"kn-material-input",modelValue:l.value,"onUpdate:modelValue":d=>l.value=d,modelModifiers:{trim:!0},disabled:!0},null,8,["modelValue","onUpdate:modelValue"]),r("label",pe,k(l.label),1)])]))),128))])):M("",!0)]),_:1},8,["visible","style"])}var he=T(se,[["render",ke]]);const me=E({name:"hierarchy-management-dimensions-table",components:{Column:O,DataTable:j,HierarchyManagementDimensionsInfoDialog:he},props:{dimensionData:{type:Object}},data(){return{hierarchyManagementDimensionsTableDescriptor:G,rows:[],columns:[],filters:{global:[q]},globalFilterFields:[],selectedItem:[],infoDialogVisible:!1}},watch:{dimensionData(){this.loadData()}},created(){this.loadData()},methods:{loadData(){var e;!this.dimensionData||(this.rows=this.dimensionData.root,this.columns=(e=this.dimensionData.columns)==null?void 0:e.filter(t=>t.VISIBLE).map(t=>({field:t.ID,header:t.NAME})),this.globalFilterFields=this.dimensionData.columns_search)},showInfo(e){this.selectedItem=[],Object.keys(e).forEach(t=>this.selectedItem.push({label:this.getColumnLabel(t),value:e[t]})),this.infoDialogVisible=!0},getColumnLabel(e){if(!this.dimensionData)return;const t=this.dimensionData.columns.findIndex(o=>o.ID===e);return t!==-1?this.dimensionData.columns[t].NAME:""},onDragStart(e,t){e.dataTransfer.setData("text/plain",JSON.stringify(t)),e.dataTransfer.dropEffect="move",e.dataTransfer.effectAllowed="move"},closeInfoDialog(){this.selectedItem=[],this.infoDialogVisible=!1}}}),ue={class:"p-mt-2"},ge={class:"table-header p-d-flex"},fe={class:"p-input-icon-left p-mr-3 p-col-12"},ve=r("i",{class:"pi pi-search"},null,-1),ye=["onDragstart"],we=["onDragstart"];function xe(e,t,o,a,h,w){const m=i("InputText"),c=i("Column"),u=i("Button"),f=i("DataTable"),l=i("HierarchyManagementDimensionsInfoDialog"),p=X("tooltip");return b(),x("div",ue,[n(f,{value:e.rows,class:"p-datatable-sm kn-table",filters:e.filters,"onUpdate:filters":t[1]||(t[1]=d=>e.filters=d),globalFilterFields:e.globalFilterFields},{empty:s(()=>[D(k(e.$t("common.info.noDataFound")),1)]),header:s(()=>[r("div",ge,[r("span",fe,[ve,n(m,{class:"kn-material-input",modelValue:e.filters.global.value,"onUpdate:modelValue":t[0]||(t[0]=d=>e.filters.global.value=d),type:"text",placeholder:e.$t("common.search")},null,8,["modelValue","placeholder"])])])]),default:s(()=>[n(c,{style:z(e.hierarchyManagementDimensionsTableDescriptor.smallIconColumn)},{body:s(d=>[r("div",{class:"pi pi-bars p-button-link",draggable:!0,onDragstart:N(v=>e.onDragStart(v,d.data),["stop"])},null,40,ye)]),_:1},8,["style"]),(b(!0),x(H,null,V(e.columns,d=>(b(),y(c,{class:"kn-truncated",header:e.$t(d.header),key:d.field,sortField:d.field,sortable:!0},{body:s(v=>[C((b(),x("span",{class:"kn-cursor-pointer",draggable:!0,onDragstart:g=>e.onDragStart(g,v.data)},[D(k(v.data[d.field]),1)],40,we)),[[p,v.data[d.field],void 0,{top:!0}]])]),_:2},1032,["header","sortField"]))),128)),n(c,{style:z(e.hierarchyManagementDimensionsTableDescriptor.smallIconColumn)},{body:s(d=>[C(n(u,{icon:"pi pi-info",class:"p-button-link",onClick:N(v=>e.showInfo(d.data),["stop"])},null,8,["onClick"]),[[p,e.$t("common.detail"),void 0,{top:!0}]])]),_:1},8,["style"])]),_:1},8,["value","filters","globalFilterFields"]),n(l,{visible:e.infoDialogVisible,selectedItem:e.selectedItem,onClose:e.closeInfoDialog},null,8,["visible","selectedItem","onClose"])])}var Me=T(me,[["render",xe]]);const De={style:{height:"60%","max-height":"60%","max-width":"60%","min-width":"60%"}};var Ce={dialog:De};const Ae=E({name:"hierarchy-management-hierarchy-master-form",components:{},props:{nodeGeneralFields:{type:Array}},data(){return{fields:[]}},watch:{nodeGeneralFields(){this.loadFields()}},created(){this.loadFields()},methods:{loadFields(){this.fields=this.nodeGeneralFields}}}),$e={class:"marginated-form p-fluid p-formgrid p-grid kn-flex p-m-2"},Ee={key:0,class:"p-field p-col-6"},Te={class:"p-float-label"},Ne={class:"kn-material-input-label"};function He(e,t,o,a,h,w){const m=i("InputText");return b(),x("form",$e,[(b(!0),x(H,null,V(e.fields,(c,u)=>(b(),x(H,{key:u},[c.VISIBLE?(b(),x("div",Ee,[r("span",Te,[n(m,{class:K(["kn-material-input",{"p-invalid":!c.value}]),type:c.TYPE==="Number"?"number":"text",modelValue:c.value,"onUpdate:modelValue":f=>c.value=f,modelModifiers:{trim:!0},disabled:!c.EDITABLE},null,8,["type","modelValue","onUpdate:modelValue","class","disabled"]),r("label",Ne,k(c.NAME+" *"),1)])])):M("",!0)],64))),128))])}var Ie=T(Ae,[["render",He]]);const Se=E({name:"hierarchy-management-hierarchy-master-select-list",components:{Dropdown:S,Listbox:te},props:{dimensionMetadata:{type:Object}},emits:["recursiveChanged","levelsChanged"],data(){return{dimensionSourceFields:[],selectedSourceFields:[],dimensionDestinationFields:[],selectedDestinationFields:[],errorMessageVisible:!1,recursive:null,parentDimensionSourceFields:[],recursiveParentName:null,recursiveParentDescription:null}},watch:{dimensionMetadata(){this.loadDimensionData()}},created(){this.loadDimensionData()},methods:{loadDimensionData(){var e;this.dimensionSourceFields=[],this.parentDimensionSourceFields=[],(e=this.dimensionMetadata)==null||e.DIM_FIELDS.forEach(t=>t.PARENT?this.parentDimensionSourceFields.push(t):this.dimensionSourceFields.push(t))},onSelectedField(){this.selectedSourceFields.length===3?(this.selectedSourceFields.splice(2,1),this.errorMessageVisible=!0):this.errorMessageVisible=!1},moveToTheRight(){var e;if(this.selectedSourceFields.length===1||this.selectedSourceFields.length===2){const t={code:this.selectedSourceFields[0],name:(e=this.selectedSourceFields[1])!=null?e:this.selectedSourceFields[0],hasCopy:this.selectedSourceFields.length===1,isLast:!0};t.code.level=this.dimensionDestinationFields.length+1,t.name.level=this.dimensionDestinationFields.length+1,this.dimensionDestinationFields.length>0&&(this.dimensionDestinationFields[this.dimensionDestinationFields.length-1].isLast=!1);for(let o=0;o<this.selectedSourceFields.length;o++){const a=this.dimensionSourceFields.findIndex(h=>h.ID===this.selectedSourceFields[o].ID);a!==-1&&this.dimensionSourceFields.splice(a,1)}this.selectedSourceFields=[],this.dimensionDestinationFields.push(t)}this.$emit("levelsChanged",this.dimensionDestinationFields)},moveToTheLeft(){if(this.selectedDestinationFields.length!==0){for(let e=0;e<this.selectedDestinationFields.length;e++){delete this.selectedDestinationFields[e].code.level,delete this.selectedDestinationFields[e].name.maxLevel,this.dimensionSourceFields.push(this.selectedDestinationFields[e].code),this.selectedDestinationFields[e].hasCopy||this.dimensionSourceFields.push(this.selectedDestinationFields[e].name);const t=this.dimensionDestinationFields.findIndex(o=>o.code.ID===this.selectedDestinationFields[e].code.ID);t!==-1&&this.dimensionDestinationFields.splice(t,1)}this.selectedDestinationFields=[];for(let e=0;e<this.dimensionDestinationFields.length;e++)this.dimensionDestinationFields[e].code.level=e+1,this.dimensionDestinationFields[e].name.level=e+1;this.$emit("levelsChanged",this.dimensionDestinationFields)}},move(e,t,o){const a=o==="up"?t-1:t+1;e.code.level=a+1,e.name.level=a+1,this.dimensionDestinationFields[t]=this.dimensionDestinationFields[a],this.dimensionDestinationFields[t].code.level=t+1,this.dimensionDestinationFields[t].level=t+1,this.dimensionDestinationFields[a]=e,this.$emit("levelsChanged",this.dimensionDestinationFields)},moveToRecursive(e,t){this.recursive&&(this.selectedDestinationFields=[this.recursive],this.moveToTheLeft()),e.isLast=!1,this.dimensionDestinationFields.splice(t,1),this.dimensionDestinationFields.length>0&&(this.dimensionDestinationFields[this.dimensionDestinationFields.length-1].isLast=!0),this.selectedDestinationFields=[],this.recursive=e,this.$emit("recursiveChanged",{recursive:this.recursive,recursiveParentName:this.recursiveParentName,recursiveParentDescription:this.recursiveParentDescription,levels:this.dimensionDestinationFields})},removeRecursive(){this.selectedDestinationFields=[this.recursive],this.moveToTheLeft(),this.recursive=!1,this.recursiveParentName=null,this.recursiveParentDescription=null,this.$emit("recursiveChanged",null)}}}),_e={key:0,class:"p-error p-ml-2","data-test":"error-message"},Fe={class:"p-d-flex kn-flex kn-overflow"},ze={id:"list-container",class:"p-d-flex p-ml-2",style:{flex:"1 1 0"}},Ve={class:"kn-list-item"},Le={class:"kn-list-item-text"},Re=["data-test"],Ue={id:"button-container",class:"p-as-center p-mx-2"},Be={class:"p-d-flex p-flex-column"},Ye={id:"identifier-container",class:"p-d-flex p-mr-2",style:{flex:"1 1 0"}},Oe={class:"kn-list-item"},je={class:"p-d-flex p-flex-row kn-flex"},Xe={class:"p-ml-auto"},Ge={id:"recursive-container",class:"p-m-2"},Qe={key:0,class:"p-ml-2"},Je={class:"marginated-form p-fluid p-formgrid p-grid"},Pe={class:"p-field p-col-6"},Ke={class:"p-float-label"},qe={class:"kn-material-input-label"},Ze={class:"p-field p-col-6"},We={class:"p-float-label"},et={class:"kn-material-input-label"};function tt(e,t,o,a,h,w){const m=i("Listbox"),c=i("Button"),u=i("Toolbar"),f=i("Dropdown");return b(),x(H,null,[e.errorMessageVisible?(b(),x("small",_e,k(e.$t("managers.hierarchyManagement.createHierarchyMasterErrorMessage")),1)):M("",!0),r("div",Fe,[r("div",ze,[n(m,{class:"kn-list kn-list-border-all kn-flex hierarchy-management-list",listStyle:"max-height:calc(100% - 62px)",modelValue:e.selectedSourceFields,"onUpdate:modelValue":t[0]||(t[0]=l=>e.selectedSourceFields=l),options:e.dimensionSourceFields,optionLabel:"NAME",multiple:!0,filter:!0,onChange:e.onSelectedField},{empty:s(()=>[D(k(e.$t("common.info.noDataFound")),1)]),option:s(l=>[r("div",Ve,[r("div",Le,[r("span",{"data-test":"list-item-"+l.option.NAME},k(l.option.NAME),9,Re)])])]),_:1},8,["modelValue","options","onChange"])]),r("div",Ue,[r("div",Be,[n(c,{class:"kn-button kn-button--primary hierarchy-management-master-selecet-list-button",icon:"pi pi-angle-double-right",disabled:e.selectedSourceFields.length===0,onClick:e.moveToTheRight,"data-test":"move-right-button"},null,8,["disabled","onClick"]),n(c,{class:"kn-button kn-button--primary hierarchy-management-master-selecet-list-button p-mt-2",icon:"pi pi-angle-double-left",disabled:e.selectedDestinationFields.length===0,onClick:e.moveToTheLeft},null,8,["disabled","onClick"])])]),r("div",Ye,[n(m,{class:"kn-list kn-list-border-all kn-flex hierarchy-management-list",listStyle:"max-height:100%",modelValue:e.selectedDestinationFields,"onUpdate:modelValue":t[1]||(t[1]=l=>e.selectedDestinationFields=l),options:e.dimensionDestinationFields,optionLabel:"NAME",multiple:!0,onChange:e.onSelectedField,"data-test":"selected-destinations-list"},{empty:s(()=>[D(k(e.$t("common.info.noDataFound")),1)]),option:s(l=>[r("div",Oe,[r("div",je,[r("span",null,[r("b",null,k(e.$t("managers.hierarchyManagement.lev")+" "+l.option.code.level+" "),1),D(" "+k(l.option.code.NAME+", "+l.option.name.NAME),1)]),r("div",Xe,[l.index===e.dimensionDestinationFields.length-1?(b(),y(c,{key:0,icon:"fa fa-plus",class:"p-button-text p-button-plain p-button-sm p-p-0",onClick:N(p=>e.moveToRecursive(l.option,l.index),["stop"]),"data-test":"recursive-button-"+l.option.code.NAME},null,8,["onClick","data-test"])):M("",!0),l.index!==0?(b(),y(c,{key:1,icon:"fa fa-arrow-up",class:"p-button-text p-button-plain p-button-sm p-p-0",onClick:N(p=>e.move(l.option,l.index,"up"),["stop"])},null,8,["onClick"])):M("",!0),l.index!==e.dimensionDestinationFields.length-1?(b(),y(c,{key:2,icon:"fa fa-arrow-down",class:"p-button-text p-button-plain p-button-sm p-p-0",onClick:N(p=>e.move(l.option,l.index,"down"),["stop"])},null,8,["onClick"])):M("",!0)])])])]),_:1},8,["modelValue","options","onChange"])])]),r("div",Ge,[n(u,{class:"kn-toolbar kn-toolbar--secondary p-p-0 p-m-0 p-col-12"},{start:s(()=>[D(k(e.$t("managers.hierarchyManagement.recursive")+": ")+" ",1),e.recursive?(b(),x("span",Qe,k(e.recursive.code.NAME+" "+e.recursive.name.NAME),1)):M("",!0)]),end:s(()=>[C(n(c,{icon:"pi pi-trash",class:"p-button-text p-button-rounded p-button-plain",onClick:e.removeRecursive},null,8,["onClick"]),[[I,e.recursive]])]),_:1}),r("form",Je,[r("div",Pe,[r("span",Ke,[n(f,{class:"kn-material-input",modelValue:e.recursiveParentName,"onUpdate:modelValue":t[2]||(t[2]=l=>e.recursiveParentName=l),options:e.parentDimensionSourceFields,optionLabel:"NAME",disabled:!e.recursive,onChange:t[3]||(t[3]=l=>e.$emit("recursiveChanged",{recursive:e.recursive,recursiveParentName:e.recursiveParentName,recursiveParentDescription:e.recursiveParentDescription}))},null,8,["modelValue","options","disabled"]),r("label",qe,k(e.$t("common.name")),1)])]),r("div",Ze,[r("span",We,[n(f,{class:"kn-material-input",modelValue:e.recursiveParentDescription,"onUpdate:modelValue":t[4]||(t[4]=l=>e.recursiveParentDescription=l),options:e.parentDimensionSourceFields,optionLabel:"NAME",disabled:!e.recursive,onChange:t[5]||(t[5]=l=>e.$emit("recursiveChanged",{recursive:e.recursive,recursiveParentName:e.recursiveParentName,recursiveParentDescription:e.recursiveParentDescription}))},null,8,["modelValue","options","disabled"]),r("label",et,k(e.$t("common.description")),1)])])])])],64)}var ot=T(Se,[["render",tt]]);const rt=E({name:"hierarchy-management-hierarchy-master-dialog",components:{Dialog:B,HierarchyManagementHierarchyMasterForm:Ie,HierarchyManagementHierarchyMasterSelectList:ot},props:{visible:{type:Boolean},nodeMetadata:{type:Object},dimensionMetadata:{type:Object},validityDate:{type:Date},selectedDimension:{type:Object},dimensionFilters:{type:Array}},emits:["close","masterHierarchyCreated"],data(){return{hierarchyManagementHierarchyMasterDialogDescriptor:Ce,nodeGeneralFields:[],recursive:null,levels:[],loading:!1}},computed:{saveButtonDisabled(){return this.requiredFieldMissing()}},watch:{visible(e){e&&this.loadNodeData()},nodeMetadata(){this.loadNodeData()}},setup(){return{store:L()}},async created(){this.loadNodeData()},methods:{loadNodeData(){this.nodeGeneralFields=this.nodeMetadata?this.nodeMetadata.GENERAL_FIELDS.map(e=>({...e,value:""})):[]},requiredFieldMissing(){let e=!1;for(let t=0;t<this.nodeGeneralFields.length;t++)if(this.nodeGeneralFields[t].VISIBLE&&!this.nodeGeneralFields[t].value){e=!0;break}return e},onLevelsChanged(e){this.levels=e==null?void 0:e.map(t=>{var o,a;return{CD:(o=t.code)==null?void 0:o.ID,NM:(a=t.name)==null?void 0:a.ID}})},onRecursiveChanged(e){var t,o,a,h;if(!e){this.recursive=null;return}e.levels&&this.onLevelsChanged(e.levels),this.recursive={NM:(t=e.recursive.name)==null?void 0:t.ID,CD:(o=e.recursive.code)==null?void 0:o.ID,NM_PARENT:(a=e.recursiveParentName)==null?void 0:a.ID,CD_PARENT:(h=e.recursiveParentDescription)==null?void 0:h.ID}},async save(){var t,o;const e={dimension:(t=this.selectedDimension)==null?void 0:t.DIMENSION_NM,validityDate:A(this.validityDate).format("YYYY-MM-DD"),optionalFilters:(o=this.dimensionFilters)==null?void 0:o.filter(a=>a.VALUE&&a.VALUE!==""),levels:this.levels,recursive:this.recursive};for(let a=0;a<this.nodeGeneralFields.length;a++)this.nodeGeneralFields[a].VISIBLE&&(e[this.nodeGeneralFields[a].ID]=this.nodeGeneralFields[a].TYPE==="NUMBER"&&this.nodeGeneralFields[a].value?parseInt(this.nodeGeneralFields[a].value):this.nodeGeneralFields[a].value);this.loading=!0,await this.$http.post("/knowage/restful-services/hierarchiesMaster/createHierarchyMaster",e).then(a=>{var h;((h=a.data)==null?void 0:h.response)==="ok"&&(this.$emit("masterHierarchyCreated"),this.store.setInfo({title:this.$t("common.toast.createTitle"),msg:this.$t("common.toast.success")}))}).catch(()=>{}),this.loading=!1},close(){this.nodeGeneralFields=[],this.levels=[],this.recursive=null,this.$emit("close")}}});function at(e,t,o,a,h,w){const m=i("Toolbar"),c=i("HierarchyManagementHierarchyMasterForm"),u=i("HierarchyManagementHierarchyMasterSelectList"),f=i("Button"),l=i("Dialog");return b(),y(l,{class:"p-fluid kn-dialog--toolbar--primary hierarchy-dialog",style:{width:"70%"},visible:e.visible,modal:!0,closable:!1,draggable:!1},{header:s(()=>[n(m,{class:"kn-toolbar kn-toolbar--primary p-p-0 p-m-0 p-col-12"},{start:s(()=>[D(k(e.$t("managers.hierarchyManagement.createHierarchyMaster")),1)]),_:1})]),footer:s(()=>[n(f,{class:"kn-button kn-button--secondary",onClick:e.close},{default:s(()=>[D(k(e.$t("common.close")),1)]),_:1},8,["onClick"]),n(f,{class:"kn-button kn-button--primary",disabled:e.saveButtonDisabled,onClick:e.save},{default:s(()=>[D(k(e.$t("common.save")),1)]),_:1},8,["disabled","onClick"])]),default:s(()=>[n(c,{nodeGeneralFields:e.nodeGeneralFields},null,8,["nodeGeneralFields"]),n(u,{dimensionMetadata:e.dimensionMetadata,onRecursiveChanged:e.onRecursiveChanged,onLevelsChanged:e.onLevelsChanged},null,8,["dimensionMetadata","onRecursiveChanged","onLevelsChanged"])]),_:1},8,["visible"])}var nt=T(rt,[["render",at]]);const it=E({name:"hierarchy-management-dimensions-filter-card",components:{Calendar:_,Checkbox:Y,Card:R},props:{dimensionFilters:{type:Array},selectedHierarchy:{type:Object}},emits:["applyFilters"],data(){return{filters:[],showMissingElements:!1,expandFilterCard:!1}},watch:{dimensionFilters(){this.loadFilters()}},async created(){this.loadFilters()},methods:{loadFilters(){this.filters=this.dimensionFilters},applyFilters(){let e=U(this.filters);e=e.filter(t=>t.VALUE&&t.VALUE!==""),e.forEach(t=>{t.TYPE==="Date"&&(t.VALUE=A(t.VALUE).format("YYYY-MM-DD"))}),this.$emit("applyFilters",{filters:e,showMissingElements:this.showMissingElements})},resetFilters(){var e;this.showMissingElements=!1,(e=this.filters)==null||e.forEach(t=>t.VALUE=""),this.$emit("applyFilters",{filters:[],showMissingElements:this.showMissingElements})}}}),lt={class:"p-grid p-fluid p-formgrid"},dt={class:"p-field-checkbox p-col-12"},st={class:"kn-material-input-label p-as-center"},ct={class:"p-float-label"},bt={class:"kn-material-input-label"};function pt(e,t,o,a,h,w){const m=i("Button"),c=i("Toolbar"),u=i("Checkbox"),f=i("Calendar"),l=i("InputText"),p=i("Card");return b(),x(H,null,[n(c,{class:"kn-toolbar kn-toolbar--default"},{start:s(()=>[e.expandFilterCard?(b(),y(m,{key:1,icon:"fas fa-chevron-up",class:"p-button-text p-button-rounded p-button-plain",onClick:t[1]||(t[1]=d=>e.expandFilterCard=!1)})):(b(),y(m,{key:0,icon:"fas fa-chevron-down",class:"p-button-text p-button-rounded p-button-plain",onClick:t[0]||(t[0]=d=>e.expandFilterCard=!0)})),r("span",null,k(e.$t("common.filters")),1)]),end:s(()=>[e.expandFilterCard?(b(),y(m,{key:0,icon:"pi pi-check",class:"p-button-text p-button-rounded p-button-plain",onClick:e.applyFilters},null,8,["onClick"])):M("",!0),e.expandFilterCard?(b(),y(m,{key:1,icon:"fas fa-eraser",class:"p-button-text p-button-rounded p-button-plain",onClick:e.resetFilters},null,8,["onClick"])):M("",!0)]),_:1}),C(n(p,null,{content:s(()=>[r("div",lt,[r("div",dt,[n(u,{class:"p-mr-2",modelValue:e.showMissingElements,"onUpdate:modelValue":t[2]||(t[2]=d=>e.showMissingElements=d),binary:!0,disabled:!e.selectedHierarchy},null,8,["modelValue","disabled"]),r("label",st,k(e.$t("managers.hierarchyManagement.showMissingElements")),1)]),(b(!0),x(H,null,V(e.filters,(d,v)=>(b(),x("div",{class:"p-field p-col-12 p-lg-6",key:v},[r("span",ct,[d.TYPE==="Date"?(b(),y(f,{key:0,class:"kn-material-input",modelValue:d.VALUE,"onUpdate:modelValue":g=>d.VALUE=g,manualInput:!0,showIcon:!0},null,8,["modelValue","onUpdate:modelValue"])):(b(),y(l,{key:1,class:"kn-material-input",type:d.TYPE==="number"?"number":"text",modelValue:d.VALUE,"onUpdate:modelValue":g=>d.VALUE=g,modelModifiers:{trim:!0}},null,8,["type","modelValue","onUpdate:modelValue"])),r("label",bt,k(d.NAME),1)])]))),128))])]),_:1},512),[[I,e.expandFilterCard]])],64)}var kt=T(it,[["render",pt]]);const ht=E({name:"hierarchy-management-dimensions-card",components:{Card:R,Calendar:_,Dropdown:S,HierarchyManagementDimensionsTable:Me,HierarchyManagementHierarchyMasterDialog:nt,HierarchyManagementDimensionsFilterCard:kt},props:{dimensions:{type:Array},hierarchyType:{type:String},selectedHierarchy:{type:Object},validityTreeDate:{type:Object}},emits:["loading","dimensionSelected","nodeMetadataChanged","validityDateSelected","dimensionMetadataChanged","synchronized","masterHierarchyCreated"],data(){return{validityDate:new Date,selectedDimension:null,hierarchyMasterDialogVisible:!1,dimensionData:null,dimensionMetadata:null,nodeMetadata:null,dimensionFilters:[],filterData:null}},computed:{synchronizeButtonDisabled(){var e;return!this.dimensionData||this.dimensionData.root.length===0||((e=this.hierarchyType)==null?void 0:e.toUpperCase())!=="MASTER"||!this.selectedHierarchy}},setup(){return{store:L()}},async created(){},methods:{async onValidityDateSelected(){this.$emit("validityDateSelected",this.validityDate),await this.loadData()},async onSelectedDimensionChange(){this.$emit("dimensionSelected",this.selectedDimension),await this.loadData()},async loadData(){await this.loadDimensionData(),await this.loadDimensionMetadata(),await this.loadNodeMetadata(),await this.loadDimensionFilters()},async loadDimensionData(){var o,a;this.$emit("loading",!0),this.dimensionData=null;const e=A(this.validityDate).format("YYYY-MM-DD");let t=`dimensions/dimensionData?dimension=${(o=this.selectedDimension)==null?void 0:o.DIMENSION_NM}&validityDate=${e}`;if(this.filterData){if(this.filterData.showMissingElements){const h=this.validityTreeDate?A(this.validityTreeDate).format("YYYY-MM-DD"):"";t=t.concat("&filterDate="+h),t=t.concat("&filterHierType="+this.hierarchyType),t=t.concat("&filterHierarchy="+((a=this.selectedHierarchy)==null?void 0:a.HIER_NM))}this.filterData.filters.length>0&&(t=t.concat("&optionalFilters="+encodeURI(JSON.stringify(this.filterData.filters))))}await this.$http.get("/knowage/restful-services/"+t).then(h=>this.dimensionData=h.data),this.$emit("loading",!1)},async loadDimensionMetadata(){var e;this.$emit("loading",!0),await this.$http.get(`/knowage/restful-services/dimensions/dimensionMetadata?dimension=${(e=this.selectedDimension)==null?void 0:e.DIMENSION_NM}`).then(t=>this.dimensionMetadata=t.data),this.$emit("dimensionMetadataChanged",this.dimensionMetadata),this.$emit("loading",!1)},async loadNodeMetadata(){var e;this.$emit("loading",!0),await this.$http.get(`/knowage/restful-services/hierarchies/nodeMetadata?dimension=${(e=this.selectedDimension)==null?void 0:e.DIMENSION_NM}&excludeLeaf=false`).then(t=>this.nodeMetadata=t.data),this.$emit("nodeMetadataChanged",this.nodeMetadata),this.$emit("loading",!1)},async loadDimensionFilters(){this.$emit("loading",!0),await this.$http.get("/knowage/restful-services/dimensions/dimensionFilterMetadata?dimension=CDC").then(e=>{var t;return this.dimensionFilters=(t=e.data)==null?void 0:t.DIM_FILTERS}),this.$emit("loading",!1)},onApplyFilters(e){this.filterData=e,this.loadDimensionData()},openHierarchyMasterDialog(){this.hierarchyMasterDialogVisible=!0},async synchronize(){var t,o;this.$emit("loading",!0);const e={dimension:(t=this.selectedDimension)==null?void 0:t.DIMENSION_NM,validityDate:A(this.validityDate).format("YYYY-MM-DD"),validityTreeDate:this.validityTreeDate?A(this.validityTreeDate).format("YYYY-MM-DD"):null,filterHierarchy:(o=this.selectedHierarchy)==null?void 0:o.HIER_NM,filterHierType:this.hierarchyType,optionalFilters:this.filterData?this.filterData.filters:[]};await this.$http.post("/knowage/restful-services/hierarchiesMaster/syncronizeHierarchyMaster",e).then(a=>{a.data.response==="ok"&&(this.store.setInfo({title:this.$t("common.info.info"),msg:this.$t("managers.hierarchyManagement.synchronizationSuccess")}),this.$emit("synchronized"))}).catch(()=>{}),this.$emit("loading",!1)},onMasterHierarchyCreated(){this.hierarchyMasterDialogVisible=!1,this.$emit("masterHierarchyCreated")}}}),mt=r("i",{class:"fa fa-list p-mr-2"},null,-1),ut={class:"p-fluid p-formgrid p-grid"},gt={class:"p-field p-col-12 p-lg-6"},ft={class:"p-field p-col-12 p-lg-6"},vt={class:"p-float-label"},yt={class:"kn-material-input-label"},wt={class:"p-field p-col-6"},xt={class:"p-field p-col-6"};function Mt(e,t,o,a,h,w){const m=i("Toolbar"),c=i("Calendar"),u=i("Dropdown"),f=i("Button"),l=i("HierarchyManagementDimensionsFilterCard"),p=i("HierarchyManagementDimensionsTable"),d=i("Card"),v=i("HierarchyManagementHierarchyMasterDialog");return b(),x(H,null,[n(d,{class:"p-m-2 p-d-flex p-flex-column hierarchy-scrollable-card"},{header:s(()=>[n(m,{class:"kn-toolbar kn-toolbar--secondary"},{start:s(()=>[mt,r("span",null,k(e.$t("managers.hierarchyManagement.dimensions")),1)]),_:1})]),content:s(()=>[r("form",ut,[r("div",gt,[n(c,{class:"kn-material-input",modelValue:e.validityDate,"onUpdate:modelValue":t[0]||(t[0]=g=>e.validityDate=g),manualInput:!0,showIcon:!0,onDateSelect:e.onValidityDateSelected},null,8,["modelValue","onDateSelect"])]),r("div",ft,[r("span",vt,[n(u,{class:"kn-material-input",modelValue:e.selectedDimension,"onUpdate:modelValue":t[1]||(t[1]=g=>e.selectedDimension=g),options:e.dimensions,optionLabel:"DIMENSION_NM",onChange:e.onSelectedDimensionChange},null,8,["modelValue","options","onChange"]),r("label",yt,k(e.$t("managers.hierarchyManagement.dimensions")),1)])]),r("div",wt,[n(f,{class:"kn-button kn-button--primary kn-truncated",label:e.$t("managers.hierarchyManagement.createHierarchyMaster"),disabled:!e.selectedDimension,onClick:e.openHierarchyMasterDialog},null,8,["label","disabled","onClick"])]),r("div",xt,[n(f,{class:"kn-button kn-button--primary",label:e.$t("managers.hierarchyManagement.synchronize"),disabled:e.synchronizeButtonDisabled,onClick:e.synchronize},null,8,["label","disabled","onClick"])])]),C(n(l,{dimensionFilters:e.dimensionFilters,selectedHierarchy:e.selectedHierarchy,onApplyFilters:e.onApplyFilters},null,8,["dimensionFilters","selectedHierarchy","onApplyFilters"]),[[I,e.selectedDimension]]),C(n(p,{dimensionData:e.dimensionData},null,8,["dimensionData"]),[[I,e.dimensionData]])]),_:1}),n(v,{visible:e.hierarchyMasterDialogVisible,nodeMetadata:e.nodeMetadata,dimensionMetadata:e.dimensionMetadata,validityDate:e.validityDate,selectedDimension:e.selectedDimension,dimensionFilters:e.dimensionFilters,onClose:t[2]||(t[2]=g=>e.hierarchyMasterDialogVisible=!1),onMasterHierarchyCreated:e.onMasterHierarchyCreated},null,8,["visible","nodeMetadata","dimensionMetadata","validityDate","selectedDimension","dimensionFilters","onMasterHierarchyCreated"])],64)}var Dt=T(ht,[["render",Mt]]);const Ct=["MASTER","TECHNICAL"];var Z={hierarchyTypes:Ct};const At={style:{padding:"0"}},$t=["","name","id"],Et="width: 5%";var Q={node:At,orderByOptions:$t,selectColumnStyle:Et};const Tt=E({name:"hierarchy-management-node-detail-dialog",components:{Calendar:_,Dialog:B},props:{visible:{type:Boolean},selectedNode:{type:Object},metadata:{type:Array},mode:{type:String}},emits:["save","close"],data(){return{hierarchyManagementHierarchiesTreeDescriptor:Q,node:null}},watch:{selectedNode(){this.loadNode()}},async created(){this.loadNode()},methods:{loadNode(){var e;this.node=U(this.selectedNode),(e=this.metadata)==null||e.forEach(t=>{t.TYPE==="Date"&&this.node[t.ID]&&(this.node[t.ID]=this.mode==="clone"?new Date:A(this.node[t.ID],"YYYY-MM-DD").toDate())})},close(){this.node=null,this.$emit("close")},save(){this.formatNode(),this.$emit("save",{node:this.node,mode:this.mode}),this.node=null},formatNode(){var e,t;this.node.name=this.node[(e=this.node)==null?void 0:e.aliasName],(t=this.metadata)==null||t.forEach(o=>{o.TYPE==="Date"&&this.node[o.ID]&&(this.node[o.ID]=A(this.node[o.ID]).format("YYYY-MM-DD"))})}}}),Nt={key:0,class:"p-fluid p-formgrid p-grid p-mt-3"},Ht={key:0,class:"p-field p-col-12 p-lg-6"},It={class:"p-float-label"},St={class:"kn-material-input-label"};function _t(e,t,o,a,h,w){const m=i("Toolbar"),c=i("Calendar"),u=i("InputText"),f=i("Button"),l=i("Dialog");return b(),y(l,{class:"kn-dialog--toolbar--primary node-detail-dialog",visible:e.visible,modal:!0,closable:!1},{header:s(()=>[n(m,{class:"kn-toolbar kn-toolbar--primary p-p-0 p-m-0 p-col-12"},{start:s(()=>[D(k(e.$t("managers.hierarchyManagement.modifyHierarchy")),1)]),_:1})]),footer:s(()=>[n(f,{class:"kn-button kn-button--secondary",onClick:e.close},{default:s(()=>[D(k(e.mode==="info"?e.$t("common.ok"):e.$t("common.cancel")),1)]),_:1},8,["onClick"]),e.mode!=="info"?(b(),y(f,{key:0,class:"kn-button kn-button--primary",onClick:e.save},{default:s(()=>[D(k(e.$t("common.save")),1)]),_:1},8,["onClick"])):M("",!0)]),default:s(()=>[e.node?(b(),x("div",Nt,[(b(!0),x(H,null,V(e.metadata,(p,d)=>(b(),x(H,{key:d},[e.mode==="createRoot"||p.VISIBLE?(b(),x("div",Ht,[r("span",It,[p.TYPE==="Date"?(b(),y(c,{key:0,modelValue:e.node[p.ID],"onUpdate:modelValue":v=>e.node[p.ID]=v,manualInput:!0,disabled:e.mode==="info"||!p.EDITABLE&&e.mode!=="create"},null,8,["modelValue","onUpdate:modelValue","disabled"])):(b(),y(u,{key:1,class:"kn-material-input",modelValue:e.node[p.ID],"onUpdate:modelValue":v=>e.node[p.ID]=v,modelModifiers:{trim:!0},type:p.TYPE==="Number"?"number":"text",disabled:e.mode==="info"||!p.EDITABLE&&e.mode!=="create"||p.FIX_VALUE},null,8,["modelValue","onUpdate:modelValue","type","disabled"])),r("label",St,k(p.NAME),1)])])):M("",!0)],64))),128))])):M("",!0)]),_:1},8,["visible"])}var W=T(Tt,[["render",_t]]);const Ft=E({name:"hierarchy-management-node-detail-dialog",components:{Column:O,DataTable:j,Dialog:B},props:{visible:{type:Boolean},hierarchiesTargets:{type:Array}},emits:["save","close"],data(){return{hierarchyManagementHierarchiesTreeDescriptor:Q,targets:[],selectedTargets:[]}},watch:{hierarchiesTargets(){this.visible&&this.loadTargets()}},created(){this.loadTargets()},methods:{loadTargets(){this.targets=this.hierarchiesTargets},getLabel(e){return this.$t("managers.hierarchyManagement.hierarchy").toUpperCase()+": "+e.HIER_CD_T+" - "+e.HIER_NM_T+" - "+this.$t("managers.hierarchyManagement.levelNode")+": "+e.NODE_LEV_T},close(){this.selectedTargets=[],this.$emit("close")},save(){this.$emit("save",[...this.selectedTargets]),this.selectedTargets=[]}}}),zt=r("br",null,null,-1);function Vt(e,t,o,a,h,w){const m=i("Toolbar"),c=i("Column"),u=i("DataTable"),f=i("Button"),l=i("Dialog");return b(),y(l,{class:"kn-dialog--toolbar--primary hierarchies-target-dialog",visible:e.visible,modal:!0,closable:!1},{header:s(()=>[n(m,{class:"kn-toolbar kn-toolbar--primary p-p-0 p-m-0 p-col-12"},{start:s(()=>[D(k(e.$t("managers.hierarchyManagement.hierarchiesTarget")),1)]),_:1})]),footer:s(()=>[n(f,{class:"kn-button kn-button--primary",onClick:e.close},{default:s(()=>[D(k(e.$t("common.cancel")),1)]),_:1},8,["onClick"]),n(f,{class:"kn-button kn-button--primary",onClick:e.save},{default:s(()=>[D(k(e.$t("common.ok")),1)]),_:1},8,["onClick"])]),default:s(()=>[n(u,{class:"p-datatable-sm kn-table",value:e.targets,selection:e.selectedTargets,"onUpdate:selection":t[0]||(t[0]=p=>e.selectedTargets=p),dataKey:"MT_ID"},{empty:s(()=>[D(k(e.$t("common.info.noDataFound")),1)]),default:s(()=>[n(c,{selectionMode:"multiple",style:z(e.hierarchyManagementHierarchiesTreeDescriptor.selectColumnStyle)},null,8,["style"]),n(c,{field:"label",header:e.$t("common.label"),sortable:!0},{body:s(p=>[r("div",null,[r("span",null,[r("b",null,k(e.getLabel(p.data)),1)]),zt,r("span",null,k(p.data.PATH_NM_T),1)])]),_:1},8,["header"])]),_:1},8,["value","selection"])]),_:1},8,["visible"])}var Lt=T(Ft,[["render",Vt]]);const Rt=E({name:"hierarchy-management-hierarchies-tree",components:{Dropdown:S,HierarchyManagementNodeDetailDialog:W,HierarchyManagementHierarchiesTargetDialog:Lt,Tree:ie},props:{propTree:{type:Object},nodeMetadata:{type:Object},selectedDimension:{type:Object},selectedHierarchy:{type:Object},dimensionMetadata:{type:Object},propRelationsMasterTree:{type:Array},treeMode:{type:String}},emits:["loading","treeUpdated"],data(){return{hierarchyManagementHierarchiesTreeDescriptor:Q,tree:null,nodes:[],buttonVisible:[],detailDialogVisible:!1,selectedNode:null,metadata:[],mode:"",orderBy:"",dropzoneActive:[],relations:[],selectedRelations:[],relationsMasterTree:[],targetDialogVisible:!1,nodeToMove:null,targetForMove:null}},watch:{propTree(){this.loadTree()},propRelationsMasterTree(){this.loadMasterTreeRelations()}},setup(){return{store:L()}},created(){this.loadTree(),this.loadMasterTreeRelations()},methods:{loadTree(){this.tree=this.propTree,this.orderBy="",this.tree&&this.createNodeTree()},loadMasterTreeRelations(){this.relationsMasterTree=this.propRelationsMasterTree},createNodeTree(){this.nodes=this.formatNodes([this.tree],null)},formatNodes(e,t){return e.map(o=>{var a;return o={key:F({length:16,type:"base64"}),id:o.id,label:o.name,children:(a=o.children)!=null?a:[],data:o,style:this.hierarchyManagementHierarchiesTreeDescriptor.node.style,leaf:o.leaf,parent:t,icon:o.root?"":"pi pi-bars"},o.children&&o.children.length>0&&(o.children=this.formatNodes(o.children,o)),o})},sortTree(e){let t="";this.orderBy==="name"||this.orderBy===""?t="label":this.orderBy==="id"&&(t="id"),e.sort((o,a)=>o[t]>a[t]?1:-1),e.forEach(o=>{o.children&&this.sortTree(o.children)})},addNode(e){var t,o;this.mode="create",this.selectedNode={CDC_CD_LEV:"",CDC_OCD_LEV:"",CDC_NM_LEV:"",ORDER_LEV:"",FORM_LIV:"",aliasId:((t=this.selectedDimension)==null?void 0:t.DIMENSION_NM)+"_CD_LEV",aliasName:((o=this.selectedDimension)==null?void 0:o.DIMENSION_NM)+"_NM_LEV",children:[],leaf:!1,parent:e},this.setMetadata(),this.detailDialogVisible=!0},cloneNode(e){this.selectedNode={...e.data,originalNode:U(e),parentNode:e.parent},this.setMetadata(),this.mode="clone",this.detailDialogVisible=!0},editNode(e){this.selectedNode={...e.data,key:e.key},this.setMetadata(),this.mode="edit",this.detailDialogVisible=!0},deleteNodeConfirm(e){this.$confirm.require({message:this.$t("common.toast.deleteMessage"),header:this.$t("common.toast.deleteConfirmTitle"),icon:"pi pi-exclamation-triangle",accept:()=>this.deleteNode(e)})},deleteNode(e){if(!e.parent)return;const t=e.parent.children.findIndex(a=>a.key===e.key);t!==-1&&e.parent.children.splice(t,1);const o=this.relationsMasterTree.findIndex(a=>a.leafData.CDC_NM===e.data.CDC_NM&&a.leafData.CDC_CD===e.data.CDC_CD);o!==-1&&this.relationsMasterTree.splice(o,1),this.$emit("treeUpdated",this.nodes)},showNodeInfo(e){this.selectedNode=e.data,this.setMetadata(),this.mode="info",this.detailDialogVisible=!0},setMetadata(){!this.nodeMetadata||(this.selectedNode.root?this.metadata=this.nodeMetadata.GENERAL_FIELDS:this.selectedNode.leaf?this.metadata=this.nodeMetadata.LEAF_FIELDS:this.metadata=this.nodeMetadata.NODE_FIELDS)},closeNodeDialog(){this.selectedNode=null,this.metadata=[],this.mode="",this.detailDialogVisible=!1},onNodeSave(e){e.mode==="edit"?this.updateNode(e.node):e.mode==="create"?this.createNode(e.node):e.mode==="clone"&&this.copyNode(e.node),this.detailDialogVisible=!1},updateNode(e){let t=null;for(let o=0;o<this.nodes.length&&(t=this.findNode(this.nodes[o],e.key),!t);o++);t&&(t.data=e,t.key=F({length:16,type:"base64"}),t.label=e.name),this.$emit("treeUpdated",this.nodes)},createNode(e){e.id=e.name;let t=this.findNodeInTree(e.parent.key);e.LEVEL=t.data.LEVEL+1,t&&t.children.push({key:F({length:16,type:"base64"}),id:e.name,label:e.name,children:e.children,data:e,style:this.hierarchyManagementHierarchiesTreeDescriptor.node.style,leaf:e.leaf,parent:t}),this.$emit("treeUpdated",this.nodes)},copyNode(e){const t=e.originalNode,o=e.parentNode;if(delete e.originalNode,delete e.parentNode,oe(e,t)){this.store.setError({title:this.$t("common.error.generic"),msg:this.$t("managers.hierarchyManagement.nodeCloneError")});return}this.createNode({...e,parent:o}),this.$emit("treeUpdated",this.nodes)},findNodeInTree(e){let t=null;for(let o=0;o<this.nodes.length&&(t=this.findNode(this.nodes[o],e),!t);o++);return t},findNode(e,t){if(e.key===t)return e;if(e.children!=null){let o=null;for(let a=0;o==null&&a<e.children.length;a++)o=this.findNode(e.children[a],t);return o}return null},async onDragDrop(e,t,o){if(this.dropzoneActive[o]=!1,this.treeMode==="info")return;const a=JSON.parse(e.dataTransfer.getData("text/plain"));this.handleItemDrop(a,t)},async handleItemDrop(e,t){e.children=this.formatNodeAfterDrop(e.children,e);const o=t.data.leaf?t.parent:t;e.movedFrom==="tree"?this.moveNodeInsideTree(e,t):e.movedFrom==="sourceTree"?this.addNodeFromSourceTree(e,t):await this.loadRelations(e,o)},formatNodeAfterDrop(e,t){return e==null?void 0:e.map(o=>(o={...o,children:o.children,parent:t},o.parentKey&&delete o.parentKey,o.children&&o.children.length>0&&(o.children=this.formatNodeForDrag(o.children.node)),o))},setDropzoneClass(e,t){this.dropzoneActive[t.key]=e},async loadRelations(e,t){if(!this.selectedDimension||!this.selectedHierarchy)return;this.$emit("loading",!0);const o=t.data[t.data.aliasId];await this.$http.get(`/knowage/restful-services/hierarchies/getRelationsMasterTechnical?dimension=${this.selectedDimension.DIMENSION_NM}&hierSourceCode=${this.selectedHierarchy.HIER_CD}&hierSourceName=${this.selectedHierarchy.HIER_NM}&nodeSourceCode=${o}`).then(a=>{var h;this.relations=(h=a.data)==null?void 0:h.root,this.relations&&this.relations.length===0?(this.store.setInfo({title:this.$t("common.info.info"),msg:this.$t("managers.hierarchyManagement.noHierarchiesForPropagation")}),this.copyNodeFromTableToTree(e,t)):(this.nodeToMove=e,this.targetForMove=t,this.targetDialogVisible=!0)}),this.$emit("loading",!1)},copyNodeFromTableToTree(e,t){var f;let o=this.findNodeInTree(t.key);if(!o)return;const a=this.selectedDimension?this.selectedDimension.DIMENSION_NM:"",h=this.selectedDimension?this.selectedDimension.DIMENSION_PREFIX:"",w=a+"_NM",m=h+"_CD";e.name=e[w],e.id=e[m],e.LEAF_PARENT_NM=o.data[o.data.aliasName],e.LEAF_PARENT_CD=o.data[o.data.aliasId],e.LEAF_ORIG_PARENT_CD=o.data[o.data.aliasId],e.LEVEL=o.LEVEL?o.data.LEVEL+1:1,e.leaf=!0;const c=this.nodeMetadata?this.nodeMetadata.LEAF_FIELDS.map(l=>({key:l.ID,type:l.TYPE})):[];for(let l=0;l<c.length;l++)if(!e[c[l].key]){let p="";c[l].type==="Date"?p=new Date:c[l].type==="Number"&&(p=-1),e[c[l].key]=p}const u=(f=this.dimensionMetadata)==null?void 0:f.MATCH_LEAF_FIELDS;for(let l in u)e[l]&&(e[u[l]]=e[l]);if(this.selectedRelations){const l={leafData:{[w]:e[w],[m]:e[m],BEGIN_DT:e.BEGIN_DT,END_DT:e.END_DT},relationsArray:[]};l.leafData[a+"_ID"]=e[a+"_ID"];for(let p=0;p<this.selectedRelations.length;p++)l.relationsArray.push(U(this.selectedRelations[p]));this.relationsMasterTree.push(l)}o.children.push({key:F({length:16,type:"base64"}),id:e.name,label:e.name,children:[],data:e,style:this.hierarchyManagementHierarchiesTreeDescriptor.node.style,leaf:!0,parent:o}),this.nodeToMove=null,this.targetForMove=null,this.$emit("treeUpdated",this.nodes)},onDragStart(e,t){const o=U(t);o.children=this.formatNodeForDrag(o.children),o.movedFrom=this.treeMode==="info"?"sourceTree":"tree",o.parentKey=t.parent?t.parent.key:t.parentKey,delete o.parent,e.dataTransfer.setData("text/plain",JSON.stringify(o)),e.dataTransfer.dropEffect="move",e.dataTransfer.effectAllowed="move"},formatNodeForDrag(e){return e.map(t=>(t={...t,children:t.children},t.parent&&delete t.parent,t.children&&t.children.length>0&&(t.children=this.formatNodeForDrag(t.children)),t))},moveNodeInsideTree(e,t){var w;delete e.movedFrom;let o=this.findNodeInTree(t.key),a=this.findNodeInTree(e.parentKey);if(!o||!a)return;const h=(w=a.children)==null?void 0:w.findIndex(m=>m.key===e.key);h!==-1&&a.children.splice(h,1),o.children?o.children.push({...e,parentKey:o.key}):o.children=[{...e,parentKey:o.key}],this.$emit("treeUpdated",this.nodes)},closeTargetDialog(){this.selectedRelations=[],this.targetDialogVisible=!1},onTargetsSave(e){this.selectedRelations=e,this.targetDialogVisible=!1,this.copyNodeFromTableToTree(this.nodeToMove,this.targetForMove)},addNodeFromSourceTree(e,t){delete e.movedFrom,e.parent=t;let o=this.findNodeInTree(t.key);o.children?o.children.push({...e,parentKey:o.key,key:F({length:4,type:"base64"})}):o.children=[{...e,parentKey:o.key,key:F({length:16,type:"base64"})}],this.$emit("treeUpdated",this.nodes)}}}),Ut={class:"p-mt-2 p-fluid p-formgrid p-grid"},Bt={class:"p-field p-col-12"},Yt={class:"p-float-label"},Ot={class:"kn-material-input-label"},jt=["draggable","onDragstart","onMouseover","onMouseleave","onDrop","onDragenter","onDragleave"],Xt={class:"node-label"};function Gt(e,t,o,a,h,w){const m=i("Dropdown"),c=i("Button"),u=i("Tree"),f=i("HierarchyManagementNodeDetailDialog"),l=i("HierarchyManagementHierarchiesTargetDialog"),p=X("tooltip");return b(),x("div",null,[r("form",Ut,[r("div",Bt,[r("span",Yt,[n(m,{class:"kn-material-input",modelValue:e.orderBy,"onUpdate:modelValue":t[0]||(t[0]=d=>e.orderBy=d),options:e.hierarchyManagementHierarchiesTreeDescriptor.orderByOptions,onChange:t[1]||(t[1]=d=>e.sortTree(e.nodes))},null,8,["modelValue","options"]),r("label",Ot,k(e.$t("common.orderBy")+" ... "),1)])])]),n(u,{class:"hierarchies-tree p-col-12",value:e.nodes,filter:!0,filterMode:"lenient"},{default:s(d=>[r("div",{class:K(["p-d-flex p-flex-row p-ai-center",{dropzone:e.dropzoneActive[d.node.key]}]),draggable:!d.node.data.root,onDragstart:N(v=>e.onDragStart(v,d.node),["stop"]),onMouseover:v=>e.buttonVisible[d.node.key]=!0,onMouseleave:v=>e.buttonVisible[d.node.key]=!1,onDrop:N(v=>e.onDragDrop(v,d.node,d.node.key),["stop"]),onDragover:t[2]||(t[2]=N(()=>{},["prevent"])),onDragenter:N(v=>e.setDropzoneClass(!0,d.node),["prevent"]),onDragleave:N(v=>e.setDropzoneClass(!1,d.node),["prevent"])},[r("span",Xt,k(d.node.label),1),C(r("div",null,[e.treeMode!=="info"?(b(),x(H,{key:0},[d.node.leaf?C((b(),y(c,{key:0,icon:"pi pi-clone",class:"p-button-link p-button-sm p-p-0",onClick:N(v=>e.cloneNode(d.node),["stop"])},null,8,["onClick"])),[[p,e.$t("common.clone"),void 0,{top:!0}]]):C((b(),y(c,{key:1,icon:"pi pi-plus",class:"p-button-link p-button-sm p-p-0",onClick:N(v=>e.addNode(d.node),["stop"])},null,8,["onClick"])),[[p,e.$t("common.add"),void 0,{top:!0}]]),d.node.data.root?M("",!0):C((b(),y(c,{key:2,icon:"pi pi-pencil",class:"p-button-link p-button-sm p-p-0",onClick:N(v=>e.editNode(d.node),["stop"])},null,8,["onClick"])),[[p,e.$t("common.edit"),void 0,{top:!0}]]),d.node.data.root?M("",!0):C((b(),y(c,{key:3,icon:"pi pi-trash",class:"p-button-link p-button-sm p-p-0",onClick:N(v=>e.deleteNodeConfirm(d.node),["stop"])},null,8,["onClick"])),[[p,e.$t("common.delete"),void 0,{top:!0}]])],64)):M("",!0),C(n(c,{icon:"pi pi-info",class:"p-button-link p-button-sm p-p-0",onClick:N(v=>e.showNodeInfo(d.node),["stop"])},null,8,["onClick"]),[[p,e.$t("common.detail"),void 0,{top:!0}]])],512),[[I,e.buttonVisible[d.node.key]]])],42,jt)]),_:1},8,["value"]),n(f,{visible:e.detailDialogVisible,selectedNode:e.selectedNode,metadata:e.metadata,mode:e.mode,onSave:e.onNodeSave,onClose:e.closeNodeDialog},null,8,["visible","selectedNode","metadata","mode","onSave","onClose"]),n(l,{visible:e.targetDialogVisible,hierarchiesTargets:e.relations,onClose:e.closeTargetDialog,onSave:e.onTargetsSave},null,8,["visible","hierarchiesTargets","onClose","onSave"])])}var J=T(Rt,[["render",Gt],["__scopeId","data-v-6b9b137e"]]);const Qt=E({name:"hierarchy-management-hierarchies-filter-card",components:{Calendar:_,Checkbox:Y,Card:R},props:{selectedHierarchy:{type:Object}},emits:["applyFilters"],data(){return{showMissingElements:!1,expandFilterCard:!1,afterDate:null}},created(){},methods:{applyFilters(){this.$emit("applyFilters",{showMissingElements:this.showMissingElements,afterDate:this.afterDate})},resetFilters(){this.showMissingElements=!1,this.afterDate=null,this.$emit("applyFilters",null)}}}),Jt={class:"p-grid p-fluid p-formgrid"},Pt={class:"p-field-checkbox p-col-12"},Kt={class:"kn-material-input-label"},qt={class:"p-field p-col-12"},Zt={class:"p-float-label"},Wt={class:"kn-material-input-label"};function eo(e,t,o,a,h,w){const m=i("Button"),c=i("Toolbar"),u=i("Checkbox"),f=i("Calendar"),l=i("Card");return b(),x(H,null,[n(c,{class:"kn-toolbar kn-toolbar--default"},{start:s(()=>[e.expandFilterCard?(b(),y(m,{key:1,icon:"fas fa-chevron-up",class:"p-button-text p-button-rounded p-button-plain",onClick:t[1]||(t[1]=p=>e.expandFilterCard=!1)})):(b(),y(m,{key:0,icon:"fas fa-chevron-down",class:"p-button-text p-button-rounded p-button-plain",onClick:t[0]||(t[0]=p=>e.expandFilterCard=!0)})),r("span",null,k(e.$t("common.filters")),1)]),end:s(()=>[e.expandFilterCard?(b(),y(m,{key:0,icon:"pi pi-check",class:"p-button-text p-button-rounded p-button-plain",onClick:e.applyFilters},null,8,["onClick"])):M("",!0),e.expandFilterCard?(b(),y(m,{key:1,icon:"fas fa-eraser",class:"p-button-text p-button-rounded p-button-plain",onClick:e.resetFilters},null,8,["onClick"])):M("",!0)]),_:1}),C(n(l,null,{content:s(()=>[r("div",Jt,[r("div",Pt,[n(u,{class:"p-mr-2",modelValue:e.showMissingElements,"onUpdate:modelValue":t[2]||(t[2]=p=>e.showMissingElements=p),binary:!0,disabled:!e.selectedHierarchy},null,8,["modelValue","disabled"]),r("label",Kt,k(e.$t("managers.hierarchyManagement.showMissingElements")),1)]),r("div",qt,[r("span",Zt,[n(f,{class:"kn-material-input",modelValue:e.afterDate,"onUpdate:modelValue":t[3]||(t[3]=p=>e.afterDate=p),manualInput:!0,showIcon:!0,disabled:!e.selectedHierarchy},null,8,["modelValue","disabled"]),r("label",Wt,k(e.$t("managers.hierarchyManagement.afterDate")),1)])])])]),_:1},512),[[I,e.expandFilterCard]])],64)}var P=T(Qt,[["render",eo]]);const to=E({name:"hierarchy-management-hierarchies-card",components:{Card:R,Calendar:_,Checkbox:Y,Dropdown:S,HierarchyManagementHierarchiesTree:J,HierarchyManagementHierarchiesFilterCard:P},props:{selectedDimension:{type:Object},nodeMetadata:{type:Object},validityDate:{type:Object},dimensionMetadata:{type:Object},synchronizationTrigger:{type:Boolean},reloadHierarchiesTrigger:{type:Boolean}},emits:["loading","hierarchySelected","dateSelected","hierarchyTypeSelected"],data(){return{hierarchyManagementHierarchiesCardDescriptor:Z,date:new Date,backup:!0,dimension:null,hierarchyType:"",hierarchies:[],selectedHierarchy:null,tree:null,treeModel:null,filterData:null,relationsMasterTree:[]}},computed:{},watch:{selectedDimension(){this.loadDimension()},synchronizationTrigger(){this.loadHierarchyTree()},reloadHierarchiesTrigger(){this.hierarchyType==="MASTER"&&this.loadHierarchies()}},setup(){return{store:L()}},created(){this.loadDimension()},methods:{loadDimension(){this.dimension=this.selectedDimension},async loadHierarchies(){var t,o;this.$emit("loading",!0);const e=this.hierarchyType==="MASTER"?`hierarchiesMaster/getHierarchiesMaster?dimension=${(t=this.selectedDimension)==null?void 0:t.DIMENSION_NM}`:`hierarchiesTechnical/getHierarchiesTechnical?dimension=${(o=this.selectedDimension)==null?void 0:o.DIMENSION_NM}`;await this.$http.get("/knowage/restful-services/"+e).then(a=>this.hierarchies=a.data),this.relationsMasterTree=[],this.$emit("loading",!1)},async loadHierarchyTree(){var o,a;this.$emit("loading",!0);const e=A(this.date).format("YYYY-MM-DD");let t=`hierarchies/getHierarchyTree?dimension=${(o=this.selectedDimension)==null?void 0:o.DIMENSION_NM}&filterHierarchy=${(a=this.selectedHierarchy)==null?void 0:a.HIER_NM}&filterType=${this.hierarchyType}&validityDate=${e}`;this.filterData&&(this.filterData.showMissingElements&&(t=t.concat("&filterDimension="+this.filterData.showMissingElements)),this.validityDate&&(t=t.concat("&optionDate="+A(this.validityDate).format("YYYY-MM-DD"))),this.filterData.afterDate&&(t=t.concat("&filterDate="+A(this.filterData.afterDate).format("YYYY-MM-DD")))),await this.$http.get("/knowage/restful-services/"+t).then(h=>this.tree=h.data).catch(()=>{}),this.relationsMasterTree=[],this.$emit("loading",!1)},async onHierarchyTypeSelected(){this.selectedHierarchy=null,this.$emit("hierarchyTypeSelected",this.hierarchyType),this.$emit("hierarchySelected",this.selectedHierarchy),await this.loadHierarchies()},async onHierarchySelected(){this.$emit("hierarchySelected",this.selectedHierarchy),await this.loadHierarchyTree()},async onTreeDateChanged(){this.$emit("dateSelected",this.date),await this.loadHierarchyTree()},onApplyFilters(e){this.filterData=e,this.loadHierarchyTree()},updateTreeModel(e){this.treeModel=this.formatNodes(e)[0]},formatNodes(e){return e==null?void 0:e.map(t=>(t={...t.data,children:t.children},t.parent&&delete t.parent,t.leaf&&t.children&&delete t.children,t.children&&t.children.length>0&&(t.children=this.formatNodes(t.children)),t))},async handleSaveHiararchy(){this.$emit("loading",!0),this.checkIfNodesWithoutChildren(this.treeModel)?this.$confirm.require({message:this.$t("managers.hierarchyManagement.parentWithoutChildrenConfirm"),header:this.$t("managers.hierarchyManagement.saveChanges"),icon:"pi pi-exclamation-triangle",accept:async()=>await this.saveHierarchy()}):await this.saveHierarchy(),this.$emit("loading",!1)},async saveHierarchy(){if(!this.dimension||!this.selectedHierarchy)return;this.updateLevelRecursive(this.treeModel,0);const e={dimension:this.dimension.DIMENSION_NM,code:this.selectedHierarchy.HIER_CD,description:this.selectedHierarchy.HIER_DS,name:this.selectedHierarchy.HIER_NM,type:this.selectedHierarchy.HIER_TP,dateValidity:A(this.date).format("YYYY-MM-DD"),isInsert:!1,doBackup:this.backup,relationsMT:this.relationsMasterTree,root:this.treeModel};await this.$http.post("/knowage/restful-services/hierarchies/saveHierarchy",e).then(t=>{t.data.response==="ok"&&(this.store.setInfo({title:this.$t("common.toast.createTitle"),msg:this.$t("common.toast.success")}),this.loadHierarchyTree())}).catch(()=>{})},updateLevelRecursive(e,t){if(t!==0&&(e.LEVEL=t),e.children&&e.children.length>0)for(let o=0;o<e.children.length;o++)this.updateLevelRecursive(e.children[o],t+1)},checkIfNodesWithoutChildren(e){var t;if(!e.root&&!e.leaf&&((t=e.children)==null?void 0:t.length)===0)return!0;if(e.children!=null){let o=!1;for(let a=0;o===!1&&a<e.children.length;a++)o=this.checkIfNodesWithoutChildren(e.children[a]);return o}return!1}}}),oo=r("i",{class:"fa fa-list p-mr-2"},null,-1),ro={class:"p-fluid p-formgrid p-grid"},ao={class:"p-field p-col-12 p-lg-6"},no={class:"p-field p-col-8 p-lg-4"},io={class:"p-field-checkbox p-col-4 p-lg-2"},lo={class:"kn-material-input-label p-ml-2"},so={class:"p-field p-col-6"},co={class:"p-float-label"},bo={class:"kn-material-input-label"},po={class:"p-field p-col-6"},ko={class:"p-float-label"},ho={class:"kn-material-input-label"};function mo(e,t,o,a,h,w){const m=i("Toolbar"),c=i("Calendar"),u=i("Button"),f=i("Checkbox"),l=i("Dropdown"),p=i("HierarchyManagementHierarchiesFilterCard"),d=i("HierarchyManagementHierarchiesTree"),v=i("Card");return b(),y(v,{class:"p-m-2 p-d-flex p-flex-column hierarchy-scrollable-card"},{header:s(()=>[n(m,{class:"kn-toolbar kn-toolbar--secondary"},{start:s(()=>[oo,r("span",null,k(e.$t("managers.hierarchyManagement.hierarchies")),1)]),_:1})]),content:s(()=>[r("form",ro,[r("div",ao,[n(c,{class:"kn-material-input",modelValue:e.date,"onUpdate:modelValue":t[0]||(t[0]=g=>e.date=g),manualInput:!0,showIcon:!0,onDateSelect:e.onTreeDateChanged},null,8,["modelValue","onDateSelect"])]),r("div",no,[n(u,{class:"kn-button kn-button--primary",label:e.$t("common.save"),disabled:!e.treeModel,onClick:e.handleSaveHiararchy},null,8,["label","disabled","onClick"])]),r("div",io,[n(f,{modelValue:e.backup,"onUpdate:modelValue":t[1]||(t[1]=g=>e.backup=g),binary:!0,disabled:!e.treeModel},null,8,["modelValue","disabled"]),r("label",lo,k(e.$t("managers.hierarchyManagement.backup")),1)]),r("div",so,[r("span",co,[n(l,{class:"kn-material-input",modelValue:e.hierarchyType,"onUpdate:modelValue":t[2]||(t[2]=g=>e.hierarchyType=g),options:e.hierarchyManagementHierarchiesCardDescriptor.hierarchyTypes,disabled:!e.dimension,onChange:e.onHierarchyTypeSelected},null,8,["modelValue","options","disabled","onChange"]),r("label",bo,k(e.$t("managers.hierarchyManagement.hierarchyType")),1)])]),r("div",po,[r("span",ko,[n(l,{class:"kn-material-input",modelValue:e.selectedHierarchy,"onUpdate:modelValue":t[3]||(t[3]=g=>e.selectedHierarchy=g),options:e.hierarchies,optionLabel:"HIER_NM",disabled:!e.dimension,onChange:e.onHierarchySelected},null,8,["modelValue","options","disabled","onChange"]),r("label",ho,k(e.$t("managers.hierarchyManagement.hierarchies")),1)])])]),n(p,{selectedHierarchy:e.selectedHierarchy,onApplyFilters:e.onApplyFilters},null,8,["selectedHierarchy","onApplyFilters"]),C(n(d,{propTree:e.tree,nodeMetadata:e.nodeMetadata,selectedDimension:e.dimension,selectedHierarchy:e.selectedHierarchy,dimensionMetadata:e.dimensionMetadata,propRelationsMasterTree:e.relationsMasterTree,onTreeUpdated:e.updateTreeModel,onLoading:t[4]||(t[4]=g=>e.$emit("loading",g))},null,8,["propTree","nodeMetadata","selectedDimension","selectedHierarchy","dimensionMetadata","propRelationsMasterTree","onTreeUpdated"]),[[I,e.tree]])]),_:1})}var uo=T(to,[["render",mo]]);const go=E({name:"hierarchy-management-master-tab",components:{HierarchyManagementDimensionsCard:Dt,HierarchyManagementHierarchiesCard:uo},props:{dimensions:{type:Array}},data(){return{selectedDimension:null,nodeMetadata:null,validityDate:new Date,dimensionMetadata:null,hierarchyType:"",selectedHierarchy:null,validityTreeDate:new Date,synchronizationTrigger:!1,reloadHierarchiesTrigger:!1}},async created(){},methods:{setSelectedDimension(e){this.selectedDimension=e},onNodeMetadataChange(e){this.nodeMetadata=e},setValidityDate(e){this.validityDate=e},onDimensionMetadataChange(e){this.dimensionMetadata=e},onHierarchyTypeSelected(e){this.hierarchyType=e},onHierarchySelected(e){this.selectedHierarchy=e},onValidityTreeDateSelected(e){this.validityTreeDate=e},onSynchronized(){this.synchronizationTrigger=!this.synchronizationTrigger},onMasterHierarchyCreated(){this.reloadHierarchiesTrigger=!this.reloadHierarchiesTrigger}}}),fo={class:"p-d-flex p-flex-row"};function vo(e,t,o,a,h,w){const m=i("HierarchyManagementDimensionsCard"),c=i("HierarchyManagementHierarchiesCard");return b(),x("div",fo,[n(m,{dimensions:e.dimensions,selectedHierarchy:e.selectedHierarchy,validityTreeDate:e.validityTreeDate,hierarchyType:e.hierarchyType,onSynchronized:e.onSynchronized,onDimensionSelected:e.setSelectedDimension,onLoading:t[0]||(t[0]=u=>e.$emit("loading",u)),onNodeMetadataChanged:e.onNodeMetadataChange,onDimensionMetadataChanged:e.onDimensionMetadataChange,onValidityDateSelected:e.setValidityDate,onMasterHierarchyCreated:e.onMasterHierarchyCreated},null,8,["dimensions","selectedHierarchy","validityTreeDate","hierarchyType","onSynchronized","onDimensionSelected","onNodeMetadataChanged","onDimensionMetadataChanged","onValidityDateSelected","onMasterHierarchyCreated"]),n(c,{selectedDimension:e.selectedDimension,nodeMetadata:e.nodeMetadata,validityDate:e.validityDate,dimensionMetadata:e.dimensionMetadata,synchronizationTrigger:e.synchronizationTrigger,reloadHierarchiesTrigger:e.reloadHierarchiesTrigger,onLoading:t[1]||(t[1]=u=>e.$emit("loading",u)),onHierarchyTypeSelected:e.onHierarchyTypeSelected,onHierarchySelected:e.onHierarchySelected,onDateSelected:e.onValidityTreeDateSelected},null,8,["selectedDimension","nodeMetadata","validityDate","dimensionMetadata","synchronizationTrigger","reloadHierarchiesTrigger","onHierarchyTypeSelected","onHierarchySelected","onDateSelected"])])}var yo=T(go,[["render",vo]]);const wo=["MASTER","TECHNICAL"];var xo={hierarchyTypes:wo};const Mo=E({name:"hierarchy-management-source-card",components:{Card:R,Calendar:_,Dropdown:S,HierarchyManagementHierarchiesTree:J,HierarchyManagementHierarchiesFilterCard:P},props:{dimensions:{type:Array},optionsDate:{type:Date}},emits:["loading","validityDateSelected","dimensionSelected","nodeMetadataChanged","hierarchyTypeSelected","hierarchySelected"],data(){return{hierarchyManagementSourceCardDescriptor:xo,validityDate:new Date,selectedDimension:null,dimensionMetadata:null,nodeMetadata:null,hierarchyType:"",hierarchies:[],selectedHierarchy:null,filterData:null,tree:null}},async created(){},methods:{async onValidityDateSelected(){this.$emit("validityDateSelected",this.validityDate),await this.loadNodeMetadata()},async onSelectedDimensionChange(){this.$emit("dimensionSelected",this.selectedDimension),await this.loadNodeMetadata()},async onHierarchyTypeSelected(){this.selectedHierarchy=null,this.$emit("hierarchyTypeSelected",this.hierarchyType),this.$emit("hierarchySelected",this.selectedHierarchy),await this.loadHierarchies()},async onHierarchySelected(){this.$emit("hierarchySelected",this.selectedHierarchy),await this.loadHierarchyTree()},async loadNodeMetadata(){var e;this.$emit("loading",!0),await this.$http.get(`/knowage/restful-services/hierarchies/nodeMetadata?dimension=${(e=this.selectedDimension)==null?void 0:e.DIMENSION_NM}&excludeLeaf=false`).then(t=>this.nodeMetadata=t.data),this.$emit("nodeMetadataChanged",this.nodeMetadata),this.$emit("loading",!1)},async loadHierarchies(){var t,o;this.$emit("loading",!0);const e=this.hierarchyType==="MASTER"?`hierarchiesMaster/getHierarchiesMaster?dimension=${(t=this.selectedDimension)==null?void 0:t.DIMENSION_NM}`:`hierarchiesTechnical/getHierarchiesTechnical?dimension=${(o=this.selectedDimension)==null?void 0:o.DIMENSION_NM}`;await this.$http.get("/knowage/restful-services/"+e).then(a=>this.hierarchies=a.data),this.$emit("loading",!1)},async loadHierarchyTree(){var o,a;this.$emit("loading",!0);const e=A(this.validityDate).format("YYYY-MM-DD");let t=`hierarchies/getHierarchyTree?dimension=${(o=this.selectedDimension)==null?void 0:o.DIMENSION_NM}&filterHierarchy=${(a=this.selectedHierarchy)==null?void 0:a.HIER_NM}&filterType=${this.hierarchyType}&validityDate=${e}`;this.filterData&&(this.filterData.showMissingElements&&(t=t.concat("&optionDate="+A(this.optionsDate).format("YYYY-MM-DD"))),this.filterData.afterDate&&(t=t.concat("&filterDate="+A(this.filterData.afterDate).format("YYYY-MM-DD")))),await this.$http.get("/knowage/restful-services/"+t).then(h=>{this.tree=h.status===200?h.data:null}).catch(()=>{}),this.$emit("loading",!1)},onApplyFilters(e){this.filterData=e,this.loadHierarchyTree()}}}),Do=r("i",{class:"fa fa-list p-mr-2"},null,-1),Co={class:"p-fluid p-formgrid p-grid"},Ao={class:"p-field p-col-12 p-lg-3"},$o={class:"p-field p-col-12 p-lg-3"},Eo={class:"p-float-label"},To={class:"kn-material-input-label"},No={class:"p-field p-col-12 p-lg-3"},Ho={class:"p-float-label"},Io={class:"kn-material-input-label"},So={class:"p-field p-col-12 p-lg-3"},_o={class:"p-float-label"},Fo={class:"kn-material-input-label"};function zo(e,t,o,a,h,w){const m=i("Toolbar"),c=i("Calendar"),u=i("Dropdown"),f=i("HierarchyManagementHierarchiesFilterCard"),l=i("HierarchyManagementHierarchiesTree"),p=i("Card");return b(),y(p,{class:"p-m-2 p-d-flex p-flex-column hierarchy-scrollable-card"},{header:s(()=>[n(m,{class:"kn-toolbar kn-toolbar--secondary"},{start:s(()=>[Do,r("span",null,k(e.$t("managers.hierarchyManagement.hierarchiesSource")),1)]),_:1})]),content:s(()=>[r("form",Co,[r("div",Ao,[n(c,{class:"kn-material-input",modelValue:e.validityDate,"onUpdate:modelValue":t[0]||(t[0]=d=>e.validityDate=d),manualInput:!0,showIcon:!0,onDateSelect:e.onValidityDateSelected},null,8,["modelValue","onDateSelect"])]),r("div",$o,[r("span",Eo,[n(u,{class:"kn-material-input",modelValue:e.selectedDimension,"onUpdate:modelValue":t[1]||(t[1]=d=>e.selectedDimension=d),options:e.dimensions,optionLabel:"DIMENSION_NM",onChange:e.onSelectedDimensionChange},null,8,["modelValue","options","onChange"]),r("label",To,k(e.$t("managers.hierarchyManagement.dimensions")),1)])]),r("div",No,[r("span",Ho,[n(u,{class:"kn-material-input",modelValue:e.hierarchyType,"onUpdate:modelValue":t[2]||(t[2]=d=>e.hierarchyType=d),options:e.hierarchyManagementSourceCardDescriptor.hierarchyTypes,disabled:!e.selectedDimension,onChange:e.onHierarchyTypeSelected},null,8,["modelValue","options","disabled","onChange"]),r("label",Io,k(e.$t("managers.hierarchyManagement.hierarchyType")),1)])]),r("div",So,[r("span",_o,[n(u,{class:"kn-material-input",modelValue:e.selectedHierarchy,"onUpdate:modelValue":t[3]||(t[3]=d=>e.selectedHierarchy=d),options:e.hierarchies,optionLabel:"HIER_NM",disabled:!e.hierarchyType,onChange:e.onHierarchySelected},null,8,["modelValue","options","disabled","onChange"]),r("label",Fo,k(e.$t("managers.hierarchyManagement.hierarchies")),1)])])]),n(f,{selectedHierarchy:e.selectedHierarchy,onApplyFilters:e.onApplyFilters},null,8,["selectedHierarchy","onApplyFilters"]),e.tree?(b(),y(l,{key:0,propTree:e.tree,nodeMetadata:e.nodeMetadata,selectedDimension:e.selectedDimension,selectedHierarchy:e.selectedHierarchy,dimensionMetadata:e.dimensionMetadata,treeMode:"info",onLoading:t[4]||(t[4]=d=>e.$emit("loading",d))},null,8,["propTree","nodeMetadata","selectedDimension","selectedHierarchy","dimensionMetadata"])):M("",!0)]),_:1})}var Vo=T(Mo,[["render",zo]]);const Lo={style:{padding:"0"}};var Ro={node:Lo};const Uo=E({name:"hierarchy-management-target-card",components:{Card:R,Calendar:_,Checkbox:Y,Dropdown:S,HierarchyManagementHierarchiesFilterCard:P,HierarchyManagementHierarchiesTree:J,HierarchyManagementNodeDetailDialog:W},props:{selectedDimension:{type:Object},validityDate:{type:Date},dimensionMetadata:{type:Object},nodeMetadata:{type:Object},selectedSourceHierarchy:{type:Object}},emits:["loading","optionsDateSelected"],data(){return{hierarchyManagementTargetCardDescriptor:Ro,optionsDate:new Date,backup:!0,hierarchies:[],selectedHierarchy:null,filterData:null,tree:null,detailDialogVisible:!1,selectedNode:null,mode:"createRoot",metadata:[],treeModel:null}},watch:{async selectedDimension(){this.selectedDimension&&await this.loadTechnicalHierarchies()}},setup(){return{store:L()}},async created(){},methods:{async onOptionsDateSelected(){this.$emit("optionsDateSelected",this.optionsDate),await this.loadHierarchyTree()},async loadTechnicalHierarchies(){var e;this.$emit("loading",!0),await this.$http.get(`/knowage/restful-services/hierarchiesTechnical/getHierarchiesTechnical?dimension=${(e=this.selectedDimension)==null?void 0:e.DIMENSION_NM}`).then(t=>this.hierarchies=t.data),this.$emit("loading",!1)},async onHierarchySelected(){await this.loadHierarchyTree()},async loadHierarchyTree(){var o,a;this.$emit("loading",!0);const e=A(this.optionsDate).format("YYYY-MM-DD");let t=`hierarchies/getHierarchyTree?dimension=${(o=this.selectedDimension)==null?void 0:o.DIMENSION_NM}&filterHierarchy=${(a=this.selectedHierarchy)==null?void 0:a.HIER_NM}&filterType=TECHNICAL&validityDate=${e}`;this.filterData&&(this.filterData.showMissingElements&&(t=t.concat("&filterDimension="+this.filterData.showMissingElements),t=t.concat("&optionDate="+A(this.validityDate).format("YYYY-MM-DD"))),this.filterData.afterDate&&(t=t.concat("&filterDate="+A(this.filterData.afterDate).format("YYYY-MM-DD")))),await this.$http.get("/knowage/restful-services/"+t).then(h=>{this.tree=h.status===200?h.data:null}).catch(()=>{}),this.$emit("loading",!1)},onApplyFilters(e){this.filterData=e,this.loadHierarchyTree()},createHierarchy(){this.selectedNode={HIER_TP:"TECHNICAL",aliasId:"HIER_CD",aliasName:"HIER_NM",leaf:!1,root:!0,children:[]},this.metadata=this.nodeMetadata?this.nodeMetadata.GENERAL_FIELDS:[];for(let e=0;e<this.metadata.length;e++){const t=this.metadata[e];this.selectedNode[t.ID]="",t.TYPE==="Number"?this.selectedNode[t.ID]=-1:t.TYPE==="Date"?this.selectedNode[t.ID]=new Date:t.FIX_VALUE&&(this.selectedNode[t.ID]=t.FIX_VALUE)}this.detailDialogVisible=!0},closeNodeDialog(){this.selectedNode=null,this.metadata=[],this.mode="",this.detailDialogVisible=!1},onNodeSave(e){const t=e.node;e.mode==="createRoot"&&(this.selectedHierarchy=null,this.tree={...t,id:t.name,HIER_TP:"TECHNICAL"}),this.detailDialogVisible=!1},updateTreeModel(e){this.treeModel=this.formatNodes(e)[0],this.treeModel.data&&(this.treeModel=this.treeModel.data)},formatNodes(e){return e.map(t=>(t={...t.data,children:t.children},t.parent&&delete t.parent,t.leaf&&t.children&&delete t.children,t.children&&t.children.length>0&&(t.children=this.formatNodes(t.children)),t))},async handleSaveHiararchy(){this.$emit("loading",!0),this.checkIfNodesWithoutChildren(this.treeModel)?this.$confirm.require({message:this.$t("common.toast.deleteMessage"),header:this.$t("common.toast.deleteConfirmTitle"),icon:"pi pi-exclamation-triangle",accept:async()=>await this.saveHierarchy()}):await this.saveHierarchy(),this.$emit("loading",!1)},async saveHierarchy(){var o,a,h,w,m,c,u;if(!this.selectedDimension)return;this.updateLevelRecursive(this.treeModel,0);const e=!this.selectedHierarchy,t={dimension:this.selectedDimension.DIMENSION_NM,code:(o=this.selectedHierarchy)==null?void 0:o.HIER_CD,description:(a=this.selectedHierarchy)==null?void 0:a.HIER_DS,name:(h=this.selectedHierarchy)==null?void 0:h.HIER_NM,type:(w=this.selectedHierarchy)==null?void 0:w.HIER_TP,hierSourceCode:(m=this.selectedSourceHierarchy)==null?void 0:m.HIER_CD,hierSourceName:(c=this.selectedSourceHierarchy)==null?void 0:c.HIER_NM,hierSourceType:(u=this.selectedSourceHierarchy)==null?void 0:u.HIER_TP,dateValidity:A(this.optionsDate).format("YYYY-MM-DD"),isInsert:e,doBackup:this.backup,root:this.treeModel};await this.$http.post("/knowage/restful-services/hierarchies/saveHierarchy",t).then(async f=>{var l;if(f.data.response==="ok")if(this.store.setInfo({title:this.$t("common.toast.createTitle"),msg:this.$t("common.toast.success")}),this.selectedHierarchy)this.loadHierarchyTree();else{await this.loadTechnicalHierarchies();const p=(l=this.hierarchies)==null?void 0:l.findIndex(d=>d.HIER_CD===this.treeModel.HIER_CD);p!==-1&&(this.selectedHierarchy=this.hierarchies[p])}}).catch(()=>{})},updateLevelRecursive(e,t){if(t!==0&&(e.LEVEL=t),e.children&&e.children.length>0)for(let o=0;o<e.children.length;o++)this.updateLevelRecursive(e.children[o],t+1)},checkIfNodesWithoutChildren(e){var t;if(!e.root&&!e.leaf&&((t=e.children)==null?void 0:t.length)===0)return!0;if(e.children!=null){let o=!1;for(let a=0;o===!1&&a<e.children.length;a++)o=this.checkIfNodesWithoutChildren(e.children[a]);return o}return!1}}}),Bo=r("i",{class:"fa fa-list p-mr-2"},null,-1),Yo={class:"p-fluid p-formgrid p-grid"},Oo={class:"p-field p-col-6 p-lg-4"},jo={class:"p-field p-col-6 p-lg-3"},Xo={class:"p-field p-col-6 p-lg-3"},Go={class:"p-field-checkbox p-col-6 p-lg-2"},Qo={class:"kn-material-input-label p-ml-2"},Jo={class:"p-field p-col-12"},Po={class:"p-float-label"},Ko={class:"kn-material-input-label"};function qo(e,t,o,a,h,w){const m=i("Toolbar"),c=i("Calendar"),u=i("Button"),f=i("Checkbox"),l=i("Dropdown"),p=i("HierarchyManagementHierarchiesFilterCard"),d=i("HierarchyManagementHierarchiesTree"),v=i("HierarchyManagementNodeDetailDialog"),g=i("Card");return b(),y(g,{class:"p-m-2 p-d-flex p-flex-column hierarchy-scrollable-card"},{header:s(()=>[n(m,{class:"kn-toolbar kn-toolbar--secondary"},{start:s(()=>[Bo,r("span",null,k(e.$t("managers.hierarchyManagement.hierarchiesTarget")),1)]),_:1})]),content:s(()=>[r("form",Yo,[r("div",Oo,[n(c,{class:"kn-material-input",modelValue:e.optionsDate,"onUpdate:modelValue":t[0]||(t[0]=$=>e.optionsDate=$),manualInput:!0,showIcon:!0,onDateSelect:e.onOptionsDateSelected},null,8,["modelValue","onDateSelect"])]),r("div",jo,[n(u,{class:"kn-button kn-button--primary",label:e.$t("common.create"),disabled:!e.selectedDimension,onClick:e.createHierarchy},null,8,["label","disabled","onClick"])]),r("div",Xo,[n(u,{class:"kn-button kn-button--primary",label:e.$t("common.save"),disabled:!e.treeModel,onClick:e.handleSaveHiararchy},null,8,["label","disabled","onClick"])]),r("div",Go,[n(f,{modelValue:e.backup,"onUpdate:modelValue":t[1]||(t[1]=$=>e.backup=$),binary:!0,disabled:!e.treeModel},null,8,["modelValue","disabled"]),r("label",Qo,k(e.$t("managers.hierarchyManagement.backup")),1)]),r("div",Jo,[r("span",Po,[n(l,{class:"kn-material-input",modelValue:e.selectedHierarchy,"onUpdate:modelValue":t[2]||(t[2]=$=>e.selectedHierarchy=$),options:e.hierarchies,optionLabel:"HIER_NM",disabled:!e.selectedDimension,onChange:e.onHierarchySelected},null,8,["modelValue","options","disabled","onChange"]),r("label",Ko,k(e.$t("managers.hierarchyManagement.hierarchies")),1)])])]),n(p,{selectedHierarchy:e.selectedHierarchy,onApplyFilters:e.onApplyFilters},null,8,["selectedHierarchy","onApplyFilters"]),e.tree?(b(),y(d,{key:0,propTree:e.tree,nodeMetadata:e.nodeMetadata,selectedDimension:e.selectedDimension,selectedHierarchy:e.selectedHierarchy,dimensionMetadata:e.dimensionMetadata,propRelationsMasterTree:[],onTreeUpdated:e.updateTreeModel,onLoading:t[3]||(t[3]=$=>e.$emit("loading",$))},null,8,["propTree","nodeMetadata","selectedDimension","selectedHierarchy","dimensionMetadata","onTreeUpdated"])):M("",!0),n(v,{visible:e.detailDialogVisible,selectedNode:e.selectedNode,metadata:e.metadata,mode:e.mode,onSave:e.onNodeSave,onClose:e.closeNodeDialog},null,8,["visible","selectedNode","metadata","mode","onSave","onClose"])]),_:1})}var Zo=T(Uo,[["render",qo]]);const Wo=E({name:"hierarchy-management-technical-tab",components:{HierarchyManagementSourceCard:Vo,HierarchyManagementTargetCard:Zo},props:{dimensions:{type:Array}},data(){return{validityDate:new Date,selectedDimension:null,dimensionMetadata:null,nodeMetadata:null,hierarchyType:"",selectedHierarchy:null,optionsDate:new Date}},created(){},methods:{setValidityDate(e){this.validityDate=e},setSelectedDimension(e){this.selectedDimension=e},onNodeMetadataChange(e){this.nodeMetadata=e},onHierarchyTypeSelected(e){this.hierarchyType=e},onHierarchySelected(e){this.selectedHierarchy=e},setOptionsDate(e){this.optionsDate=e}}}),er={class:"p-d-flex p-flex-row"};function tr(e,t,o,a,h,w){const m=i("HierarchyManagementSourceCard"),c=i("HierarchyManagementTargetCard");return b(),x("div",er,[n(m,{dimensions:e.dimensions,optionsDate:e.optionsDate,onLoading:t[0]||(t[0]=u=>e.$emit("loading",u)),onValidityDateSelected:e.setValidityDate,onDimensionSelected:e.setSelectedDimension,onNodeMetadataChanged:e.onNodeMetadataChange,onHierarchyTypeSelected:e.onHierarchyTypeSelected,onHierarchySelected:e.onHierarchySelected},null,8,["dimensions","optionsDate","onValidityDateSelected","onDimensionSelected","onNodeMetadataChanged","onHierarchyTypeSelected","onHierarchySelected"]),n(c,{selectedDimension:e.selectedDimension,validityDate:e.validityDate,nodeMetadata:e.nodeMetadata,selectedSourceHierarchy:e.selectedHierarchy,onLoading:t[1]||(t[1]=u=>e.$emit("loading",u)),onOptionsDateSelected:e.setOptionsDate},null,8,["selectedDimension","validityDate","nodeMetadata","selectedSourceHierarchy","onOptionsDateSelected"])])}var or=T(Wo,[["render",tr]]);const rr=E({name:"hierarchy-management-technical-tab",components:{Dropdown:S,Column:O,DataTable:j},props:{dimensions:{type:Array}},data(){return{hierarchyManagementHierarchiesCardDescriptor:Z,hierarchyManagementDimensionsTableDescriptor:G,selectedDimension:null,hierarchyType:"",selectedHierarchy:null,nodeMetadata:null,hierarchies:[],backupData:[],rows:[],editingRows:[],columns:[],globalFilterFields:[],filters:{global:[q]},loading:!1}},setup(){return{store:L()}},created(){},methods:{async onSelectedDimensionChange(){await this.loadNodeMetadata()},async onHierarchyTypeSelected(){this.selectedHierarchy=null,await this.loadHierarchies()},async onHierarchySelected(){await this.loadBackupData()},async loadNodeMetadata(){var e;await this.$http.get(`/knowage/restful-services/hierarchies/nodeMetadata?dimension=${(e=this.selectedDimension)==null?void 0:e.DIMENSION_NM}&excludeLeaf=false`).then(t=>this.nodeMetadata=t.data)},async loadHierarchies(){var t,o;const e=this.hierarchyType==="MASTER"?`hierarchiesMaster/getHierarchiesMaster?dimension=${(t=this.selectedDimension)==null?void 0:t.DIMENSION_NM}`:`hierarchiesTechnical/getHierarchiesTechnical?dimension=${(o=this.selectedDimension)==null?void 0:o.DIMENSION_NM}`;await this.$http.get("/knowage/restful-services/"+e).then(a=>this.hierarchies=a.data)},async loadBackupData(){var t,o,a,h;this.loading=!0;const e=`hierarchiesBackup/getHierarchyBkps?dimension=${(t=this.selectedDimension)==null?void 0:t.DIMENSION_NM}&hierarchyCode=${(o=this.selectedHierarchy)==null?void 0:o.HIER_CD}&hierarchyName=${(a=this.selectedHierarchy)==null?void 0:a.HIER_NM}&hierarchyType=${(h=this.selectedHierarchy)==null?void 0:h.HIER_TP}`;await this.$http.get("/knowage/restful-services/"+e).then(w=>{var m;this.rows=w.data.root,this.columns=(m=w.data.columns)==null?void 0:m.filter(c=>c.VISIBLE).map(c=>({field:c.ID,header:c.NAME})),this.globalFilterFields=w.data.columns_search}),this.loading=!1},deleteBackupConfirm(e){this.$confirm.require({header:this.$t("common.delete"),message:this.$t("managers.hierarchyManagement.deleteBackupConfirm"),icon:"pi pi-exclamation-triangle",accept:()=>this.deleteBackup(e)})},async deleteBackup(e){var a;const t="hierarchies/deleteHierarchy";let o={dimension:(a=this.selectedDimension)==null?void 0:a.DIMENSION_NM,name:e.HIER_NM};await this.$http.post("/knowage/restful-services/"+t,o).then(h=>{h.data.response==="ok"&&(this.store.setInfo({title:this.$t("common.toast.deleteTitle"),msg:this.$t("managers.hierarchyManagement.backupDeleted")}),this.loadBackupData())})},updateBackupConfirm(e){this.$confirm.require({header:this.$t("common.update"),message:this.$t("managers.hierarchyManagement.saveBackupMessage"),icon:"pi pi-exclamation-triangle",accept:()=>this.updateBackup(e)})},async updateBackup(e){var a;const t="hierarchiesBackup/modifyHierarchyBkps";let o={HIER_DS:e.newData.HIER_DS,HIER_NM:e.newData.HIER_NM,HIER_NM_ORIG:e.data.HIER_NM,dimension:(a=this.selectedDimension)==null?void 0:a.DIMENSION_NM};await this.$http.post("/knowage/restful-services/"+t,o).then(h=>{h.data.response==="ok"&&(this.store.setInfo({title:this.$t("common.toast.updateTitle"),msg:this.$t("common.toast.success")}),this.loadBackupData())})},restoreBackupConfirm(e){this.$confirm.require({header:this.$t("managers.hierarchyManagement.restoreTitle"),message:this.$t("managers.hierarchyManagement.restoreMsg"),icon:"pi pi-exclamation-triangle",accept:()=>this.restoreBackup(e)})},async restoreBackup(e){var a;const t="hierarchiesBackup/restoreHierarchyBkps";let o={code:e.HIER_CD,name:e.HIER_NM,dimension:(a=this.selectedDimension)==null?void 0:a.DIMENSION_NM};await this.$http.post("/knowage/restful-services/"+t,o).then(h=>{h.data.response==="ok"&&(this.store.setInfo({title:this.$t("common.restore"),msg:this.$t("common.toast.success")}),this.loadBackupData())})}}}),ar={class:"p-d-flex p-flex-row"},nr=r("i",{class:"fa fa-list p-mr-2"},null,-1),ir={class:"p-fluid p-formgrid p-grid"},lr={class:"p-field p-col-12 p-lg-4"},dr={class:"p-float-label"},sr={class:"kn-material-input-label"},cr={class:"p-field p-col-12 p-lg-4"},br={class:"p-float-label"},pr={class:"kn-material-input-label"},kr={class:"p-field p-col-12 p-lg-4"},hr={class:"p-float-label"},mr={class:"kn-material-input-label"},ur={class:"table-header p-d-flex"},gr={class:"p-input-icon-left p-mr-3 p-col-12"},fr=r("i",{class:"pi pi-search"},null,-1),vr={class:"kn-cursor-pointer"},yr={key:1,class:"kn-cursor-pointer"};function wr(e,t,o,a,h,w){const m=i("Toolbar"),c=i("Dropdown"),u=i("InputText"),f=i("Column"),l=i("Button"),p=i("DataTable"),d=i("Card"),v=X("tooltip");return b(),x("div",ar,[n(d,{class:"p-m-2 p-d-flex p-flex-column hierarchy-scrollable-card"},{header:s(()=>[n(m,{class:"kn-toolbar kn-toolbar--secondary"},{start:s(()=>[nr,r("span",null,k(e.$t("managers.hierarchyManagement.backup")),1)]),_:1})]),content:s(()=>[r("form",ir,[r("div",lr,[r("span",dr,[n(c,{class:"kn-material-input",modelValue:e.selectedDimension,"onUpdate:modelValue":t[0]||(t[0]=g=>e.selectedDimension=g),options:e.dimensions,optionLabel:"DIMENSION_NM",onChange:e.onSelectedDimensionChange},null,8,["modelValue","options","onChange"]),r("label",sr,k(e.$t("managers.hierarchyManagement.dimensions")),1)])]),r("div",cr,[r("span",br,[n(c,{class:"kn-material-input",modelValue:e.hierarchyType,"onUpdate:modelValue":t[1]||(t[1]=g=>e.hierarchyType=g),options:e.hierarchyManagementHierarchiesCardDescriptor.hierarchyTypes,disabled:!e.selectedDimension,onChange:e.onHierarchyTypeSelected},null,8,["modelValue","options","disabled","onChange"]),r("label",pr,k(e.$t("managers.hierarchyManagement.hierarchyType")),1)])]),r("div",kr,[r("span",hr,[n(c,{class:"kn-material-input",modelValue:e.selectedHierarchy,"onUpdate:modelValue":t[2]||(t[2]=g=>e.selectedHierarchy=g),options:e.hierarchies,optionLabel:"HIER_NM",disabled:!e.hierarchyType,onChange:e.onHierarchySelected},null,8,["modelValue","options","disabled","onChange"]),r("label",mr,k(e.$t("managers.hierarchyManagement.hierarchies")),1)])])]),n(p,{value:e.rows,class:"p-datatable-sm kn-table","edit-mode":"row","editing-rows":e.editingRows,"onUpdate:editing-rows":t[4]||(t[4]=g=>e.editingRows=g),onRowEditSave:e.updateBackupConfirm,filters:e.filters,"onUpdate:filters":t[5]||(t[5]=g=>e.filters=g),globalFilterFields:e.globalFilterFields,loading:e.loading,responsiveLayout:"stack",breakpoint:"700px"},{empty:s(()=>[D(k(e.$t("common.info.noDataFound")),1)]),header:s(()=>[r("div",ur,[r("span",gr,[fr,n(u,{class:"kn-material-input",modelValue:e.filters.global.value,"onUpdate:modelValue":t[3]||(t[3]=g=>e.filters.global.value=g),type:"text",placeholder:e.$t("common.search")},null,8,["modelValue","placeholder"])])])]),default:s(()=>[(b(!0),x(H,null,V(e.columns,g=>(b(),y(f,{class:"kn-truncated",header:e.$t(g.header),key:g.field,sortField:g.field,sortable:!0},{body:s($=>[C((b(),x("span",vr,[D(k($.data[g.field]),1)])),[[v,$.data[g.field],void 0,{top:!0}]])]),editor:s($=>[g.header=="Name"||g.header=="Description"?C((b(),y(u,{key:0,class:"kn-material-input",modelValue:$.data[g.field],"onUpdate:modelValue":ee=>$.data[g.field]=ee},null,8,["modelValue","onUpdate:modelValue"])),[[v,$.data[g.field],void 0,{top:!0}]]):C((b(),x("span",yr,[D(k($.data[g.field]),1)])),[[v,$.data[g.field],void 0,{top:!0}]])]),_:2},1032,["header","sortField"]))),128)),n(f,{rowEditor:!0,style:z(e.hierarchyManagementDimensionsTableDescriptor.iconColumnStyle)},null,8,["style"]),n(f,{style:z(e.hierarchyManagementDimensionsTableDescriptor.iconColumnStyle)},{body:s(g=>[C(n(l,{icon:"pi pi-history",class:"p-button-link",onClick:$=>e.restoreBackupConfirm(g.data)},null,8,["onClick"]),[[v,e.$t("common.restore"),void 0,{top:!0}]]),C(n(l,{icon:"pi pi-trash",class:"p-button-link",onClick:$=>e.deleteBackupConfirm(g.data)},null,8,["onClick"]),[[v,e.$t("common.delete"),void 0,{top:!0}]])]),_:1},8,["style"])]),_:1},8,["value","editing-rows","onRowEditSave","filters","globalFilterFields","loading"])]),_:1})])}var xr=T(rr,[["render",wr]]),Mr={};const Dr=E({name:"hierarchy-management",components:{ProgressSpinner:re,HierarchyManagementMasterTab:yo,HierarchyManagementTechnicalTab:or,HierarchyManagementBackupTab:xr,TabView:ae,TabPanel:ne},data(){return{dimensions:[],loading:!1,descriptor:Mr}},async created(){await this.loadDimensions()},methods:{async loadDimensions(){this.loading=!0,await this.$http.get("/knowage/restful-services/dimensions/getDimensions").then(e=>this.dimensions=e.data).catch(()=>{}),this.loading=!1},setLoading(e){this.loading=e}}}),Cr={class:"kn-page"},Ar={class:"kn-page-content"};function $r(e,t,o,a,h,w){const m=i("ProgressSpinner"),c=i("HierarchyManagementMasterTab"),u=i("TabPanel"),f=i("HierarchyManagementTechnicalTab"),l=i("HierarchyManagementBackupTab"),p=i("TabView");return b(),x("div",Cr,[r("div",Ar,[e.loading?(b(),y(m,{key:0,class:"kn-progress-spinner","data-test":"spinner"})):M("",!0),n(p,{class:"hierarchy-tabview kn-height-full"},{default:s(()=>[n(u,null,{header:s(()=>[r("span",null,k(e.$t("managers.hierarchyManagement.master")),1)]),default:s(()=>[n(c,{dimensions:e.dimensions,onLoading:e.setLoading},null,8,["dimensions","onLoading"])]),_:1}),n(u,null,{header:s(()=>[r("span",null,k(e.$t("managers.hierarchyManagement.technical")),1)]),default:s(()=>[n(f,{dimensions:e.dimensions,onLoading:e.setLoading},null,8,["dimensions","onLoading"])]),_:1}),n(u,null,{header:s(()=>[r("span",null,k(e.$t("managers.hierarchyManagement.backup")),1)]),default:s(()=>[n(l,{dimensions:e.dimensions},null,8,["dimensions"])]),_:1})]),_:1})])])}var Sr=T(Dr,[["render",$r]]);export{Sr as default};
//# sourceMappingURL=HierarchyManagement-f38b7482.js.map
