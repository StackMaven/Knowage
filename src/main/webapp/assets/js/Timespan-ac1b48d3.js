import{_ as T,d as f,X as $,s as w,r as a,o as p,c as k,a as r,f as o,w as m,g as C,t as v,h as B,A as _,V as l}from"./index-1e676509.js";import{K as D}from"./KnListBox-94855720.js";import{t as y}from"./TimespanDescriptor-40eb9dcc.js";import"./menu.esm-6bee86d0.js";const b=f({name:"timespan",components:{KnListBox:D,FabButton:$},data(){return{timespanDescriptor:y,timespans:[],categories:[],loading:!1}},setup(){return{store:w()}},async created(){await this.loadTimespans(),await this.loadCategories()},methods:{async loadTimespans(){this.loading=!0,await this.$http.get("/knowage/restful-services/1.0/timespan/listDynTimespan").then(e=>{var t;return this.timespans=(t=e.data)==null?void 0:t.map(s=>({...s,isCloneable:s.type==="temporal"}))}),this.loading=!1},async loadCategories(){this.loading=!0,await this.$http.get("/knowage/restful-services/domains/listValueDescriptionByType?DOMAIN_TYPE=TIMESPAN_CATEGORY").then(e=>this.categories=e.data),this.loading=!1},showTimespanDetails(e,t){var n;const s=e?`/timespan/edit-timespan?id=${(n=e.item)==null?void 0:n.id}&clone=${t}`:"/timespan/new-timespan";this.$router.push(s)},deleteTimespanConfirm(e){this.$confirm.require({message:this.$t("common.toast.deleteMessage"),header:this.$t("common.toast.deleteTitle"),icon:"pi pi-exclamation-triangle",accept:async()=>{await this.deleteTimespan(e.item.id)}})},async deleteTimespan(e){this.loading=!0,await this.$http.post(`/knowage/restful-services/1.0/timespan/deleteTimespan?ID=${e}`).then(t=>{var s;((s=t.data)==null?void 0:s.Status)==="OK"&&(this.store.setInfo({title:this.$t("common.toast.deleteTitle"),msg:this.$t("common.toast.deleteSuccess")}),this.removeTimespan(e),this.$router.push("/timespan"))}).catch(t=>{this.store.setError({title:this.$t("common.toast.deleteTitle"),msg:t==null?void 0:t.message})}),this.loading=!1},removeTimespan(e){const t=this.timespans.findIndex(s=>s.id===e);t!==-1&&this.timespans.splice(t,1)},onTimespanCreated(){this.loadTimespans()}}}),K={class:"kn-page"},N={class:"kn-page-content p-grid p-m-0"},V={class:"kn-list--column p-col-4 p-sm-4 p-md-3 p-p-0"},E={class:"p-col-8 p-sm-8 p-md-9 p-p-0 p-m-0 kn-router-view"};function I(e,t,s,n,S,A){const d=a("FabButton"),c=a("Toolbar"),h=a("ProgressBar"),g=a("KnListBox"),u=a("router-view");return p(),k("div",K,[r("div",N,[r("div",V,[o(c,{class:"kn-toolbar kn-toolbar--primary"},{start:m(()=>[C(v(e.$t("managers.timespan.title")),1)]),end:m(()=>[o(d,{icon:"fas fa-plus",onClick:t[0]||(t[0]=i=>e.showTimespanDetails(null,!1))})]),_:1}),e.loading?(p(),B(h,{key:0,class:"kn-progress-bar",mode:"indeterminate","data-test":"progress-bar"})):_("",!0),o(g,{options:e.timespans,settings:e.timespanDescriptor.knListSettings,onClick:t[1]||(t[1]=i=>e.showTimespanDetails(i,!1)),onClone:t[2]||(t[2]=l(i=>e.showTimespanDetails(i,!0),["stop"])),onDelete:l(e.deleteTimespanConfirm,["stop"])},null,8,["options","settings","onDelete"])]),r("div",E,[o(u,{categories:e.categories,timespans:e.timespans,onTimespanCreated:e.onTimespanCreated},null,8,["categories","timespans","onTimespanCreated"])])])])}var O=T(b,[["render",I]]);export{O as default};
//# sourceMappingURL=Timespan-ac1b48d3.js.map
