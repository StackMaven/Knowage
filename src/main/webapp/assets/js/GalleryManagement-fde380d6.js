import{_ as m,d as u,X as h,a9 as f,s as w,r as o,o as b,c as x,a as r,f as e,w as i,g as y,t as M,h as A,A as C}from"./index-1e676509.js";import{s as E}from"./menu.esm-6bee86d0.js";import{g as z}from"./GalleryManagementDescriptor-33e009e7.js";import{K as T}from"./KnListBox-94855720.js";const _=u({name:"gallery-management",components:{FabButton:h,KnInputFile:f,KnListBox:T,Menu:E},data(){return{galleryTemplates:[],loading:!1,typeDescriptor:z,triggerInput:!1,addMenuItems:[{label:this.$t("managers.widgetGallery.newTemplate"),icon:"fas fa-plus",command:()=>this.newTemplate()},{label:this.$t("managers.widgetGallery.importTemplate"),icon:"fas fa-file-import",command:()=>{this.triggerInputFile(!0)}}],importingTemplate:{}}},setup(){return{store:w()}},created(){this.loadAllTemplates()},methods:{triggerInputFile(a){this.triggerInput=a},loadAllTemplates(){this.loading=!0,this.axios.get("/knowage-api/api/1.0/widgetgallery").then(a=>{this.galleryTemplates=a.data.map(t=>(t.label=t.label||t.name,t))}).catch(a=>console.error(a)).finally(()=>this.loading=!1)},deleteTemplate(a,t){a.preventDefault(),a.item&&a.item.id&&(t=a.item.id),this.$confirm.require({message:this.$t("managers.widgetGallery.templateDoYouWantToDeleteTemplate"),header:this.$t("managers.widgetGallery.deleteTemplate"),icon:"pi pi-exclamation-triangle",accept:()=>{this.axios.delete("/knowage-api/api/1.0/widgetgallery/"+t).then(()=>{this.store.setInfo({title:this.$t("managers.widgetGallery.deleteTemplate"),msg:this.$t("managers.widgetGallery.templateSuccessfullyDeleted")}),this.loadAllTemplates(),t===this.$route.params.id&&this.$router.push("/gallery-management")}).catch(n=>console.error(n))}})},newTemplate(){this.$router.push("/gallery-management/new-template")},savedElement(){this.loadAllTemplates()},toggleAdd(a){this.$refs.menu.toggle(a),this.triggerInputFile(!1)},uploadTemplate(a){var t=new FileReader;t.onload=this.onReaderLoad,t.readAsText(a.target.files[0]),this.triggerInputFile(!1),a.target.value=""},onReaderLoad(a){let t=JSON.parse(a.target.result);t.id?this.importWidget(t):this.$confirm.require({message:this.$t("importExport.import.itemWithoutIdConfirm"),header:this.$t("common.import"),icon:"pi pi-exclamation-triangle",accept:()=>{t.id="",this.importWidget(t)}})},importWidget(a){this.$http.post("/knowage-api/api/1.0/widgetgallery/import",a).then(()=>{this.store.setInfo({title:this.$t("managers.widgetGallery.uploadTemplate"),msg:this.$t("managers.widgetGallery.templateSuccessfullyUploaded")}),this.loadAllTemplates()})}}}),I={class:"kn-page"},$={class:"kn-page-content p-grid p-m-0"},B={class:"p-col-4 p-sm-4 p-md-3 p-p-0 kn-page"},F={class:"p-col-8 p-sm-8 p-md-9 p-p-0 p-m-0 kn-router-view"};function N(a,t,n,S,D,G){const d=o("FabButton"),l=o("Menu"),c=o("Toolbar"),s=o("KnInputFile"),p=o("ProgressBar"),k=o("KnListBox"),v=o("router-view");return b(),x("div",I,[r("div",$,[r("div",B,[e(c,{class:"kn-toolbar kn-toolbar--primary"},{start:i(()=>[y(M(a.$t("managers.widgetGallery.title")),1)]),end:i(()=>[e(d,{icon:"fas fa-plus",onClick:a.toggleAdd},null,8,["onClick"]),e(l,{ref:"menu",model:a.addMenuItems,popup:"true"},null,8,["model"])]),_:1}),e(s,{label:"",changeFunction:a.uploadTemplate,accept:"application/json,application/zip",triggerInput:a.triggerInput},null,8,["changeFunction","triggerInput"]),a.loading?(b(),A(p,{key:0,mode:"indeterminate",class:"kn-progress-bar"})):C("",!0),e(k,{options:a.galleryTemplates,settings:a.typeDescriptor.knListSettings,onDelete:t[0]||(t[0]=g=>a.deleteTemplate(g,a.item))},null,8,["options","settings"])]),r("div",F,[e(v,{onSaved:a.savedElement},null,8,["onSaved"])])])])}var R=m(_,[["render",N],["__scopeId","data-v-3b778b92"]]);export{R as default};
//# sourceMappingURL=GalleryManagement-fde380d6.js.map
