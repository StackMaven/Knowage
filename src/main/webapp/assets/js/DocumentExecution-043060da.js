import{d as V,_,r as p,o as u,h as y,w as b,a as c,t as k,c as C,g as A,A as E,B as R,C as L,p as bt,b as pt,i as G,a4 as kt,m as ut,s as K,f as m,L as Ge,U as Rt,G as I,J as Me,a5 as Ut,q as Le,a6 as mt,W as ft,a7 as Ne,D as le,X as Lt,v as vt,u as gt,a8 as Ft,a9 as ht,I as Bt,z as P,Y as he,l as wt,n as xt,y as Fe,aa as jt,ab as Xt,ac as Qt,ad as Wt,ae as Jt,af as Ht,ag as Yt}from"./index-1e676509.js";import{D as Kt,e as ie}from"./DashboardController-182bb635.js";import{s as Gt}from"./breadcrumb.esm-bbffcb4d.js";import{g as qt}from"./GlossaryDefinitionDescriptor-620d1c10.js";import{s as Be}from"./editor.esm-7f249187.js";import{s as yt}from"./textarea.esm-32051d54.js";import{s as Zt,a as ea}from"./accordiontab.esm-2c1b3232.js";import{f as Mt}from"./filterHelper-a723991a.js";import{K as ta}from"./KnParameterSidebar-7c5f3d6f.js";import aa from"./Registry-d0cf4afe.js";import{K as oa,u as ra,c as na}from"./KnValidatonMessages-ebe48c72.js";import{K as ia}from"./KnHint-6d455703.js";import{s as la}from"./contextmenu.esm-4301c9fe.js";import da from"./Olap-345cdd86.js";import"./checkbox.esm-fa6c8259.js";import"./radiobutton.esm-c3e6fa9b.js";import"./multiselect.esm-ce4000f7.js";import"./calendar.esm-60a451ba.js";import"./menu.esm-6bee86d0.js";import"./chip.esm-057ba1f1.js";import"./inputswitch.esm-80317a38.js";import"./inlinemessage.esm-1edef892.js";import"./KnCalculatedField-ab0b2f81.js";import"./colorpicker.esm-423214e6.js";import"./chips.esm-693c3c01.js";import"./tree.esm-837306a6.js";import"./selectbutton.esm-1085ac65.js";function sa(e,t,a,o,i,r,n,l){const d=[];if(r==="dashboard"&&d.push({label:n("common.settings"),items:[{icon:"pi pi-cog",label:n("common.general")},{icon:"fa-brands fa-diaspora",label:n("common.variables")},{icon:"fas fa-paint-roller",label:n("common.themes")},{icon:"fas fa-recycle",label:n("documentExecution.main.clearCache")}]}),l||d.push({label:n("common.file"),items:[{icon:"pi pi-print",label:n("common.print"),command:()=>t.print()}]}),a&&a.length!==0&&!l&&d.push({label:n("common.export"),items:[]}),o.enterprise&&!l&&d.push({label:n("common.info.info"),items:[{icon:"pi pi-star",label:n("common.rank"),command:()=>t.openRank()}]}),l||d.push({label:n("common.shortcuts"),items:[]}),l||a==null||a.forEach(s=>d[1].items.push({icon:"fa fa-file-excel",label:s.name,command:()=>t.export(s.name)})),o.functionalities.includes("SendMailFunctionality")&&e.typeCode==="REPORT"){const s=d.findIndex(f=>f.label===n("common.info.info"));s!==-1?d[s].items.push({icon:"pi pi-envelope",label:n("common.sendByEmail"),command:()=>t.openMailDialog()}):d.push({label:n("common.export"),items:[{icon:"pi pi-envelope",label:n("common.sendByEmail"),command:()=>t.openMailDialog()}]})}if(o.functionalities.includes("SeeMetadataFunctionality")&&!l){const s=d.findIndex(f=>f.label===n("common.info.info"));s!==-1&&d[s].items.unshift({icon:"pi pi-info-circle",label:n("common.metadata"),command:()=>t.openMetadata()})}if(o.functionalities.includes("SeeNotesFunctionality")&&!l){const s=d.findIndex(f=>f.label===n("common.info.info"));s!==-1&&d[s].items.push({icon:"pi pi-file",label:n("common.notes"),command:()=>t.openNotes()})}if(o.functionalities.includes("SeeSnapshotsFunctionality")&&o.enterprise&&!l){const s=d.findIndex(f=>f.label===n("common.shortcuts"));s!==-1&&d[s].items.unshift({icon:"",label:n("documentExecution.main.showScheduledExecutions"),command:()=>t.showScheduledExecutions()})}if(i&&!l){const s=d.findIndex(f=>f.label===n("common.shortcuts"));s!==-1&&d[s].items.unshift({icon:"fa fa-suitcase ",label:n("documentExecution.main.addToWorkspace"),command:()=>t.addToWorkspace()})}if(r==="olap"){const s=d.findIndex(f=>f.label===n("common.shortcuts"));s!==-1&&d[s].items.unshift({icon:"",label:n("documentExecution.main.showOLAPCustomView"),command:()=>t.showOLAPCustomView()})}if(o.functionalities.includes("EnableToCopyAndEmbed")&&!l){const s=d.findIndex(f=>f.label===n("common.shortcuts"));s!==-1&&(d[s].items.push({icon:"fa fa-share",label:n("documentExecution.main.copyLink"),command:()=>t.copyLink(!1)}),d[s].items.push({icon:"fa fa-share",label:n("documentExecution.main.embedInHtml"),command:()=>t.copyLink(!0)}))}return r==="dashboard"&&!l&&d.push({label:n("common.view"),items:[{icon:"pi pi-eye",label:n("documentExecution.main.asFinalUser")},{icon:"pi pi-print",label:n("documentExecution.main.inFullScreen")}]}),ca(d),d}const ca=e=>{for(let t=e.length-1;t>=0;t--)e[t].items.length===0&&e.splice(t,1)};const ba=V({name:"document-execution-breadcrumb",components:{Breadcrumb:Gt},props:{breadcrumbs:{type:Array}},emits:["breadcrumbClicked"],data(){return{home:{icon:"pi pi-home"},items:[]}},watch:{breadcrumbs(){this.loadBreadcrumbs()}},created(){this.loadBreadcrumbs()},methods:{loadBreadcrumbs(){this.items=this.breadcrumbs},selectBreadcrumb(e){const t=this.items.findIndex(a=>a.label===e.target.textContent||a.crossBreadcrumb===e.target.textContent);t!==-1&&(this.$emit("breadcrumbClicked",this.items[t]),this.items.splice(t+1))}}});function pa(e,t,a,o,i,r){const n=p("Breadcrumb");return u(),y(n,{home:e.home,model:e.items},{item:b(({item:l})=>[c("span",{class:"breadcrumbs-item",onClick:t[0]||(t[0]=(...d)=>e.selectBreadcrumb&&e.selectBreadcrumb(...d))},k(l.crossBreadcrumb?l.crossBreadcrumb:l.label),1)]),_:1},8,["home","model"])}var ka=_(ba,[["render",pa]]);const ua={style:{height:"80vh",padding:0,width:"80vw"}},ma=["WORD"];var fa={dialog:ua,filterFields:ma};const va=V({name:"document-execution-word-detail",components:{},props:{wordDetail:{type:Object},selectedWordName:{type:String}},data(){return{glossaryDefinitionDescriptor:qt,contentInfo:null}},watch:{wordDetail(){this.loadWordInfo()}},created(){this.loadWordInfo()},methods:{loadWordInfo(){this.contentInfo=this.wordDetail}}}),ga=e=>(bt("data-v-6dd714e7"),e=e(),pt(),e),ha={class:"word-info-container p-m-5 kn-overflow"},wa={key:1},xa={key:2},ya={key:0},Ma={key:0},Ea={class:"p-mr-2"},Ca={class:"p-d-flex p-flex-row p-flex-wrap"},Aa=ga(()=>c("span",null,null,-1)),Da={class:"p-mr-2"},$a={class:"p-d-flex p-flex-row p-flex-wrap"};function Ta(e,t,a,o,i,r){var d;const n=p("Toolbar"),l=p("Chip");return u(),C("div",ha,[e.selectedWordName?(u(),y(n,{key:0,class:"kn-toolbar kn-toolbar--secondary p-p-0 p-m-0 p-col-12"},{start:b(()=>[A(k(e.selectedWordName),1)]),_:1})):E("",!0),e.contentInfo&&e.contentInfo.CONTENT_ID?(u(),C("div",wa,[c("ul",null,[c("li",null,[c("span",null,k(e.$t("common.name"))+":",1),c("span",null,k(e.contentInfo.CONTENT_NM),1)]),c("li",null,[c("span",null,k(e.$t("managers.glossary.common.code"))+":",1),c("span",null,k(e.contentInfo.CONTENT_CD),1)]),c("li",null,[c("span",null,k(e.$t("common.description"))+":",1),c("span",null,k(e.contentInfo.CONTENT_DS),1)])])])):(d=e.contentInfo)!=null&&d.WORD_ID?(u(),C("div",xa,[c("ul",null,[c("li",null,[c("span",null,k(e.$tc("managers.glossary.common.word",1))+":",1),c("span",null,k(e.contentInfo.WORD),1)]),c("li",null,[c("span",null,k(e.$t("managers.glossary.common.status"))+":",1),e.contentInfo.STATE_NM?(u(),C("span",ya,k(e.$t(e.glossaryDefinitionDescriptor.translation[e.contentInfo.STATE_NM])),1)):E("",!0)]),c("li",null,[c("span",null,k(e.$t("managers.glossary.common.category"))+":",1),e.contentInfo.CATEGORY_NM?(u(),C("span",Ma,k(e.$t(e.glossaryDefinitionDescriptor.translation[e.contentInfo.CATEGORY_NM])),1)):E("",!0)]),c("li",null,[c("span",null,k(e.$t("common.description"))+":",1),c("span",null,k(e.contentInfo.DESCR),1)]),c("li",null,[c("span",null,k(e.$t("managers.glossary.common.formula"))+":",1),c("span",null,k(e.contentInfo.FORMULA),1)]),c("li",null,[c("span",Ea,k(e.$t("managers.glossary.common.link"))+":",1),c("div",Ca,[(u(!0),C(R,null,L(e.contentInfo.LINK,(s,f)=>(u(),y(l,{class:"p-m-1",key:f},{default:b(()=>[A(k(s.WORD),1)]),_:2},1024))),128))])]),c("li",null,[c("span",null,k(e.$t("managers.glossary.common.attributes"))+":",1),c("ul",null,[(u(!0),C(R,null,L(e.contentInfo.SBI_GL_WORD_ATTR,(s,f)=>(u(),C("li",{key:f},[c("span",null,k(s.ATTRIBUTE_NM)+":",1),Aa,c("ul",null,[c("li",Da,k(s.VALUE),1),c("div",$a,[(u(!0),C(R,null,L(e.contentInfo.LINK,(v,w)=>(u(),y(l,{class:"p-m-1",key:w},{default:b(()=>[A(k(v.WORD),1)]),_:2},1024))),128))])])]))),128))])])])])):E("",!0)])}var Sa=_(va,[["render",Ta],["__scopeId","data-v-6dd714e7"]]);const za=V({name:"document-execution-help-dialog",components:{Dialog:G,DocumentExecutionWordDetail:Sa,Listbox:kt},props:{visible:{type:Boolean},propDocument:{type:Object}},emits:["close"],data(){return{documentExecutionHelpDialogDescriptor:fa,document:null,words:[],wordDetail:null,selectedWordName:""}},computed:{...ut(K,{isEnterprise:"isEnterprise"})},watch:{async propDocument(){await this.loadDocument()}},setup(){return{store:K()}},async created(){await this.loadDocument()},methods:{async loadDocument(){this.document=this.propDocument?{...this.propDocument}:{},this.isEnterprise&&this.document.id&&await this.loadDocumentWords()},async loadDocumentWords(){this.store.setLoading(!0),await this.$http.get(`/knowage/restful-services/1.0/glossary/getDocumentInfo?DOCUMENT_ID=${this.document.id}`).then(e=>this.words=e.data.word).finally(()=>this.store.setLoading(!1))},async loadWordDetail(e){this.store.setLoading(!0),await this.$http.get(`/knowage/restful-services/1.0/glossary/getWord?WORD_ID=${e==null?void 0:e.WORD_ID}`).then(t=>{this.selectedWordName=e.WORD,this.wordDetail=t.data}).finally(()=>this.store.setLoading(!1))},closeDialog(){this.$emit("close")}}}),Na={class:"p-d-flex p-flex-row kn-height-full"},Ia=["onClick"];function Oa(e,t,a,o,i,r){const n=p("Button"),l=p("Toolbar"),d=p("Listbox"),s=p("DocumentExecutionWordDetail"),f=p("Dialog");return u(),y(f,{class:"p-fluid kn-dialog--toolbar--primary",contentStyle:e.documentExecutionHelpDialogDescriptor.dialog.style,visible:e.visible,modal:!0,closable:!1},{header:b(()=>[m(l,{class:"kn-toolbar kn-toolbar--primary p-p-0 p-m-0 p-col-12"},{start:b(()=>[A(k(e.$t("common.onlineHelp")),1)]),end:b(()=>[m(n,{icon:"pi pi-times",class:"kn-button p-button-text p-button-rounded",onClick:e.closeDialog},null,8,["onClick"])]),_:1})]),default:b(()=>[c("div",Na,[m(d,{class:"kn-list--column kn-flex kn-height-full",options:e.words,filter:!0,filterPlaceholder:e.$t("common.search"),filterMatchMode:"contains",filterFields:e.documentExecutionHelpDialogDescriptor.filterFields,emptyFilterMessage:e.$t("common.info.noDataFound")},{empty:b(()=>[A(k(e.$t("common.info.noDataFound")),1)]),option:b(v=>[c("div",{class:"kn-list-item",onClick:w=>e.loadWordDetail(v.option)},[c("span",null,k(v.option.WORD),1)],8,Ia)]),_:1},8,["options","filterPlaceholder","filterFields","emptyFilterMessage"]),m(s,{id:"document-execution-word-detail",wordDetail:e.wordDetail,selectedWordName:e.selectedWordName},null,8,["wordDetail","selectedWordName"])])]),_:1},8,["contentStyle","visible"])}var Va=_(za,[["render",Oa],["__scopeId","data-v-604b7730"]]),Et={name:"Rating",emits:["update:modelValue","change","focus","blur"],props:{modelValue:{type:Number,default:null},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},stars:{type:Number,default:5},cancel:{type:Boolean,default:!0},onIcon:{type:String,default:"pi pi-star-fill"},offIcon:{type:String,default:"pi pi-star"},cancelIcon:{type:String,default:"pi pi-ban"}},data(){return{focusedOptionIndex:-1}},methods:{onOptionClick(e,t){if(!this.readonly&&!this.disabled){this.onOptionSelect(e,t);const a=Ge.getFirstFocusableElement(e.currentTarget);a&&Ge.focus(a)}},onFocus(e,t){this.focusedOptionIndex=t,this.$emit("focus",e)},onBlur(e){this.focusedOptionIndex=-1,this.$emit("blur",e)},onChange(e,t){this.onOptionSelect(e,t)},onOptionSelect(e,t){this.focusedOptionIndex=t,this.updateModel(e,t||null)},updateModel(e,t){this.$emit("update:modelValue",t),this.$emit("change",{originalEvent:e,value:t})},cancelAriaLabel(){return this.$primevue.config.locale.clear},starAriaLabel(e){return e===1?this.$primevue.config.locale.aria.star:this.$primevue.config.locale.aria.stars.replace(/{star}/g,e)}},computed:{containerClass(){return["p-rating",{"p-readonly":this.readonly,"p-disabled":this.disabled}]},cancelIconClass(){return["p-rating-icon p-rating-cancel",this.cancelIcon]},onIconClass(){return["p-rating-icon",this.onIcon]},offIconClass(){return["p-rating-icon",this.offIcon]},name(){return this.$attrs.name||Rt()}}};const _a={class:"p-hidden-accessible"},Pa=["name","checked","disabled","readonly","aria-label"],Ra=["onClick"],Ua={class:"p-hidden-accessible"},La=["value","name","checked","disabled","readonly","aria-label","onFocus","onChange"];function Fa(e,t,a,o,i,r){return u(),C("div",{class:I(r.containerClass)},[a.cancel?(u(),C("div",{key:0,class:I(["p-rating-item p-rating-cancel-item",{"p-focus":i.focusedOptionIndex===0}]),onClick:t[3]||(t[3]=n=>r.onOptionClick(n,0))},[c("span",_a,[c("input",{type:"radio",value:"0",name:r.name,checked:a.modelValue===0,disabled:a.disabled,readonly:a.readonly,"aria-label":r.cancelAriaLabel(),onFocus:t[0]||(t[0]=n=>r.onFocus(n,0)),onBlur:t[1]||(t[1]=(...n)=>r.onBlur&&r.onBlur(...n)),onChange:t[2]||(t[2]=n=>r.onChange(n,0))},null,40,Pa)]),Me(e.$slots,"cancelicon",{},()=>[c("span",{class:I(r.cancelIconClass)},null,2)])],2)):E("",!0),(u(!0),C(R,null,L(a.stars,n=>(u(),C("div",{key:n,class:I(["p-rating-item",{"p-rating-item-active":n<=a.modelValue,"p-focus":n===i.focusedOptionIndex}]),onClick:l=>r.onOptionClick(l,n)},[c("span",Ua,[c("input",{type:"radio",value:n,name:r.name,checked:a.modelValue===n,disabled:a.disabled,readonly:a.readonly,"aria-label":r.starAriaLabel(n),onFocus:l=>r.onFocus(l,n),onBlur:t[4]||(t[4]=(...l)=>r.onBlur&&r.onBlur(...l)),onChange:l=>r.onChange(l,n)},null,40,La)]),n<=a.modelValue?Me(e.$slots,"onicon",{key:0,value:n},()=>[c("span",{class:I(r.onIconClass)},null,2)]):Me(e.$slots,"officon",{key:1,value:n},()=>[c("span",{class:I(r.offIconClass)},null,2)])],10,Ra))),128))],2)}function Ba(e,t){t===void 0&&(t={});var a=t.insertAt;if(!(!e||typeof document=="undefined")){var o=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",a==="top"&&o.firstChild?o.insertBefore(i,o.firstChild):o.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}var ja=`
.p-rating {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
}
.p-rating-item {
    display: -webkit-inline-box;
    display: -ms-inline-flexbox;
    display: inline-flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    cursor: pointer;
}
.p-rating.p-readonly .p-rating-item {
    cursor: default;
}
`;Ba(ja);Et.render=Fa;const Xa=V({name:"document-execution-help-dialog",components:{Dialog:G,Rating:Et},props:{visible:{type:Boolean},propDocumentRank:{type:Object}},emits:["close","saveRank"],data(){return{documentRank:null,newRank:null}},watch:{propDocumentRank(){this.loadDocumentRank()}},created(){this.loadDocumentRank()},methods:{loadDocumentRank(){this.newRank=null,this.documentRank=this.propDocumentRank},closeDialog(){this.newRank=null,this.$emit("close")},save(){this.$emit("saveRank",this.newRank)}}}),Qa={class:"p-p-2"},Wa={class:"p-p-2"},Ja={class:"p-d-flex p-flex-row p-jc-end"};function Ha(e,t,a,o,i,r){const n=p("Toolbar"),l=p("Rating"),d=p("Button"),s=p("Dialog");return u(),y(s,{class:"p-fluid kn-dialog--toolbar--primary",visible:e.visible,modal:!0,closable:!1},{header:b(()=>[m(n,{class:"kn-toolbar kn-toolbar--primary p-p-0 p-m-0 p-col-12"},{start:b(()=>[A(k(e.$t("common.rank")),1)]),_:1})]),footer:b(()=>[c("div",Ja,[m(d,{class:"kn-button kn-button--primary",onClick:e.closeDialog},{default:b(()=>[A(k(e.$t("common.cancel")),1)]),_:1},8,["onClick"]),m(d,{class:"kn-button kn-button--primary",onClick:e.save},{default:b(()=>[A(k(e.$t("common.save")),1)]),_:1},8,["onClick"])])]),default:b(()=>[c("div",Qa,[c("label",null,k(e.documentRank===0?e.$t("documentExecution.main.firstToRate"):e.$t("documentExecution.main.currentRank")),1),e.documentRank!==0?(u(),y(l,{key:0,class:"document-execution-rank-stars",modelValue:e.documentRank,"onUpdate:modelValue":t[0]||(t[0]=f=>e.documentRank=f),disabled:!0,cancel:!1},null,8,["modelValue"])):E("",!0)]),c("div",Wa,[c("label",null,k(e.$t("documentExecution.main.yourRating")+": "),1),m(l,{class:"document-execution-rank-stars",modelValue:e.newRank,"onUpdate:modelValue":t[1]||(t[1]=f=>e.newRank=f),cancel:!1},null,8,["modelValue"])])]),_:1},8,["visible"])}var Ya=_(Xa,[["render",Ha]]);const Ka={style:{padding:0,width:"80vw"}},Ga=["Public","Private"],qa={"align-items":"center",display:"flex","justify-content":"center","text-align":"center"};var je={dialog:Ka,dropdownOptions:Ga,messageStyle:qa};const Za=V({name:"document-execution-notes-form",components:{Dropdown:Ut,Editor:Be},props:{datasets:{type:Array},selectedNote:{type:Object}},emits:["selected"],data(){return{documentExecutionNotesDialogDescriptor:je,note:{}}},watch:{selectedNote(){this.loadNote()}},created(){this.loadNote()},methods:{loadNote(){this.note=this.selectedNote}}}),eo={class:"p-m-2"},to={class:"p-d-field p-my-3"},ao={class:"kn-material-input-label"};function oo(e,t,a,o,i,r){const n=p("Editor"),l=p("Dropdown");return u(),C("div",eo,[m(n,{modelValue:e.note.content,"onUpdate:modelValue":t[0]||(t[0]=d=>e.note.content=d),class:"p-m-2",editorStyle:"height: 220px"},null,8,["modelValue"]),c("div",to,[c("label",ao,k(e.$t("common.type")+" *"),1),m(l,{class:I(["kn-material-input",{"p-invalid":!e.note.type}]),modelValue:e.note.type,"onUpdate:modelValue":t[1]||(t[1]=d=>e.note.type=d),options:e.documentExecutionNotesDialogDescriptor.dropdownOptions},null,8,["class","modelValue","options"])])])}var ro=_(Za,[["render",oo]]);const no=V({name:"document-execution-notes-list",components:{Message:Le},props:{propNotes:{type:Array},document:{type:Object}},emits:["editNote","deleteNote"],data(){return{documentExecutionNotesDialogDescriptor:je,notes:[]}},watch:{propNotes(){this.loadNotes()}},created(){this.loadNotes()},methods:{loadNotes(){this.notes=this.propNotes},deleteNoteConfirm(e){this.$confirm.require({message:this.$t("documentExecution.dossier.deleteConfirm"),header:this.$t("documentExecution.dossier.deleteTitle"),icon:"pi pi-exclamation-triangle",accept:()=>this.$emit("deleteNote",e)})},getFormattedDate(e){const t=mt(e).format("DD/MM/YYYY");return ft(t,"","DD/MM/YYYY")},onNoteEdit(e){this.$emit("editNote",Ne(e))}}}),io={class:"p-ml-4"},lo={class:"p-mr-4"},so={class:"p-mr-4"},co=["innerHTML"];function bo(e,t,a,o,i,r){const n=p("Message"),l=p("Button"),d=p("Toolbar");return u(),C("div",null,[e.notes.length===0?(u(),y(n,{key:0,class:"p-m-2",severity:"info",closable:!1,style:le(e.documentExecutionNotesDialogDescriptor.messageStyle)},{default:b(()=>[A(k(e.$t("common.info.noDataFound")),1)]),_:1},8,["style"])):(u(!0),C(R,{key:1},L(e.notes,s=>(u(),C("div",{key:s.id},[m(d,{class:"kn-toolbar kn-toolbar--secondary"},{start:b(()=>[c("span",io,k(e.$t("common.owner")+" "+s.owner),1)]),end:b(()=>[c("span",lo,k(e.$t("common.creationDate")+": "+e.getFormattedDate(s.creationDate)),1),c("span",so,k(e.$t("common.lastChangeDate")+": "+e.getFormattedDate(s.lastChangeDate)),1),m(l,{icon:"pi pi-pencil",class:"p-button-link",onClick:f=>e.onNoteEdit(s)},null,8,["onClick"]),m(l,{icon:"pi pi-trash",class:"p-button-link",onClick:f=>e.deleteNoteConfirm(s)},null,8,["onClick"])]),_:2},1024),c("div",{innerHTML:s.content,class:"p-mt-0 p-ml-2 p-mr-2 p-mb-2 noteContent",disabled:""},null,8,co)]))),128))])}var po=_(no,[["render",bo],["__scopeId","data-v-3e6d8bb8"]]);const ko=V({name:"document-execution-notes-dialog",components:{Dialog:G,DocumentExecutionNotesForm:ro,DocumentExecutionNotesList:po,FabButton:Lt,TabView:vt,TabPanel:gt},props:{visible:{type:Boolean},propDocument:{type:Object}},emits:["close"],data(){return{documentExecutionNotesDialogDescriptor:je,document:null,notes:[],selectedNote:{},activeTab:0,loading:!1}},watch:{async visible(){this.visible&&await this.loadDocument()},async propDocument(){await this.loadDocument()}},computed:{saveButtonDisabled(){return!this.selectedNote.type},exportButtonDisabled(){return this.notes.length===0},...ut(K,{isEnterprise:"isEnterprise"})},setup(){return{store:K()}},async mounted(){await this.loadDocument()},methods:{async loadDocument(){this.document=this.propDocument,this.isEnterprise&&this.document&&this.document.id&&await this.loadNotes()},closeDialog(){this.selectedNote={},this.$emit("close")},async loadNotes(){this.loading=!0,this.notes=[],await this.$http.get(`/knowage/restful-services/document-notes/${this.document.id}`).then(e=>{var t;this.notes=(t=e.data)==null?void 0:t.map(a=>({...a,type:a.public?"Public":"Private"}))}).catch(e=>this.store.setError({title:this.$t("common.error.generic"),msg:e})),this.loading=!1},async saveNote(){this.loading=!0,await this.$http.post(`/knowage/restful-services/document-notes/${this.document.id}`,{public:this.selectedNote.type==="Public",content:this.selectedNote.content,id:this.selectedNote.id}).then(async e=>{this.store.setInfo({title:this.$t("common.toast.createTitle"),msg:this.$t("common.toast.success")}),this.selectedNote={...e.data,type:e.data.public?"Public":"Private"},await this.loadNotes()}).catch(e=>this.store.setError({title:this.$t("common.error.generic"),msg:e})),this.loading=!1},onEditNote(e){this.selectedNote={...e},this.activeTab=0},async onDeleteNote(e){this.loading=!0,await this.$http.delete(`/knowage/restful-services/document-notes/${this.document.id}/${e.id}`).then(async()=>{this.store.setInfo({title:this.$t("common.toast.deleteTitle"),msg:this.$t("common.toast.deleteSuccess")}),this.selectedNote.id===e.id&&(this.selectedNote={}),await this.loadNotes()}).catch(t=>this.store.setError({title:this.$t("common.error.generic"),msg:t})),this.loading=!1},async exportNotes(e){this.loading=!0,await this.$http.get(`/knowage/restful-services/document-notes/${this.document.id}/download/${e}`,{headers:{Accept:"application/json, text/plain, */*"}}).then(t=>{const a=new Uint8Array(t.data.file);Ft(a,this.document.label,e==="pdf"?"application/pdf":"application/rtf")}).catch(()=>{}),this.loading=!1},createNewNote(){this.selectedNote={},this.activeTab=0}}}),uo={class:"p-d-flex p-flex-row"};function mo(e,t,a,o,i,r){const n=p("FabButton"),l=p("Toolbar"),d=p("ProgressBar"),s=p("DocumentExecutionNotesForm"),f=p("TabPanel"),v=p("DocumentExecutionNotesList"),w=p("TabView"),x=p("Button"),g=p("Dialog");return u(),y(g,{class:"p-fluid kn-dialog--toolbar--primary",contentStyle:e.documentExecutionNotesDialogDescriptor.dialog.style,visible:e.visible,modal:!0,closable:!1},{header:b(()=>[m(l,{class:"kn-toolbar kn-toolbar--primary p-p-0 p-m-0 p-col-12"},{start:b(()=>[A(k(e.$t("common.notes")),1)]),end:b(()=>[m(n,{icon:"fas fa-plus",onClick:e.createNewNote},null,8,["onClick"])]),_:1})]),footer:b(()=>[c("div",uo,[e.activeTab===1?(u(),y(x,{key:0,class:"kn-button kn-button--primary",onClick:t[1]||(t[1]=T=>e.exportNotes("pdf")),disabled:e.exportButtonDisabled},{default:b(()=>[A(k(e.$t("documentExecution.main.exportInPDF")),1)]),_:1},8,["disabled"])):E("",!0),e.activeTab===1?(u(),y(x,{key:1,class:"kn-button kn-button--primary",onClick:t[2]||(t[2]=T=>e.exportNotes("rtf")),disabled:e.exportButtonDisabled},{default:b(()=>[A(k(e.$t("documentExecution.main.exportInRTF")),1)]),_:1},8,["disabled"])):E("",!0),m(x,{class:"kn-button kn-button--primary p-ml-auto",onClick:e.closeDialog},{default:b(()=>[A(k(e.$t("common.close")),1)]),_:1},8,["onClick"]),e.activeTab===0?(u(),y(x,{key:2,class:"kn-button kn-button--primary",onClick:e.saveNote,disabled:e.saveButtonDisabled},{default:b(()=>[A(k(e.$t("common.save")),1)]),_:1},8,["onClick","disabled"])):E("",!0)])]),default:b(()=>[e.loading?(u(),y(d,{key:0,mode:"indeterminate",class:"kn-progress-bar"})):E("",!0),m(w,{activeIndex:e.activeTab,"onUpdate:activeIndex":t[0]||(t[0]=T=>e.activeTab=T)},{default:b(()=>[m(f,null,{header:b(()=>[c("span",null,k(e.$t("common.note")),1)]),default:b(()=>[m(s,{selectedNote:e.selectedNote},null,8,["selectedNote"])]),_:1}),m(f,null,{header:b(()=>[c("span",null,k(e.$t("common.notesList")),1)]),default:b(()=>[m(v,{propNotes:e.notes,document:e.document,onEditNote:e.onEditNote,onDeleteNote:e.onDeleteNote},null,8,["propNotes","document","onEditNote","onDeleteNote"])]),_:1})]),_:1},8,["activeIndex"])]),_:1},8,["contentStyle","visible"])}var fo=_(ko,[["render",mo]]);const vo={style:{width:"80vw"}},go={style:{height:"260px"}};var ho={dialog:vo,editor:go};const wo=V({name:"document-execution-metadata-dialog",components:{Dialog:G,Editor:Be,KnInputFile:ht,TabView:vt,TabPanel:gt,Textarea:yt},props:{visible:{type:Boolean},propDocument:{type:Object},propMetadata:{type:Object,required:!0},propLoading:{type:Boolean}},emits:["close","saveMetadata"],data(){return{documentExecutionMetadataDialogDescriptor:ho,document:null,metadata:null,uploadedFiles:{},loading:!1}},watch:{propMetadata(){this.loadDocument(),this.loadMetadata()},propLoading(){this.setLoading()}},computed:{canModify(){return this.store.$state.user.functionalities.includes("SaveMetadataFunctionality")}},setup(){return{store:K()}},created(){this.setLoading(),this.loadDocument(),this.loadMetadata()},methods:{loadDocument(){this.document=this.propDocument},loadMetadata(){this.propMetadata&&(this.metadata={generalMetadata:this.propMetadata.GENERAL_META?[...this.propMetadata.GENERAL_META]:[],shortText:this.propMetadata.SHORT_TEXT?[...this.propMetadata.SHORT_TEXT]:[],longText:this.propMetadata.LONG_TEXT?[...this.propMetadata.LONG_TEXT]:[],file:this.propMetadata.FILE?[...this.propMetadata.FILE]:[]},this.metadata.file.length>0&&this.formatMetadataFileValues())},formatMetadataFileValues(){!this.metadata||(this.metadata.file=this.metadata.file.map(e=>(e.value&&(e.value=JSON.parse(e.value)),e)))},setLoading(){this.loading=this.propLoading},uploadFile(e){this.uploadedFiles[e.target.id]=e.target.files[0]},async uploadMetaFile(e){if(!this.uploadedFiles[e.id])this.store.setError({title:this.$t("common.error.generic"),msg:this.$t("documentExecution.main.selectFileError")});else{this.loading=!0;const t=new FormData;t.append("file",this.uploadedFiles[e.id]),t.append("fileName",this.uploadedFiles[e.id].name),await this.$http.post("/knowage/restful-services/1.0/documentexecution/uploadfilemetadata",t,{headers:{"Content-Type":"multipart/form-data"}}).then(()=>{this.store.setInfo({title:this.$t("common.uploadFile"),msg:this.$t("common.uploadFileSuccess")}),this.updateMetadataFile(e.id,this.uploadedFiles[e.id].name)}).catch(a=>this.store.setError({title:this.$t("common.error.generic"),msg:a})),this.loading=!1}},updateMetadataFile(e,t){var o;if(!this.metadata)return;const a=(o=this.metadata)==null?void 0:o.file.findIndex(i=>i.id===e);a!==-1&&(this.metadata.file[a].fileToSave={file:{},fileName:t},this.metadata.file[a].value&&(this.metadata.file[a].value=""))},cleanFile(e){const t=this.$refs[e.id];if(t&&this.metadata){t.resetInput(),delete this.uploadedFiles[e.id];const a=this.metadata.file.findIndex(o=>o.id===e.id);a!==-1&&(delete this.metadata.file[a].fileToSave,this.metadata.file[a].value="")}},async downloadFile(e){!e.value||await this.$http.get(`/knowage/restful-services/1.0/documentexecution/${this.document.id}/${e.id}/documentfilemetadata`,{headers:{Accept:"application/json, text/plain, */*"},responseType:"blob"}).then(t=>{Bt(t),this.store.setInfo({title:this.$t("common.toast.success")})}).catch(t=>{this.store.setError({title:this.$t("common.error.generic"),msg:t})})},closeDialog(){this.metadata=null,this.$emit("close"),this.uploadedFiles={}},save(){this.$emit("saveMetadata",this.metadata),this.uploadedFiles={}}}}),xo={key:1},yo={key:0},Mo={class:"p-grid p-ai-center"},Eo={class:"kn-material-input-label"},Co={key:1},Ao={class:"p-grid"},Do={class:"kn-material-input-label"},$o={class:"p-text-uppercase kn-truncated"},To={class:"kn-flex p-d-flex p-flex-row p-m-2"},So={key:0,class:"kn-flex p-d-flex p-flex-row p-m-1"},zo={class:"p-m-1"},No={class:"kn-material-input-label"},Io={class:"kn-flex p-d-flex p-flex-row p-jc-between p-ml-auto"},Oo={class:"p-d-flex p-flex-row p-jc-end"};function Vo(e,t,a,o,i,r){const n=p("Toolbar"),l=p("ProgressBar"),d=p("InputText"),s=p("Textarea"),f=p("Editor"),v=p("TabPanel"),w=p("TabView"),x=p("KnInputFile"),g=p("Button"),T=p("Dialog");return u(),y(T,{class:"p-fluid kn-dialog--toolbar--primary",contentStyle:e.documentExecutionMetadataDialogDescriptor.dialog.style,visible:e.visible,modal:!0,closable:!1},{header:b(()=>[m(n,{class:"kn-toolbar kn-toolbar--primary p-p-0 p-m-0 p-col-12"},{start:b(()=>[A(k(e.$t("common.metadata")),1)]),_:1})]),footer:b(()=>[c("div",Oo,[m(g,{class:"kn-button kn-button--primary",onClick:e.closeDialog},{default:b(()=>[A(k(e.$t("common.close")),1)]),_:1},8,["onClick"]),m(g,{class:"kn-button kn-button--primary",disabled:!e.canModify,onClick:e.save},{default:b(()=>[A(k(e.$t("common.save")),1)]),_:1},8,["disabled","onClick"])])]),default:b(()=>[e.loading?(u(),y(l,{key:0,mode:"indeterminate",class:"kn-progress-bar"})):E("",!0),e.metadata?(u(),C("div",xo,[e.metadata.generalMetadata.length>0?(u(),C("div",yo,[c("h2",null,k(e.$t("common.documentDetails")),1),c("div",Mo,[(u(!0),C(R,null,L(e.metadata.generalMetadata,(h,M)=>(u(),C(R,{key:M},[h.value&&M!==e.metadata.generalMetadata.length-1?(u(),C("div",{key:0,class:I({"p-col-4":M!==3,"p-col-12":M===3})},[c("label",Eo,k(h.name),1),M!==3?(u(),y(d,{key:0,class:"kn-material-input p-inputtext-sm",modelValue:h.value,"onUpdate:modelValue":$=>h.value=$,disabled:!0},null,8,["modelValue","onUpdate:modelValue"])):(u(),y(s,{key:1,modelValue:h.value,"onUpdate:modelValue":$=>h.value=$,rows:"2",disabled:!0},null,8,["modelValue","onUpdate:modelValue"]))],2)):E("",!0)],64))),128))])])):E("",!0),e.metadata.shortText.length>0||e.metadata.longText.length>0?(u(),C("div",Co,[c("h2",null,k(e.$t("documentExecution.main.customMetadata")),1),P(c("div",Ao,[(u(!0),C(R,null,L(e.metadata.shortText,(h,M)=>(u(),C("div",{key:M,class:"p-col-4"},[c("label",Do,k(h.name),1),m(d,{class:"kn-material-input p-inputtext-sm",modelValue:h.value,"onUpdate:modelValue":$=>h.value=$,disabled:!e.canModify},null,8,["modelValue","onUpdate:modelValue","disabled"])]))),128))],512),[[he,e.metadata.shortText.length>0]])])):E("",!0),(e.metadata.shortText.length>0||e.metadata.longText.length>0)&&e.metadata.longText.length>0?(u(),y(w,{key:2,scrollable:""},{default:b(()=>[(u(!0),C(R,null,L(e.metadata.longText,(h,M)=>(u(),y(v,{key:M},{header:b(()=>[c("span",$o,k(h.name),1)]),default:b(()=>[m(f,{modelValue:h.value,"onUpdate:modelValue":$=>h.value=$,readonly:!e.canModify,editorStyle:e.documentExecutionMetadataDialogDescriptor.editor.style},null,8,["modelValue","onUpdate:modelValue","readonly","editorStyle"])]),_:2},1024))),128))]),_:1})):E("",!0),P(c("div",null,[c("h2",null,k(e.$t("common.attachments")),1),(u(!0),C(R,null,L(e.metadata.file,(h,M)=>(u(),C("div",{key:M,class:"p-d-flex p-flex-row p-ai-center"},[c("div",To,[h.value?(u(),C("div",So,[m(d,{class:"kn-material-input p-inputtext-sm",modelValue:h.value.fileName,"onUpdate:modelValue":$=>h.value.fileName=$,disabled:!0},null,8,["modelValue","onUpdate:modelValue"]),m(d,{class:"kn-material-input p-inputtext-sm",modelValue:h.value.saveDate,"onUpdate:modelValue":$=>h.value.saveDate=$,disabled:!0},null,8,["modelValue","onUpdate:modelValue"])])):E("",!0),c("div",zo,[c("label",No,k(h.name),1),m(x,{ref_for:!0,ref:""+h.id,id:""+h.id,changeFunction:e.uploadFile,visibility:!0},null,8,["id","changeFunction"])])]),c("div",Io,[e.canModify?(u(),y(g,{key:0,class:"kn-button kn-button--primary document-execution-metadata-dialog-upload-button",onClick:$=>e.uploadMetaFile(h)},{default:b(()=>[A(k(e.$t("common.upload")),1)]),_:2},1032,["onClick"])):E("",!0),P(m(g,{class:"kn-button kn-button--primary document-execution-metadata-dialog-upload-button",onClick:$=>e.downloadFile(h)},{default:b(()=>[A(k(e.$t("common.download")),1)]),_:2},1032,["onClick"]),[[he,e.canModify&&h.value]]),e.canModify?(u(),y(g,{key:1,class:"kn-button kn-button--primary document-execution-metadata-dialog-upload-button",onClick:$=>e.cleanFile(h)},{default:b(()=>[A(k(e.$t("common.clean")),1)]),_:2},1032,["onClick"])):E("",!0)])]))),128))],512),[[he,e.metadata.file.length>0]])])):E("",!0)]),_:1},8,["contentStyle","visible"])}var _o=_(wo,[["render",Vo]]);const Po=160,Ro={style:{width:"60vw"}},Uo={style:{height:"260px"}},Lo=160,Fo={message:{"align-items":"center",display:"flex","justify-content":"center","text-align":"center"}};var Bo={ccMaxLength:Po,dialog:Ro,editor:Uo,objectMaxLength:Lo,styles:Fo};const jo=V({name:"document-execution-help-dialog",components:{Accordion:Zt,AccordionTab:ea,Dialog:G,Editor:Be,Message:Le},props:{visible:{type:Boolean}},emits:["close","sendMail"],data(){return{documentExecutionMailDialogDescriptor:Bo,mail:{},mailToDirty:!1}},computed:{ccHelp(){var e,t;return((t=(e=this.mail.CC)==null?void 0:e.length)!=null?t:"0")+" / "+this.documentExecutionMailDialogDescriptor.ccMaxLength},objectHelp(){var e,t;return((t=(e=this.mail.OBJECT)==null?void 0:e.length)!=null?t:"0")+" / "+this.documentExecutionMailDialogDescriptor.objectMaxLength},saveButtonDisabled(){return!this.mail.TO||this.mail.TO.length===0}},created(){},methods:{closeDialog(){this.mail={},this.$emit("close")},save(){this.$emit("sendMail",this.mail)}}}),Xo={class:"p-fluid p-formgrid p-grid p-mx-2 p-my-4"},Qo={class:"p-field p-col-12"},Wo={class:"kn-material-input-label"},Jo={class:"p-field p-col-12"},Ho={class:"kn-material-input-label"},Yo={class:"p-d-flex p-flex-row p-jc-end p-col-12"},Ko={class:"max-length-help p-m-0"},Go={class:"p-field p-col-12"},qo={class:"kn-material-input-label"},Zo={class:"p-d-flex p-flex-row p-jc-end p-col-12"},er={class:"max-length-help p-m-0"},tr={class:"p-field p-col-12"},ar={class:"kn-material-input-label"},or={class:"p-grid p-mt-4"},rr={class:"p-field p-col-6"},nr={class:"kn-material-input-label"},ir={class:"p-field p-col-6"},lr={class:"kn-material-input-label"},dr={class:"p-field p-col-12"},sr={class:"kn-material-input-label"},cr={id:"reply-to-help"},br={class:"p-d-flex p-flex-row p-jc-end"};function pr(e,t,a,o,i,r){const n=p("Toolbar"),l=p("InputText"),d=p("Editor"),s=p("Message"),f=p("AccordionTab"),v=p("Accordion"),w=p("Button"),x=p("Dialog");return u(),y(x,{class:"p-fluid kn-dialog--toolbar--primary",contentStyle:e.documentExecutionMailDialogDescriptor.dialog.style,visible:e.visible,modal:!0,closable:!1},{header:b(()=>[m(n,{class:"kn-toolbar kn-toolbar--primary p-p-0 p-m-0 p-col-12"},{start:b(()=>[A(k(e.$t("common.sendMail")),1)]),_:1})]),footer:b(()=>[c("div",br,[m(w,{class:"kn-button kn-button--primary",onClick:e.closeDialog},{default:b(()=>[A(k(e.$t("common.cancel")),1)]),_:1},8,["onClick"]),m(w,{class:"kn-button kn-button--primary",onClick:e.save,disabled:e.saveButtonDisabled},{default:b(()=>[A(k(e.$t("common.save")),1)]),_:1},8,["onClick","disabled"])])]),default:b(()=>[c("div",Xo,[c("div",Qo,[c("label",Wo,k(e.$t("common.to"))+" *",1),m(l,{class:I(["kn-material-input p-inputtext-sm",{"p-invalid":e.mailToDirty&&(!e.mail.TO||e.mail.TO.length===0)}]),modelValue:e.mail.TO,"onUpdate:modelValue":t[0]||(t[0]=g=>e.mail.TO=g),onInput:t[1]||(t[1]=g=>e.mailToDirty=!0),onBlur:t[2]||(t[2]=g=>e.mailToDirty=!0)},null,8,["modelValue","class"])]),c("div",Jo,[c("label",Ho,k(e.$t("common.cc")),1),m(l,{class:"kn-material-input p-inputtext-sm",modelValue:e.mail.CC,"onUpdate:modelValue":t[3]||(t[3]=g=>e.mail.CC=g),maxLength:e.documentExecutionMailDialogDescriptor.ccMaxLength},null,8,["modelValue","maxLength"])]),c("div",Yo,[c("p",Ko,k(e.ccHelp),1)]),c("div",Go,[c("label",qo,k(e.$t("common.object")),1),m(l,{class:"kn-material-input p-inputtext-sm",modelValue:e.mail.OBJECT,"onUpdate:modelValue":t[4]||(t[4]=g=>e.mail.OBJECT=g),maxLength:e.documentExecutionMailDialogDescriptor.objectMaxLength},null,8,["modelValue","maxLength"])]),c("div",Zo,[c("p",er,k(e.objectHelp),1)]),c("div",tr,[c("label",ar,k(e.$t("common.message")),1),m(d,{modelValue:e.mail.MESSAGE,"onUpdate:modelValue":t[5]||(t[5]=g=>e.mail.MESSAGE=g),class:"p-m-2",editorStyle:e.documentExecutionMailDialogDescriptor.editor.style},null,8,["modelValue","editorStyle"])]),m(v,{class:"p-col-12"},{default:b(()=>[m(f,null,{header:b(()=>[c("span",null,k(e.$t("common.advanced")),1)]),default:b(()=>[m(s,{class:"p-m-2",severity:"info",closable:!1,style:le(e.documentExecutionMailDialogDescriptor.styles.message)},{default:b(()=>[A(k(e.$t("documentExecution.main.sendEmailMessage")),1)]),_:1},8,["style"]),c("div",or,[c("div",rr,[c("label",nr,k(e.$t("common.login")),1),m(l,{class:"kn-material-input p-inputtext-sm",modelValue:e.mail.LOGIN,"onUpdate:modelValue":t[6]||(t[6]=g=>e.mail.LOGIN=g),maxLength:e.documentExecutionMailDialogDescriptor.objectMaxLength},null,8,["modelValue","maxLength"])]),c("div",ir,[c("label",lr,k(e.$t("common.password")),1),m(l,{class:"kn-material-input p-inputtext-sm",type:"password",modelValue:e.mail.PASSWORD,"onUpdate:modelValue":t[7]||(t[7]=g=>e.mail.PASSWORD=g),maxLength:e.documentExecutionMailDialogDescriptor.objectMaxLength},null,8,["modelValue","maxLength"])]),c("div",dr,[c("label",sr,k(e.$t("common.replyTo")),1),m(l,{class:"kn-material-input p-inputtext-sm",modelValue:e.mail.REPLAYTO,"onUpdate:modelValue":t[8]||(t[8]=g=>e.mail.REPLAYTO=g),maxLength:e.documentExecutionMailDialogDescriptor.objectMaxLength,"aria-describedby":"reply-to-help"},null,8,["modelValue","maxLength"]),c("small",cr,k(e.$t("documentExecution.main.replyToHint")),1)])])]),_:1})]),_:1})])]),_:1},8,["contentStyle","visible"])}var kr=_(jo,[["render",pr],["__scopeId","data-v-ee9637f6"]]);const ur={style:{height:"80vh",padding:0,width:"80vw"}},mr=["name","description","dateCreation"],fr={style:{"text-align":"end",width:"5%"}},vr={message:{"align-items":"center",display:"flex","justify-content":"center","text-align":"center"}};var Ct={dialog:ur,globalFilterFields:mr,iconColumn:fr,styles:vr};const gr=V({name:"document-execution-help-dialog",components:{Dialog:G},props:{visible:{type:Boolean},propUrl:{type:String}},emits:["close"],data(){return{documentExecutionSchedulationsTableDescriptor:Ct,url:""}},watch:{propUrl(){this.loadUrl()}},created(){this.loadUrl()},methods:{loadUrl(){this.url=this.propUrl},closeDialog(){this.$emit("close")}}}),hr=["src"];function wr(e,t,a,o,i,r){const n=p("Button"),l=p("Toolbar"),d=p("Dialog");return u(),y(d,{class:"p-fluid kn-dialog--toolbar--primary",contentStyle:e.documentExecutionSchedulationsTableDescriptor.dialog.style,visible:e.visible,modal:!0,closable:!1},{header:b(()=>[m(l,{class:"kn-toolbar kn-toolbar--primary p-p-0 p-m-0 p-col-12"},{start:b(()=>[A(k(e.$t("common.snapshot")),1)]),end:b(()=>[m(n,{icon:"pi pi-times",class:"kn-button p-button-text p-button-rounded",onClick:e.closeDialog},null,8,["onClick"])]),_:1})]),default:b(()=>[c("iframe",{id:"document-execution-snapshot-dialog-iframe",src:e.url},null,8,hr)]),_:1},8,["contentStyle","visible"])}var xr=_(gr,[["render",wr],["__scopeId","data-v-8152affc"]]);const yr=V({name:"document-execution-schedulations-table",components:{Column:wt,DataTable:xt,DocumentExecutionSnapshotDialog:xr,Message:Le},props:{propSchedulations:{type:Array}},emits:["deleteSchedulation","close"],data(){return{documentExecutionSchedulationsTableDescriptor:Ct,schedulations:[],filters:{global:[Mt]},url:"",snapshotDialogVisible:!1,user:null}},watch:{propSchedulations(){this.loadSchedulations()}},setup(){return{store:K()}},created(){this.user=this.store.$state.user,this.loadSchedulations()},methods:{loadSchedulations(){this.schedulations=this.propSchedulations},getFormattedDate(e,t){return ft(e,t)},downloadSnapshot(e){var t;this.url=`/knowage/servlet/AdapterHTTP?NEW_SESSION=TRUE&user_id=${(t=this.user)==null?void 0:t.userUniqueIdentifier}&ACTION_NAME=GET_SNAPSHOT_CONTENT&SNAPSHOT_ID=${e.id}&LIGHT_NAVIGATOR_DISABLED=TRUE&OBJECT_ID=${e.biobjId}`,this.snapshotDialogVisible=!0},deleteSchedulationConfirm(e){this.$confirm.require({message:this.$t("documentExecution.dossier.deleteConfirm"),header:this.$t("documentExecution.dossier.deleteTitle"),icon:"pi pi-exclamation-triangle",accept:()=>this.$emit("deleteSchedulation",e)})},closeTable(){this.schedulations=[],this.$emit("close")}}}),Mr=e=>(bt("data-v-5aa70928"),e=e(),pt(),e),Er={class:"p-grid p-m-0"},Cr={class:"table-header p-d-flex p-ai-center"},Ar={id:"search-container",class:"p-input-icon-left p-mr-3"},Dr=Mr(()=>c("i",{class:"pi pi-search"},null,-1));function $r(e,t,a,o,i,r){const n=p("Button"),l=p("Toolbar"),d=p("Message"),s=p("InputText"),f=p("Column"),v=p("DataTable"),w=p("DocumentExecutionSnapshotDialog"),x=Fe("tooltip");return u(),C("div",Er,[m(l,{class:"kn-toolbar kn-toolbar--primary p-col-12"},{start:b(()=>[A(k(e.$t("documentExecution.main.scheduledExecutions")),1)]),end:b(()=>[m(n,{id:"document-execution-schedulations-close-button",class:"kn-button kn-button--primary",onClick:e.closeTable},{default:b(()=>[A(k(e.$t("common.close")),1)]),_:1},8,["onClick"])]),_:1}),m(v,{value:e.schedulations,id:"old-chedulations-table",class:"p-datatable-sm kn-table p-col-12",dataKey:"id",filters:e.filters,"onUpdate:filters":t[1]||(t[1]=g=>e.filters=g),globalFilterFields:e.documentExecutionSchedulationsTableDescriptor.globalFilterFields,paginator:e.schedulations.length>20,rows:20,responsiveLayout:"stack",breakpoint:"600px"},{empty:b(()=>[m(d,{class:"p-m-2",severity:"info",closable:!1,style:le(e.documentExecutionSchedulationsTableDescriptor.styles.message)},{default:b(()=>[A(k(e.$t("common.info.noDataFound")),1)]),_:1},8,["style"])]),header:b(()=>[c("div",Cr,[c("span",Ar,[Dr,m(s,{class:"kn-material-input",modelValue:e.filters.global.value,"onUpdate:modelValue":t[0]||(t[0]=g=>e.filters.global.value=g),type:"text",placeholder:e.$t("common.search")},null,8,["modelValue","placeholder"])])])]),default:b(()=>[m(f,{class:"kn-truncated",field:"name",header:e.$t("common.name"),key:"name",sortable:!0},null,8,["header"]),m(f,{class:"kn-truncated",field:"description",header:e.$t("common.description"),key:"description",sortable:!0},null,8,["header"]),m(f,{class:"kn-truncated",field:"dateCreation",header:e.$t("common.creationDate"),key:"dateCreation",sortable:!0},{body:b(g=>[A(k(e.getFormattedDate(g.data.dateCreation,"DD/MM/YYYY hh:mm")),1)]),_:1},8,["header"]),m(f,{style:le(e.documentExecutionSchedulationsTableDescriptor.iconColumn.style)},{body:b(g=>[P(m(n,{icon:"pi pi-download",class:"p-button-link",onClick:T=>e.downloadSnapshot(g.data)},null,8,["onClick"]),[[x,e.$t("common.download"),void 0,{top:!0}]]),m(n,{icon:"pi pi-trash",class:"p-button-link",onClick:T=>e.deleteSchedulationConfirm(g.data)},null,8,["onClick"])]),_:1},8,["style"])]),_:1},8,["value","filters","globalFilterFields","paginator"]),m(w,{visible:e.snapshotDialogVisible,propUrl:e.url,onClose:t[2]||(t[2]=g=>e.snapshotDialogVisible=!1)},null,8,["visible","propUrl"])])}var Tr=_(yr,[["render",$r],["__scopeId","data-v-5aa70928"]]);const Sr={style:{width:"50vw"}},zr={message:{"align-items":"center",display:"flex","justify-content":"center","text-align":"center"}};var Nr={dialog:Sr,styles:zr},Ir={},Or=Object.freeze(Object.defineProperty({__proto__:null,default:Ir},Symbol.toStringTag,{value:"Module"})),Vr=jt(Or),Xe=typeof Map=="function"&&Map.prototype,Ee=Object.getOwnPropertyDescriptor&&Xe?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,we=Xe&&Ee&&typeof Ee.get=="function"?Ee.get:null,_r=Xe&&Map.prototype.forEach,Qe=typeof Set=="function"&&Set.prototype,Ce=Object.getOwnPropertyDescriptor&&Qe?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,xe=Qe&&Ce&&typeof Ce.get=="function"?Ce.get:null,Pr=Qe&&Set.prototype.forEach,Rr=typeof WeakMap=="function"&&WeakMap.prototype,ke=Rr?WeakMap.prototype.has:null,Ur=typeof WeakSet=="function"&&WeakSet.prototype,ue=Ur?WeakSet.prototype.has:null,Lr=typeof WeakRef=="function"&&WeakRef.prototype,qe=Lr?WeakRef.prototype.deref:null,Fr=Boolean.prototype.valueOf,Br=Object.prototype.toString,jr=Function.prototype.toString,Xr=String.prototype.match,We=String.prototype.slice,ee=String.prototype.replace,Qr=String.prototype.toUpperCase,Ze=String.prototype.toLowerCase,At=RegExp.prototype.test,et=Array.prototype.concat,X=Array.prototype.join,Wr=Array.prototype.slice,tt=Math.floor,Ie=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Ae=Object.getOwnPropertySymbols,Oe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,de=typeof Symbol=="function"&&typeof Symbol.iterator=="object",O=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===de?"object":"symbol")?Symbol.toStringTag:null,Dt=Object.prototype.propertyIsEnumerable,at=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function ot(e,t){if(e===1/0||e===-1/0||e!==e||e&&e>-1e3&&e<1e3||At.call(/e/,t))return t;var a=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof e=="number"){var o=e<0?-tt(-e):tt(e);if(o!==e){var i=String(o),r=We.call(t,i.length+1);return ee.call(i,a,"$&_")+"."+ee.call(ee.call(r,/([0-9]{3})/g,"$&_"),/_$/,"")}}return ee.call(t,a,"$&_")}var Ve=Vr,rt=Ve.custom,nt=Tt(rt)?rt:null,Jr=function e(t,a,o,i){var r=a||{};if(Z(r,"quoteStyle")&&r.quoteStyle!=="single"&&r.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Z(r,"maxStringLength")&&(typeof r.maxStringLength=="number"?r.maxStringLength<0&&r.maxStringLength!==1/0:r.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var n=Z(r,"customInspect")?r.customInspect:!0;if(typeof n!="boolean"&&n!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Z(r,"indent")&&r.indent!==null&&r.indent!=="	"&&!(parseInt(r.indent,10)===r.indent&&r.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Z(r,"numericSeparator")&&typeof r.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var l=r.numericSeparator;if(typeof t=="undefined")return"undefined";if(t===null)return"null";if(typeof t=="boolean")return t?"true":"false";if(typeof t=="string")return zt(t,r);if(typeof t=="number"){if(t===0)return 1/0/t>0?"0":"-0";var d=String(t);return l?ot(t,d):d}if(typeof t=="bigint"){var s=String(t)+"n";return l?ot(t,s):s}var f=typeof r.depth=="undefined"?5:r.depth;if(typeof o=="undefined"&&(o=0),o>=f&&f>0&&typeof t=="object")return _e(t)?"[Array]":"[Object]";var v=pn(r,o);if(typeof i=="undefined")i=[];else if(St(i,t)>=0)return"[Circular]";function w(D,U,H){if(U&&(i=Wr.call(i),i.push(U)),H){var be={depth:r.depth};return Z(r,"quoteStyle")&&(be.quoteStyle=r.quoteStyle),e(D,be,o+1,i)}return e(D,r,o+1,i)}if(typeof t=="function"&&!it(t)){var x=an(t),g=fe(t,w);return"[Function"+(x?": "+x:" (anonymous)")+"]"+(g.length>0?" { "+X.call(g,", ")+" }":"")}if(Tt(t)){var T=de?ee.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):Oe.call(t);return typeof t=="object"&&!de?pe(T):T}if(sn(t)){for(var h="<"+Ze.call(String(t.nodeName)),M=t.attributes||[],$=0;$<M.length;$++)h+=" "+M[$].name+"="+$t(Hr(M[$].value),"double",r);return h+=">",t.childNodes&&t.childNodes.length&&(h+="..."),h+="</"+Ze.call(String(t.nodeName))+">",h}if(_e(t)){if(t.length===0)return"[]";var F=fe(t,w);return v&&!bn(F)?"["+Pe(F,v)+"]":"[ "+X.call(F,", ")+" ]"}if(Kr(t)){var q=fe(t,w);return!("cause"in Error.prototype)&&"cause"in t&&!Dt.call(t,"cause")?"{ ["+String(t)+"] "+X.call(et.call("[cause]: "+w(t.cause),q),", ")+" }":q.length===0?"["+String(t)+"]":"{ ["+String(t)+"] "+X.call(q,", ")+" }"}if(typeof t=="object"&&n){if(nt&&typeof t[nt]=="function"&&Ve)return Ve(t,{depth:f-o});if(n!=="symbol"&&typeof t.inspect=="function")return t.inspect()}if(on(t)){var ae=[];return _r.call(t,function(D,U){ae.push(w(U,t,!0)+" => "+w(D,t))}),lt("Map",we.call(t),ae,v)}if(ln(t)){var oe=[];return Pr.call(t,function(D){oe.push(w(D,t))}),lt("Set",xe.call(t),oe,v)}if(rn(t))return De("WeakMap");if(dn(t))return De("WeakSet");if(nn(t))return De("WeakRef");if(qr(t))return pe(w(Number(t)));if(en(t))return pe(w(Ie.call(t)));if(Zr(t))return pe(Fr.call(t));if(Gr(t))return pe(w(String(t)));if(!Yr(t)&&!it(t)){var Q=fe(t,w),re=at?at(t)===Object.prototype:t instanceof Object||t.constructor===Object,S=t instanceof Object?"":"null prototype",W=!re&&O&&Object(t)===t&&O in t?We.call(te(t),8,-1):S?"Object":"",B=re||typeof t.constructor!="function"?"":t.constructor.name?t.constructor.name+" ":"",J=B+(W||S?"["+X.call(et.call([],W||[],S||[]),": ")+"] ":"");return Q.length===0?J+"{}":v?J+"{"+Pe(Q,v)+"}":J+"{ "+X.call(Q,", ")+" }"}return String(t)};function $t(e,t,a){var o=(a.quoteStyle||t)==="double"?'"':"'";return o+e+o}function Hr(e){return ee.call(String(e),/"/g,"&quot;")}function _e(e){return te(e)==="[object Array]"&&(!O||!(typeof e=="object"&&O in e))}function Yr(e){return te(e)==="[object Date]"&&(!O||!(typeof e=="object"&&O in e))}function it(e){return te(e)==="[object RegExp]"&&(!O||!(typeof e=="object"&&O in e))}function Kr(e){return te(e)==="[object Error]"&&(!O||!(typeof e=="object"&&O in e))}function Gr(e){return te(e)==="[object String]"&&(!O||!(typeof e=="object"&&O in e))}function qr(e){return te(e)==="[object Number]"&&(!O||!(typeof e=="object"&&O in e))}function Zr(e){return te(e)==="[object Boolean]"&&(!O||!(typeof e=="object"&&O in e))}function Tt(e){if(de)return e&&typeof e=="object"&&e instanceof Symbol;if(typeof e=="symbol")return!0;if(!e||typeof e!="object"||!Oe)return!1;try{return Oe.call(e),!0}catch{}return!1}function en(e){if(!e||typeof e!="object"||!Ie)return!1;try{return Ie.call(e),!0}catch{}return!1}var tn=Object.prototype.hasOwnProperty||function(e){return e in this};function Z(e,t){return tn.call(e,t)}function te(e){return Br.call(e)}function an(e){if(e.name)return e.name;var t=Xr.call(jr.call(e),/^function\s*([\w$]+)/);return t?t[1]:null}function St(e,t){if(e.indexOf)return e.indexOf(t);for(var a=0,o=e.length;a<o;a++)if(e[a]===t)return a;return-1}function on(e){if(!we||!e||typeof e!="object")return!1;try{we.call(e);try{xe.call(e)}catch{return!0}return e instanceof Map}catch{}return!1}function rn(e){if(!ke||!e||typeof e!="object")return!1;try{ke.call(e,ke);try{ue.call(e,ue)}catch{return!0}return e instanceof WeakMap}catch{}return!1}function nn(e){if(!qe||!e||typeof e!="object")return!1;try{return qe.call(e),!0}catch{}return!1}function ln(e){if(!xe||!e||typeof e!="object")return!1;try{xe.call(e);try{we.call(e)}catch{return!0}return e instanceof Set}catch{}return!1}function dn(e){if(!ue||!e||typeof e!="object")return!1;try{ue.call(e,ue);try{ke.call(e,ke)}catch{return!0}return e instanceof WeakSet}catch{}return!1}function sn(e){return!e||typeof e!="object"?!1:typeof HTMLElement!="undefined"&&e instanceof HTMLElement?!0:typeof e.nodeName=="string"&&typeof e.getAttribute=="function"}function zt(e,t){if(e.length>t.maxStringLength){var a=e.length-t.maxStringLength,o="... "+a+" more character"+(a>1?"s":"");return zt(We.call(e,0,t.maxStringLength),t)+o}var i=ee.call(ee.call(e,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,cn);return $t(i,"single",t)}function cn(e){var t=e.charCodeAt(0),a={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return a?"\\"+a:"\\x"+(t<16?"0":"")+Qr.call(t.toString(16))}function pe(e){return"Object("+e+")"}function De(e){return e+" { ? }"}function lt(e,t,a,o){var i=o?Pe(a,o):X.call(a,", ");return e+" ("+t+") {"+i+"}"}function bn(e){for(var t=0;t<e.length;t++)if(St(e[t],`
`)>=0)return!1;return!0}function pn(e,t){var a;if(e.indent==="	")a="	";else if(typeof e.indent=="number"&&e.indent>0)a=X.call(Array(e.indent+1)," ");else return null;return{base:a,prev:X.call(Array(t+1),a)}}function Pe(e,t){if(e.length===0)return"";var a=`
`+t.prev+t.base;return a+X.call(e,","+a)+`
`+t.prev}function fe(e,t){var a=_e(e),o=[];if(a){o.length=e.length;for(var i=0;i<e.length;i++)o[i]=Z(e,i)?t(e[i],e):""}var r=typeof Ae=="function"?Ae(e):[],n;if(de){n={};for(var l=0;l<r.length;l++)n["$"+r[l]]=r[l]}for(var d in e)!Z(e,d)||a&&String(Number(d))===d&&d<e.length||de&&n["$"+d]instanceof Symbol||(At.call(/[^\w$]/,d)?o.push(t(d,e)+": "+t(e[d],e)):o.push(d+": "+t(e[d],e)));if(typeof Ae=="function")for(var s=0;s<r.length;s++)Dt.call(e,r[s])&&o.push("["+t(r[s])+"]: "+t(e[r[s]],e));return o}var Je=Xt,ce=Qt,kn=Jr,un=Je("%TypeError%"),ve=Je("%WeakMap%",!0),ge=Je("%Map%",!0),mn=ce("WeakMap.prototype.get",!0),fn=ce("WeakMap.prototype.set",!0),vn=ce("WeakMap.prototype.has",!0),gn=ce("Map.prototype.get",!0),hn=ce("Map.prototype.set",!0),wn=ce("Map.prototype.has",!0),He=function(e,t){for(var a=e,o;(o=a.next)!==null;a=o)if(o.key===t)return a.next=o.next,o.next=e.next,e.next=o,o},xn=function(e,t){var a=He(e,t);return a&&a.value},yn=function(e,t,a){var o=He(e,t);o?o.value=a:e.next={key:t,next:e.next,value:a}},Mn=function(e,t){return!!He(e,t)},En=function(){var t,a,o,i={assert:function(r){if(!i.has(r))throw new un("Side channel does not contain "+kn(r))},get:function(r){if(ve&&r&&(typeof r=="object"||typeof r=="function")){if(t)return mn(t,r)}else if(ge){if(a)return gn(a,r)}else if(o)return xn(o,r)},has:function(r){if(ve&&r&&(typeof r=="object"||typeof r=="function")){if(t)return vn(t,r)}else if(ge){if(a)return wn(a,r)}else if(o)return Mn(o,r);return!1},set:function(r,n){ve&&r&&(typeof r=="object"||typeof r=="function")?(t||(t=new ve),fn(t,r,n)):ge?(a||(a=new ge),hn(a,r,n)):(o||(o={key:{},next:null}),yn(o,r,n))}};return i},Cn=String.prototype.replace,An=/%20/g,$e={RFC1738:"RFC1738",RFC3986:"RFC3986"},Ye={default:$e.RFC3986,formatters:{RFC1738:function(e){return Cn.call(e,An,"+")},RFC3986:function(e){return String(e)}},RFC1738:$e.RFC1738,RFC3986:$e.RFC3986},Dn=Ye,Te=Object.prototype.hasOwnProperty,ne=Array.isArray,j=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),$n=function(t){for(;t.length>1;){var a=t.pop(),o=a.obj[a.prop];if(ne(o)){for(var i=[],r=0;r<o.length;++r)typeof o[r]!="undefined"&&i.push(o[r]);a.obj[a.prop]=i}}},Nt=function(t,a){for(var o=a&&a.plainObjects?Object.create(null):{},i=0;i<t.length;++i)typeof t[i]!="undefined"&&(o[i]=t[i]);return o},Tn=function e(t,a,o){if(!a)return t;if(typeof a!="object"){if(ne(t))t.push(a);else if(t&&typeof t=="object")(o&&(o.plainObjects||o.allowPrototypes)||!Te.call(Object.prototype,a))&&(t[a]=!0);else return[t,a];return t}if(!t||typeof t!="object")return[t].concat(a);var i=t;return ne(t)&&!ne(a)&&(i=Nt(t,o)),ne(t)&&ne(a)?(a.forEach(function(r,n){if(Te.call(t,n)){var l=t[n];l&&typeof l=="object"&&r&&typeof r=="object"?t[n]=e(l,r,o):t.push(r)}else t[n]=r}),t):Object.keys(a).reduce(function(r,n){var l=a[n];return Te.call(r,n)?r[n]=e(r[n],l,o):r[n]=l,r},i)},Sn=function(t,a){return Object.keys(a).reduce(function(o,i){return o[i]=a[i],o},t)},zn=function(e,t,a){var o=e.replace(/\+/g," ");if(a==="iso-8859-1")return o.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(o)}catch{return o}},Nn=function(t,a,o,i,r){if(t.length===0)return t;var n=t;if(typeof t=="symbol"?n=Symbol.prototype.toString.call(t):typeof t!="string"&&(n=String(t)),o==="iso-8859-1")return escape(n).replace(/%u[0-9a-f]{4}/gi,function(f){return"%26%23"+parseInt(f.slice(2),16)+"%3B"});for(var l="",d=0;d<n.length;++d){var s=n.charCodeAt(d);if(s===45||s===46||s===95||s===126||s>=48&&s<=57||s>=65&&s<=90||s>=97&&s<=122||r===Dn.RFC1738&&(s===40||s===41)){l+=n.charAt(d);continue}if(s<128){l=l+j[s];continue}if(s<2048){l=l+(j[192|s>>6]+j[128|s&63]);continue}if(s<55296||s>=57344){l=l+(j[224|s>>12]+j[128|s>>6&63]+j[128|s&63]);continue}d+=1,s=65536+((s&1023)<<10|n.charCodeAt(d)&1023),l+=j[240|s>>18]+j[128|s>>12&63]+j[128|s>>6&63]+j[128|s&63]}return l},In=function(t){for(var a=[{obj:{o:t},prop:"o"}],o=[],i=0;i<a.length;++i)for(var r=a[i],n=r.obj[r.prop],l=Object.keys(n),d=0;d<l.length;++d){var s=l[d],f=n[s];typeof f=="object"&&f!==null&&o.indexOf(f)===-1&&(a.push({obj:n,prop:s}),o.push(f))}return $n(a),t},On=function(t){return Object.prototype.toString.call(t)==="[object RegExp]"},Vn=function(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))},_n=function(t,a){return[].concat(t,a)},Pn=function(t,a){if(ne(t)){for(var o=[],i=0;i<t.length;i+=1)o.push(a(t[i]));return o}return a(t)},It={arrayToObject:Nt,assign:Sn,combine:_n,compact:In,decode:zn,encode:Nn,isBuffer:Vn,isRegExp:On,maybeMap:Pn,merge:Tn},Ot=En,Re=It,me=Ye,Rn=Object.prototype.hasOwnProperty,dt={brackets:function(t){return t+"[]"},comma:"comma",indices:function(t,a){return t+"["+a+"]"},repeat:function(t){return t}},Y=Array.isArray,Un=String.prototype.split,Ln=Array.prototype.push,Vt=function(e,t){Ln.apply(e,Y(t)?t:[t])},Fn=Date.prototype.toISOString,st=me.default,N={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:Re.encode,encodeValuesOnly:!1,format:st,formatter:me.formatters[st],indices:!1,serializeDate:function(t){return Fn.call(t)},skipNulls:!1,strictNullHandling:!1},Bn=function(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"},Se={},jn=function e(t,a,o,i,r,n,l,d,s,f,v,w,x,g,T,h){for(var M=t,$=h,F=0,q=!1;($=$.get(Se))!==void 0&&!q;){var ae=$.get(t);if(F+=1,typeof ae!="undefined"){if(ae===F)throw new RangeError("Cyclic object value");q=!0}typeof $.get(Se)=="undefined"&&(F=0)}if(typeof d=="function"?M=d(a,M):M instanceof Date?M=v(M):o==="comma"&&Y(M)&&(M=Re.maybeMap(M,function(ye){return ye instanceof Date?v(ye):ye})),M===null){if(r)return l&&!g?l(a,N.encoder,T,"key",w):a;M=""}if(Bn(M)||Re.isBuffer(M)){if(l){var oe=g?a:l(a,N.encoder,T,"key",w);if(o==="comma"&&g){for(var Q=Un.call(String(M),","),re="",S=0;S<Q.length;++S)re+=(S===0?"":",")+x(l(Q[S],N.encoder,T,"value",w));return[x(oe)+(i&&Y(M)&&Q.length===1?"[]":"")+"="+re]}return[x(oe)+"="+x(l(M,N.encoder,T,"value",w))]}return[x(a)+"="+x(String(M))]}var W=[];if(typeof M=="undefined")return W;var B;if(o==="comma"&&Y(M))B=[{value:M.length>0?M.join(",")||null:void 0}];else if(Y(d))B=d;else{var J=Object.keys(M);B=s?J.sort(s):J}for(var D=i&&Y(M)&&M.length===1?a+"[]":a,U=0;U<B.length;++U){var H=B[U],be=typeof H=="object"&&typeof H.value!="undefined"?H.value:M[H];if(!(n&&be===null)){var Pt=Y(M)?typeof o=="function"?o(D,H):D:D+(f?"."+H:"["+H+"]");h.set(t,F);var Ke=Ot();Ke.set(Se,h),Vt(W,e(be,Pt,o,i,r,n,l,d,s,f,v,w,x,g,T,Ke))}}return W},Xn=function(t){if(!t)return N;if(t.encoder!==null&&typeof t.encoder!="undefined"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");var a=t.charset||N.charset;if(typeof t.charset!="undefined"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var o=me.default;if(typeof t.format!="undefined"){if(!Rn.call(me.formatters,t.format))throw new TypeError("Unknown format option provided.");o=t.format}var i=me.formatters[o],r=N.filter;return(typeof t.filter=="function"||Y(t.filter))&&(r=t.filter),{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:N.addQueryPrefix,allowDots:typeof t.allowDots=="undefined"?N.allowDots:!!t.allowDots,charset:a,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:N.charsetSentinel,delimiter:typeof t.delimiter=="undefined"?N.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:N.encode,encoder:typeof t.encoder=="function"?t.encoder:N.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:N.encodeValuesOnly,filter:r,format:o,formatter:i,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:N.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:N.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:N.strictNullHandling}},Qn=function(e,t){var a=e,o=Xn(t),i,r;typeof o.filter=="function"?(r=o.filter,a=r("",a)):Y(o.filter)&&(r=o.filter,i=r);var n=[];if(typeof a!="object"||a===null)return"";var l;t&&t.arrayFormat in dt?l=t.arrayFormat:t&&"indices"in t?l=t.indices?"indices":"repeat":l="indices";var d=dt[l];if(t&&"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var s=d==="comma"&&t&&t.commaRoundTrip;i||(i=Object.keys(a)),o.sort&&i.sort(o.sort);for(var f=Ot(),v=0;v<i.length;++v){var w=i[v];o.skipNulls&&a[w]===null||Vt(n,jn(a[w],w,d,s,o.strictNullHandling,o.skipNulls,o.encode?o.encoder:null,o.filter,o.sort,o.allowDots,o.serializeDate,o.format,o.formatter,o.encodeValuesOnly,o.charset,f))}var x=n.join(o.delimiter),g=o.addQueryPrefix===!0?"?":"";return o.charsetSentinel&&(o.charset==="iso-8859-1"?g+="utf8=%26%2310003%3B&":g+="utf8=%E2%9C%93&"),x.length>0?g+x:""},se=It,Ue=Object.prototype.hasOwnProperty,Wn=Array.isArray,z={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:se.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},Jn=function(e){return e.replace(/&#(\d+);/g,function(t,a){return String.fromCharCode(parseInt(a,10))})},_t=function(e,t){return e&&typeof e=="string"&&t.comma&&e.indexOf(",")>-1?e.split(","):e},Hn="utf8=%26%2310003%3B",Yn="utf8=%E2%9C%93",Kn=function(t,a){var o={},i=a.ignoreQueryPrefix?t.replace(/^\?/,""):t,r=a.parameterLimit===1/0?void 0:a.parameterLimit,n=i.split(a.delimiter,r),l=-1,d,s=a.charset;if(a.charsetSentinel)for(d=0;d<n.length;++d)n[d].indexOf("utf8=")===0&&(n[d]===Yn?s="utf-8":n[d]===Hn&&(s="iso-8859-1"),l=d,d=n.length);for(d=0;d<n.length;++d)if(d!==l){var f=n[d],v=f.indexOf("]="),w=v===-1?f.indexOf("="):v+1,x,g;w===-1?(x=a.decoder(f,z.decoder,s,"key"),g=a.strictNullHandling?null:""):(x=a.decoder(f.slice(0,w),z.decoder,s,"key"),g=se.maybeMap(_t(f.slice(w+1),a),function(T){return a.decoder(T,z.decoder,s,"value")})),g&&a.interpretNumericEntities&&s==="iso-8859-1"&&(g=Jn(g)),f.indexOf("[]=")>-1&&(g=Wn(g)?[g]:g),Ue.call(o,x)?o[x]=se.combine(o[x],g):o[x]=g}return o},Gn=function(e,t,a,o){for(var i=o?t:_t(t,a),r=e.length-1;r>=0;--r){var n,l=e[r];if(l==="[]"&&a.parseArrays)n=[].concat(i);else{n=a.plainObjects?Object.create(null):{};var d=l.charAt(0)==="["&&l.charAt(l.length-1)==="]"?l.slice(1,-1):l,s=parseInt(d,10);!a.parseArrays&&d===""?n={0:i}:!isNaN(s)&&l!==d&&String(s)===d&&s>=0&&a.parseArrays&&s<=a.arrayLimit?(n=[],n[s]=i):d!=="__proto__"&&(n[d]=i)}i=n}return i},qn=function(t,a,o,i){if(!!t){var r=o.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,n=/(\[[^[\]]*])/,l=/(\[[^[\]]*])/g,d=o.depth>0&&n.exec(r),s=d?r.slice(0,d.index):r,f=[];if(s){if(!o.plainObjects&&Ue.call(Object.prototype,s)&&!o.allowPrototypes)return;f.push(s)}for(var v=0;o.depth>0&&(d=l.exec(r))!==null&&v<o.depth;){if(v+=1,!o.plainObjects&&Ue.call(Object.prototype,d[1].slice(1,-1))&&!o.allowPrototypes)return;f.push(d[1])}return d&&f.push("["+r.slice(d.index)+"]"),Gn(f,a,o,i)}},Zn=function(t){if(!t)return z;if(t.decoder!==null&&t.decoder!==void 0&&typeof t.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof t.charset!="undefined"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var a=typeof t.charset=="undefined"?z.charset:t.charset;return{allowDots:typeof t.allowDots=="undefined"?z.allowDots:!!t.allowDots,allowPrototypes:typeof t.allowPrototypes=="boolean"?t.allowPrototypes:z.allowPrototypes,allowSparse:typeof t.allowSparse=="boolean"?t.allowSparse:z.allowSparse,arrayLimit:typeof t.arrayLimit=="number"?t.arrayLimit:z.arrayLimit,charset:a,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:z.charsetSentinel,comma:typeof t.comma=="boolean"?t.comma:z.comma,decoder:typeof t.decoder=="function"?t.decoder:z.decoder,delimiter:typeof t.delimiter=="string"||se.isRegExp(t.delimiter)?t.delimiter:z.delimiter,depth:typeof t.depth=="number"||t.depth===!1?+t.depth:z.depth,ignoreQueryPrefix:t.ignoreQueryPrefix===!0,interpretNumericEntities:typeof t.interpretNumericEntities=="boolean"?t.interpretNumericEntities:z.interpretNumericEntities,parameterLimit:typeof t.parameterLimit=="number"?t.parameterLimit:z.parameterLimit,parseArrays:t.parseArrays!==!1,plainObjects:typeof t.plainObjects=="boolean"?t.plainObjects:z.plainObjects,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:z.strictNullHandling}},ei=function(e,t){var a=Zn(t);if(e===""||e===null||typeof e=="undefined")return a.plainObjects?Object.create(null):{};for(var o=typeof e=="string"?Kn(e,a):e,i=a.plainObjects?Object.create(null):{},r=Object.keys(o),n=0;n<r.length;++n){var l=r[n],d=qn(l,o[l],a,typeof e=="string");i=se.merge(i,d,a)}return a.allowSparse===!0?i:se.compact(i)},ti=Qn,ai=ei,oi=Ye,ct={formats:oi,parse:ai,stringify:ti};const ri=V({name:"document-execution-link-dialog",components:{Dialog:G,Textarea:yt},props:{visible:{type:Boolean},linkInfo:{type:Object},embedHTML:{type:Boolean},propDocument:{type:Object},parameters:{type:Array}},emits:["close"],data(){return{documentExecutionLinkDialogDescriptor:Nr,publicUrl:"",document:null,linkParameters:[]}},watch:{visible(){this.loadLink()},propDocument(){this.loadLink()},linkParameters(){this.loadLink()}},setup(){return{store:K()}},created(){this.loadLink()},methods:{loadLink(){this.loadDocument(),this.loadParameters(),this.getPublicUrl()},loadDocument(){this.document=this.propDocument},loadParameters(){this.linkParameters=this.parameters},getPublicUrl(){const e=this.store.$state.user.organization;!this.document||(this.document.typeCode==="DATAMART"||this.document.typeCode==="DOSSIER"?this.embedHTML?this.publicUrl='<iframe width="600" height="600" src='+this.$route.fullPath+' frameborder="0"></iframe>':this.publicUrl=""+this.$route.fullPath:this.embedHTML?this.publicUrl=`<iframe width="600" height="600" src=/knowage/servlet/AdapterHTTP?ACTION_NAME=EXECUTE_DOCUMENT_ACTION&OBJECT_LABEL=${this.document.label}&TOOLBAR_VISIBLE=true&ORGANIZATION=${e}&NEW_SESSION=true&PARAMETERS=${ct.stringify(this.linkParameters)} frameborder="0"></iframe>`:this.publicUrl=`/knowage/servlet/AdapterHTTP?ACTION_NAME=EXECUTE_DOCUMENT_ACTION&OBJECT_LABEL=${this.document.label}&TOOLBAR_VISIBLE=true&ORGANIZATION=${e}&NEW_SESSION=true&PARAMETERS=${ct.stringify(this.linkParameters)}`)},closeDialog(){this.$emit("close"),this.publicUrl=""}}}),ni={class:"p-m-2"},ii={key:0,class:"p-m-2"},li=c("i",{class:"fa fa-exclamation-triangle p-mr-2"},null,-1),di={class:"p-m-2"},si={class:"p-fluid p-formgrid p-grid p-m-2"},ci={class:"p-field p-col-12"},bi={class:"p-d-flex p-flex-row p-jc-end"};function pi(e,t,a,o,i,r){const n=p("Toolbar"),l=p("Textarea"),d=p("InputText"),s=p("Button"),f=p("Dialog");return u(),y(f,{class:"p-fluid kn-dialog--toolbar--primary",contentStyle:e.documentExecutionLinkDialogDescriptor.dialog.style,visible:e.visible,modal:!0,closable:!1},{header:b(()=>[m(n,{class:"kn-toolbar kn-toolbar--primary p-p-0 p-m-0 p-col-12"},{start:b(()=>[A(k(e.$t("documentExecution.main.linkToDocument ")),1)]),_:1})]),footer:b(()=>[c("div",bi,[m(s,{class:"kn-button kn-button--primary",onClick:e.closeDialog},{default:b(()=>[A(k(e.$t("common.cancel")),1)]),_:1},8,["onClick"])])]),default:b(()=>[c("div",ni,[e.linkInfo.isPublic?E("",!0):(u(),C("div",ii,[c("p",null,[li,c("span",null,k(e.$t("documentExecution.main.publicUrlExecutionDisabled")),1)])])),c("div",di,[c("p",null,k(e.$t("documentExecution.main.copyLinkAndShare")),1)]),c("div",si,[c("div",ci,[e.embedHTML?(u(),y(l,{key:0,class:"kn-material-input",modelValue:e.publicUrl,"onUpdate:modelValue":t[0]||(t[0]=v=>e.publicUrl=v),rows:6},null,8,["modelValue"])):(u(),y(d,{key:1,class:"kn-material-input p-inputtext-sm",modelValue:e.publicUrl,"onUpdate:modelValue":t[1]||(t[1]=v=>e.publicUrl=v)},null,8,["modelValue"]))])])])]),_:1},8,["contentStyle","visible"])}var ki=_(ri,[["render",pi]]);const ui=[{field:"partial",header:"documentExecution.dossier.headers.partial"},{field:"total",header:"documentExecution.dossier.headers.total"},{field:"status",header:"documentExecution.dossier.headers.status"}],mi={iconColumn:{style:{"text-align":"end",width:"10%"}}},fi={activity:[{fieldName:"activityName",validators:[{key:"required"},{key:"regex",validator:{type:"extendedAlphanumericRegex"}}]}]};var ze={columns:ui,table:mi,validations:fi};const vi=V({name:"dossier",components:{KnInputFile:ht,Menu:la,Card:Wt,Column:wt,DataTable:xt,KnHint:ia,KnValidationMessages:oa},props:{id:{type:String,required:!1},reloadTrigger:{type:Boolean},filterData:Object},computed:{showHint(){return this.dossierActivities.length==0},buttonDisabled(){return this.v$.$invalid}},watch:{async reloadTrigger(){this.getDossierTemplate(),this.getDossierActivities(),this.interval=setInterval(()=>{this.getDossierActivities()},1e4)}},setup(){return{store:K()}},created(){this.getDossierTemplate(),this.getDossierActivities(),this.interval=setInterval(()=>{this.getDossierActivities()},1e4)},deactivated(){clearInterval(this.interval)},data(){return{v$:ra(),dossierDescriptor:ze,activity:{activityName:""},loading:!1,triggerUpload:!1,uploading:!1,interval:null,dossierActivities:[],menuButtons:[],columns:ze.columns,jsonTemplate:{},filters:{global:[Mt]}}},validations(){return{activity:na("activity",ze.validations.activity)}},methods:{formatDate(e){return Jt(e,{dateStyle:"short",timeStyle:"short"})},dateCheck(e){return Date.now()-e.creationDate<864e5&&e.status==="STARTED"},async getDossierActivities(){this.loading=!0,await this.$http.get(`/knowage/restful-services/dossier/activities/${this.id}`).then(e=>{this.dossierActivities=[...e.data]}).finally(()=>{this.loading=!1})},async getDossierTemplate(){var o;this.loading=!0;let e=`/knowagedossierengine/api/start/dossierTemplate?documentId=${this.id}`,t=this.filterData?this.filterData:{};(o=t.filterStatus)==null||o.forEach(i=>{["dataDependsOnParameters","dataDependentParameters","lovDependsOnParameters","lovDependentParameters","dependsOnParameters","dependentParameters"].forEach(n=>delete i[n])});let a={headers:{Accept:"application/json, text/plain, */*"},data:encodeURIComponent(JSON.stringify(t))};await this.$http.post(e,a).then(i=>{this.jsonTemplate={...i.data}}).catch(i=>console.log(i)).finally(()=>{this.loading=!1})},deleteDossierConfirm(e){this.$confirm.require({message:this.$t("documentExecution.dossier.deleteConfirm"),header:this.$t("documentExecution.dossier.deleteTitle"),icon:"pi pi-exclamation-triangle",accept:()=>this.deleteDossier(e)})},async deleteDossier(e){let t=`/knowage/restful-services/dossier/activity/${e.id}`;e.status=="DOWNLOAD"||e.status=="ERROR"||!this.dateCheck(e)?await this.$http.delete(t,{headers:{Accept:"application/json, text/plain, */*"}}).then(()=>{this.store.setInfo({title:this.$t("common.toast.deleteTitle"),msg:this.$t("documentExecution.dossier.deleteSuccess")}),this.getDossierActivities()}).catch(a=>{a&&this.store.setError({title:this.$t("common.error.generic"),msg:a.message})}):this.store.setError({title:this.$t("common.error.generic"),msg:this.$t("documentExecution.dossier.progressNotFinished")})},async createNewActivity(){let e=`/knowagedossierengine/api/dossier/run?activityName=${this.activity.activityName}&documentId=${this.id}`;await this.$http.post(e,this.jsonTemplate,{headers:{Accept:"application/json, text/plain, */*"}}).then(t=>{t.data.errors?this.store.setError({title:this.$t("common.error.saving"),msg:t.data.errors}):this.store.setInfo({title:this.$t("common.save"),msg:this.$t("documentExecution.dossier.saveSuccess")})}),this.getDossierActivities()},async downloadActivity(e){if(e.status=="ERROR")if(e.hasBinContent){var t=`/knowagedossierengine/restful-services/dossier/activity/${e.id}/txt?activityName=${e.activity}`;window.open(t)}else await this.$http.get(`/knowage/restful-services/dossier/random-key/${e.progressId}`).then(a=>{var o=`../api/start/errorFile?activityId=${e.id}&randomKey=${a.data}&activityName=${e.activity}`;this.jsonTemplate.PPT_TEMPLATE!=null?(o+="&type=PPT",o+="&templateName="+this.jsonTemplate.PPT_TEMPLATE.name):this.jsonTemplate.DOC_TEMPLATE!=null?(o+="&type=DOC",o+="&templateName="+this.jsonTemplate.DOC_TEMPLATE.name):(o+="&type=PPTV2",o+="&templateName="+this.jsonTemplate.PPT_TEMPLATE_V2.name),t="/knowage/restful-services/"+o,window.open(t),a.data.errors&&this.store.setError({title:this.$t("common.error.generic"),msg:a.data.errors[0].message})});else e.partial==e.total?e.hasBinContent?(t=`/knowage/restful-services/dossier/activity/${e.id}/pptx?activityName=${e.activity}`,window.open(t)):e.hasDocBinContent?(t=`/knowage/restful-services/dossier/activity/${e.id}/doc?activityName=${e.activity}`,window.open(t)):e.hasPptV2BinContent?(t=`/knowage/restful-services/dossier/activity/${e.id}/pptv2?activityName=${e.activity}`,window.open(t)):(t=`/knowage/restful-services/dossier/random-key/${e.progressId}`,await this.$http.get(t,{headers:{Accept:"application/json, text/plain, */*"}}).then(a=>{this.jsonTemplate.PPT_TEMPLATE!=null?this.storePPT(e.id,a.data,e.activity):this.jsonTemplate.DOC_TEMPLATE!=null?this.storeDOC(e.id,a.data,e.activity):this.storePPTV2(e.id,a.data,e.activity),a.data.errors&&this.store.setError({title:this.$t("common.error.generic"),msg:a.data.errors[0].message})})):this.store.setError({title:this.$t("common.error.generic"),msg:this.$t("documentExecution.dossier.progressNotFinished")})},storePPT(e,t,a){let o="generatePPT",i=this.jsonTemplate.PPT_TEMPLATE.name;this.storeDossier(e,t,a,o,i)},storePPTV2(e,t,a){let o="generatePPTV2",i=this.jsonTemplate.PPT_TEMPLATE_V2.name;this.storeDossier(e,t,a,o,i)},storeDOC(e,t,a){let o="generateDOC",i=this.jsonTemplate.DOC_TEMPLATE.name;this.storeDossier(e,t,a,o,i)},storeDossier(e,t,a,o,i){var r="/knowagedossierengine/api/start/"+o+`?activityId=${e}&randomKey=${t}&templateName=${i}&activityName=${a}`;window.open(r)},showMenu(e){this.createMenuItems(),this.$refs.optionsMenu.toggle(e)},createMenuItems(){this.menuButtons=[],this.menuButtons.push({key:"1",visible:this.templateOptionEnabled("uploadable"),icon:"fas fa-upload",label:this.$t("documentExecution.dossier.uploadTemplate"),command:()=>this.setUploadType()},{key:"2",visible:this.templateOptionEnabled("downloadable"),icon:"fas fa-download",label:this.$t("documentExecution.dossier.downloadTemplate"),command:()=>this.downloadTemplate()})},templateOptionEnabled(e){var a,o,i,r,n,l,d,s,f;var t=!1;return this.jsonTemplate&&((a=this.jsonTemplate)==null?void 0:a.PPT_TEMPLATE)?t=(i=(o=this.jsonTemplate)==null?void 0:o.PPT_TEMPLATE)==null?void 0:i[e]:this.jsonTemplate&&((r=this.jsonTemplate)==null?void 0:r.PPT_TEMPLATE_V2)?t=(l=(n=this.jsonTemplate)==null?void 0:n.PPT_TEMPLATE_V2)==null?void 0:l[e]:this.jsonTemplate&&((d=this.jsonTemplate)==null?void 0:d.DOC_TEMPLATE)&&(t=(f=(s=this.jsonTemplate)==null?void 0:s.DOC_TEMPLATE)==null?void 0:f[e]),t},async downloadTemplate(){var t,a,o,i,r,n;if(this.jsonTemplate.PPT_TEMPLATE==null){var e=(a=(t=this.jsonTemplate)==null?void 0:t.DOC_TEMPLATE)!=null&&a.name?(i=(o=this.jsonTemplate)==null?void 0:o.DOC_TEMPLATE)==null?void 0:i.name:(n=(r=this.jsonTemplate)==null?void 0:r.PPT_TEMPLATE_V2)==null?void 0:n.name;await this.$http.get("/knowage/restful-services/dossier/checkPathFile?templateName="+e).then(l=>{l.data.STATUS=="KO"?this.store.setInfo({title:this.$t("common.error.generic"),msg:this.$t("documentExecution.dossier.templateDownloadError")}):l.data.STATUS=="OK"&&window.open("/knowage/restful-services/dossier/resourcePath?templateName="+e)}).catch(l=>{l&&this.store.setError({title:this.$t("common.error.generic"),msg:l.message})})}else{var e=this.jsonTemplate.PPT_TEMPLATE.name;window.open("/knowage/restful-services/resourcePath?templateName="+e)}},setUploadType(){this.triggerUpload=!1,setTimeout(()=>this.triggerUpload=!0,200)},startTemplateUpload(e){this.uploading=!0,this.uploadTemplate(e.target.files[0]),this.triggerUpload=!1,setTimeout(()=>this.uploading=!1,200)},async uploadTemplate(e){var t=new FormData;t.append("file",e),await this.$http.post("/knowage/restful-services/dossier/importTemplateFile",t,{headers:{"Content-Type":"multipart/form-data","X-Disable-Errors":"true"}}).then(async()=>{this.store.setInfo({title:this.$t("common.toast.success"),msg:this.$t("common.toast.uploadSuccess")})}).catch(()=>this.store.setError({title:this.$t("common.toast.errorTitle"),msg:this.$t("documentExecution.dossier.templateUploadError")})).finally(()=>this.triggerUpload=!1)}}}),gi={class:"kn-width-full"},hi={class:"p-fluid p-formgrid p-grid"},wi={class:"p-field p-col-12 p-md-10"},xi={class:"p-float-label"},yi={for:"activityName",class:"kn-material-input-label"},Mi={class:"p-field p-md-2"},Ei={class:"table-header"},Ci={class:"p-input-icon-left"},Ai=c("i",{class:"pi pi-search"},null,-1);function Di(e,t,a,o,i,r){const n=p("Button"),l=p("Toolbar"),d=p("InputText"),s=p("KnValidationMessages"),f=p("Card"),v=p("KnHint"),w=p("Column"),x=p("DataTable"),g=p("Menu"),T=p("KnInputFile");return u(),C(R,null,[c("div",gi,[m(f,{class:"p-m-3"},{header:b(()=>[m(l,{class:"kn-toolbar kn-toolbar--secondary"},{start:b(()=>[A(k(e.$t("common.details")),1)]),end:b(()=>[e.templateOptionEnabled("uploadable")||e.templateOptionEnabled("downloadable")?(u(),y(n,{key:0,icon:"fas fa-ellipsis-v kn-cursor-pointer",class:"p-button-text p-button-rounded p-button-plain",onClick:e.showMenu},null,8,["onClick"])):E("",!0)]),_:1})]),content:b(()=>[c("form",hi,[c("div",wi,[c("span",xi,[m(d,{id:"activityName",class:I(["kn-material-input p-mb-2",{"p-invalid":e.v$.activity.activityName.$invalid&&e.v$.activity.activityName.$dirty}]),type:"text",modelValue:e.v$.activity.activityName.$model,"onUpdate:modelValue":t[0]||(t[0]=h=>e.v$.activity.activityName.$model=h),modelModifiers:{trim:!0},maxLength:"100",onBlur:t[1]||(t[1]=h=>e.v$.activity.activityName.$touch()),"data-test":"activityName-input"},null,8,["modelValue","class"]),c("label",yi,k(e.$t("documentExecution.dossier.headers.activity"))+" * ",1)]),m(s,{vComp:e.v$.activity.activityName,additionalTranslateParams:{fieldName:e.$t("documentExecution.dossier.headers.activity")}},null,8,["vComp","additionalTranslateParams"])]),c("div",Mi,[m(n,{class:"kn-button p-button-text",disabled:e.buttonDisabled,label:e.$t("documentExecution.dossier.launchActivity"),onClick:e.createNewActivity,"data-test":"input-button"},null,8,["disabled","label","onClick"])])])]),_:1}),m(f,{class:"p-m-3"},{header:b(()=>[m(l,{class:"kn-toolbar kn-toolbar--secondary"},{start:b(()=>[A(k(e.$t("documentExecution.dossier.launchedActivities")),1)]),_:1})]),content:b(()=>[e.showHint?(u(),y(v,{key:0,title:"documentExecution.dossier.title",hint:"documentExecution.dossier.hint","data-test":"hint"},null,8,["title","hint"])):(u(),y(x,{key:1,value:e.dossierActivities,filters:e.filters,"onUpdate:filters":t[3]||(t[3]=h=>e.filters=h),scrollable:!0,scrollHeight:"40vh",rows:20,class:"p-datatable-sm kn-table",dataKey:"id",responsiveLayout:"stack",breakpoint:"960px","data-test":"activities-table"},{header:b(()=>[c("div",Ei,[c("span",Ci,[Ai,m(d,{class:"kn-material-input",modelValue:e.filters.global.value,"onUpdate:modelValue":t[2]||(t[2]=h=>e.filters.global.value=h),type:"text",placeholder:e.$t("common.search"),badge:"0"},null,8,["modelValue","placeholder"])])])]),empty:b(()=>[A(k(e.$t("common.info.noDataFound")),1)]),filter:b(({filterModel:h})=>[m(d,{type:"text",modelValue:h.value,"onUpdate:modelValue":M=>h.value=M,class:"p-column-filter"},null,8,["modelValue","onUpdate:modelValue"])]),default:b(()=>[m(w,{field:"activity",header:e.$t("documentExecution.dossier.headers.activity"),sortable:!0},null,8,["header"]),m(w,{field:"creationDate",header:e.$t("common.creationDate"),sortable:!0,dataType:"date"},{body:b(({data:h})=>[A(k(e.formatDate(h.creationDate)),1)]),_:1},8,["header"]),(u(!0),C(R,null,L(e.columns,h=>(u(),y(w,{field:h.field,header:e.$t(h.header),key:h.field,style:le(h.style),class:"kn-truncated",sortable:!0},null,8,["field","header","style"]))),128)),m(w,{header:"",style:le(e.dossierDescriptor.table.iconColumn.style),onRowClick:h=>!1},{body:b(h=>[m(n,{icon:"pi pi-download",class:"p-button-link",onClick:M=>e.downloadActivity(h.data)},null,8,["onClick"]),m(n,{icon:"pi pi-trash",class:"p-button-link",disabled:e.dateCheck(h.data),onClick:M=>e.deleteDossierConfirm(h.data),"data-test":"delete-button"},null,8,["disabled","onClick"])]),_:1},8,["style"])]),_:1},8,["value","filters"]))]),_:1})]),m(g,{id:"optionsMenu",ref:"optionsMenu",model:e.menuButtons},null,8,["model"]),e.uploading?E("",!0):(u(),y(T,{key:0,label:"",changeFunction:e.startTemplateUpload,triggerInput:e.triggerUpload},null,8,["changeFunction","triggerInput"]))],64)}var $i=_(vi,[["render",Di]]);const Ti={style:{padding:0,width:"40vw"}};var Si={dialog:Ti};const zi=V({name:"document-execution-select-cn-dialog",components:{Dialog:G,Listbox:kt},props:{visible:{type:Boolean},crossNavigationDocuments:{type:Array}},emits:["close","selected"],data(){return{documentExecutionSelectCNDialogDsecriptor:Si}},methods:{closeDialog(){this.$emit("close")},navigationSelected(e){this.$emit("selected",e)}}}),Ni={class:"kn-list-item","data-test":"list-item"},Ii={class:"kn-list-item-text"},Oi={class:"p-d-flex p-flex-row"};function Vi(e,t,a,o,i,r){const n=p("Toolbar"),l=p("Listbox"),d=p("Button"),s=p("Dialog");return u(),y(s,{class:"p-fluid kn-dialog--toolbar--primary",contentStyle:e.documentExecutionSelectCNDialogDsecriptor.dialog.style,visible:e.visible,modal:!0,closable:!1},{header:b(()=>[m(n,{class:"kn-toolbar kn-toolbar--primary p-p-0 p-m-0 p-col-12"},{start:b(()=>[A(k(e.$t("documentExecution.main.destinationSelectionTitle")),1)]),_:1})]),footer:b(()=>[c("div",Oi,[m(d,{class:"kn-button kn-button--primary p-ml-auto",onClick:e.closeDialog},{default:b(()=>[A(k(e.$t("common.cancel")),1)]),_:1},8,["onClick"])])]),default:b(()=>[m(l,{id:"cross-navigation-document-list",class:"p-m-2",options:e.crossNavigationDocuments,onChange:t[0]||(t[0]=f=>e.navigationSelected(f.value)),"data-test":"kpi-list"},{option:b(f=>[c("div",Ni,[c("div",Ii,[c("span",null,k(f.option.crossText),1)])])]),_:1},8,["options"])]),_:1},8,["contentStyle","visible"])}var _i=_(zi,[["render",Vi],["__scopeId","data-v-73524430"]]);const Pi={style:{height:"80vh",padding:0,width:"80vw"}};var Ri={dialog:Pi};const Ui=V({name:"document-execution-cn-container-dialog",components:{Dialog:G},props:{visible:{type:Boolean},data:{type:Object}},emits:["close","selected"],data(){return{documentExecutionCNContainerDialogDescriptor:Ri}},methods:{closeDialog(){this.$emit("close")}}}),Li=["name"];function Fi(e,t,a,o,i,r){const n=p("Button"),l=p("Toolbar"),d=p("Dialog"),s=Fe("tooltip");return u(),y(d,{class:"p-fluid kn-dialog--toolbar--primary",contentStyle:e.documentExecutionCNContainerDialogDescriptor.dialog.style,visible:e.visible,modal:!0,closable:!1},{header:b(()=>[m(l,{class:"kn-toolbar kn-toolbar--primary p-p-0 p-m-0 p-col-12"},{start:b(()=>{var f;return[A(k((f=e.data)==null?void 0:f.documentLabel),1)]}),end:b(()=>[P(m(n,{icon:"pi pi-times",class:"p-button-text p-button-rounded p-button-plain",onClick:e.closeDialog},null,8,["onClick"]),[[s,e.$t("common.close")]])]),_:1})]),default:b(()=>[e.data?(u(),C("iframe",{key:0,ref:"documentFramePopup",name:e.data.iFrameName,class:"iframe"},null,8,Li)):E("",!0)]),_:1},8,["contentStyle","visible"])}var Bi=_(Ui,[["render",Fi],["__scopeId","data-v-b4850ae2"]]);window.execExternalCrossNavigation=function(e,t,a){postMessage({type:"crossNavigation",outputParameters:e,inputParameters:{},targetCrossNavigation:a,docLabel:null,otherOutputParameters:t?[t]:[]},"*")};const ji=V({name:"document-execution",components:{DocumentExecutionBreadcrumb:ka,DocumentExecutionHelpDialog:Va,DocumentExecutionRankDialog:Ya,DocumentExecutionNotesDialog:fo,DocumentExecutionMetadataDialog:_o,DocumentExecutionMailDialog:kr,DocumentExecutionSchedulationsTable:Tr,DocumentExecutionLinkDialog:ki,KnParameterSidebar:ta,TieredMenu:Ht,Registry:aa,Dossier:$i,Olap:da,DocumentExecutionSelectCrossNavigationDialog:_i,DocumentExecutionCNContainerDialog:Bi,DashboardController:Kt},props:{id:{type:String},parameterValuesMap:{type:Object},tabKey:{type:String},propMode:{type:String},selectedMenuItem:{type:Object},menuItemClickedTrigger:{type:Boolean}},emits:["close","updateDocumentName","parametersChanged"],data(){return{managementOpened:!1,document:null,hiddenFormData:{},hiddenFormUrl:"",documentMode:"VIEW",filtersData:{},urlData:null,exporters:null,mode:null,parameterSidebarVisible:!1,toolbarMenuItems:[],helpDialogVisible:!1,documentRank:null,rankDialogVisible:!1,notesDialogVisible:!1,metadataDialogVisible:!1,mailDialogVisible:!1,metadata:{},schedulationsTableVisible:!1,schedulations:[],linkDialogVisible:!1,linkInfo:null,sbiExecutionId:null,embedHTML:!1,user:null,reloadTrigger:!1,breadcrumbs:[],linkParameters:[],embed:!1,olapCustomViewVisible:!1,userRole:null,loading:!1,olapDesignerMode:!1,sessionEnabled:!1,dateFormat:"",destinationSelectDialogVisible:!1,crossNavigationDocuments:[],angularData:null,crossNavigationContainerVisible:!1,crossNavigationContainerData:null,newDashboardMode:!1}},watch:{async menuItemClickedTrigger(){if(!this.selectedMenuItem||!["registry","document-composite","report","office-doc","olap","map","report","kpi","dossier","etl"].some(o=>{var i;return(i=this.selectedMenuItem)==null?void 0:i.to.includes(o)}))return;const a=this.selectedMenuItem.to.substring(this.selectedMenuItem.to.lastIndexOf("/")+1);this.document={label:a},this.document.label&&(this.breadcrumbs=[],this.filtersData={},await this.loadDocument(),this.userRole?await this.loadPage(!0):this.parameterSidebarVisible=!0)}},setup(){return{store:K()}},async activated(){this.mode==="iframe"&&this.$route.name!=="new-dashboard"&&(this.userRole?await this.loadPage(!0):this.parameterSidebarVisible=!0)},deactivated(){this.parameterSidebarVisible=!1,window.removeEventListener("message",this.iframeEventsListener)},computed:{canEditCockpit(){var e,t,a;return!this.user||!this.document?!1:(((e=this.document.engine)==null?void 0:e.toLowerCase())==="knowagecockpitengine"||((t=this.document.engine)==null?void 0:t.toLowerCase())==="knowagedashboardengine")&&(((a=this.user.functionalities)==null?void 0:a.includes("DocumentAdminManagement"))||this.document.creationUser===this.user.userId)},sessionRole(){return this.user&&this.user.sessionRole!==this.$t("role.defaultRolePlaceholder")?this.user.sessionRole:null},url(){return this.document?`/knowage/restful-services/publish?PUBLISHER=documentExecutionNg&OBJECT_ID=${this.document.id}&OBJECT_LABEL=${this.document.label}&TOOLBAR_VISIBLE=false&MENU_PARAMETERS=%7B%7D&LIGHT_NAVIGATOR_DISABLED=TRUE&SBI_EXECUTION_ID=${this.sbiExecutionId}&OBJECT_NAME=${this.document.name}&CROSS_PARAMETER=null`:""},isParameterSidebarVisible(){var t,a;let e=!1;for(let o=0;o<((a=(t=this.filtersData)==null?void 0:t.filterStatus)==null?void 0:a.length);o++){const i=this.filtersData.filterStatus[o];if(i.showOnPanel==="true"&&i.visible){e=!0;break}}return e||!this.sessionRole}},async created(){if(this.setEventListeners(),window.addEventListener("message",this.iframeEventsListener),!(this.propMode!=="document-execution"&&!this.$route.path.includes("olap-designer")&&this.$route.name!=="document-execution"&&this.$route.name!=="document-execution-embed"&&this.$route.name!=="document-execution-workspace")&&(this.$route.name==="new-dashboard"&&(this.newDashboardMode=!0),await this.loadUserConfig(),this.isOlapDesignerMode(),this.setMode(),this.document={label:this.id},!!this.document.label)){if(this.user=this.store.$state.user,this.userRole=this.user.sessionRole!==this.$t("role.defaultRolePlaceholder")?this.user.sessionRole:null,this.document.label==="new-dashboard"){this.newDashboardMode=!0;return}await this.loadDocument(),this.userRole?await this.loadPage(!0):this.parameterSidebarVisible=!0}},methods:{iframeEventsListener(e){e.data.type==="crossNavigation"?this.executeCrossNavigation(e):e.data.type==="cockpitExecuted"&&(this.loading=!1)},editCockpitDocumentConfirm(){this.documentMode==="EDIT"?this.$confirm.require({message:this.$t("documentExecution.main.editModeConfirm"),header:this.$t("documentExecution.main.editCockpit"),icon:"pi pi-exclamation-triangle",accept:()=>this.editCockpitDocument()}):this.editCockpitDocument()},async editCockpitDocument(){this.loading=!0,this.documentMode=this.documentMode==="EDIT"?"VIEW":"EDIT",this.hiddenFormData.set("documentMode",this.documentMode),await this.loadURL(null)},openHelp(){this.helpDialogVisible=!0},async refresh(){this.parameterSidebarVisible=!1,await this.loadURL(null),this.reloadTrigger=!this.reloadTrigger},toggle(e){this.createMenuItems(),this.$refs.menu.toggle(e)},createMenuItems(){this.toolbarMenuItems=sa(this.document,{print:this.print,openRank:this.openRank,export:this.export,openMailDialog:this.openMailDialog,openMetadata:this.openMetadata,openNotes:this.openNotes,showScheduledExecutions:this.showScheduledExecutions,addToWorkspace:this.addToWorkspace,showOLAPCustomView:this.showOLAPCustomView,copyLink:this.copyLink},this.exporters,this.user,this.isOrganizerEnabled(),this.mode,this.$t,this.newDashboardMode)},print(){window.print()},export(e){if(this.document.typeCode==="OLAP")this.exportOlap(e);else{const t=this.breadcrumbs.findIndex(o=>o.label===this.document.name);let a=window.frames[t];for(;a&&a.name!=="documentFrame"+t;)a=a[0].frames;a.postMessage({type:"export",format:e.toLowerCase()},"*")}},exportOlap(e){const t=e==="PDF"?`/knowagewhatifengine/restful-services/1.0/model/export/pdf?SBI_EXECUTION_ID=${this.sbiExecutionId}`:`/knowagewhatifengine/restful-services/1.0/model/export/excel?SBI_EXECUTION_ID=${this.sbiExecutionId}`;window.open(t)},openMailDialog(){this.mailDialogVisible=!0},async openMetadata(){this.loading=!0,await this.$http.get(`/knowage/restful-services/1.0/documentexecutionee/${this.document.id}/documentMetadata`).then(e=>this.metadata=e.data),this.metadataDialogVisible=!0,this.loading=!1},async openRank(){await this.getRank(),this.rankDialogVisible=!0},openNotes(){this.notesDialogVisible=!0},async showScheduledExecutions(){this.loading=!0,this.parameterSidebarVisible=!1,this.schedulationsTableVisible=!0,await this.$http.get(`/knowage/restful-services/1.0/documentsnapshot/getSnapshots?id=${this.document.id}`).then(e=>{var t;(t=e.data)==null||t.schedulers.forEach(a=>this.schedulations.push({...a,urlPath:e.data.urlPath}))}),this.loading=!1},async copyLink(e){this.loading=!0,this.linkParameters=this.getFormattedParameters(),await this.$http.post("/knowage/restful-services/1.0/documentexecution/canHavePublicExecutionUrl",{label:this.document.label}).then(t=>{this.embedHTML=e,this.linkInfo=t.data,this.linkDialogVisible=!0}).catch(()=>{}),this.loading=!1},closeDocument(){const e=this.$route.path.includes("workspace")?"/workspace":"/document-browser";this.$router.push(e),this.breadcrumbs=[],this.$emit("close")},setMode(){this.embed=this.$route.path.includes("embed"),this.embed&&this.store.setDocumentExecutionEmbed(),this.$route.path.includes("registry")?this.mode="registry":this.$route.path.includes("dossier")?this.mode="dossier":this.$route.path.includes("olap")?this.mode="olap":this.$route.path.includes("dashboard")?this.mode="dashboard":this.mode="iframe"},async loadPage(e=!1,t=null,a=!1){var o,i;this.loading=!0,await this.loadFilters(e),(o=this.filtersData)!=null&&o.isReadyForExecution?(this.parameterSidebarVisible=!1,await this.loadURL(null,t,a),await this.loadExporters()):(i=this.filtersData)!=null&&i.filterStatus&&(this.parameterSidebarVisible=!0),this.updateMode(),this.loading=!1},updateMode(){this.document.typeCode==="DATAMART"?this.mode="registry":this.document.typeCode==="DOSSIER"?this.mode="dossier":this.document.typeCode==="OLAP"?this.mode="olap":this.document.typeCode==="DOCUMENT_COMPOSITE"&&this.$route.path.includes("dashboard")?this.mode="dashboard":this.mode="iframe"},async loadDocument(){var t;await this.$http.get(`/knowage/restful-services/2.0/documents/${(t=this.document)==null?void 0:t.label}`).then(a=>this.document=a.data);const e=this.breadcrumbs.findIndex(a=>a.label===this.document.name);e!==-1?this.breadcrumbs[e].document=this.document:this.breadcrumbs.push({label:this.document.name,document:this.document})},async loadFilters(e=!1){var t,a,o,i;if(this.parameterValuesMap&&this.parameterValuesMap[this.document.label+"-"+this.tabKey]&&e){this.filtersData=this.parameterValuesMap[this.document.label+"-"+this.tabKey],this.setFiltersForBreadcrumbItem();return}if(this.sessionEnabled&&!this.document.navigationParams){const r=sessionStorage.getItem(this.document.label);if(r){this.filtersData=JSON.parse(r),(t=this.filtersData.filterStatus)==null||t.forEach(n=>{n.type==="DATE"&&n.parameterValue[0].value&&(n.parameterValue[0].value=new Date(n.parameterValue[0].value))}),this.setFiltersForBreadcrumbItem();return}}await this.$http.post("/knowage/restful-services/2.0/documentexecution/filters",{label:this.document.label,role:this.userRole,parameters:(a=this.document.navigationParams)!=null?a:{}}).then(r=>this.filtersData=r.data).catch(r=>{var n;((n=r.response)==null?void 0:n.status)===500&&this.store.setError({title:this.$t("common.error.generic"),msg:this.$t("documentExecution.main.userRoleError")})}),(i=(o=this.filtersData)==null?void 0:o.filterStatus)==null||i.forEach(r=>{var n,l,d,s,f;if(r.parameterValue=r.multivalue?[]:[{value:"",description:""}],((n=r.driverDefaultValue)==null?void 0:n.length)>0){let v="_col0",w="col1";(l=r.metadata)!=null&&l.colsMap&&(v=Object.keys((d=r.metadata)==null?void 0:d.colsMap).find(x=>r.metadata.colsMap[x]===r.metadata.valueColumn),w=Object.keys((s=r.metadata)==null?void 0:s.colsMap).find(x=>r.metadata.colsMap[x]===r.metadata.descriptionColumn)),r.parameterValue=r.driverDefaultValue.map(x=>{var g,T;return{value:(g=x.value)!=null?g:x[v],description:(T=x.desc)!=null?T:x[w]}}),r.type==="DATE"&&!r.selectionType&&r.valueSelection==="man_in"&&r.showOnPanel==="true"&&r.visible&&(r.parameterValue[0].value=mt((f=r.parameterValue[0].description)==null?void 0:f.split("#")[0]).toDate())}r.data&&(r.data=r.data.map(v=>this.formatParameterDataOptions(r,v)),r.data.length===1&&(r.parameterValue=[...r.data])),(r.selectionType==="COMBOBOX"||r.selectionType==="LIST")&&r.multivalue&&r.mandatory&&r.data.length===1&&(r.showOnPanel="false",r.visible=!1),r.parameterValue||(r.parameterValue=[{value:"",description:""}]),r.parameterValue[0]&&!r.parameterValue[0].description&&(r.parameterValue[0].description=r.parameterDescription?r.parameterDescription[0]:"")}),this.document.navigationParams&&this.loadNavigationParamsInitialValue(),this.setFiltersForBreadcrumbItem()},setFiltersForBreadcrumbItem(){const e=this.breadcrumbs.findIndex(t=>t.label===this.document.name);e!==-1&&(this.breadcrumbs[e].filtersData=this.filtersData)},loadNavigationParamsInitialValue(){Object.keys(this.document.navigationParams).forEach(e=>{for(let t=0;t<this.filtersData.filterStatus.length;t++){const a=this.filtersData.filterStatus[t];(e===a.urlName||e===a.label)&&(a.multivalue&&Array.isArray(this.document.navigationParams[e])?(a.parameterValue=this.document.navigationParams[e].map(o=>({value:o,description:""})),this.setCrossNavigationComboParameterDescription(a)):(a.parameterValue[0].value=this.document.navigationParams[e],this.document.navigationParams[e+"_field_visible_description"]&&(a.parameterValue[0].description=this.document.navigationParams[e+"_field_visible_description"]),a.selectionType==="COMBOBOX"&&this.setCrossNavigationComboParameterDescription(a),a.type==="DATE"&&a.parameterValue[0]&&a.parameterValue[0].value&&(a.parameterValue[0].value=new Date(a.parameterValue[0].value))))}})},setCrossNavigationComboParameterDescription(e){for(let t=0;t<e.parameterValue.length;t++)if(e.parameterValue[t].value){const a=e.data.findIndex(o=>o.value===e.parameterValue[t].value);a!==-1&&(e.parameterValue[t].description=e.data[a].description)}},formatParameterDataOptions(e,t){if(!e.metadata)return{value:"",description:""};const a=e.metadata.valueColumn,o=e.metadata.descriptionColumn,i=Object.keys(e.metadata.colsMap).find(n=>e.metadata.colsMap[n]===a),r=Object.keys(e.metadata.colsMap).find(n=>e.metadata.colsMap[n]===o);return{value:i?t[i]:"",description:r?t[r]:""}},async loadURL(e,t=null,a=!1){var r;const o={label:this.document.label,role:this.userRole,parameters:e||this.getFormattedParameters(),EDIT_MODE:"null",IS_FOR_EXPORT:!0};this.sbiExecutionId&&(o.SBI_EXECUTION_ID=this.sbiExecutionId),this.document.typeCode==="MAP"&&(o.EDIT_MODE="edit_map"),await this.$http.post("/knowage/restful-services/1.0/documentexecution/url",o).then(n=>{var l;this.urlData=n.data,this.sbiExecutionId=(l=this.urlData)==null?void 0:l.sbiExecutionId}).catch(n=>{var l;this.urlData=n.data,this.sbiExecutionId=(l=this.urlData)==null?void 0:l.sbiExecutionId});const i=this.breadcrumbs.findIndex(n=>n.label===this.document.name);i!==-1&&(this.breadcrumbs[i].urlData=this.urlData,this.sbiExecutionId=(r=this.urlData)==null?void 0:r.sbiExecutionId),await this.sendForm(t,a)},async loadExporters(){var e;await this.$http.get(`/knowage/restful-services/2.0/exporters/${(e=this.urlData)==null?void 0:e.engineLabel}`).then(t=>this.exporters=t.data.exporters)},async sendForm(e=null,t=!1){var s,f;let a=this.breadcrumbs.findIndex(v=>v.label===this.document.name);const o=((s=this.urlData)==null?void 0:s.url)+"&timereloadurl="+new Date().getTime(),i={params:{document:null},url:o.split("?")[0]};i.params.documentMode=this.documentMode,this.hiddenFormUrl=i.url;const r=(f=o==null?void 0:o.split("?")[1])==null?void 0:f.split("&");for(let v in r)typeof r!="function"&&(i.params[r[v].split("=")[0]]=r[v].split("=")[1]);let n=document.getElementById("postForm_"+i.params.document);n||(n=document.createElement("form")),n.id="postForm_"+i.params.document,n.action=""+i.url,n.method="post";const l=t?"documentFramePopup":"documentFrame";n.target=a!==-1?l+a:e,n.acceptCharset="UTF-8",document.body.appendChild(n),this.hiddenFormData=new URLSearchParams;for(let v in i.params){const w=document.getElementById("postForm_"+i.params.document+v);if(w)w.value=decodeURIComponent(i.params[v]),w.value=w.value.replace(/\+/g," "),this.hiddenFormData.set(v,decodeURIComponent(i.params[v]).replace(/\+/g," "));else{const x=document.createElement("input");x.type="hidden",x.id="postForm_"+i.params.document+v,x.name=v,x.value=decodeURIComponent(i.params[v]),x.value=x.value.replace(/\+/g," "),n.appendChild(x),this.hiddenFormData.append(v,decodeURIComponent(i.params[v]).replace(/\+/g," "))}}for(let v=n.elements.length-1;v>=0;v--){const w=n.elements[v].id.replace("postForm_"+i.params.document,"");w in i.params||(n.removeChild(n.elements[v]),this.hiddenFormData.delete(w))}this.hiddenFormData.append("documentMode",this.documentMode),this.document.typeCode==="DATAMART"||this.document.typeCode==="DOSSIER"||this.document.typeCode==="OLAP"||this.document.typeCode==="DOCUMENT_COMPOSITE"&&this.mode==="dashboard"?await this.sendHiddenFormData():n.submit();const d=this.breadcrumbs.findIndex(v=>v.label===this.document.name);d!==-1&&(this.breadcrumbs[d].hiddenFormData=this.hiddenFormData)},async sendHiddenFormData(){await this.$http.post(this.hiddenFormUrl,this.hiddenFormData,{headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}}).then(()=>{}).catch(()=>{})},async onExecute(){var e;if(this.loading=!0,this.filtersData.isReadyForExecution=!0,await this.loadURL(null),this.parameterSidebarVisible=!1,this.reloadTrigger=!this.reloadTrigger,!this.exporters||this.exporters.length===0){await this.loadExporters();const t=this.toolbarMenuItems.findIndex(a=>a.label===this.$t("common.export"));t===-1?this.toolbarMenuItems.splice(1,0,{label:this.$t("common.export"),items:[]}):(e=this.exporters)==null||e.forEach(a=>this.toolbarMenuItems[t].items.push({icon:"fa fa-file-excel",label:a.name,command:()=>this.export(a.name)}))}this.sessionEnabled&&this.saveParametersInSession(),this.loading=!1},async onExportCSV(){const e={documentId:this.document.id,documentLabel:this.document.label,exportType:"CSV",parameters:this.getFormattedParametersForCSVExport()};this.loading=!0,await this.$http.post("/knowage/restful-services/2.0/export/cockpitData",e).then(()=>{this.store.setInfo({title:this.$t("common.toast.updateTitle"),msg:this.$t("common.exportSuccess")})}).catch(()=>{}),this.loading=!1},getFormattedParameters(){if(!this.filtersData||!this.filtersData.filterStatus)return{};let e={};return Object.keys(this.filtersData.filterStatus).forEach(t=>{const a=this.filtersData.filterStatus[t];if(a.parameterValue)if(a.type==="DATE")e[a.urlName]=this.getFormattedDate(a.parameterValue[0].value),e[a.urlName+"_field_visible_description"]=this.getFormattedDate(a.parameterValue[0].value,!0);else if(a.valueSelection==="man_in")a.parameterValue[0]||(a.parameterValue[0]={value:"",description:""}),e[a.urlName]=a.type==="NUM"&&a.parameterValue[0].value?+a.parameterValue[0].value:a.parameterValue[0].value,e[a.urlName+"_field_visible_description"]=a.type==="NUM"&&a.parameterValue[0].description?+a.parameterValue[0].description:a.parameterValue[0].description;else if(a.selectionType==="TREE"||a.selectionType==="LOOKUP"||a.multivalue){e[a.urlName]=a.parameterValue.map(i=>i.value);let o="";for(let i=0;i<a.parameterValue.length;i++)o+=a.parameterValue[i].description,o+=i===a.parameterValue.length-1?"":";";e[a.urlName+"_field_visible_description"]=o}else e[a.urlName]=a.parameterValue[0].value,e[a.urlName+"_field_visible_description"]=a.parameterValue[0].description}),e},getFormattedParametersForCSVExport(){if(!this.filtersData)return{};let e={};return Object.keys(this.filtersData.filterStatus).forEach(t=>{const a=this.filtersData.filterStatus[t];if(a.parameterValue)if(a.type==="DATE")e[a.urlName]=this.getFormattedDate(a.parameterValue[0].value);else if(a.valueSelection==="man_in"&&!a.multivalue)e[a.urlName]=a.type==="NUM"?+a.parameterValue[0].value:a.parameterValue[0].value;else if(a.selectionType==="TREE"||a.selectionType==="LOOKUP"||a.multivalue){let o="";for(let i=0;i<a.parameterValue.length;i++)o+=a.parameterValue[i].value,o+=i===a.parameterValue.length-1?"":",";e[a.urlName]=o}else e[a.urlName]=a.parameterValue[0].value}),e},async getRank(){this.loading=!0,await this.$http.post("/knowage/restful-services/documentrating/getvote",{obj:this.document.id}).then(e=>this.documentRank=e.data).catch(e=>this.store.setError({title:this.$t("common.error.generic"),msg:e})),this.loading=!1},async onSaveRank(e){e&&(this.loading=!0,await this.$http.post("/knowage/restful-services/documentrating/vote",{rating:e,obj:this.document.id}).then(()=>this.store.setInfo({title:this.$t("common.toast.updateTitle"),msg:this.$t("documentExecution.main.rankSaveSucces")})).catch(t=>this.store.setError({title:this.$t("common.error.generic"),msg:t})),this.loading=!1),this.rankDialogVisible=!1},async onMetadataSave(e){this.loading=!0;const t=[];["shortText","longText","file"].forEach(o=>e[o].forEach(i=>{(i.value||o==="file"&&i.fileToSave)&&(o==="file"&&(i.value=JSON.stringify(i.value)),t.push(i))})),await this.$http.post("/knowage/restful-services/1.0/documentexecutionee/saveDocumentMetadata",{id:this.document.id,jsonMeta:t}).then(()=>{this.store.setInfo({title:this.$t("common.toast.createTitle"),msg:this.$t("common.toast.success")}),this.metadataDialogVisible=!1}).catch(()=>{}),this.loading=!1},async onMailSave(e){this.loading=!0;const t={...e,label:this.document.label,docId:this.document.id,userId:this.user.userId,parameters:this.getFormattedParameters()};await this.$http.post("/knowage/restful-services/1.0/documentexecutionmail/sendMail",t).then(()=>{this.store.setInfo({title:this.$t("common.toast.createTitle"),msg:this.$t("common.sendMailSuccess")}),this.mailDialogVisible=!1}).catch(a=>{this.store.setError({title:this.$t("common.error.generic"),msg:a})}),this.loading=!1},async onDeleteSchedulation(e){this.loading=!0,await this.$http.post("/knowage/restful-services/1.0/documentsnapshot/deleteSnapshot",{SNAPSHOT:""+e.id}).then(async()=>{this.removeSchedulation(e),this.store.setInfo({title:this.$t("common.toast.deleteTitle"),msg:this.$t("common.toast.deleteSuccess")})}).catch(()=>{}),this.loading=!1},removeSchedulation(e){const t=this.schedulations.findIndex(a=>a.id===e.id);t!==-1&&this.schedulations.splice(t,1)},getFormattedDate(e,t){const a=e instanceof Date?void 0:"dd/MM/yyyy";return Yt(e,a,t?void 0:this.dateFormat)},async onBreadcrumbClick(e){this.document=e.document,this.filtersData=e.filtersData,this.urlData=e.urlData,this.hiddenFormData=e.hiddenFormData,this.documentMode="VIEW",this.updateMode()},async onRoleChange(e){this.userRole=e,this.filtersData={},this.urlData=null,this.exporters=null,await this.loadPage()},async executeCrossNavigation(e){this.angularData=e.data,await this.loadCrossNavigationByDocument(e.data)},async loadCrossNavigationByDocument(e){if(!this.document)return;let t={};this.loading=!0,await this.$http.get(`/knowage/restful-services/1.0/crossNavigation/${this.document.label}/loadCrossNavigationByDocument`).then(o=>t=o.data),this.loading=!1;const a=this.findCrossTargetByCrossName(e,t);!a&&t.length>1?(this.crossNavigationDocuments=t,this.destinationSelectDialogVisible=!0):this.loadCrossNavigation(a!=null?a:t[0],e)},findCrossTargetByCrossName(e,t){if(!e||!t)return;const a=t.findIndex(o=>o.crossName===e.targetCrossNavigation.crossName);return a!==-1?t[a]:null},async loadCrossNavigation(e,t){this.formatAngularOutputParameters(t.otherOutputParameters);const a=this.formatNavigationParams(t.otherOutputParameters,e?e.navigationParams:[]);this.addDocumentOtherParametersToNavigationParamas(a,t,e);const o=e.popupOptions?JSON.parse(e.popupOptions):null;if((e==null?void 0:e.crossType)!==2&&(this.document={...e==null?void 0:e.document,navigationParams:a}),(e==null?void 0:e.crossType)===2)this.openCrossNavigationInNewWindow(o,e,a);else if((e==null?void 0:e.crossType)===1){const i=e==null?void 0:e.document.label;this.crossNavigationContainerData={documentLabel:i,iFrameName:i},this.crossNavigationContainerVisible=!0,await this.loadPage(!1,i,!0)}else{const i=this.breadcrumbs.findIndex(r=>r.label===this.document.name);i!==-1?this.breadcrumbs[i].document=this.document:this.breadcrumbs.push({label:this.document.name,document:this.document,crossBreadcrumb:this.getCrossBeadcrumb(e,t)}),await this.loadPage()}this.documentMode="VIEW"},getCrossBeadcrumb(e,t){let a=e.crossBreadcrumb;return a!=null&&a.includes("$P{")&&(a=this.updateCrossBreadCrumbWithParameterValues(a,t)),a!=null?a:this.document.name},updateCrossBreadCrumbWithParameterValues(e,t){const a=e.match(/{[\w\d]+}/g);if(!a)return"";const o=t.outputParameters;for(let n=0;n<t.otherOutputParameters.length;n++){const l=Object.keys(t.otherOutputParameters[n])[0];o[l]=t.otherOutputParameters[n][l]}const i=[];for(let n=0;n<a.length;n++){const l=a[n].substring(1,a[n].length-1);i.push({parameterPlaceholder:a[n],value:o[l]})}let r=e;for(let n=0;n<i.length;n++)r=r.replaceAll("$P"+i[n].parameterPlaceholder,i[n].value);return r},addDocumentOtherParametersToNavigationParamas(e,t,a){var r;if(!t.outputParameters||t.outputParameters.length===0||!(a!=null&&a.navigationParams))return;const o=Object.keys(t.outputParameters),i=Object.keys(a.navigationParams);for(let n=0;n<o.length;n++){const l=o[n];let d="";for(let s=0;s<i.length;s++)((r=a.navigationParams[i[s]].value)==null?void 0:r.label)===l&&(d=i[s]);d&&(e[d]=t.outputParameters[l])}},openCrossNavigationInNewWindow(e,t,a){if(!t||!t.document)return;const o=encodeURI(JSON.stringify(a)),i=`/knowage/restful-services/publish?PUBLISHER=documentExecutionNg&OBJECT_ID=${t.document.id}&OBJECT_LABEL=${t.document.label}&SELECTED_ROLE=${this.sessionRole}&SBI_EXECUTION_ID=null&OBJECT_NAME=${t.document.name}&CROSS_PARAMETER=${o}`;window.open(i,"_blank",`toolbar=0,status=0,menubar=0,width=${e.width||"800"},height=${e.height||"600"}`)},formatAngularOutputParameters(e){const t=Ne(this.document.drivers),a=[];e.forEach(o=>a.push(Object.keys(o)[0]));for(let o=0;o<t.length;o++)if(!a.includes(t[o].label)){const i={};i[t[o].label]=this.getParameterValueForCrossNavigation(t[o].label),e.push(i)}},getParameterValueForCrossNavigation(e){var a;if(!e)return;const t=(a=this.filtersData.filterStatus)==null?void 0:a.findIndex(o=>o.label===e);return t!==-1?this.filtersData.filterStatus[t].parameterValue[0].value:""},formatNavigationParams(e,t){let a={};return e.forEach(o=>{let i=!1,r="";for(let n=0;n<Object.keys(t).length;n++)if(t[Object.keys(t)[n]].value.label===Object.keys(o)[0]){i=!0,r=Object.keys(t)[n];break}i&&(a[r]=o[Object.keys(o)[0]],a[r+"_field_visible_description"]=o[Object.keys(o)[0]])}),a},showOLAPCustomView(){this.olapCustomViewVisible=!0},async executeOlapCustomView(e){this.loading=!0,this.olapCustomViewVisible=!1,await this.loadURL(e),this.reloadTrigger=!this.reloadTrigger,this.loading=!1},async executeOLAPCrossNavigation(e){let t={};if(this.loading=!0,await this.$http.get(`/knowage/restful-services/1.0/crossNavigation/${this.document.label}/loadCrossNavigationByDocument`).then(o=>t=o.data),this.loading=!1,!t||t.length===0){this.store.setError({title:this.$t("common.error.generic"),msg:this.$t("documentExecution.main.crossNavigationNoTargetError")});return}this.document={...t[0].document,navigationParams:this.formatOLAPNavigationParams(e,t[0].navigationParams)};const a=this.breadcrumbs.findIndex(o=>o.label===this.document.name);a!==-1?this.breadcrumbs[a].document=this.document:this.breadcrumbs.push({label:this.document.name,document:this.document}),await this.loadPage(),this.reloadTrigger=!this.reloadTrigger},formatOLAPNavigationParams(e,t){const a=Object.keys(e);let o={};return Object.keys(t).forEach(i=>{const r=a.findIndex(n=>n===t[i].value.label);r!==-1&&(o[i]=e[a[r]])}),o},isOlapDesignerMode(){this.$route.name==="olap-designer"&&(this.olapDesignerMode=!0)},isOrganizerEnabled(){return this.user.isSuperadmin||this.user.functionalities.includes("DocumentAdminManagement")||this.user.functionalities.includes("SaveIntoFolderFunctionality")},async addToWorkspace(){this.loading=!0,await this.$http.post(`/knowage/restful-services/2.0/organizer/documents/${this.document.id}`,{},{headers:{"X-Disable-Errors":"true"}}).then(()=>{this.store.setInfo({title:this.$t("common.toast.updateTitle"),msg:this.$t("common.toast.success")})}).catch(e=>{this.store.setError({title:this.$t("common.toast.updateTitle"),msg:e.message==="sbi.workspace.organizer.document.addtoorganizer.error.duplicateentry"?this.$t("documentExecution.main.addToWorkspaceError"):e.message})}),this.loading=!1},async loadUserConfig(){await this.$http.get("/knowage/restful-services/1.0/user-configs").then(e=>{e.data&&(this.sessionEnabled=e.data["SPAGOBI.SESSION_PARAMETERS_MANAGER.enabled"]!=="false",this.dateFormat=e.data["SPAGOBI.DATE-FORMAT-SERVER.format"]==="%Y-%m-%d"?"dd/MM/yyyy":e.data["SPAGOBI.DATE-FORMAT-SERVER.format"])})},saveParametersInSession(){var t;const e=Ne(this.filtersData);(t=e.filterStatus)==null||t.forEach(a=>{delete a.dataDependsOnParameters,delete a.dataDependentParameters,delete a.dependsOnParameters,delete a.dependentParameters,delete a.lovDependsOnParameters,delete a.lovDependentParameters}),sessionStorage.setItem(this.document.label,JSON.stringify(e))},async onCrossNavigationSelected(e){this.destinationSelectDialogVisible=!1,await this.loadCrossNavigation(e,this.angularData)},onCrossNavigationContainerClose(){this.crossNavigationContainerData=null,this.crossNavigationContainerVisible=!0,this.onBreadcrumbClick(this.breadcrumbs[0])},addWidget(){ie.emit("openNewWidgetPicker")},openDashboardDatasetManagement(){this.managementOpened=!0,ie.emit("openDatasetManagement")},setEventListeners(){ie.on("datasetManagementClosed",()=>{this.managementOpened=!1}),ie.on("widgetEditorOpened",()=>{this.managementOpened=!0}),ie.on("widgetEditorClosed",()=>{this.managementOpened=!1})},saveDashboard(){ie.emit("saveDashboard")},async onNewDashboardSaved(e){this.document.label=e.label,await this.loadDocument(),this.user=this.store.$state.user,this.userRole=this.user.sessionRole!==this.$t("role.defaultRolePlaceholder")?this.user.sessionRole:null,this.userRole?await this.loadPage(!0):this.parameterSidebarVisible=!0,this.newDashboardMode=!1}}}),Xi={class:"kn-height-full detail-page-container"},Qi={class:"p-d-flex p-jc-around"},Wi={ref:"document-execution-view",id:"document-execution-view",class:"p-d-flex p-flex-row myDivToPrint"},Ji=["name"];function Hi(e,t,a,o,i,r){var W,B,J;const n=p("Button"),l=p("TieredMenu"),d=p("Toolbar"),s=p("ProgressBar"),f=p("DocumentExecutionBreadcrumb"),v=p("Registry"),w=p("Dossier"),x=p("Olap"),g=p("DashboardController"),T=p("DocumentExecutionSchedulationsTable"),h=p("KnParameterSidebar"),M=p("DocumentExecutionHelpDialog"),$=p("DocumentExecutionRankDialog"),F=p("DocumentExecutionNotesDialog"),q=p("DocumentExecutionMetadataDialog"),ae=p("DocumentExecutionMailDialog"),oe=p("DocumentExecutionLinkDialog"),Q=p("DocumentExecutionSelectCrossNavigationDialog"),re=p("DocumentExecutionCNContainerDialog"),S=Fe("tooltip");return u(),C("div",Xi,[!e.embed&&!e.olapDesignerMode&&!e.managementOpened?(u(),y(d,{key:0,class:"kn-toolbar kn-toolbar--primary p-col-12"},{start:b(()=>{var D;return[c("span",null,k((D=e.document)==null?void 0:D.name),1)]}),end:b(()=>[c("div",Qi,[e.mode=="dashboard"?P((u(),y(n,{key:0,icon:"fas fa-database",class:I(["p-button-text p-button-rounded p-button-plain p-mx-2",{"dashboard-toolbar-icon":e.mode==="dashboard"}]),onClick:e.openDashboardDatasetManagement},null,8,["class","onClick"])),[[S,e.$t("common.datasets"),void 0,{left:!0}]]):E("",!0),e.mode=="dashboard"?P((u(),y(n,{key:1,icon:"pi pi-save",class:I(["p-button-text p-button-rounded p-button-plain p-mx-2",{"dashboard-toolbar-icon":e.mode==="dashboard"}]),onClick:e.saveDashboard},null,8,["class","onClick"])),[[S,e.$t("common.save"),void 0,{left:!0}]]):E("",!0),e.mode!=="dashboard"&&e.canEditCockpit&&e.documentMode==="VIEW"?P((u(),y(n,{key:2,icon:"pi pi-pencil",class:"p-button-text p-button-rounded p-button-plain p-mx-2",onClick:e.editCockpitDocumentConfirm},null,8,["onClick"])),[[S,e.$t("documentExecution.main.editCockpit"),void 0,{left:!0}]]):E("",!0),e.mode!=="dashboard"&&e.canEditCockpit&&e.documentMode==="EDIT"?P((u(),y(n,{key:3,icon:"fa fa-eye",class:"p-button-text p-button-rounded p-button-plain p-mx-2",onClick:e.editCockpitDocumentConfirm},null,8,["onClick"])),[[S,e.$t("documentExecution.main.viewCockpit"),void 0,{left:!0}]]):E("",!0),e.mode!=="dashboard"?P((u(),y(n,{key:4,icon:"pi pi-book",class:"p-button-text p-button-rounded p-button-plain p-mx-2",onClick:e.openHelp},null,8,["onClick"])),[[S,e.$t("common.onlineHelp"),void 0,{left:!0}]]):E("",!0),e.newDashboardMode?E("",!0):P((u(),y(n,{key:5,icon:"pi pi-refresh",class:I(["p-button-text p-button-rounded p-button-plain p-mx-2",{"dashboard-toolbar-icon":e.mode==="dashboard"}]),onClick:e.refresh},null,8,["class","onClick"])),[[S,e.$t("common.refresh"),void 0,{left:!0}]]),e.isParameterSidebarVisible&&!e.newDashboardMode?P((u(),y(n,{key:6,icon:"fa fa-filter",class:I(["p-button-text p-button-rounded p-button-plain p-mx-2",{"dashboard-toolbar-icon":e.mode==="dashboard"}]),onClick:t[0]||(t[0]=D=>e.parameterSidebarVisible=!e.parameterSidebarVisible),"data-test":"parameter-sidebar-icon"},null,8,["class"])),[[S,e.$t("common.parameters"),void 0,{left:!0}]]):E("",!0),P(m(n,{icon:"fa fa-ellipsis-v",class:I(["p-button-text p-button-rounded p-button-plain p-mx-2",{"dashboard-toolbar-icon":e.mode==="dashboard"}]),onClick:e.toggle},null,8,["class","onClick"]),[[S,e.$t("common.menu"),void 0,{left:!0}]]),m(l,{ref:"menu",model:e.toolbarMenuItems,popup:!0},null,8,["model"]),e.mode=="dashboard"?(u(),y(n,{key:7,id:"add-widget-button",class:"p-button-sm",label:e.$t("dashboard.widgetEditor.addWidget"),icon:"pi pi-plus-circle",onClick:e.addWidget},null,8,["label","onClick"])):E("",!0),P(m(n,{icon:"fa fa-times",class:I(["p-button-text p-button-rounded p-button-plain p-mx-2",{"dashboard-toolbar-icon":e.mode==="dashboard"}]),onClick:e.closeDocument},null,8,["class","onClick"]),[[S,e.$t("common.close"),void 0,{left:!0}]])])]),_:1})):E("",!0),e.loading?(u(),y(s,{key:1,class:"kn-progress-bar",mode:"indeterminate"})):E("",!0),e.breadcrumbs.length>1?(u(),y(f,{key:2,breadcrumbs:e.breadcrumbs,onBreadcrumbClicked:e.onBreadcrumbClick},null,8,["breadcrumbs","onBreadcrumbClicked"])):E("",!0),c("div",Wi,[e.parameterSidebarVisible?(u(),C("div",{key:0,id:"document-execution-backdrop",onClick:t[1]||(t[1]=D=>e.parameterSidebarVisible=!1)})):E("",!0),e.filtersData&&e.filtersData.isReadyForExecution&&!e.loading&&!e.schedulationsTableVisible||e.newDashboardMode?(u(),C(R,{key:1},[e.mode==="registry"?(u(),y(v,{key:0,id:(W=e.urlData)==null?void 0:W.sbiExecutionId,reloadTrigger:e.reloadTrigger},null,8,["id","reloadTrigger"])):e.mode==="dossier"?(u(),y(w,{key:1,id:e.document.id,reloadTrigger:e.reloadTrigger,filterData:e.filtersData},null,8,["id","reloadTrigger","filterData"])):e.mode==="olap"?(u(),y(x,{key:2,id:(B=e.urlData)==null?void 0:B.sbiExecutionId,olapId:e.document.id,olapName:e.document.label,reloadTrigger:e.reloadTrigger,olapCustomViewVisible:e.olapCustomViewVisible,hiddenFormDataProp:e.hiddenFormData,onCloseOlapCustomView:t[2]||(t[2]=D=>e.olapCustomViewVisible=!1),onApplyCustomView:e.executeOlapCustomView,onExecuteCrossNavigation:e.executeOLAPCrossNavigation},null,8,["id","olapId","olapName","reloadTrigger","olapCustomViewVisible","hiddenFormDataProp","onApplyCustomView","onExecuteCrossNavigation"])):e.mode==="dashboard"||e.newDashboardMode?(u(),y(g,{key:3,sbiExecutionId:(J=e.urlData)==null?void 0:J.sbiExecutionId,document:e.document,reloadTrigger:e.reloadTrigger,hiddenFormData:e.hiddenFormData,filtersData:e.filtersData,newDashboardMode:e.newDashboardMode,onNewDashboardSaved:e.onNewDashboardSaved},null,8,["sbiExecutionId","document","reloadTrigger","hiddenFormData","filtersData","newDashboardMode","onNewDashboardSaved"])):E("",!0)],64)):E("",!0),(u(!0),C(R,null,L(e.breadcrumbs,(D,U)=>P((u(),C("iframe",{key:U,ref_for:!0,ref:"documentFrame",name:"documentFrame"+U,class:"document-execution-iframe"},null,8,Ji)),[[he,e.mode==="iframe"&&e.filtersData&&e.filtersData.isReadyForExecution&&!e.loading&&!e.schedulationsTableVisible&&(D.label===e.document.name||e.crossNavigationContainerData&&U===e.breadcrumbs.length-1)]])),128)),e.schedulationsTableVisible?(u(),y(T,{key:2,id:"document-execution-schedulations-table",propSchedulations:e.schedulations,onDeleteSchedulation:e.onDeleteSchedulation,onClose:t[3]||(t[3]=D=>e.schedulationsTableVisible=!1)},null,8,["propSchedulations","onDeleteSchedulation"])):E("",!0),e.parameterSidebarVisible?(u(),y(h,{key:3,class:"document-execution-parameter-sidebar kn-overflow-y",filtersData:e.filtersData,propDocument:e.document,userRole:e.userRole,sessionEnabled:e.sessionEnabled,dateFormat:e.dateFormat,onExecute:e.onExecute,onExportCSV:e.onExportCSV,onRoleChanged:e.onRoleChange,onParametersChanged:t[4]||(t[4]=D=>e.$emit("parametersChanged",D)),"data-test":"parameter-sidebar"},null,8,["filtersData","propDocument","userRole","sessionEnabled","dateFormat","onExecute","onExportCSV","onRoleChanged"])):E("",!0),m(M,{visible:e.helpDialogVisible,propDocument:e.document,onClose:t[5]||(t[5]=D=>e.helpDialogVisible=!1)},null,8,["visible","propDocument"]),m($,{visible:e.rankDialogVisible,propDocumentRank:e.documentRank,onClose:t[6]||(t[6]=D=>e.rankDialogVisible=!1),onSaveRank:e.onSaveRank},null,8,["visible","propDocumentRank","onSaveRank"]),m(F,{visible:e.notesDialogVisible,propDocument:e.document,onClose:t[7]||(t[7]=D=>e.notesDialogVisible=!1)},null,8,["visible","propDocument"]),m(q,{visible:e.metadataDialogVisible,propDocument:e.document,propMetadata:e.metadata,propLoading:e.loading,onClose:t[8]||(t[8]=D=>e.metadataDialogVisible=!1),onSaveMetadata:e.onMetadataSave},null,8,["visible","propDocument","propMetadata","propLoading","onSaveMetadata"]),m(ae,{visible:e.mailDialogVisible,onClose:t[9]||(t[9]=D=>e.mailDialogVisible=!1),onSendMail:e.onMailSave},null,8,["visible","onSendMail"]),m(oe,{visible:e.linkDialogVisible,linkInfo:e.linkInfo,embedHTML:e.embedHTML,propDocument:e.document,parameters:e.linkParameters,onClose:t[10]||(t[10]=D=>e.linkDialogVisible=!1)},null,8,["visible","linkInfo","embedHTML","propDocument","parameters"]),m(Q,{visible:e.destinationSelectDialogVisible,crossNavigationDocuments:e.crossNavigationDocuments,onClose:t[11]||(t[11]=D=>e.destinationSelectDialogVisible=!1),onSelected:e.onCrossNavigationSelected},null,8,["visible","crossNavigationDocuments","onSelected"]),e.crossNavigationContainerData?(u(),y(re,{key:4,visible:e.crossNavigationContainerVisible,data:e.crossNavigationContainerData,onClose:e.onCrossNavigationContainerClose},null,8,["visible","data","onClose"])):E("",!0)],512)])}var yl=_(ji,[["render",Hi]]);export{yl as default};
//# sourceMappingURL=DocumentExecution-043060da.js.map
