import{_,d as v,X as k,a4 as C,s as F,r as n,o,c as M,a as s,f as i,w as l,g as h,t as r,h as c,A as d,V as w}from"./index-1e676509.js";import{K as y}from"./KnHint-6d455703.js";const N=["MULTITENANT_NAME"];var L={filterFields:N};const B=v({name:"tenant-management",components:{FabButton:k,Listbox:C,KnHint:y},data(){return{multitenants:[],selTenant:{},listOfThemes:[],listOfDataSources:[],listOfProductTypes:[],listOfavailableLicenses:[],tenantsDescriptor:L,loading:!1,touched:!1,hintVisible:!0}},setup(){return{store:F()}},async created(){await this.loadTenants(),await this.getLicences()},methods:{loadData(t){return this.$http.get(`/knowage/restful-services/multitenant${t}`).finally(()=>this.loading=!1)},async getLicences(){return this.$http.get("/knowage/restful-services/1.0/license").then(t=>{var e=t.data.hosts[0].hostName,m=t.data.licenses[e];this.listOfavailableLicenses=m}).finally(()=>this.loading=!1)},async loadTenants(){this.loading=!0,await this.loadData("").then(t=>{this.multitenants=t.data.root}),this.loading=!1},deleteTenantConfirm(t){this.$confirm.require({message:this.$t("common.toast.deleteMessage"),header:this.$t("common.toast.deleteTitle"),icon:"pi pi-exclamation-triangle",accept:()=>this.deleteTenant(t)})},async deleteTenant(t){let e="/knowage/restful-services/multitenant";await this.$http.delete(e,{data:t}).then(()=>{this.store.setInfo({title:this.$t("common.toast.deleteTitle"),msg:this.$t("common.toast.deleteSuccess")}),this.$router.push("/tenants-management"),this.pageReload()})},showForm(t){const e=t.value?`/tenants-management/${t.value.MULTITENANT_ID}`:"/tenants-management/new-tenant";this.hintVisible=!1,this.touched?this.$confirm.require({message:this.$t("common.toast.unsavedChangesMessage"),header:this.$t("common.toast.unsavedChangesHeader"),icon:"pi pi-exclamation-triangle",accept:()=>{this.touched=!1,this.$router.push(e),this.selTenant=t.value}}):(this.$router.push(e),this.selTenant=t.value)},pageReload(){this.touched=!1,this.hintVisible=!0,this.loadTenants()},onFormClose(){this.touched=!1,this.hintVisible=!0}}}),V={class:"kn-page"},D={class:"kn-page-content p-grid p-m-0"},E={class:"kn-list--column p-col-4 p-sm-4 p-md-3 p-p-0"},I={class:"kn-list-item","data-test":"list-item"},A={class:"kn-list-item-text"},O={class:"kn-list-item-text-secondary"},H={class:"p-col-8 p-sm-8 p-md-9 p-p-0 p-m-0"};function K(t,e,m,U,P,R){const p=n("FabButton"),u=n("Toolbar"),f=n("ProgressBar"),g=n("Button"),T=n("Listbox"),$=n("router-view"),b=n("KnHint");return o(),M("div",V,[s("div",D,[s("div",E,[i(u,{class:"kn-toolbar kn-toolbar--primary"},{start:l(()=>[h(r(t.$t("managers.tenantManagement.title")),1)]),end:l(()=>[i(p,{icon:"fas fa-plus",onClick:t.showForm,"data-test":"open-form-button"},null,8,["onClick"])]),_:1}),t.loading?(o(),c(f,{key:0,mode:"indeterminate",class:"kn-progress-bar","data-test":"progress-bar"})):d("",!0),t.loading?d("",!0):(o(),c(T,{key:1,class:"kn-list--column",options:t.multitenants,filter:!0,filterPlaceholder:t.$t("common.search"),optionLabel:"name",filterMatchMode:"contains",filterFields:t.tenantsDescriptor.filterFields,emptyFilterMessage:t.$t("common.info.noDataFound"),onChange:t.showForm,"data-test":"tenants-list"},{empty:l(()=>[h(r(t.$t("common.info.noDataFound")),1)]),option:l(a=>[s("div",I,[s("div",A,[s("span",null,r(a.option.MULTITENANT_NAME),1),s("span",O,r(a.option.MULTITENANT_THEME),1)]),i(g,{icon:"far fa-trash-alt",class:"p-button-text p-button-rounded p-button-plain",onClick:w(S=>t.deleteTenantConfirm(a.option),["stop"]),"data-test":"delete-button"},null,8,["onClick"])])]),_:1},8,["options","filterPlaceholder","filterFields","emptyFilterMessage","onChange"]))]),s("div",H,[i($,{selectedTenant:t.selTenant,licenses:t.listOfavailableLicenses,onTouched:e[0]||(e[0]=a=>t.touched=!0),onClosed:t.onFormClose,onInserted:t.pageReload},null,8,["selectedTenant","licenses","onClosed","onInserted"]),t.hintVisible?(o(),c(b,{key:0,title:"managers.tenantManagement.hintTitle",hint:"managers.tenantManagement.hint"},null,8,["title","hint"])):d("",!0)])])])}var j=_(B,[["render",K]]);export{j as default};
//# sourceMappingURL=TenantManagement-c5f5e0de.js.map
