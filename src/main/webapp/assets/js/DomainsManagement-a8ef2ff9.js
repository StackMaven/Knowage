import{d as N,i as U,s as M,_ as V,r as l,o as p,h as D,w as s,f as t,a as o,D as m,G as c,t as d,l as q,n as K,X as S,x as $,c as y,g as b,A as C,B as O,C as z}from"./index-1e676509.js";import{f as g}from"./filterHelper-a723991a.js";import{K as H,u as j,c as E}from"./KnValidatonMessages-ebe48c72.js";const G=[{field:"valueCd",header:"managers.domainsManagement.valueCode"},{field:"valueName",header:"managers.domainsManagement.valueName"},{field:"domainCode",header:"managers.domainsManagement.domainCode"},{field:"domainName",header:"managers.domainsManagement.domainName"},{field:"valueDescription",header:"managers.domainsManagement.valueDescription"}],X={style:{width:"60vw"}},J=["valueCd","valueName","domainCode","domainName","valueDescription"],Q={insert:{toastTitle:"common.toast.createTitle"},success:"common.toast.success",update:{toastTitle:"common.toast.updateTitle"}},W={style:{"margin-bottom":"40px"}},Y={column:{style:{width:"18%","word-break":"break-all"}},iconColumn:{style:{"text-align":"end",width:"5%"}}};var T={columns:G,form:X,globalFilterFields:J,operation:Q,pField:W,table:Y};const Z={domain:[{fieldName:"valueCd",validators:[{key:"required"},{key:"maximumCharacters",validator:{type:"maxLength",params:{max:100}}},{key:"regex",validator:{type:"extendedAlphanumericRegex"}}]},{fieldName:"valueName",validators:[{key:"required"},{key:"maximumCharacters",validator:{type:"maxLength",params:{max:40}}},{key:"regex",validator:{type:"extendedAlphanumericRegex"}}]},{fieldName:"domainCode",validators:[{key:"required"},{key:"maximumCharacters",validator:{type:"maxLength",params:{max:20}}},{key:"regex",validator:{type:"extendedAlphanumericRegex"}}]},{fieldName:"domainName",validators:[{key:"required"},{key:"maximumCharacters",validator:{type:"maxLength",params:{max:40}}},{key:"regex",validator:{type:"extendedAlphanumericRegex"}}]},{fieldName:"valueDescription",validators:[{key:"required"},{key:"maximumCharacters",validator:{type:"maxLength",params:{max:160}}},{key:"regex",validator:{type:"extendedAlphanumericRegex"}}]}]};var k={validations:Z};const x=N({name:"domain-management-dialog",components:{Dialog:U,KnValidationMessages:H},props:{model:{type:Object,requried:!1}},emits:["close","created"],data(){return{domainsManagementDescriptor:T,domainsManagementValidationDescriptor:k,domain:{},dirty:!1,v$:j(),operation:"insert"}},validations(){return{domain:E("domain",k.validations.domain)}},computed:{formHeader(){return this.domain.valueId?this.$t("common.edit"):this.$t("common.new")},buttonDisabled(){return this.v$.$invalid}},setup(){return{store:M()}},mounted(){this.model&&(this.domain={...this.model})},watch:{model(){this.domain={...this.model}}},methods:{async handleSubmit(){if(this.v$.$invalid)return;let e="/knowage/restful-services/2.0/domains";this.domain.valueId&&(this.operation="update",e+="/"+this.domain.valueId),await this.sendRequest(e).then(()=>{this.store.setInfo({title:this.$t(this.domainsManagementDescriptor.operation[this.operation].toastTitle),msg:this.$t(this.domainsManagementDescriptor.operation.success)}),this.$emit("created")})},sendRequest(e){return this.operation==="insert"?this.$http.post(e,this.domain):this.$http.put(e,this.domain)},closeTemplate(){this.$emit("close")}}}),_={class:"p-fluid p-m-5",ref:"domain-form"},ee={class:"p-float-label"},ae={for:"valueCd",class:"kn-material-input-label"},oe={class:"p-float-label"},te={for:"valueName",class:"kn-material-input-label"},ne={class:"p-float-label"},ie={for:"domainCode",class:"kn-material-input-label"},le={class:"p-float-label"},se={for:"domainName",class:"kn-material-input-label"},de={class:"p-float-label"},me={for:"valueDescription",class:"kn-material-input-label"};function re(e,a,F,w,B,A){const r=l("InputText"),u=l("KnValidationMessages"),f=l("Button"),h=l("Dialog");return p(),D(h,{visible:!0,modal:!0,class:"p-fluid kn-dialog--toolbar--primary",header:e.formHeader,closable:!1,style:m(e.domainsManagementDescriptor.form.style)},{footer:s(()=>[t(f,{class:"kn-button kn-button--secondary",label:e.$t("common.close"),onClick:e.closeTemplate},null,8,["label","onClick"]),t(f,{class:"kn-button kn-button--primary",label:e.$t("common.save"),disabled:e.buttonDisabled,onClick:e.handleSubmit},null,8,["label","disabled","onClick"])]),default:s(()=>[o("form",_,[o("div",{class:"p-field",style:m(e.domainsManagementDescriptor.pField.style)},[o("span",ee,[t(r,{id:"valueCd",class:c(["kn-material-input",{"p-invalid":e.v$.domain.valueCd.$invalid&&e.v$.domain.valueCd.$dirty}]),type:"text",modelValue:e.v$.domain.valueCd.$model,"onUpdate:modelValue":a[0]||(a[0]=n=>e.v$.domain.valueCd.$model=n),modelModifiers:{trim:!0},maxLength:"100",onBlur:a[1]||(a[1]=n=>e.v$.domain.valueCd.$touch())},null,8,["modelValue","class"]),o("label",ae,d(e.$t("managers.domainsManagement.valueCode"))+" *",1)]),t(u,{vComp:e.v$.domain.valueCd,additionalTranslateParams:{fieldName:e.$t("managers.domainsManagement.valueCode")}},null,8,["vComp","additionalTranslateParams"])],4),o("div",{class:"p-field",style:m(e.domainsManagementDescriptor.pField.style)},[o("span",oe,[t(r,{id:"valueName",class:c(["kn-material-input",{"p-invalid":e.v$.domain.valueName.$invalid&&e.v$.domain.valueName.$dirty}]),type:"text",modelValue:e.v$.domain.valueName.$model,"onUpdate:modelValue":a[2]||(a[2]=n=>e.v$.domain.valueName.$model=n),modelModifiers:{trim:!0},maxLength:"40",onBlur:a[3]||(a[3]=n=>e.v$.domain.valueName.$touch())},null,8,["modelValue","class"]),o("label",te,d(e.$t("managers.domainsManagement.valueName"))+" * ",1)]),t(u,{vComp:e.v$.domain.valueName,additionalTranslateParams:{fieldName:e.$t("managers.domainsManagement.valueName")}},null,8,["vComp","additionalTranslateParams"])],4),o("div",{class:"p-field",style:m(e.domainsManagementDescriptor.pField.style)},[o("span",ne,[t(r,{id:"domainCode",class:c(["kn-material-input",{"p-invalid":e.v$.domain.domainCode.$invalid&&e.v$.domain.domainCode.$dirty}]),type:"text",modelValue:e.v$.domain.domainCode.$model,"onUpdate:modelValue":a[4]||(a[4]=n=>e.v$.domain.domainCode.$model=n),modelModifiers:{trim:!0},maxLength:"20",onBlur:a[5]||(a[5]=n=>e.v$.domain.domainCode.$touch())},null,8,["modelValue","class"]),o("label",ie,d(e.$t("managers.domainsManagement.domainCode"))+" * ",1)]),t(u,{vComp:e.v$.domain.domainCode,additionalTranslateParams:{fieldName:e.$t("managers.domainsManagement.domainCode")}},null,8,["vComp","additionalTranslateParams"])],4),o("div",{class:"p-field",style:m(e.domainsManagementDescriptor.pField.style)},[o("span",le,[t(r,{id:"domainName",class:c(["kn-material-input",{"p-invalid":e.v$.domain.domainName.$invalid&&e.v$.domain.domainName.$dirty}]),type:"text",modelValue:e.v$.domain.domainName.$model,"onUpdate:modelValue":a[6]||(a[6]=n=>e.v$.domain.domainName.$model=n),modelModifiers:{trim:!0},maxLength:"40",onBlur:a[7]||(a[7]=n=>e.v$.domain.domainName.$touch())},null,8,["modelValue","class"]),o("label",se,d(e.$t("managers.domainsManagement.domainName"))+" * ",1)]),t(u,{vComp:e.v$.domain.domainName,additionalTranslateParams:{fieldName:e.$t("managers.domainsManagement.domainName")}},null,8,["vComp","additionalTranslateParams"])],4),o("div",{class:"p-field",style:m(e.domainsManagementDescriptor.pField.style)},[o("span",de,[t(r,{id:"valueDescription",class:c(["kn-material-input",{"p-invalid":e.v$.domain.valueDescription.$invalid&&e.v$.domain.valueDescription.$dirty}]),type:"text",modelValue:e.v$.domain.valueDescription.$model,"onUpdate:modelValue":a[8]||(a[8]=n=>e.v$.domain.valueDescription.$model=n),modelModifiers:{trim:!0},maxLength:"160",onBlur:a[9]||(a[9]=n=>e.v$.domain.valueDescription.$touch())},null,8,["modelValue","class"]),o("label",me,d(e.$t("managers.domainsManagement.valueDescription"))+" * ",1)]),t(u,{vComp:e.v$.domain.valueDescription,additionalTranslateParams:{fieldName:e.$t("managers.domainsManagement.valueDescription")}},null,8,["vComp","additionalTranslateParams"])],4)],512)]),_:1},8,["header","style"])}var ue=V(x,[["render",re]]);const pe=N({name:"domains-management",components:{Column:q,DataTable:K,DomainsManagementDialog:ue,KnFabButton:S},data(){return{domainsManagementDescriptor:T,domains:[],filters:{global:[g],valueCd:{operator:$.AND,constraints:[g]},valueName:{operator:$.AND,constraints:[g]},domainCode:{operator:$.AND,constraints:[g]},domainName:{operator:$.AND,constraints:[g]},valueDescription:{operator:$.AND,constraints:[g]}},formVisible:!1,loading:!1,selectedDomain:null}},setup(){return{store:M()}},created(){this.loadAllDomains()},methods:{async loadAllDomains(){this.loading=!0,await this.$http.get("/knowage/restful-services/2.0/domains").then(e=>{this.domains=e.data}).finally(()=>this.loading=!1)},deleteDomainConfirm(e){this.$confirm.require({message:this.$t("common.toast.deleteMessage"),header:this.$t("common.toast.deleteConfirmTitle"),icon:"pi pi-exclamation-triangle",accept:()=>this.deleteDomain(e)})},async deleteDomain(e){await this.$http.delete("/knowage/restful-services/2.0/domains/"+e).then(()=>{this.store.setInfo({title:this.$t("common.toast.deleteTitle"),msg:this.$t("common.toast.deleteSuccess")}),this.loadAllDomains()})},showForm(e){e&&(this.selectedDomain=e.data),this.formVisible=!0},closeForm(){this.selectedDomain=null,this.formVisible=!1},reloadDomains(){this.formVisible=!1,this.loadAllDomains()}}}),ve={class:"kn-page"},ge={class:"kn-page-content p-grid p-m-0"},ce={key:0,class:"p-col"},$e={class:"table-header"},fe={class:"p-input-icon-left"},he=o("i",{class:"pi pi-search"},null,-1),ye=["title"],be={key:1};function Ce(e,a,F,w,B,A){const r=l("KnFabButton"),u=l("Toolbar"),f=l("ProgressBar"),h=l("InputText"),n=l("Column"),P=l("Button"),L=l("DataTable"),R=l("DomainsManagementDialog");return p(),y("div",ve,[t(u,{class:"kn-toolbar kn-toolbar--primary"},{start:s(()=>[b(d(e.$t("managers.domainsManagement.title")),1)]),end:s(()=>[t(r,{icon:"fas fa-plus",onClick:a[0]||(a[0]=i=>e.showForm()),"data-test":"open-form-button"})]),_:1}),e.loading?(p(),D(f,{key:0,mode:"indeterminate",class:"kn-progress-bar","data-test":"progress-bar"})):C("",!0),o("div",ge,[e.loading?C("",!0):(p(),y("div",ce,[t(L,{value:e.domains,paginator:!0,loading:e.loading,rows:20,selection:e.selectedDomain,"onUpdate:selection":a[2]||(a[2]=i=>e.selectedDomain=i),selectionMode:"single",class:"p-datatable-sm kn-table",dataKey:"valueId",filters:e.filters,"onUpdate:filters":a[3]||(a[3]=i=>e.filters=i),filterDisplay:"menu",globalFilterFields:e.domainsManagementDescriptor.globalFilterFields,rowsPerPageOptions:[10,15,20],responsiveLayout:"stack",breakpoint:"960px",currentPageReportTemplate:e.$t("common.table.footer.paginated",{first:"{first}",last:"{last}",totalRecords:"{totalRecords}"}),onRowClick:a[4]||(a[4]=i=>e.showForm(i)),"data-test":"domains-table"},{header:s(()=>[o("div",$e,[o("span",fe,[he,t(h,{class:"kn-material-input",type:"text",modelValue:e.filters.global.value,"onUpdate:modelValue":a[1]||(a[1]=i=>e.filters.global.value=i),placeholder:e.$t("common.search"),badge:"0","data-test":"search-input"},null,8,["modelValue","placeholder"])])])]),empty:s(()=>[b(d(e.$t("common.info.noDataFound")),1)]),loading:s(()=>[b(d(e.$t("common.info.dataLoading")),1)]),default:s(()=>[(p(!0),y(O,null,z(e.domainsManagementDescriptor.columns,i=>(p(),D(n,{field:i.field,header:e.$t(i.header),key:i.field,style:m(e.domainsManagementDescriptor.table.column.style),sortable:!0,class:"kn-truncated"},{filter:s(({filterModel:v})=>[t(h,{type:"text",modelValue:v.value,"onUpdate:modelValue":I=>v.value=I,class:"p-column-filter"},null,8,["modelValue","onUpdate:modelValue"])]),body:s(v=>[o("span",{title:v.data[i.field]},d(v.data[i.field]),9,ye)]),_:2},1032,["field","header","style"]))),128)),t(n,{style:m(e.domainsManagementDescriptor.table.iconColumn.style)},{body:s(i=>[t(P,{icon:"pi pi-trash",class:"p-button-link",onClick:v=>e.deleteDomainConfirm(i.data.valueId),"data-test":"delete-button"},null,8,["onClick"])]),_:1},8,["style"])]),_:1},8,["value","loading","selection","filters","globalFilterFields","currentPageReportTemplate"])])),e.formVisible?(p(),y("div",be,[t(R,{model:e.selectedDomain,onCreated:e.reloadDomains,onClose:e.closeForm,"data-test":"domain-form"},null,8,["model","onCreated","onClose"])])):C("",!0)])])}var Me=V(pe,[["render",Ce]]);export{Me as default};
//# sourceMappingURL=DomainsManagement-a8ef2ff9.js.map
