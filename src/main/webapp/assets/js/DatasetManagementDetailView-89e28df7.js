import{K as R,u as P,c as I}from"./KnValidatonMessages-ebe48c72.js";import{d as S,ad as q,a5 as F,n as H,l as B,s as j,ae as Ne,_ as E,r as s,o as v,c as V,f as a,w as l,a as o,G as x,t as u,N as Pe,g as $,h as C,A as D,B as N,z,Y as K,D as A,a9 as Re,a8 as Ie,y as we,C as Fe,i as Q,ah as _,a7 as re,aA as $e,aM as Ue,a4 as Oe,q as Le,v as je,u as ze,m as He}from"./index-1e676509.js";import{s as Be}from"./autocomplete.esm-bebdfcbd.js";import{s as ae}from"./checkbox.esm-fa6c8259.js";import{s as Qe}from"./chips.esm-693c3c01.js";import{Q as Je,D as Ke,a as ce,l as ne}from"./QBE-95a8c4bc.js";import{s as Ge}from"./radiobutton.esm-c3e6fa9b.js";import{D as Xe,W as We}from"./WorkspaceDataPreviewDialog-5099e5c1.js";import{s as Ye}from"./inputswitch.esm-80317a38.js";import"./chip.esm-057ba1f1.js";import"./calendar.esm-60a451ba.js";import"./filterHelper-a723991a.js";import"./menu.esm-6bee86d0.js";import"./multiselect.esm-ce4000f7.js";import"./KnCronDescriptor-98645843.js";import"./contextmenu.esm-4301c9fe.js";import"./KnParameterSidebar-7c5f3d6f.js";import"./tree.esm-837306a6.js";import"./KnCalculatedField-ab0b2f81.js";import"./KnHint-6d455703.js";import"./KnScheduler-d2aec922.js";import"./WorkspaceDescriptor-d4693b02.js";const Ze={actions:[{description:"Dataset detail",name:"detaildataset"},{description:"Delete dataset",name:"delete"},{description:"Show Qbe",name:"qbe"}],canLoadData:!0,catTypeId:null,catTypeVn:null,csvDelimiter:"",csvEncoding:"UTF-8",csvQuote:"",dateFormat:"",dateIn:"2021-10-18T12:10:43.000+02:00",description:"CR Test",dsTypeCd:"File",dsVersions:[{dateIn:"2021/10/18 12:09:27",dsId:136,type:"File",userIn:"demo_admin",versNum:1},{dateIn:"2021/10/18 12:10:37",dsId:136,type:"File",userIn:"demo_admin",versNum:2}],endDate:"2021-12-31T00:00:00.000Z",fileName:"CR Test_2.xlsx",fileType:"XLSX",fileUploaded:!1,id:136,isIterable:!1,isPersisted:!0,isPersistedHDFS:!1,isRealtime:!1,isScheduled:!0,label:"CR Test",limitRows:"",meta:[{displayedName:"MONTH_YEAR",fieldType:"ATTRIBUTE",name:"MONTH_YEAR",type:"java.lang.String"},{displayedName:"Numero Assunti_SUM",fieldType:"MEASURE",name:"Numero Assunti_SUM",type:"java.lang.Double"},{displayedName:"Numero Cessati_SUM",fieldType:"MEASURE",name:"Numero Cessati_SUM",type:"java.lang.Double"},{displayedName:"YEAR_MONTH",fieldType:"ATTRIBUTE",name:"YEAR_MONTH",type:"java.lang.String"}],name:"CR Test",owner:"demo_admin",pars:[],persistTableName:"dbtest",pivotColName:null,pivotColValue:null,pivotIsNumRows:!1,pivotRowName:null,recalculateMetadata:!0,schedulingCronLine:"0 0,2,4 * * * ?",scopeCd:"USER",scopeId:186,selected:!0,skipRows:"0",startDate:"2021-12-01T00:00:00.000Z",tags:[{name:"dar",tagId:1}],timestampFormat:"",trasfTypeCd:null,usedByNDocs:0,userIn:"demo_admin",versNum:3,xslSheetNumber:"1"},_e={catTypeId:"",catTypeVn:"",dataSource:"",dataframeName:"",dateIn:"",description:"",dsTypeCd:"",dsVersions:"",isPersisted:!1,isPersistedHDFS:!1,label:"",name:"",owner:"",pars:"",persistTableName:"",pivotIsNumRows:"",pythonEnvironment:{label:"",value:""},pythonScript:"",query:"",queryScript:"",queryScriptLanguage:"",restAddress:"",restDirectlyJSONAttributes:"",restFetchSize:"",restHttpMethod:"",restJsonPathAttributes:"",restJsonPathItems:"",restMaxResults:"",restNGSI:"",restOffset:"",restRequestAdditionalParameters:[],restRequestBody:"*:*",restRequestHeaders:[],scopeCd:"",scopeId:"",solrCollection:"",solrFacetField:"",solrFacetPrefix:"",solrFacetQuery:"",solrFieldList:"",solrType:"FACETS",sparqlDefaultGraphIri:"",sparqlEndpoint:"",sparqlExecutionTimeout:30,sparqlQuery:"",tags:[],trasfTypeCd:"",usedByNDocs:"",userIn:"",versNum:""},et={infoDialog:{width:"60vw"},previewDialog:{width:"80vw"}};var G={cronDataset:Ze,newDataset:_e,style:et};const tt={dataset:[{fieldName:"name",validators:[{key:"required"},{key:"regex",validator:{type:"extendedAlphanumericRegex"}}]},{fieldName:"label",validators:[{key:"required"},{key:"regex",validator:{type:"extendedAlphanumericRegex"}}]},{fieldName:"description",validators:[{key:"regex",validator:{type:"extendedAlphanumericRegex"}}]},{fieldName:"scopeCd",validators:[{key:"required"}]},{fieldName:"catTypeVn",validators:[{key:"required",validator:{type:"cat-type-required"}}]}]};var pe={validations:tt};const at=S({components:{Card:q,Dropdown:F,KnValidationMessages:R,DataTable:H,Column:B,AutoComplete:Be},props:{scopeTypes:{type:Array,required:!0},categoryTypes:{type:Array,required:!0},selectedDataset:{type:Object},selectedDatasetVersions:{type:Array},availableTags:{type:Array},loading:{type:Boolean}},computed:{noDatasetVersions(){return!(this.selectedDatasetVersions.length>0)}},emits:["touched","reloadVersions","loadingOlderVersion","olderVersionLoaded"],data(){return{detailTabDescriptor:pe,loadingVersion:!1,v$:P(),dataset:{},datasetVersions:[],availableTagsNames:[],selectedTagsNames:[],filteredTagsNames:null}},setup(){return{store:j()}},created(){this.dataset=this.selectedDataset},watch:{selectedDataset(){this.dataset=this.selectedDataset,this.v$.dataset.label.$touch(),this.v$.dataset.name.$touch()}},validations(){const t={"cat-type-required":n=>this.dataset.scopeCd=="USER"||n};return{dataset:I("dataset",pe.validations.dataset,t)}},methods:{deleteConfirm(e,t){let r="";e==="deleteOne"?r="managers.datasetManagement.deleteOneVersionMsg":r="managers.datasetManagement.deleteAllVersionsMsg",this.$confirm.require({message:this.$t(r),header:this.$t("common.uppercaseDelete"),icon:"pi pi-exclamation-triangle",accept:()=>{e==="deleteOne"?this.deleteSelectedVersion(t):this.deleteAllVersions()}})},async deleteSelectedVersion(e){return this.$http.delete(`/knowage/restful-services/1.0/datasets/${e.dsId}/version/${e.versNum}`).then(()=>{this.store.setInfo({title:this.$t("common.toast.deleteTitle"),msg:this.$t("common.toast.deleteSuccess")}),this.$emit("reloadVersions")}).catch(t=>this.store.setError({title:this.$t("common.error.generic"),msg:t.message}))},async deleteAllVersions(){return this.$http.delete(`/knowage/restful-services/1.0/datasets/${this.selectedDataset.id}/allversions/`).then(()=>{this.store.setInfo({title:this.$t("common.toast.deleteTitle"),msg:this.$t("managers.datasetManagement.deleteAllVersionsSuccess")}),this.$emit("reloadVersions")}).catch(e=>this.store.setError({title:this.$t("common.error.generic"),msg:e.message}))},restoreVersionConfirm(e){this.$confirm.require({icon:"pi pi-exclamation-triangle",message:this.$t("managers.datasetManagement.restoreMsg"),header:this.$t("managers.datasetManagement.restoreTitle"),accept:()=>this.restoreVersion(e)})},async restoreVersion(e){this.$emit("loadingOlderVersion"),await this.$http.get(`/knowage/restful-services/1.0/datasets/${this.dataset.id}/restore?versionId=${e.versNum}`).then(t=>{this.dataset.dsTypeCd.toLowerCase()=="file"&&this.refactorFileDatasetConfig(t.data[0]),this.$emit("olderVersionLoaded",t.data[0])}),this.loadingVersion=!1},refactorFileDatasetConfig(e){this.dataset.fileType=e!=null?e.fileType:"",this.dataset.fileName=e!=null?e.fileName:"",this.dataset.csvEncoding=e!=null?e.csvEncoding:"UTF-8",this.dataset.csvDelimiter=e!=null?e.csvDelimiter:",",this.dataset.csvQuote=e!=null?e.csvQuote:'"',this.dataset.dateFormat=e!=null&&e.dateFormat!=null?e.dateFormat:"dd/MM/yyyy",this.dataset.timestampFormat=e!=null&&e.timestampFormat!=null?e.timestampFormat:"dd/MM/yyyy HH:mm:ss",e!=null?e.limitRows!=null&&e.limitRows!=""?this.dataset.limitRows=Number(e.limitRows):this.dataset.limitRows=e.limitRows:this.dataset.limitRows=null,this.dataset.catTypeVn=e!=null?e.catTypeVn:"",e!=null?(this.dataset.catTypeId=Number(e.catTypeId),this.dataset.xslSheetNumber=Number(1),this.dataset.skipRows=Number(e.skipRows),this.dataset.limitRows=Number(null)):(this.dataset.catTypeId=null,this.dataset.xslSheetNumber=null,this.dataset.skipRows=null,this.dataset.limitRows=null),this.dataset.id=e!=null?e.id:"",this.dataset.label=e!=null?e.label:"",this.dataset.name=e!=null?e.name:"",this.dataset.description=e!=null?e.description:"",this.dataset.meta=e!=null?e.meta:[],this.dataset.fileUploaded=!1},searchTag(e){setTimeout(()=>{e.query.trim().length?this.filteredTagsNames=this.availableTags.filter(t=>t.name.toLowerCase().startsWith(e.query.toLowerCase())):this.filteredTagsNames=[...this.availableTags]},250)},createTagChip(e){e.target.value&&(this.availableTags.find(r=>r.name==e.target.value)||(this.dataset.tags.push(e.target.value),this.buildTagObject(),e.target.value=""))},buildTagObject(){this.dataset.tags=this.dataset.tags.map(e=>typeof e!="string"?e:{name:e})},formatDate(e){return Ne(e,{dateStyle:"short",timeStyle:"short"})},updateIdFromCd(e,t,r){const n=e.find(m=>m.VALUE_CD===r);n&&(this.dataset[t]=n.VALUE_ID)}}}),ot={class:"p-fluid p-formgrid p-grid"},rt={class:"p-field p-mt-1 p-col-6"},nt={class:"p-float-label"},st={for:"label",class:"kn-material-input-label"},it={class:"p-field p-mt-1 p-col-6"},lt={class:"p-float-label"},dt={for:"name",class:"kn-material-input-label"},ct={class:"p-field p-mt-1 p-col-12"},pt={class:"p-float-label"},ut={for:"description",class:"kn-material-input-label"},mt={class:"p-field p-mt-1 p-col-6"},bt={class:"p-float-label"},vt={for:"scope",class:"kn-material-input-label"},kt={class:"p-field p-mt-1 p-col-6"},ft={class:"p-float-label"},ht={key:0,for:"category",class:"kn-material-input-label"},gt={key:1,for:"category",class:"kn-material-input-label"},yt={class:"p-field p-mt-1 p-col-12"},wt={class:"p-float-label kn-material-input"},$t={for:"tags",class:"kn-material-input-label"},Ct={id:"username1-help"};function Mt(e,t,r,n,m,y){const i=s("InputText"),b=s("KnValidationMessages"),p=s("Dropdown"),f=s("AutoComplete"),d=s("Card"),w=s("Button"),g=s("Toolbar"),h=s("ProgressBar"),k=s("Column"),M=s("DataTable");return v(),V(N,null,[a(d,{class:"p-m-2"},{content:l(()=>[o("form",ot,[o("div",rt,[o("span",nt,[a(i,{id:"label",class:x(["kn-material-input",{"p-invalid":e.v$.dataset.label.$invalid&&e.v$.dataset.label.$dirty}]),type:"text",maxLength:"50",modelValue:e.v$.dataset.label.$model,"onUpdate:modelValue":t[0]||(t[0]=c=>e.v$.dataset.label.$model=c),onBlur:t[1]||(t[1]=c=>e.v$.dataset.label.$touch()),onChange:t[2]||(t[2]=c=>e.$emit("touched")),"data-test":"label-input"},null,8,["modelValue","class"]),o("label",st,u(e.$t("common.label"))+" * ",1)]),a(b,{class:"p-mt-1",vComp:e.v$.dataset.label,additionalTranslateParams:{fieldName:e.$t("common.label")}},null,8,["vComp","additionalTranslateParams"])]),o("div",it,[o("span",lt,[a(i,{id:"name",class:x(["kn-material-input",{"p-invalid":e.v$.dataset.name.$invalid&&e.v$.dataset.name.$dirty}]),type:"text",maxLength:"50",modelValue:e.v$.dataset.name.$model,"onUpdate:modelValue":t[3]||(t[3]=c=>e.v$.dataset.name.$model=c),onBlur:t[4]||(t[4]=c=>e.v$.dataset.name.$touch()),onChange:t[5]||(t[5]=c=>e.$emit("touched")),"data-test":"name-input"},null,8,["modelValue","class"]),o("label",dt,u(e.$t("common.name"))+" * ",1)]),a(b,{class:"p-mt-1",vComp:e.v$.dataset.name,additionalTranslateParams:{fieldName:e.$t("common.name")}},null,8,["vComp","additionalTranslateParams"])]),o("div",ct,[o("span",pt,[a(i,{id:"description",class:x(["kn-material-input",{"p-invalid":e.v$.dataset.description.$invalid&&e.v$.dataset.description.$dirty}]),type:"text",maxLength:"150",modelValue:e.v$.dataset.description.$model,"onUpdate:modelValue":t[6]||(t[6]=c=>e.v$.dataset.description.$model=c),onBlur:t[7]||(t[7]=c=>e.v$.dataset.description.$touch()),onChange:t[8]||(t[8]=c=>e.$emit("touched")),"data-test":"description-input"},null,8,["modelValue","class"]),o("label",ut,u(e.$t("common.description")),1)]),a(b,{class:"p-mt-1",vComp:e.v$.dataset.description,additionalTranslateParams:{fieldName:e.$t("common.description")}},null,8,["vComp","additionalTranslateParams"])]),o("div",mt,[o("span",bt,[a(p,{id:"scope",class:x(["kn-material-input",{"p-invalid":e.v$.dataset.scopeCd.$invalid&&e.v$.dataset.scopeCd.$dirty}]),options:e.scopeTypes,optionLabel:"VALUE_CD",optionValue:"VALUE_CD",modelValue:e.v$.dataset.scopeCd.$model,"onUpdate:modelValue":t[9]||(t[9]=c=>e.v$.dataset.scopeCd.$model=c),onBeforeShow:t[10]||(t[10]=c=>e.v$.dataset.scopeCd.$touch()),onChange:t[11]||(t[11]=c=>(e.updateIdFromCd(this.scopeTypes,"scopeId",c.value),e.$emit("touched"))),"data-test":"scope-input"},null,8,["options","modelValue","class"]),o("label",vt,u(e.$t("managers.datasetManagement.scope"))+" * ",1)]),a(b,{vComp:e.v$.dataset.scopeCd,additionalTranslateParams:{fieldName:e.$t("managers.datasetManagement.scope")}},null,8,["vComp","additionalTranslateParams"])]),o("div",kt,[o("span",ft,[a(p,{id:"category",class:x(["kn-material-input",{"p-invalid":e.v$.dataset.catTypeVn.$invalid&&e.v$.dataset.catTypeVn.$dirty}]),options:e.categoryTypes,optionLabel:"VALUE_CD",optionValue:"VALUE_CD",modelValue:e.v$.dataset.catTypeVn.$model,"onUpdate:modelValue":t[12]||(t[12]=c=>e.v$.dataset.catTypeVn.$model=c),onBeforeShow:t[13]||(t[13]=c=>e.v$.dataset.catTypeVn.$touch()),onChange:t[14]||(t[14]=c=>(e.updateIdFromCd(this.categoryTypes,"catTypeId",c.value),e.$emit("touched"))),"data-test":"category-input"},null,8,["options","modelValue","class"]),this.dataset.scopeCd=="USER"?(v(),V("label",ht,u(e.$t("common.category")),1)):(v(),V("label",gt,u(e.$t("common.category"))+" * ",1))]),a(b,{vComp:e.v$.dataset.catTypeVn,additionalTranslateParams:{fieldName:e.$t("managers.datasetManagement.scope")}},null,8,["vComp","additionalTranslateParams"])]),o("div",yt,[o("span",wt,[a(f,{modelValue:e.dataset.tags,"onUpdate:modelValue":t[15]||(t[15]=c=>e.dataset.tags=c),suggestions:e.filteredTagsNames,multiple:!0,onComplete:e.searchTag,onKeydown:Pe(e.createTagChip,["enter"])},{chip:l(c=>[$(u(c.value.name),1)]),item:l(c=>[$(u(c.item.name),1)]),_:1},8,["modelValue","suggestions","onComplete","onKeydown"]),o("label",$t,u(e.$t("common.tags")),1)]),o("small",Ct,u(e.$t("managers.widgetGallery.tags.availableCharacters")),1)])])]),_:1}),a(d,{class:"p-m-2"},{header:l(()=>[a(g,{class:"kn-toolbar kn-toolbar--secondary"},{start:l(()=>[$(u(e.$t("managers.datasetManagement.oldVersions")),1)]),end:l(()=>[a(w,{icon:"fas fa-eraser",class:"p-button-text p-button-rounded p-button-plain",disabled:e.noDatasetVersions,onClick:t[16]||(t[16]=c=>e.deleteConfirm("deleteAll"))},null,8,["disabled"])]),_:1})]),content:l(()=>[e.loading?(v(),C(h,{key:0,mode:"indeterminate",class:"kn-progress-bar","data-test":"versions-loading"})):D("",!0),e.loading?D("",!0):(v(),C(M,{key:1,class:"p-datatable-sm kn-table",value:e.selectedDatasetVersions,scrollable:!0,scrollHeight:"400px",loading:e.loading,dataKey:"versNum",responsiveLayout:"stack",breakpoint:"960px"},{empty:l(()=>[$(u(e.$t("managers.datasetManagement.noVersions")),1)]),default:l(()=>[a(k,{field:"userIn",header:e.$t("managers.datasetManagement.creationUser"),sortable:!0},null,8,["header"]),a(k,{field:"type",header:e.$t("importExport.gallery.column.type"),sortable:!0},null,8,["header"]),a(k,{field:"dateIn",header:e.$t("managers.mondrianSchemasManagement.headers.creationDate"),dataType:"date",sortable:!0},{body:l(({data:c})=>[$(u(e.formatDate(c.dateIn)),1)]),_:1},8,["header"]),a(k,{onRowClick:c=>!1},{body:l(c=>[c.data.versNum!==0?(v(),C(w,{key:0,icon:"fas fa-retweet",class:"p-button-link",onClick:T=>e.restoreVersionConfirm(c.data)},null,8,["onClick"])):D("",!0),c.data.versNum!==0?(v(),C(w,{key:1,icon:"pi pi-trash",class:"p-button-link",onClick:T=>e.deleteConfirm("deleteOne",c.data)},null,8,["onClick"])):D("",!0)]),_:1})]),_:1},8,["value","loading"]))]),_:1})],64)}var Dt=E(at,[["render",Mt]]);const Tt={columnStyle:{height:"25px"},maxWidth:{width:"100%"}},Vt={dataset:[{fieldName:"dsTypeCd",validators:[{key:"required"}]}]};var ue={style:Tt,validations:Vt};const At=[{name:"String",value:"String"},{name:"Number",value:"Number"},{name:"Raw",value:"Raw"},{name:"Generic",value:"Generic"}],xt=["string","int","double","date yyy-MM-dd","timestamp yyyy-MM-dd HH:mm:ss","ISO8601 yyyy-MM-ddTHH:mm:ss.SSSZ","time HH:mm:ss","boolean"],St={jsonPathValue:"",name:"",typeOrJsonPathValue:""},Et={defaultValue:"",multiValue:!1,name:"",type:""},qt={name:"",value:""},Nt={columnStyle:{height:"25px"},maxWidth:{width:"100%"}};var O={datasetParamTypes:At,jsonPathTypes:xt,newJsonPathAttr:St,newParam:Et,newRequestHeader:qt,style:Nt};const Pt=S({components:{Card:q,Chips:Qe,Dropdown:F,DataTable:H,Column:B,Checkbox:ae},props:{selectedDataset:{type:Object}},computed:{disableDeleteAll(){return!this.dataset.pars||this.dataset.pars.length==0}},emits:["touched"],data(){return{tableDescriptor:O,dataset:{},expandParamsCard:!0,datasetParamTypes:O.datasetParamTypes}},created(){this.dataset=this.selectedDataset},watch:{selectedDataset(){this.dataset=this.selectedDataset}},methods:{addNewParam(){this.dataset.isPersisted?this.$confirm.require({message:this.$t("managers.datasetManagement.disablePersistenceMsg"),header:this.$t("managers.datasetManagement.disablePersistence"),icon:"pi pi-exclamation-triangle",accept:()=>{this.dataset.isPersisted=!1,this.dataset.persistTableName=null,this.insertParameter()}}):this.insertParameter()},checkboxChange(e){e.multiValue?e.defaultValue&&(e.defaultValue=[e.defaultValue]):e.defaultValue&&(e.defaultValue=e.defaultValue.join("")),this.$forceUpdate()},insertParameter(){this.dataset.pars||(this.dataset.pars=[]);const e={...O.newParam};this.dataset.pars.push(e)},deleteParam(e){this.$confirm.require({message:this.$t("common.toast.deleteMessage"),header:this.$t("common.uppercaseDelete"),icon:"pi pi-exclamation-triangle",accept:()=>this.dataset.pars=this.dataset.pars.filter(t=>e.data.name!==t.name)})},removeAllParams(){this.$confirm.require({message:this.$t("managers.datasetManagement.deleteAllParamsMsg"),header:this.$t("managers.datasetManagement.deleteAllParams"),icon:"pi pi-exclamation-triangle",accept:()=>this.dataset.pars=[]})},onCellEditComplete(e){this.dataset.pars[e.index]=e.newData}}}),Rt={key:1,class:"p-d-flex p-flex-column chipsContainer"},It={id:"chips-help"},Ft={key:1,class:"p-d-flex p-flex-column chipsContainer"},Ut={id:"chips-help"};function Ot(e,t,r,n,m,y){const i=s("Button"),b=s("Toolbar"),p=s("InputText"),f=s("Column"),d=s("Dropdown"),w=s("Chips"),g=s("Checkbox"),h=s("DataTable"),k=s("Card");return v(),V(N,null,[a(b,{class:"kn-toolbar kn-toolbar--secondary p-mt-2 p-mx-2"},{start:l(()=>[e.expandParamsCard?(v(),C(i,{key:1,icon:"fas fa-chevron-down",class:"p-button-text p-button-rounded p-button-plain",style:{color:"white"},onClick:t[1]||(t[1]=M=>e.expandParamsCard=!1)})):(v(),C(i,{key:0,icon:"fas fa-chevron-right",class:"p-button-text p-button-rounded p-button-plain",style:{color:"white"},onClick:t[0]||(t[0]=M=>e.expandParamsCard=!0)})),$(" "+u(e.$t("managers.datasetManagement.params")),1)]),end:l(()=>[a(i,{icon:"fas fa-plus",class:"p-button-text p-button-rounded p-button-plain",onClick:e.addNewParam},null,8,["onClick"]),a(i,{icon:"fas fa-eraser",class:"p-button-text p-button-rounded p-button-plain",disabled:e.disableDeleteAll,onClick:e.removeAllParams},null,8,["disabled","onClick"])]),_:1}),z(a(k,{class:"p-mx-2"},{content:l(()=>[a(h,{class:"p-datatable-sm kn-table",editMode:"cell",value:e.dataset.pars,scrollable:!0,scrollHeight:"250px",dataKey:"versNum",responsiveLayout:"stack",breakpoint:"960px",onCellEditComplete:e.onCellEditComplete},{empty:l(()=>[$(u(e.$t("managers.datasetManagement.tableEmpty")),1)]),default:l(()=>[a(f,{field:"name",header:e.$t("kpi.alert.name"),sortable:!0},{editor:l(({data:M})=>[a(p,{class:"kn-material-input",style:A(e.tableDescriptor.style.columnStyle),modelValue:M.name,"onUpdate:modelValue":c=>M.name=c},null,8,["style","modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),a(f,{field:"type",header:e.$t("kpi.alert.type"),sortable:!0},{editor:l(({data:M})=>[a(d,{id:"scope",class:"kn-material-input",style:A(e.tableDescriptor.style.columnStyle),options:e.datasetParamTypes,optionLabel:"value",optionValue:"value",modelValue:M.type,"onUpdate:modelValue":c=>M.type=c},null,8,["style","options","modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),a(f,{field:"defaultValue",header:e.$t("managers.driversManagement.useModes.defaultValue"),sortable:!0},{editor:l(({data:M})=>[M.multiValue===!1?(v(),C(p,{key:0,class:"kn-material-input",style:A(e.tableDescriptor.style.columnStyle),modelValue:M.defaultValue,"onUpdate:modelValue":c=>M.defaultValue=c},null,8,["style","modelValue","onUpdate:modelValue"])):(v(),V("div",Rt,[a(w,{class:"kn-border-none",modelValue:M.defaultValue,"onUpdate:modelValue":c=>M.defaultValue=c},null,8,["modelValue","onUpdate:modelValue"]),o("small",It,u(e.$t("common.chipsHint")),1)]))]),body:l(({data:M})=>[M.multiValue===!1?(v(),C(p,{key:0,class:"kn-material-input",style:A(e.tableDescriptor.style.columnStyle),modelValue:M.defaultValue,"onUpdate:modelValue":c=>M.defaultValue=c},null,8,["style","modelValue","onUpdate:modelValue"])):(v(),V("div",Ft,[a(w,{class:"kn-border-none",modelValue:M.defaultValue,"onUpdate:modelValue":c=>M.defaultValue=c},null,8,["modelValue","onUpdate:modelValue"]),o("small",Ut,u(e.$t("common.chipsHint")),1)]))]),_:1},8,["header"]),a(f,{field:"multiValue",header:e.$t("managers.profileAttributesManagement.form.multiValue"),sortable:!0},{body:l(({data:M})=>[a(g,{modelValue:M.multiValue,"onUpdate:modelValue":c=>M.multiValue=c,binary:!0,onChange:c=>e.checkboxChange(M)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),editor:l(({data:M})=>[a(g,{modelValue:M.multiValue,"onUpdate:modelValue":c=>M.multiValue=c,binary:!0,onChange:c=>e.checkboxChange(M)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1},8,["header"]),a(f,{onRowClick:M=>!1},{body:l(M=>[a(i,{icon:"pi pi-trash",class:"p-button-link",onClick:c=>e.deleteParam(M)},null,8,["onClick"])]),_:1})]),_:1},8,["value","onCellEditComplete"])]),_:1},512),[[K,e.expandParamsCard]])],64)}var Lt=E(Pt,[["render",Ot],["__scopeId","data-v-29e2047e"]]);const jt=[{name:",",value:","},{name:";",value:";"},{name:"\\t",value:"\\t"},{name:"|",value:"|"}],zt=[{name:"windows-1252",value:"windows-1252"},{name:"UTF-8",value:"UTF-8"},{name:"UTF-8-BOM",value:"UTF-8-BOM"},{name:"UTF-16",value:"UTF-16"},{name:"US-ASCII",value:"US-ASCII"},{name:"ISO-8859-1",value:"ISO-8859-1"}],Ht=[{name:'"',value:'"'},{name:"'",value:"'"}],Bt=[{name:"dd/MM/yyyy",value:"dd/MM/yyyy"},{name:"MM/dd/yyyy",value:"MM/dd/yyyy"},{name:"dd-MM-yyyy",value:"dd-MM-yyyy"},{name:"MM-dd-yyyy",value:"MM-dd-yyyy"},{name:"yyyy-MM-dd",value:"yyyy-MM-dd"},{name:"yyyy:MM:dd",value:"yyyy:MM:dd"},{name:"dd.MM.yyyy",value:"dd.MM.yyyy"},{name:"MM.dd.yyyy",value:"MM.dd.yyyy"}],Qt={maxwidth:"width:100%"},Jt=[{name:"dd/MM/yyyy HH:mm:ss",value:"dd/MM/yyyy HH:mm:ss"},{name:"MM/dd/yyyy hh:mm:ss a",value:"MM/dd/yyyy hh:mm:ss a"},{name:"dd-MM-yyyy hh:mm:ss a",value:"dd-MM-yyyy hh:mm:ss a"},{name:"MM-dd-yyyy hh:mm:ss a",value:"MM-dd-yyyy hh:mm:ss a"},{name:"yyyy-MM-dd hh:mm:ss a",value:"yyyy-MM-dd hh:mm:ss a"},{name:"yyyy:MM:dd hh:mm:ss a",value:"yyyy:MM:dd hh:mm:ss a"},{name:"dd.MM.yyyy HH:mm:ss",value:"dd.MM.yyyy HH:mm:ss"},{name:"MM.dd.yyyy HH:mm:ss",value:"MM.dd.yyyy HH:mm:ss"}],Kt={dataset:[{fieldName:"fileName",validators:[{key:"required",validator:{type:"file-fields-required"}}]}]};var me={csvDelimiterCharacterTypes:jt,csvEncodingTypes:zt,csvQuoteCharacterTypes:Ht,dateFormatTypes:Bt,style:Qt,timestampFormatTypes:Jt,validations:Kt};const Gt=S({components:{Card:q,KnValidationMessages:R,KnInputFile:Re,Dropdown:F,DataTable:H,Column:B},props:{selectedDataset:{type:Object},dataSources:{type:Array}},emits:["touched","fileUploaded","checkFormulaForParams"],data(){return{v$:P(),fileDescriptor:me,dataset:{},triggerUpload:!1,uploading:!1,loading:!1,expandTableCard:!0,columns:[],rows:[]}},setup(){return{store:j()}},created(){this.dataset=this.selectedDataset,this.dataset.id&&this.getPreviewData()},watch:{selectedDataset(){this.dataset=this.selectedDataset,this.dataset.id&&this.getPreviewData()}},validations(){const t={"file-fields-required":n=>this.dataset.dsTypeCd!="File"||n};return{dataset:I("dataset",me.validations.dataset,t)}},methods:{setUploadType(){this.triggerUpload=!1,setTimeout(()=>this.triggerUpload=!0,200)},uploadDatasetFile(e){this.uploading=!0;let t=e.target.files[0];t.name.includes(this.dataset.fileName)?(this.store.setError({title:this.$t("common.toast.errorTitle"),msg:this.$t("common.error.sameFileName")}),this.triggerUpload=!1):this.startUpload(t),this.triggerUpload=!1,setTimeout(()=>this.uploading=!1,200)},async startUpload(e){var t=new FormData;t.append("file",e),await this.$http.post("/knowage/restful-services/selfservicedatasetupload/fileupload",t,{headers:{"Content-Type":"multipart/form-data; boundary=----WebKitFormBoundaryFYwjkDOpT85ZFN3L"}}).then(r=>{this.store.setInfo({title:this.$t("common.uploading"),msg:this.$t("importExport.import.successfullyCompleted")}),this.dataset.fileType=r.data.fileType,this.dataset.fileName=r.data.fileName,this.$emit("fileUploaded"),this.resetFields(),this.getPreviewData()}).catch().finally(()=>{this.triggerUpload=!1})},resetFields(){this.dataset.csvEncoding="UTF-8",this.dataset.csvDelimiter=",",this.dataset.dateFormat="dd/MM/yyyy",this.dataset.timestampFormat="dd/MM/yyyy HH:mm:ss",this.dataset.csvQuote='"',this.dataset.skipRows=0,this.dataset.limitRows=null,this.dataset.xslSheetNumber=1,(this.dataset.fileType=="XLS"||this.dataset.fileType=="XLSX")&&(this.dataset.limitRows="",this.dataset.csvDelimiter="",this.dataset.dateFormat="",this.dataset.timestampFormat="",this.dataset.csvQuote="")},async downloadDatasetFile(){var e=encodeURI(this.dataset.label);await this.$http.get(`/knowage/restful-services/2.0/datasets/download/file?dsLabel=${e}&type=${this.dataset.fileType}`,{headers:{Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"}}).then(t=>{t.data.errors?this.store.setError({title:this.$t("common.error.downloading"),msg:this.$t("common.error.errorCreatingPackage")}):(this.store.setInfo({title:this.$t("common.toast.success")}),t.headers&&Ie(t.data,this.createCompleteFileName(t),t.headers["content-type"]))},t=>this.store.setError({title:this.$t("common.error.downloading"),msg:this.$t(t)}))},createCompleteFileName(e){var t=e.headers["content-disposition"],r=t.match(/filename[^;\n=]*=((['"]).*?\2|[^;\n]*)/i)[1],n=r.replaceAll('"',"");return n},async getPreviewData(e=!0){this.loading=!0,this.dataset.limit=10,e||delete this.dataset.meta,await this.$http.post("/knowage/restful-services/1.0/datasets/preview",this.dataset,{headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json;charset=UTF-8","X-Disable-Errors":"true"}}).then(t=>{t.data.metaData.fields.forEach(n=>{typeof n!="object"||this.columns.push(n)}),this.rows=t.data.rows}).catch().finally(()=>this.loading=!1)}}}),Xt={class:"p-d-flex"},Wt={class:"p-float-label"},Yt={for:"fileName",class:"kn-material-input-label"},Zt={key:0,class:"p-fluid p-formgrid p-grid p-mt-3"},_t={class:"p-field p-float-label p-col"},ea={for:"scope",class:"kn-material-input-label"},ta={class:"p-field p-float-label p-col"},aa={for:"scope",class:"kn-material-input-label"},oa={class:"p-field p-float-label p-col"},ra={for:"scope",class:"kn-material-input-label"},na={class:"p-field p-float-label p-col"},sa={for:"scope",class:"kn-material-input-label"},ia={class:"p-field p-float-label p-col"},la={for:"scope",class:"kn-material-input-label"},da={key:1,class:"p-fluid p-formgrid p-grid p-mt-3"},ca={class:"p-field p-col"},pa={class:"p-float-label"},ua={for:"skipRows",class:"kn-material-input-label"},ma={class:"p-field p-col"},ba={class:"p-float-label"},va={for:"limitRows",class:"kn-material-input-label"},ka={class:"p-field p-col"},fa={class:"p-float-label"},ha={for:"sheetnumber",class:"kn-material-input-label"},ga={key:0,id:"preview-container"};function ya(e,t,r,n,m,y){const i=s("InputText"),b=s("KnValidationMessages"),p=s("Button"),f=s("KnInputFile"),d=s("Dropdown"),w=s("Card"),g=s("Toolbar"),h=s("Column"),k=s("DataTable"),M=we("tooltip");return v(),V(N,null,[a(w,{class:"p-m-2"},{content:l(()=>[o("div",Xt,[o("div",{class:"p-field",style:A(e.fileDescriptor.style.maxwidth)},[o("span",Wt,[a(i,{id:"fileName",class:x(["kn-material-input",{"p-invalid":e.v$.dataset.fileName.$invalid&&e.v$.dataset.fileName.$dirty}]),style:A(e.fileDescriptor.style.maxwidth),modelValue:e.v$.dataset.fileName.$model,"onUpdate:modelValue":t[0]||(t[0]=c=>e.v$.dataset.fileName.$model=c),modelModifiers:{trim:!0},disabled:!0,onBlur:t[1]||(t[1]=c=>e.v$.dataset.fileName.$touch()),onChange:t[2]||(t[2]=c=>e.$emit("touched"))},null,8,["style","modelValue","class"]),o("label",Yt,u(e.$t("downloadsDialog.columns.fileName"))+" * ",1)]),a(b,{class:"p-mt-1",vComp:e.v$.dataset.fileName,additionalTranslateParams:{fieldName:e.$t("downloadsDialog.columns.fileName")}},null,8,["vComp","additionalTranslateParams"])],4),a(p,{icon:"fas fa-upload",class:"p-button-text p-button-plain p-ml-2",onClick:e.setUploadType},null,8,["onClick"]),a(p,{icon:"fas fa-download",class:"p-button-text y p-button-plain p-ml-2",onClick:e.downloadDatasetFile},null,8,["onClick"]),e.uploading?D("",!0):(v(),C(f,{key:0,changeFunction:e.uploadDatasetFile,accept:".csv, .xls, .xlsx",triggerInput:e.triggerUpload},null,8,["changeFunction","triggerInput"]))]),e.dataset.fileType&&e.dataset.fileType=="CSV"?(v(),V("div",Zt,[o("span",_t,[a(d,{id:"csvDelimiter",class:"kn-material-input",options:e.fileDescriptor.csvDelimiterCharacterTypes,optionLabel:"name",optionValue:"value",modelValue:e.dataset.csvDelimiter,"onUpdate:modelValue":t[3]||(t[3]=c=>e.dataset.csvDelimiter=c),onChange:t[4]||(t[4]=c=>e.getPreviewData(!1))},null,8,["options","modelValue"]),o("label",ea,u(e.$t("managers.datasetManagement.ckanCsvDelimiter")),1)]),o("span",ta,[a(d,{id:"csvQuote",class:"kn-material-input",options:e.fileDescriptor.csvQuoteCharacterTypes,optionLabel:"name",optionValue:"value",modelValue:e.dataset.csvQuote,"onUpdate:modelValue":t[5]||(t[5]=c=>e.dataset.csvQuote=c),onChange:t[6]||(t[6]=c=>e.getPreviewData(!1))},null,8,["options","modelValue"]),o("label",aa,u(e.$t("managers.datasetManagement.ckanCsvQuote")),1)]),o("span",oa,[a(d,{id:"csvEncoding",class:"kn-material-input",options:e.fileDescriptor.csvEncodingTypes,optionLabel:"name",optionValue:"value",modelValue:e.dataset.csvEncoding,"onUpdate:modelValue":t[7]||(t[7]=c=>e.dataset.csvEncoding=c),onChange:t[8]||(t[8]=c=>e.getPreviewData(!1))},null,8,["options","modelValue"]),o("label",ra,u(e.$t("managers.datasetManagement.ckanCsvEncoding")),1)]),o("span",na,[a(d,{id:"dateFormat",class:"kn-material-input",options:e.fileDescriptor.dateFormatTypes,optionLabel:"name",optionValue:"value",modelValue:e.dataset.dateFormat,"onUpdate:modelValue":t[9]||(t[9]=c=>e.dataset.dateFormat=c),onChange:t[10]||(t[10]=c=>e.getPreviewData(!1))},null,8,["options","modelValue"]),o("label",sa,u(e.$t("managers.datasetManagement.ckanDateFormat")),1)]),o("span",ia,[a(d,{id:"timestampFormat",class:"kn-material-input",options:e.fileDescriptor.timestampFormatTypes,optionLabel:"name",optionValue:"value",modelValue:e.dataset.timestampFormat,"onUpdate:modelValue":t[11]||(t[11]=c=>e.dataset.timestampFormat=c),onChange:t[12]||(t[12]=c=>e.getPreviewData(!1))},null,8,["options","modelValue"]),o("label",la,u(e.$t("managers.datasetManagement.timestampFormat")),1)])])):D("",!0),e.dataset.fileType=="XLS"||e.dataset.fileType=="XLSX"?(v(),V("div",da,[o("div",ca,[o("span",pa,[a(i,{id:"skipRows",class:"kn-material-input",type:"number",modelValue:e.dataset.skipRows,"onUpdate:modelValue":t[13]||(t[13]=c=>e.dataset.skipRows=c),modelModifiers:{trim:!0},onChange:t[14]||(t[14]=c=>e.getPreviewData(!1))},null,8,["modelValue"]),o("label",ua,u(e.$t("managers.datasetManagement.ckanSkipRows")),1)])]),o("div",ma,[o("span",ba,[a(i,{id:"limitRows",class:"kn-material-input",type:"number",modelValue:e.dataset.limitRows,"onUpdate:modelValue":t[15]||(t[15]=c=>e.dataset.limitRows=c),modelModifiers:{trim:!0},onChange:t[16]||(t[16]=c=>e.getPreviewData(!1))},null,8,["modelValue"]),o("label",va,u(e.$t("managers.datasetManagement.ckanLimitRows")),1)])]),o("div",ka,[o("span",fa,[a(i,{id:"sheetnumber",class:"kn-material-input",type:"number",modelValue:e.dataset.xslSheetNumber,"onUpdate:modelValue":t[17]||(t[17]=c=>e.dataset.xslSheetNumber=c),modelModifiers:{trim:!0},onChange:t[18]||(t[18]=c=>e.getPreviewData(!1))},null,8,["modelValue"]),o("label",ha,u(e.$t("managers.datasetManagement.ckanXslSheetNumber")),1)])])])):D("",!0)]),_:1}),e.rows.length>0?(v(),V("div",ga,[a(g,{class:"kn-toolbar kn-toolbar--secondary p-mt-3"},{start:l(()=>[e.expandTableCard?(v(),C(p,{key:1,icon:"fas fa-chevron-down",class:"p-button-text p-button-rounded p-button-plain",style:{color:"white"},onClick:t[20]||(t[20]=c=>e.expandTableCard=!1)})):(v(),C(p,{key:0,icon:"fas fa-chevron-right",class:"p-button-text p-button-rounded p-button-plain",style:{color:"white"},onClick:t[19]||(t[19]=c=>e.expandTableCard=!0)})),$(" "+u(e.$t("managers.lovsManagement.preview")),1)]),end:l(()=>[z(a(p,{icon:"pi pi-refresh",class:"p-button-text p-button-rounded p-button-plain p-ml-auto",onClick:e.getPreviewData},null,8,["onClick"]),[[M,e.$t("common.refresh"),void 0,{left:!0}]])]),_:1}),z(a(w,{class:"p-m-2"},{content:l(()=>[a(k,{value:e.rows,class:"p-datatable-sm kn-table",loading:e.loading,responsiveLayout:"scroll",scrollable:!0,scrollDirection:"both",scrollHeight:"800px",stripedRows:"",rowHover:"",style:{width:"70vw"}},{default:l(()=>[(v(!0),V(N,null,Fe(e.columns,c=>(v(),C(h,{field:c.name,header:c.header,key:c.dataIndex,class:"kn-truncated",style:{width:"250px"}},null,8,["field","header"]))),128))]),_:1},8,["value","loading"])]),_:1},512),[[K,e.expandTableCard]])])):D("",!0)],64)}var wa=E(Gt,[["render",ya]]);const $a={dialog:{"font-size":"13px",width:"600px"},maxWidth:{width:"100%"}},Ca={dataset:[{fieldName:"dataSource",validators:[{key:"required",validator:{type:"query-fields-required"}}]}]};var se={style:$a,validations:Ca};const Ma=S({components:{Dialog:Q},props:{},emits:["close"],data(){return{queryDescriptor:se}}}),Da=["innerHTML"],Ta=["innerHTML"],Va=["innerHTML"],Aa=["innerHTML"],xa=["innerHTML"],Sa=["innerHTML"],Ea={class:"p-d-flex p-flex-row p-jc-end"};function qa(e,t,r,n,m,y){const i=s("Toolbar"),b=s("Button"),p=s("Dialog");return v(),C(p,{id:"query-help-dialog",class:"p-fluid kn-dialog--toolbar--primary",visible:e.visible,modal:!0,closable:!1},{header:l(()=>[a(i,{class:"kn-toolbar kn-toolbar--primary p-p-0 p-m-0 p-col-12"},{start:l(()=>[$(u(e.$t("common.help")),1)]),_:1})]),footer:l(()=>[o("div",Ea,[a(b,{class:"kn-button kn-button--primary",onClick:t[0]||(t[0]=f=>e.$emit("close"))},{default:l(()=>[$(u(e.$t("common.close")),1)]),_:1})])]),default:l(()=>[o("div",{style:A(e.queryDescriptor.style.dialog),innerHTML:e.$t("managers.datasetManagement.queryHelpDialog.paragraph1")},null,12,Da),o("div",{style:A(e.queryDescriptor.style.dialog),innerHTML:e.$t("managers.datasetManagement.queryHelpDialog.paragraph2")},null,12,Ta),o("div",{style:A(e.queryDescriptor.style.dialog),innerHTML:e.$t("managers.datasetManagement.queryHelpDialog.list1")},null,12,Va),o("div",{style:A(e.queryDescriptor.style.dialog),innerHTML:e.$t("managers.datasetManagement.queryHelpDialog.list2")},null,12,Aa),o("div",{style:A(e.queryDescriptor.style.dialog),innerHTML:e.$t("managers.datasetManagement.queryHelpDialog.list3")},null,12,xa),o("div",{style:A(e.queryDescriptor.style.dialog),innerHTML:e.$t("managers.datasetManagement.queryHelpDialog.list4")},null,12,Sa)]),_:1},8,["visible"])}var Na=E(Ma,[["render",qa]]);const Pa=S({components:{Card:q,Dropdown:F,KnValidationMessages:R,VCodeMirror:_,HelpDialog:Na},props:{selectedDataset:{type:Object},dataSources:{type:Array},scriptTypes:{type:Array},activeTab:{type:Number}},emits:["touched","queryEdited"],data(){return{queryDescriptor:se,dataset:{},codeMirror:{},codeMirrorScript:{},v$:P(),expandQueryCard:!0,expandScriptCard:!0,helpDialogVisible:!1,codemirrorOptions:{mode:"text/x-sql",lineWrapping:!0,indentWithTabs:!0,smartIndent:!0,matchBrackets:!0,theme:"eclipse",lineNumbers:!0},scriptOptions:{mode:"",indentWithTabs:!0,smartIndent:!0,lineWrapping:!0,matchBrackets:!0,autofocus:!0,theme:"eclipse",lineNumbers:!0}}},created(){const e=setInterval(()=>{!this.$refs.codeMirror||(this.codeMirror=this.$refs.codeMirror.cminstance,this.$refs.codeMirrorScript&&(this.codeMirrorScript=this.$refs.codeMirrorScript.cminstance,this.loadDataset(),this.loadScriptMode(),clearInterval(e)))},200)},watch:{selectedDataset(){this.loadDataset(),this.loadScriptMode()},activeTab(){this.activeTab===1&&this.codeMirror&&this.codeMirrorScript&&setTimeout(()=>{this.codeMirror.refresh(),this.codeMirrorScript.refresh()},0)}},validations(){const t={"query-fields-required":n=>this.dataset.dsTypeCd!="Query"||n};return{dataset:I("dataset",se.validations.dataset,t)}},methods:{loadDataset(){this.dataset=this.selectedDataset,this.dataset.query||(this.dataset.query=""),this.dataset.queryScript||(this.dataset.queryScript="")},loadScriptMode(){this.dataset.queryScriptLanguage&&(this.scriptOptions.mode=this.dataset.queryScriptLanguage==="ECMAScript"?"text/javascript":"text/x-groovy",this.codeMirrorScript.setOption("mode",this.dataset.queryScriptLanguage==="ECMAScript"?"text/javascript":"text/x-groovy"))},onLanguageChanged(e){const t=e==="ECMAScript"?"text/javascript":"text/x-groovy";this.codeMirrorScript.setOption("mode",t),this.$emit("touched")}}}),Ra={class:"p-field"},Ia={class:"p-float-label"},Fa={for:"scope",class:"kn-material-input-label"},Ua={class:"p-float-label"},Oa={for:"queryScriptLanguage",class:"kn-material-input-label"};function La(e,t,r,n,m,y){const i=s("Dropdown"),b=s("KnValidationMessages"),p=s("Button"),f=s("Toolbar"),d=s("VCodeMirror"),w=s("Card"),g=s("HelpDialog");return v(),V(N,null,[a(w,{class:"p-m-2"},{content:l(()=>[o("div",Ra,[o("span",Ia,[a(i,{id:"dataSource",class:x(["kn-material-input",{"p-invalid":e.v$.dataset.dataSource.$invalid&&e.v$.dataset.dataSource.$dirty}]),style:A(e.queryDescriptor.style.maxWidth),options:e.dataSources,optionLabel:"label",optionValue:"label",modelValue:e.v$.dataset.dataSource.$model,"onUpdate:modelValue":t[0]||(t[0]=h=>e.v$.dataset.dataSource.$model=h),onBeforeShow:t[1]||(t[1]=h=>e.v$.dataset.dataSource.$touch())},null,8,["style","options","modelValue","class"]),o("label",Fa,u(e.$t("managers.businessModelManager.dataSource"))+" * ",1)]),a(b,{vComp:e.v$.dataset.dataSource,additionalTranslateParams:{fieldName:e.$t("managers.businessModelManager.dataSource")}},null,8,["vComp","additionalTranslateParams"])]),a(f,{class:"kn-toolbar kn-toolbar--secondary"},{start:l(()=>[e.expandQueryCard?(v(),C(p,{key:1,icon:"fas fa-chevron-down",class:"p-button-text p-button-rounded p-button-plain",style:{color:"white"},onClick:t[3]||(t[3]=h=>e.expandQueryCard=!1)})):(v(),C(p,{key:0,icon:"fas fa-chevron-right",class:"p-button-text p-button-rounded p-button-plain",style:{color:"white"},onClick:t[2]||(t[2]=h=>e.expandQueryCard=!0)})),$(" "+u(e.$t("managers.datasetManagement.editQuery")),1)]),end:l(()=>[a(p,{icon:"fas fa-info-circle",class:"p-button-text p-button-rounded p-button-plain p-col-1",onClick:t[4]||(t[4]=h=>e.helpDialogVisible=!0)})]),_:1}),z(a(w,null,{content:l(()=>[a(d,{ref:"codeMirror",value:e.dataset.query,"onUpdate:value":t[5]||(t[5]=h=>e.dataset.query=h),autoHeight:!0,options:e.codemirrorOptions,onKeyup:t[6]||(t[6]=h=>e.$emit("queryEdited"))},null,8,["value","options"])]),_:1},512),[[K,e.expandQueryCard]]),a(f,{class:"kn-toolbar kn-toolbar--secondary p-mt-2"},{start:l(()=>[e.expandScriptCard?(v(),C(p,{key:1,icon:"fas fa-chevron-down",class:"p-button-text p-button-rounded p-button-plain",style:{color:"white"},onClick:t[8]||(t[8]=h=>e.expandScriptCard=!1)})):(v(),C(p,{key:0,icon:"fas fa-chevron-right",class:"p-button-text p-button-rounded p-button-plain",style:{color:"white"},onClick:t[7]||(t[7]=h=>e.expandScriptCard=!0)})),$(" "+u(e.$t("managers.datasetManagement.editScript")),1)]),_:1}),z(a(w,null,{content:l(()=>[o("span",Ua,[a(i,{id:"queryScriptLanguage",class:"kn-material-input",style:A(e.queryDescriptor.style.maxWidth),options:e.scriptTypes,optionLabel:"VALUE_NM",optionValue:"VALUE_CD",modelValue:e.dataset.queryScriptLanguage,"onUpdate:modelValue":t[9]||(t[9]=h=>e.dataset.queryScriptLanguage=h),onChange:t[10]||(t[10]=h=>e.onLanguageChanged(h.value))},null,8,["style","options","modelValue"]),o("label",Oa,u(e.$t("managers.lovsManagement.placeholderScript")),1)]),a(d,{class:"p-mt-2",ref:"codeMirrorScript",value:e.dataset.queryScript,"onUpdate:value":t[11]||(t[11]=h=>e.dataset.queryScript=h),autoHeight:!0,options:e.scriptOptions,onKeyup:t[12]||(t[12]=h=>e.$emit("touched"))},null,8,["value","options"])]),_:1},512),[[K,e.expandScriptCard]])]),_:1}),a(g,{visible:e.helpDialogVisible,onClose:t[13]||(t[13]=h=>e.helpDialogVisible=!1)},null,8,["visible"])],64)}var ja=E(Pa,[["render",La]]);const za={maxWidth:{width:"100%"}},Ha={dataset:[{fieldName:"jClassName",validators:[{key:"required",validator:{type:"java-class-field-required"}}]}]};var be={style:za,validations:Ha};const Ba=S({components:{Card:q,KnValidationMessages:R},props:{selectedDataset:{type:Object}},emits:["touched"],data(){return{dataset:{},javaDatasetDescriptor:be,v$:P()}},setup(){return{store:j()}},created(){this.dataset=this.selectedDataset},watch:{selectedDataset(){this.dataset=this.selectedDataset}},validations(){const t={"java-class-field-required":n=>this.dataset.dsTypeCd!="Java Class"||n};return{dataset:I("dataset",be.validations.dataset,t)}},methods:{changeTypeWarning(){this.store.setInfo({title:this.$t("documentExecution.registry.warning"),msg:this.$t("managers.datasetManagement.changeTypeMsg")})}}}),Qa={class:"p-field"},Ja={class:"p-float-label"},Ka={for:"jClassName",class:"kn-material-input-label"};function Ga(e,t,r,n,m,y){const i=s("InputText"),b=s("KnValidationMessages"),p=s("Card");return v(),C(p,{class:"p-m-2"},{content:l(()=>[o("div",Qa,[o("span",Ja,[a(i,{id:"jClassName",class:x(["kn-material-input",{"p-invalid":e.v$.dataset.jClassName.$invalid&&e.v$.dataset.jClassName.$dirty}]),type:"text",style:A(e.javaDatasetDescriptor.style.maxWidth),modelValue:e.v$.dataset.jClassName.$model,"onUpdate:modelValue":t[0]||(t[0]=f=>e.v$.dataset.jClassName.$model=f),modelModifiers:{trim:!0},onBlur:t[1]||(t[1]=f=>e.v$.dataset.jClassName.$touch()),onChange:t[2]||(t[2]=f=>e.$emit("touched"))},null,8,["style","modelValue","class"]),o("label",Ka,u(e.$t("managers.lovsManagement.javaClassName"))+" * ",1)]),a(b,{class:"p-mt-1",vComp:e.v$.dataset.jClassName,additionalTranslateParams:{fieldName:e.$t("managers.lovsManagement.javaClassName")}},null,8,["vComp","additionalTranslateParams"])])]),_:1})}var Xa=E(Ba,[["render",Ga]]);const Wa={maxWidth:{width:"100%"}},Ya={dataset:[{fieldName:"scriptLanguage",validators:[{key:"required",validator:{type:"script-fields-required"}}]}]};var ve={style:Wa,validations:Ya};const Za=S({components:{Card:q,Dropdown:F,VCodeMirror:_,KnValidationMessages:R},props:{selectedDataset:{type:Object},scriptTypes:{type:Array},activeTab:{type:Number}},emits:["touched"],data(){return{queryDescriptor:ve,dataset:{},v$:P(),codeMirrorScriptType:{},scriptOptions:{mode:"",indentWithTabs:!0,smartIndent:!0,lineWrapping:!0,matchBrackets:!0,autofocus:!0,theme:"eclipse",lineNumbers:!0}}},created(){this.loadDataset();const e=setInterval(()=>{!this.$refs.codeMirrorScriptType||(this.codeMirrorScriptType=this.$refs.codeMirrorScriptType.cminstance,this.loadDataset(),this.loadScriptMode(),clearInterval(e))},200)},watch:{selectedDataset(){this.loadDataset(),this.loadScriptMode()},activeTab(){this.activeTab===1&&this.codeMirrorScriptType&&setTimeout(()=>{this.codeMirrorScriptType.refresh()},0)}},validations(){const t={"script-fields-required":n=>this.dataset.dsTypeCd!="Script"||n};return{dataset:I("dataset",ve.validations.dataset,t)}},methods:{loadDataset(){this.dataset=this.selectedDataset,this.dataset.script||(this.dataset.script=""),this.dataset.scriptLanguage||(this.dataset.scriptLanguage="ECMAScript")},loadScriptMode(){this.dataset.scriptLanguage&&(this.scriptOptions.mode=this.dataset.scriptLanguage==="ECMAScript"?"text/javascript":"text/x-groovy",this.codeMirrorScriptType.setOption("mode",this.dataset.queryScriptLanguage==="ECMAScript"?"text/javascript":"text/x-groovy"))},onLanguageChanged(e){const t=e==="ECMAScript"?"text/javascript":"text/x-groovy";this.codeMirrorScriptType.setOption("mode",t),this.$emit("touched")}}}),_a={class:"p-float-label"},eo={class:"p-field"},to={class:"p-float-label"},ao={for:"scope",class:"kn-material-input-label"};function oo(e,t,r,n,m,y){const i=s("Dropdown"),b=s("KnValidationMessages"),p=s("VCodeMirror"),f=s("Card");return v(),C(f,{class:"p-m-2"},{content:l(()=>[o("span",_a,[o("div",eo,[o("span",to,[a(i,{id:"scriptLanguage",class:x(["kn-material-input",{"p-invalid":e.v$.dataset.scriptLanguage.$invalid&&e.v$.dataset.scriptLanguage.$dirty}]),style:A(e.queryDescriptor.style.maxWidth),options:e.scriptTypes,optionLabel:"VALUE_NM",optionValue:"VALUE_CD",modelValue:e.v$.dataset.scriptLanguage.$model,"onUpdate:modelValue":t[0]||(t[0]=d=>e.v$.dataset.scriptLanguage.$model=d),onBeforeShow:t[1]||(t[1]=d=>e.v$.dataset.scriptLanguage.$touch()),onChange:t[2]||(t[2]=d=>e.onLanguageChanged(d.value))},null,8,["style","options","modelValue","class"]),o("label",ao,u(e.$t("managers.lovsManagement.language"))+" * ",1)]),a(b,{vComp:e.v$.dataset.scriptLanguage,additionalTranslateParams:{fieldName:e.$t("managers.lovsManagement.language")}},null,8,["vComp","additionalTranslateParams"])])]),a(p,{class:"p-mt-2",ref:"codeMirrorScriptType",value:e.dataset.script,"onUpdate:value":t[3]||(t[3]=d=>e.dataset.script=d),autoHeight:!0,options:e.scriptOptions,onKeyup:t[4]||(t[4]=d=>e.$emit("touched"))},null,8,["value","options"])]),_:1})}var ro=E(Za,[["render",oo]]);const no={codeMirror:{height:"50%",width:"50%"}},so={dataset:[{fieldName:"qbeDataSource",validators:[{key:"required",validator:{type:"qbe-fields-required"}}]},{fieldName:"qbeDatamarts",validators:[{key:"required",validator:{type:"qbe-fields-required"}}]}]};var ke={style:no,validations:so};const io=S({components:{Card:q,Dropdown:F,KnValidationMessages:R,Dialog:Q,VCodeMirror:_,QBE:Je},props:{parentValid:{type:Boolean},selectedDataset:{type:Object},dataSources:{type:Array},businessModels:{type:Array}},emits:["touched","qbeDialogClosed","qbeDialogSaved"],data(){return{qbeDescriptor:ke,dataset:{},v$:P(),qbeQuery:"",qbeQueryDialogVisible:!1,qbeVisible:!1,codeMirror:{},qbeDataset:{},selectedBusinessModel:{},datsetBmChanged:!1,getQueryFromDataset:!1,codemirrorOptions:{readOnly:!0,mode:"text/javascript",indentWithTabs:!0,smartIndent:!0,lineWrapping:!0,matchBrackets:!0,autofocus:!0,theme:"eclipse",lineNumbers:!0}}},created(){this.dataset=this.selectedDataset,this.setupCodeMirror()},watch:{selectedDataset(){this.dataset=this.selectedDataset,this.setupCodeMirror()}},validations(){const t={"qbe-fields-required":n=>this.dataset.dsTypeCd!="Qbe"||n};return{dataset:I("dataset",ke.validations.dataset,t)}},methods:{setupCodeMirror(){const e=setInterval(()=>{!this.$refs.codeMirror||(this.codeMirror=this.$refs.codeMirror.cminstance,setTimeout(()=>{this.codeMirror.refresh()},0),clearInterval(e))},200)},openQbeQueryDialog(){typeof this.dataset.qbeJSONQuery=="string"?this.qbeQuery=JSON.stringify(JSON.parse(this.dataset.qbeJSONQuery),null,2):this.qbeQuery=JSON.stringify(this.dataset.qbeJSONQuery,null,2),this.qbeQueryDialogVisible=!0},async getDriversData(e){this.datsetBmChanged=!0,this.getQueryFromDataset=!1;const t=this.businessModels.find(r=>r.name===e.value).id;await this.$http.get(`/knowage/restful-services/2.0/businessmodels/${t}`).then(r=>{this.selectedBusinessModel=r.data}).catch()},openDatasetInQBE(){this.$route.name==="new-dataset"?(this.qbeDataset=re(this.selectedBusinessModel),this.getQueryFromDataset&&(this.qbeDataset.qbeJSONQuery=this.dataset.qbeJSONQuery)):this.datsetBmChanged?this.qbeDataset=re(this.selectedBusinessModel):this.qbeDataset=re(this.dataset),this.qbeDataset.pars=this.dataset.pars,this.qbeVisible=!0},onQbeDialogClose(){this.qbeVisible=!1},onQbeDialogSave(e){this.dataset.qbeJSONQuery=e,this.datsetBmChanged=!1,this.getQueryFromDataset=!0,this.qbeVisible=!1}}}),lo={key:0,class:"p-fluid p-formgrid p-grid"},co={class:"p-field p-col-6"},po={class:"p-float-label"},uo={for:"scope",class:"kn-material-input-label"},mo={class:"p-field p-col-6"},bo={class:"p-float-label"},vo={for:"scope",class:"kn-material-input-label"},ko={key:1};function fo(e,t,r,n,m,y){const i=s("Dropdown"),b=s("KnValidationMessages"),p=s("Button"),f=s("Card"),d=s("Toolbar"),w=s("VCodeMirror"),g=s("Dialog"),h=s("QBE");return v(),V(N,null,[a(f,{class:"p-m-2"},{content:l(()=>[e.dataset.dsTypeCd=="Qbe"?(v(),V("form",lo,[o("div",co,[o("span",po,[a(i,{id:"qbeDataSource",class:x(["kn-material-input",{"p-invalid":e.v$.dataset.qbeDataSource.$invalid&&e.v$.dataset.qbeDataSource.$dirty}]),options:e.dataSources,optionLabel:"label",optionValue:"label",modelValue:e.v$.dataset.qbeDataSource.$model,"onUpdate:modelValue":t[0]||(t[0]=k=>e.v$.dataset.qbeDataSource.$model=k),onBeforeShow:t[1]||(t[1]=k=>e.v$.dataset.qbeDataSource.$touch())},null,8,["options","modelValue","class"]),o("label",uo,u(e.$t("managers.glossary.glossaryUsage.dataSource"))+" * ",1)]),a(b,{vComp:e.v$.dataset.qbeDataSource,additionalTranslateParams:{fieldName:e.$t("managers.glossary.glossaryUsage.dataSource")}},null,8,["vComp","additionalTranslateParams"])]),o("div",mo,[o("span",bo,[a(i,{id:"qbeDatamarts",class:x(["kn-material-input",{"p-invalid":e.v$.dataset.qbeDatamarts.$invalid&&e.v$.dataset.qbeDatamarts.$dirty}]),options:e.businessModels,optionLabel:"name",optionValue:"name",modelValue:e.v$.dataset.qbeDatamarts.$model,"onUpdate:modelValue":t[2]||(t[2]=k=>e.v$.dataset.qbeDatamarts.$model=k),onChange:e.getDriversData,onBeforeShow:t[3]||(t[3]=k=>e.v$.dataset.qbeDatamarts.$touch())},null,8,["options","modelValue","class","onChange"]),o("label",vo,u(e.$t("managers.datasetManagement.qbeDatamarts"))+" * ",1)]),a(b,{vComp:e.v$.dataset.qbeDatamarts,additionalTranslateParams:{fieldName:e.$t("managers.datasetManagement.qbeDatamarts")}},null,8,["vComp","additionalTranslateParams"])])])):D("",!0),e.dataset.dsTypeCd=="Qbe"||e.dataset.dsTypeCd=="Federated"?(v(),V("div",ko,[a(p,{label:e.$t("managers.datasetManagement.viewQbeButton"),class:"p-col-2 p-mr-2 p-button kn-button--primary",style:{"max-height":"38px"},onClick:e.openQbeQueryDialog},null,8,["label","onClick"]),a(p,{label:e.$t("managers.datasetManagement.openQbeButton"),class:"p-col-2 p-button kn-button--primary",disabled:e.parentValid,onClick:e.openDatasetInQBE},null,8,["label","disabled","onClick"])])):D("",!0)]),_:1}),a(g,{class:"dmdialog",visible:e.qbeQueryDialogVisible,modal:!0,closable:!1,style:A(e.qbeDescriptor.style.codeMirror)},{header:l(()=>[a(d,{class:"kn-toolbar kn-toolbar--primary p-col-12"},{start:l(()=>[o("span",null,u(e.$t("managers.datasetManagement.viewQbeButton")),1)]),end:l(()=>[a(p,{icon:"pi pi-times",class:"p-button-text p-button-rounded p-button-plain",onClick:t[4]||(t[4]=k=>e.qbeQueryDialogVisible=!1)})]),_:1})]),default:l(()=>[a(w,{class:"kn-height-full",ref:"codeMirror",value:e.qbeQuery,"onUpdate:value":t[5]||(t[5]=k=>e.qbeQuery=k),options:e.codemirrorOptions},null,8,["value","options"])]),_:1},8,["visible","style"]),e.qbeVisible?(v(),C(h,{key:0,visible:e.qbeVisible,dataset:e.qbeDataset,returnQueryMode:!0,getQueryFromDatasetProp:e.getQueryFromDataset,onQuerySaved:e.onQbeDialogSave,onClose:e.onQbeDialogClose},null,8,["visible","dataset","getQueryFromDatasetProp","onQuerySaved","onClose"])):D("",!0)],64)}var ho=E(io,[["render",fo]]);const go={dataset:[{fieldName:"flatTableName",validators:[{key:"required",validator:{type:"flat-fields-required"}}]},{fieldName:"dataSourceFlat",validators:[{key:"required",validator:{type:"flat-fields-required"}}]}]};var fe={validations:go};const yo=S({components:{Card:q,Dropdown:F,KnValidationMessages:R},props:{selectedDataset:{type:Object},dataSources:{type:Array}},emits:["touched"],data(){return{flatTypeDescriptor:fe,dataset:{},v$:P()}},setup(){return{store:j()}},created(){this.dataset=this.selectedDataset},watch:{selectedDataset(){this.dataset=this.selectedDataset}},validations(){const t={"flat-fields-required":n=>this.dataset.dsTypeCd!="Flat"||n};return{dataset:I("dataset",fe.validations.dataset,t)}},methods:{changeTypeWarning(){this.store.setInfo({title:this.$t("documentExecution.registry.warning"),msg:this.$t("managers.datasetManagement.changeTypeMsg")})}}}),wo={class:"p-fluid p-formgrid p-grid"},$o={class:"p-field p-col-6"},Co={class:"p-float-label"},Mo={for:"flatTableName",class:"kn-material-input-label"},Do={class:"p-field p-col-6"},To={class:"p-float-label"},Vo={for:"scope",class:"kn-material-input-label"};function Ao(e,t,r,n,m,y){const i=s("InputText"),b=s("KnValidationMessages"),p=s("Dropdown"),f=s("Card");return v(),C(f,{class:"p-m-2"},{content:l(()=>[o("form",wo,[o("div",$o,[o("span",Co,[a(i,{id:"flatTableName",class:x(["kn-material-input",{"p-invalid":e.v$.dataset.flatTableName.$invalid&&e.v$.dataset.flatTableName.$dirty}]),modelValue:e.v$.dataset.flatTableName.$model,"onUpdate:modelValue":t[0]||(t[0]=d=>e.v$.dataset.flatTableName.$model=d),modelModifiers:{trim:!0},onBlur:t[1]||(t[1]=d=>e.v$.dataset.flatTableName.$touch()),onChange:t[2]||(t[2]=d=>e.$emit("touched"))},null,8,["modelValue","class"]),o("label",Mo,u(e.$t("managers.datasetManagement.flatTableName"))+" * ",1)]),a(b,{class:"p-mt-1",vComp:e.v$.dataset.flatTableName,additionalTranslateParams:{fieldName:e.$t("managers.datasetManagement.flatTableName")}},null,8,["vComp","additionalTranslateParams"])]),o("div",Do,[o("span",To,[a(p,{id:"dataSourceFlat",class:x(["kn-material-input",{"p-invalid":e.v$.dataset.dataSourceFlat.$invalid&&e.v$.dataset.dataSourceFlat.$dirty}]),options:e.dataSources,optionLabel:"label",optionValue:"label",modelValue:e.v$.dataset.dataSourceFlat.$model,"onUpdate:modelValue":t[3]||(t[3]=d=>e.v$.dataset.dataSourceFlat.$model=d),onBeforeShow:t[4]||(t[4]=d=>e.v$.dataset.dataSourceFlat.$touch())},null,8,["options","modelValue","class"]),o("label",Vo,u(e.$t("managers.businessModelManager.dataSource"))+" * ",1)]),a(b,{vComp:e.v$.dataset.dataSourceFlat,additionalTranslateParams:{fieldName:e.$t("managers.businessModelManager.dataSource")}},null,8,["vComp","additionalTranslateParams"])])])]),_:1})}var xo=E(yo,[["render",Ao]]);const So=[{name:"dd/MM/yyyy",value:"dd/MM/yyyy"},{name:"MM/dd/yyyy",value:"MM/dd/yyyy"},{name:"dd-MM-yyyy",value:"dd-MM-yyyy"},{name:"MM-dd-yyyy",value:"MM-dd-yyyy"},{name:"yyyy-MM-dd",value:"yyyy-MM-dd"},{name:"yyyy:MM:dd",value:"yyyy:MM:dd"},{name:"dd.MM.yyyy",value:"dd.MM.yyyy"},{name:"MM.dd.yyyy",value:"MM.dd.yyyy"}],Eo=[{name:"XLS",value:"xls"},{name:"CSV",value:"csv"}],qo=[{name:",",value:","},{name:";",value:";"},{name:"\\t",value:"\\t"},{name:"|",value:"|"}],No=[{name:"windows-1252",value:"windows-1252"},{name:"UTF-8",value:"UTF-8"},{name:"UTF-16",value:"UTF-16"},{name:"US-ASCII",value:"US-ASCII"},{name:"ISO-8859-1",value:"ISO-8859-1"}],Po=[{name:'"',value:'"'},{name:"'",value:"'"}],Ro={dataset:[{fieldName:"ckanFileType",validators:[{key:"required",validator:{type:"ckan-fields-required"}}]},{fieldName:"ckanId",validators:[{key:"required",validator:{type:"ckan-fields-required"}}]},{fieldName:"ckanUrl",validators:[{key:"required",validator:{type:"ckan-fields-required"}}]},{fieldName:"ckanCsvDelimiter",validators:[{key:"required",validator:{type:"csv-fields-required"}}]},{fieldName:"ckanCsvQuote",validators:[{key:"required",validator:{type:"csv-fields-required"}}]},{fieldName:"ckanCsvEncoding",validators:[{key:"required",validator:{type:"csv-fields-required"}}]},{fieldName:"ckanDateFormat",validators:[{key:"required",validator:{type:"csv-fields-required"}}]}]};var J={ckanDateFormat:So,ckanFileTypes:Eo,csvDelimiterCharacterTypes:qo,csvEncodingTypes:No,csvQuoteCharacterTypes:Po,validations:Ro};const Io=S({components:{Card:q,Dropdown:F,KnValidationMessages:R},props:{selectedDataset:{type:Object}},emits:["touched"],data(){return{v$:P(),ckanDescriptor:J,dataset:{},ckanDateFormat:J.ckanDateFormat,availableFileTypes:J.ckanFileTypes,csvEncodingTypes:J.csvEncodingTypes,csvQuoteCharacterTypes:J.csvQuoteCharacterTypes,csvDelimiterCharacterTypes:J.csvDelimiterCharacterTypes}},created(){this.dataset=this.selectedDataset},watch:{selectedDataset(){this.dataset=this.selectedDataset}},validations(){const r={"ckan-fields-required":m=>this.dataset.dsTypeCd!="Ckan"||m,"csv-fields-required":m=>this.dataset.ckanFileType!="CSV"||m};return{dataset:I("dataset",J.validations.dataset,r)}},methods:{}}),Fo={class:"p-fluid p-formgrid p-grid"},Uo={class:"p-field p-col-12"},Oo={class:"p-float-label"},Lo={for:"scope",class:"kn-material-input-label"},jo={key:0,class:"p-formgrid p-grid p-col-12"},zo={class:"p-field p-col-4"},Ho={class:"p-float-label"},Bo={for:"ckanSkipRows",class:"kn-material-input-label"},Qo={class:"p-field p-col-4"},Jo={class:"p-float-label"},Ko={for:"ckanLimitRows",class:"kn-material-input-label"},Go={class:"p-field p-col-4"},Xo={class:"p-float-label"},Wo={for:"ckanXslSheetNumber",class:"kn-material-input-label"},Yo={key:1,class:"p-formgrid p-grid p-col-12"},Zo={class:"p-field p-col-3"},_o={class:"p-float-label"},er={for:"scope",class:"kn-material-input-label"},tr={class:"p-field p-col-3"},ar={class:"p-float-label"},or={for:"scope",class:"kn-material-input-label"},rr={class:"p-field p-col-3"},nr={class:"p-float-label"},sr={for:"scope",class:"kn-material-input-label"},ir={class:"p-field p-col-3"},lr={class:"p-float-label"},dr={for:"scope",class:"kn-material-input-label"},cr={key:2,class:"p-formgrid p-grid p-col-12"},pr={class:"p-field p-col-6"},ur={class:"p-float-label"},mr={for:"ckanId",class:"kn-material-input-label"},br={class:"p-field p-col-6"},vr={class:"p-float-label"},kr={for:"ckanUrl",class:"kn-material-input-label"};function fr(e,t,r,n,m,y){const i=s("Dropdown"),b=s("KnValidationMessages"),p=s("InputText"),f=s("Card");return v(),C(f,{class:"p-mt-3"},{content:l(()=>[o("form",Fo,[o("div",Uo,[o("span",Oo,[a(i,{id:"ckanFileType",class:x(["kn-material-input",{"p-invalid":e.v$.dataset.ckanFileType.$invalid&&e.v$.dataset.ckanFileType.$dirty}]),options:e.availableFileTypes,optionLabel:"name",optionValue:"name",modelValue:e.v$.dataset.ckanFileType.$model,"onUpdate:modelValue":t[0]||(t[0]=d=>e.v$.dataset.ckanFileType.$model=d),onBeforeShow:t[1]||(t[1]=d=>e.v$.dataset.ckanFileType.$touch())},null,8,["options","modelValue","class"]),o("label",Lo,u(e.$t("managers.datasetManagement.fileType"))+" * ",1)]),a(b,{vComp:e.v$.dataset.ckanFileType,additionalTranslateParams:{fieldName:e.$t("managers.datasetManagement.fileType")}},null,8,["vComp","additionalTranslateParams"])]),e.dataset.ckanFileType=="XLS"?(v(),V("div",jo,[o("div",zo,[o("span",Ho,[a(p,{id:"ckanSkipRows",class:"kn-material-input",type:"number",modelValue:e.dataset.ckanSkipRows,"onUpdate:modelValue":t[2]||(t[2]=d=>e.dataset.ckanSkipRows=d),modelModifiers:{trim:!0},onChange:t[3]||(t[3]=d=>e.$emit("touched"))},null,8,["modelValue"]),o("label",Bo,u(e.$t("managers.datasetManagement.ckanSkipRows")),1)])]),o("div",Qo,[o("span",Jo,[a(p,{id:"ckanLimitRows",class:"kn-material-input",type:"number",modelValue:e.dataset.ckanLimitRows,"onUpdate:modelValue":t[4]||(t[4]=d=>e.dataset.ckanLimitRows=d),modelModifiers:{trim:!0},onChange:t[5]||(t[5]=d=>e.$emit("touched"))},null,8,["modelValue"]),o("label",Ko,u(e.$t("managers.datasetManagement.ckanLimitRows")),1)])]),o("div",Go,[o("span",Xo,[a(p,{id:"ckanXslSheetNumber",class:"kn-material-input",type:"number",modelValue:e.dataset.ckanXslSheetNumber,"onUpdate:modelValue":t[6]||(t[6]=d=>e.dataset.ckanXslSheetNumber=d),modelModifiers:{trim:!0},onChange:t[7]||(t[7]=d=>e.$emit("touched"))},null,8,["modelValue"]),o("label",Wo,u(e.$t("managers.datasetManagement.ckanXslSheetNumber")),1)])])])):D("",!0),e.dataset.ckanFileType=="CSV"?(v(),V("div",Yo,[o("div",Zo,[o("span",_o,[a(i,{id:"ckanCsvDelimiter",class:x(["kn-material-input",{"p-invalid":e.v$.dataset.ckanCsvDelimiter.$invalid&&e.v$.dataset.ckanCsvDelimiter.$dirty}]),options:e.csvDelimiterCharacterTypes,optionLabel:"name",optionValue:"name",modelValue:e.v$.dataset.ckanCsvDelimiter.$model,"onUpdate:modelValue":t[8]||(t[8]=d=>e.v$.dataset.ckanCsvDelimiter.$model=d),onBeforeShow:t[9]||(t[9]=d=>e.v$.dataset.ckanCsvDelimiter.$touch())},null,8,["options","modelValue","class"]),o("label",er,u(e.$t("managers.datasetManagement.ckanCsvDelimiter"))+" * ",1)]),a(b,{vComp:e.v$.dataset.ckanCsvDelimiter,additionalTranslateParams:{fieldName:e.$t("managers.datasetManagement.ckanCsvDelimiter")}},null,8,["vComp","additionalTranslateParams"])]),o("div",tr,[o("span",ar,[a(i,{id:"ckanCsvQuote",class:x(["kn-material-input",{"p-invalid":e.v$.dataset.ckanCsvQuote.$invalid&&e.v$.dataset.ckanCsvQuote.$dirty}]),options:e.csvQuoteCharacterTypes,optionLabel:"name",optionValue:"name",modelValue:e.v$.dataset.ckanCsvQuote.$model,"onUpdate:modelValue":t[10]||(t[10]=d=>e.v$.dataset.ckanCsvQuote.$model=d),onBeforeShow:t[11]||(t[11]=d=>e.v$.dataset.ckanCsvQuote.$touch())},null,8,["options","modelValue","class"]),o("label",or,u(e.$t("managers.datasetManagement.ckanCsvQuote"))+" * ",1)]),a(b,{vComp:e.v$.dataset.ckanCsvQuote,additionalTranslateParams:{fieldName:e.$t("managers.datasetManagement.ckanCsvQuote")}},null,8,["vComp","additionalTranslateParams"])]),o("div",rr,[o("span",nr,[a(i,{id:"ckanCsvEncoding",class:x(["kn-material-input",{"p-invalid":e.v$.dataset.ckanCsvEncoding.$invalid&&e.v$.dataset.ckanCsvEncoding.$dirty}]),options:e.csvEncodingTypes,optionLabel:"name",optionValue:"name",modelValue:e.v$.dataset.ckanCsvEncoding.$model,"onUpdate:modelValue":t[12]||(t[12]=d=>e.v$.dataset.ckanCsvEncoding.$model=d),onBeforeShow:t[13]||(t[13]=d=>e.v$.dataset.ckanCsvEncoding.$touch())},null,8,["options","modelValue","class"]),o("label",sr,u(e.$t("managers.datasetManagement.ckanCsvEncoding"))+" * ",1)]),a(b,{vComp:e.v$.dataset.ckanCsvEncoding,additionalTranslateParams:{fieldName:e.$t("managers.datasetManagement.ckanCsvEncoding")}},null,8,["vComp","additionalTranslateParams"])]),o("div",ir,[o("span",lr,[a(i,{id:"ckanDateFormat",class:x(["kn-material-input",{"p-invalid":e.v$.dataset.ckanDateFormat.$invalid&&e.v$.dataset.ckanDateFormat.$dirty}]),options:e.ckanDateFormat,optionLabel:"name",optionValue:"name",modelValue:e.v$.dataset.ckanDateFormat.$model,"onUpdate:modelValue":t[14]||(t[14]=d=>e.v$.dataset.ckanDateFormat.$model=d),onBeforeShow:t[15]||(t[15]=d=>e.v$.dataset.ckanDateFormat.$touch())},null,8,["options","modelValue","class"]),o("label",dr,u(e.$t("managers.datasetManagement.ckanDateFormat"))+" * ",1)]),a(b,{vComp:e.v$.dataset.ckanDateFormat,additionalTranslateParams:{fieldName:e.$t("managers.datasetManagement.ckanDateFormat")}},null,8,["vComp","additionalTranslateParams"])])])):D("",!0),e.dataset.ckanFileType?(v(),V("div",cr,[o("div",pr,[o("span",ur,[a(p,{id:"ckanId",class:x(["kn-material-input",{"p-invalid":e.v$.dataset.ckanId.$invalid&&e.v$.dataset.ckanId.$dirty}]),modelValue:e.v$.dataset.ckanId.$model,"onUpdate:modelValue":t[16]||(t[16]=d=>e.v$.dataset.ckanId.$model=d),modelModifiers:{trim:!0},onBlur:t[17]||(t[17]=d=>e.v$.dataset.ckanId.$touch()),onChange:t[18]||(t[18]=d=>e.$emit("touched"))},null,8,["modelValue","class"]),o("label",mr,u(e.$t("managers.datasetManagement.ckanId"))+" * ",1)]),a(b,{class:"p-mt-1",vComp:e.v$.dataset.ckanId,additionalTranslateParams:{fieldName:e.$t("managers.datasetManagement.ckanId")}},null,8,["vComp","additionalTranslateParams"])]),o("div",br,[o("span",vr,[a(p,{id:"ckanUrl",class:x(["kn-material-input",{"p-invalid":e.v$.dataset.ckanUrl.$invalid&&e.v$.dataset.ckanUrl.$dirty}]),modelValue:e.v$.dataset.ckanUrl.$model,"onUpdate:modelValue":t[19]||(t[19]=d=>e.v$.dataset.ckanUrl.$model=d),modelModifiers:{trim:!0},onBlur:t[20]||(t[20]=d=>e.v$.dataset.ckanUrl.$touch()),onChange:t[21]||(t[21]=d=>e.$emit("touched"))},null,8,["modelValue","class"]),o("label",kr,u(e.$t("managers.datasetManagement.ckanUrl"))+" * ",1)]),a(b,{class:"p-mt-1",vComp:e.v$.dataset.ckanUrl,additionalTranslateParams:{fieldName:e.$t("managers.datasetManagement.ckanUrl")}},null,8,["vComp","additionalTranslateParams"])])])):D("",!0)])]),_:1})}var hr=E(Io,[["render",fr]]);const gr=S({name:"lovs-management-info-dialog",components:{Dialog:Q},emits:["close"],props:{visible:{type:Boolean}},data(){return{detailDescriptor:G}}}),yr=o("div",{class:"p-mt-3"},[o("b",null,"JSON Path Items"),$(" must indicate the place of items in the JSON, like rows of query. It uses "),o("a",{href:"https://github.com/jayway/JsonPath",target:"_blank"},"JsonPath"),$(" language. It needs to be a single or list of JSON Objects. For example, in this JSON: "),o("pre",null,`    {\r
      "contextResponses": [\r
        {\r
          "contextElement": {\r
            "id": "pros6_Meter",\r
            "type": "Meter",\r
            "isPattern": "false",\r
            "attributes": [\r
              {\r
                "name": "atTime",\r
                "type": "timestamp",\r
                "value": "2015-07-14T17:19:14.014+0200"\r
              },\r
              {\r
                "name": "downstreamActivePower",\r
                "type": "double",\r
                "value": "4.8"\r
              },\r
              {\r
                "name": "prosumerId",\r
                "type": "string",\r
                "value": "pros6"\r
              },\r
              {\r
                "name": "unitOfMeasurement",\r
                "type": "string",\r
                "value": "kW"\r
              },\r
              {\r
                "name": "upstreamActivePower",\r
                "type": "double",\r
                "value": "0"\r
              }\r
            ]\r
          },\r
          "statusCode": {\r
            "reasonPhrase": "OK",\r
            "code": "200"\r
          }\r
        },\r
        {\r
          "contextElement": {\r
            "id": "pros1_Meter",\r
            "type": "Meter",\r
            "isPattern": "false",\r
            "attributes": [\r
              {\r
                "name": "atTime",\r
                "type": "timestamp",\r
                "value": "2015-07-14T17:19:14.014+0200"\r
              },\r
              {\r
                "name": "downstreamActivePower",\r
                "type": "double",\r
                "value": "3.5"\r
              },\r
              {\r
                "name": "prosumerId",\r
                "type": "string",\r
                "value": "pros1"\r
              },\r
              {\r
                "name": "unitOfMeasurement",\r
                "type": "string",\r
                "value": "kW"\r
              },\r
              {\r
                "name": "upstreamActivePower",\r
                "type": "double",\r
                "value": "0"\r
              }\r
            ]\r
          },\r
          "statusCode": {\r
            "reasonPhrase": "OK",\r
            "code": "200"\r
          }\r
        }\r
      ]\r
    }\r
    `),$(" if I want to take the two ContextElement items then the JSON Path Items will be: "),o("pre",null,`    $.contextResponses[*].contextElement\r
    `)],-1);function wr(e,t,r,n,m,y){const i=s("Button"),b=s("Dialog");return v(),C(b,{header:e.$t("managers.datasetManagement.helpTitle"),style:A(e.detailDescriptor.style.infoDialog),visible:e.visible,modal:!0,class:"p-fluid kn-dialog--toolbar--primary",closable:!1},{footer:l(()=>[a(i,{class:"kn-button kn-button--primary",onClick:t[0]||(t[0]=p=>e.$emit("close"))},{default:l(()=>[$(u(e.$t("common.close")),1)]),_:1})]),default:l(()=>[yr]),_:1},8,["header","style","visible"])}var $r=E(gr,[["render",wr]]);const Cr=S({name:"lovs-management-info-dialog",components:{Dialog:Q},emits:["close"],props:{visible:{type:Boolean}},data(){return{detailDescriptor:G}}}),Mr=o("div",{class:"p-mt-3"},[$(" If the JSON response contains the data in simple list of objects format like: "),o("pre",null,`  {\r
    "contextResponses": [\r
      {\r
        "a":3,\r
        "c":"d",\r
        "e":"f"\r
      },{\r
        "a":2,\r
        "e":"r",\r
        "f":"s",\r
        "b":"q"\r
       }\r
     ]\r
  }\r
      `),$(" then it will be sufficient to define only the JSON Path Items and check "),o("b",null,"Use directly JSON Attributes"),$(" without defining the attributes. The attributes will be retrieved automatically from the JSON Objects: the names will be the fields names, the values will be the fields values. In this examples, the JSON Path Items will be: "),o("pre",null,`  $.contextResponses[*]\r
      `),$(" and the result DataSet content will have these objects (name: value): "),o("pre",null,`  "a":3\r
  "c":"d"\r
  "e":"f"\r
  ...\r
      `)],-1);function Dr(e,t,r,n,m,y){const i=s("Button"),b=s("Dialog");return v(),C(b,{header:e.$t("managers.datasetManagement.helpTitle"),style:A(e.detailDescriptor.style.infoDialog),visible:e.visible,modal:!0,class:"p-fluid kn-dialog--toolbar--primary",closable:!1},{footer:l(()=>[a(i,{class:"kn-button kn-button--primary",onClick:t[0]||(t[0]=p=>e.$emit("close"))},{default:l(()=>[$(u(e.$t("common.close")),1)]),_:1})]),default:l(()=>[Mr]),_:1},8,["header","style","visible"])}var Tr=E(Cr,[["render",Dr]]);const Vr=S({name:"lovs-management-info-dialog",components:{Dialog:Q},emits:["close"],props:{visible:{type:Boolean}},data(){return{detailDescriptor:G}}}),Ar=o("div",{class:"p-mt-3"},[$(" This attribute is related to "),o("a",{href:"http://www.fiware.org",target:"_blank"},"Fiware"),$(" project, more specifically to "),o("a",{href:"http://catalogue.fiware.org/enablers/publishsubscribe-context-broker-orion-context-broker",target:"_blank"}," Orion Context Broker (OCB)"),$(". It permits to NOT define JSON path Items, Attributes and Headers if the response is from OBC, a NGSI implementation. So if you use the REST DataSet to retrieve information from OCB then you don't need to define items and attributes because the format of JSON Response is well known. ")],-1);function xr(e,t,r,n,m,y){const i=s("Button"),b=s("Dialog");return v(),C(b,{header:e.$t("managers.datasetManagement.helpTitle"),style:A(e.detailDescriptor.style.infoDialog),visible:e.visible,modal:!0,class:"p-fluid kn-dialog--toolbar--primary",closable:!1},{footer:l(()=>[a(i,{class:"kn-button kn-button--primary",onClick:t[0]||(t[0]=p=>e.$emit("close"))},{default:l(()=>[$(u(e.$t("common.close")),1)]),_:1})]),default:l(()=>[Ar]),_:1},8,["header","style","visible"])}var Sr=E(Vr,[["render",xr]]);const Er=S({components:{Card:q,DataTable:H,Column:B},props:{selectedDataset:{type:Object}},computed:{disableDeleteAll(){return!this.dataset.restRequestHeaders||this.dataset.restRequestHeaders.length==0}},emits:["touched"],data(){return{tableDescriptor:O,dataset:{},expandTableCard:!1}},created(){this.dataset=this.selectedDataset},watch:{selectedDataset(){this.dataset=this.selectedDataset}},methods:{addNewParam(){this.dataset.restRequestHeaders||(this.dataset.restRequestHeaders=[]);const e={...O.newRequestHeader};this.dataset.restRequestHeaders.push(e)},deleteParam(e){this.$confirm.require({message:this.$t("common.toast.deleteMessage"),header:this.$t("common.uppercaseDelete"),icon:"pi pi-exclamation-triangle",accept:()=>this.dataset.restRequestHeaders=this.dataset.restRequestHeaders.filter(t=>e.data.name!==t.name)})},removeAllParams(){this.$confirm.require({message:this.$t("managers.datasetManagement.deleteAllRequestHeaderMsg"),header:this.$t("managers.datasetManagement.deleteAllRequestHeaderTitle"),icon:"pi pi-exclamation-triangle",accept:()=>this.dataset.restRequestHeaders=[]})},onCellEditComplete(e){this.dataset.restRequestHeaders[e.index]=e.newData}}});function qr(e,t,r,n,m,y){const i=s("Button"),b=s("Toolbar"),p=s("InputText"),f=s("Column"),d=s("DataTable"),w=s("Card");return v(),V(N,null,[a(b,{class:"kn-toolbar kn-toolbar--secondary p-mt-2 p-mx-2"},{start:l(()=>[e.expandTableCard?(v(),C(i,{key:1,icon:"fas fa-chevron-down",class:"p-button-text p-button-rounded p-button-plain",style:{color:"white"},onClick:t[1]||(t[1]=g=>e.expandTableCard=!1)})):(v(),C(i,{key:0,icon:"fas fa-chevron-right",class:"p-button-text p-button-rounded p-button-plain",style:{color:"white"},onClick:t[0]||(t[0]=g=>e.expandTableCard=!0)})),$(" "+u(e.$t("managers.datasetManagement.requestHeaders")),1)]),end:l(()=>[a(i,{icon:"fas fa-plus",class:"p-button-text p-button-rounded p-button-plain",onClick:e.addNewParam},null,8,["onClick"]),a(i,{icon:"fas fa-eraser",class:"p-button-text p-button-rounded p-button-plain",disabled:e.disableDeleteAll,onClick:e.removeAllParams},null,8,["disabled","onClick"])]),_:1}),z(a(w,{class:"p-mx-2"},{content:l(()=>[a(d,{class:"p-datatable-sm kn-table",editMode:"cell",value:e.dataset.restRequestHeaders,scrollable:!0,scrollHeight:"250px",dataKey:"versNum",responsiveLayout:"stack",breakpoint:"960px",onCellEditComplete:e.onCellEditComplete},{empty:l(()=>[$(u(e.$t("managers.datasetManagement.tableEmpty")),1)]),default:l(()=>[a(f,{field:"name",header:e.$t("kpi.alert.name"),sortable:!0},{editor:l(({data:g})=>[a(p,{class:"kn-material-input",style:A(e.tableDescriptor.style.columnStyle),modelValue:g.name,"onUpdate:modelValue":h=>g.name=h},null,8,["style","modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),a(f,{field:"value",header:e.$t("common.value"),sortable:!0},{editor:l(({data:g})=>[a(p,{class:"kn-material-input",style:A(e.tableDescriptor.style.columnStyle),modelValue:g.value,"onUpdate:modelValue":h=>g.value=h},null,8,["style","modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),a(f,{onRowClick:g=>!1},{body:l(g=>[a(i,{icon:"pi pi-trash",class:"p-button-link",onClick:h=>e.deleteParam(g)},null,8,["onClick"])]),_:1})]),_:1},8,["value","onCellEditComplete"])]),_:1},512),[[K,e.expandTableCard]])],64)}var Ce=E(Er,[["render",qr]]);const Nr=S({name:"lovs-management-info-dialog",components:{Dialog:Q},emits:["close"],props:{visible:{type:Boolean}},data(){return{detailDescriptor:G}}}),Pr=o("div",{class:"p-mt-3"},[o("b",null,"JSON Path Attributes"),$(" indicates the fields of DataSet items in the "),o("a",{href:"https://github.com/jayway/JsonPath",target:"_blank"},"JsonPath"),$(" format. For each attribute to retrieve you need to indicate: "),o("ul",null,[o("li",null,[$("name: the name of field. In this case if you use "),o("b",null,"id"),$(" name then it will have a particular meaning: it will be used as unique identifier")]),o("li",null,[$(" value: where to retrieve the value in the JSON response. It uses JSON Path format "),o("b",null,"related to the JSON Items previously specified"),$(" (the $. start if from the item object). For example, if you have this response: "),o("pre",null,`{\r
  "contextResponses": [\r
    {\r
      "contextElement": {\r
        "id": "pros6_Meter",\r
        "type": "Meter",\r
        "isPattern": "false",\r
        "attributes": [\r
          {\r
            "name": "atTime",\r
            "type": "timestamp",\r
            "value": "2015-07-14T17:19:14.014+0200"\r
          },\r
          {\r
            "name": "downstreamActivePower",\r
            "type": "double",\r
            "value": "4.8"\r
          },\r
          {\r
            "name": "prosumerId",\r
            "type": "string",\r
            "value": "pros6"\r
          },\r
          {\r
            "name": "unitOfMeasurement",\r
            "type": "string",\r
            "value": "kW"\r
          },\r
          {\r
            "name": "upstreamActivePower",\r
            "type": "double",\r
            "value": "0"\r
          }\r
        ]\r
      },\r
      "statusCode": {\r
        "reasonPhrase": "OK",\r
        "code": "200"\r
      }\r
    },\r
    {\r
      "contextElement": {\r
        "id": "pros1_Meter",\r
        "type": "Meter",\r
        "isPattern": "false",\r
        "attributes": [\r
          {\r
            "name": "atTime",\r
            "type": "timestamp",\r
            "value": "2015-07-14T17:19:14.014+0200"\r
          },\r
          {\r
            "name": "downstreamActivePower",\r
            "type": "double",\r
            "value": "3.5"\r
          },\r
          {\r
            "name": "prosumerId",\r
            "type": "string",\r
            "value": "pros1"\r
          },\r
          {\r
            "name": "unitOfMeasurement",\r
            "type": "string",\r
            "value": "kW"\r
          },\r
          {\r
            "name": "upstreamActivePower",\r
            "type": "double",\r
            "value": "0"\r
          }\r
        ]\r
      },\r
      "statusCode": {\r
        "reasonPhrase": "OK",\r
        "code": "200"\r
      }\r
    }\r
  ]\r
}\r
`),$(" and you use this JSON Path Items: "),o("pre",null,`	$.contextResponses[*].contextElement\r
`),$(" then to retrieve the "),o("i",null,"downstreamActivePower"),$(" attribute for every item you need to specify this value: "),o("pre",null,`	$.attributes[?(@.name==downstreamActivePower)].value\r
`)]),o("li",null," type: the type of attribute (int, string, etc..). It can be directly specified or it can be in the JsonPath format if the type is contained in the response. ")])],-1);function Rr(e,t,r,n,m,y){const i=s("Button"),b=s("Dialog");return v(),C(b,{header:e.$t("managers.datasetManagement.helpTitle"),style:A(e.detailDescriptor.style.infoDialog),visible:e.visible,modal:!0,class:"p-fluid kn-dialog--toolbar--primary",closable:!1},{footer:l(()=>[a(i,{class:"kn-button kn-button--primary",onClick:t[0]||(t[0]=p=>e.$emit("close"))},{default:l(()=>[$(u(e.$t("common.close")),1)]),_:1})]),default:l(()=>[Pr]),_:1},8,["header","style","visible"])}var Ir=E(Nr,[["render",Rr]]);const Fr=S({components:{Card:q,DataTable:H,Column:B,Dropdown:F,HelpDialog:Ir},props:{selectedDataset:{type:Object}},computed:{disableDeleteAll(){return!this.dataset.restJsonPathAttributes||this.dataset.restJsonPathAttributes.length==0}},emits:["touched"],data(){return{tableDescriptor:O,dataset:{},expandTableCard:!1,datasetParamTypes:O.datasetParamTypes,jsonPathTypes:O.jsonPathTypes,helpDialogVisible:!1}},created(){this.dataset=this.selectedDataset},watch:{selectedDataset(){this.dataset=this.selectedDataset}},methods:{addNewParam(){const e={...O.newJsonPathAttr};this.dataset.restJsonPathAttributes.push(e)},deleteParam(e){this.$confirm.require({message:this.$t("common.toast.deleteMessage"),header:this.$t("common.uppercaseDelete"),icon:"pi pi-exclamation-triangle",accept:()=>this.dataset.restJsonPathAttributes=this.dataset.restJsonPathAttributes.filter(t=>e.data.name!==t.name)})},removeAllParams(){this.$confirm.require({message:this.$t("managers.datasetManagement.deleteAllRequestHeaderMsg"),header:this.$t("managers.datasetManagement.deleteAllRequestHeaderTitle"),icon:"pi pi-exclamation-triangle",accept:()=>this.dataset.restJsonPathAttributes=[]})},onCellEditComplete(e){this.dataset.restJsonPathAttributes[e.index]=e.newData}}});function Ur(e,t,r,n,m,y){const i=s("Button"),b=s("Toolbar"),p=s("InputText"),f=s("Column"),d=s("Dropdown"),w=s("DataTable"),g=s("Card"),h=s("HelpDialog");return v(),V(N,null,[a(b,{class:"kn-toolbar kn-toolbar--secondary p-mt-3 p-mx-2"},{start:l(()=>[e.expandTableCard?(v(),C(i,{key:1,icon:"fas fa-chevron-down",class:"p-button-text p-button-rounded p-button-plain",style:{color:"white"},onClick:t[1]||(t[1]=k=>e.expandTableCard=!1)})):(v(),C(i,{key:0,icon:"fas fa-chevron-right",class:"p-button-text p-button-rounded p-button-plain",style:{color:"white"},onClick:t[0]||(t[0]=k=>e.expandTableCard=!0)})),$(" "+u(e.$t("managers.datasetManagement.jsonPathAttributes")),1)]),end:l(()=>[a(i,{icon:"fas fa-plus",class:"p-button-text p-button-rounded p-button-plain",onClick:e.addNewParam},null,8,["onClick"]),a(i,{icon:"fas fa-info-circle",class:"p-button-text p-button-rounded p-button-plain",onClick:t[2]||(t[2]=k=>e.helpDialogVisible=!0)}),a(i,{icon:"fas fa-eraser",class:"p-button-text p-button-rounded p-button-plain",disabled:e.disableDeleteAll,onClick:e.removeAllParams},null,8,["disabled","onClick"])]),_:1}),z(a(g,{class:"p-mx-2"},{content:l(()=>[a(w,{class:"p-datatable-sm kn-table",editMode:"cell",value:e.dataset.restJsonPathAttributes,scrollable:!0,scrollHeight:"250px",dataKey:"versNum",responsiveLayout:"stack",breakpoint:"960px",onCellEditComplete:e.onCellEditComplete},{empty:l(()=>[$(u(e.$t("managers.datasetManagement.tableEmpty")),1)]),default:l(()=>[a(f,{field:"name",header:e.$t("kpi.alert.name"),sortable:!0},{editor:l(({data:k})=>[a(p,{class:"kn-material-input",style:A(e.tableDescriptor.style.columnStyle),modelValue:k.name,"onUpdate:modelValue":M=>k.name=M},null,8,["style","modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),a(f,{field:"jsonPathValue",header:e.$t("managers.datasetManagement.jsonPathValue"),sortable:!0},{editor:l(({data:k})=>[a(p,{class:"kn-material-input",style:A(e.tableDescriptor.style.columnStyle),modelValue:k.jsonPathValue,"onUpdate:modelValue":M=>k.jsonPathValue=M},null,8,["style","modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),a(f,{field:"typeOrJsonPathValue",header:e.$t("managers.datasetManagement.typeOrJsonPathValue"),sortable:!0},{body:l(k=>[$(u(k.data.jsonPathType),1)]),editor:l(({data:k})=>[a(d,{id:"scope",class:"kn-material-input",style:A(e.tableDescriptor.style.columnStyle),options:e.jsonPathTypes,modelValue:k.jsonPathType,"onUpdate:modelValue":M=>k.jsonPathType=M},null,8,["style","options","modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),a(f,{onRowClick:k=>!1},{body:l(k=>[a(i,{icon:"pi pi-trash",class:"p-button-link",onClick:M=>e.deleteParam(k)},null,8,["onClick"])]),_:1})]),_:1},8,["value","onCellEditComplete"])]),_:1},512),[[K,e.expandTableCard]]),a(h,{visible:e.helpDialogVisible,onClose:t[3]||(t[3]=k=>e.helpDialogVisible=!1)},null,8,["visible"])],64)}var Or=E(Fr,[["render",Ur]]);const Lr=[{name:"Get",value:"Get"},{name:"Post",value:"Post"},{name:"Put",value:"Put"},{name:"Delete",value:"Delete"}],jr={infoColumnsContainer:{display:"flex","justify-content":"space-between"},maxWidth:{width:"100%"}},zr={dataset:[{fieldName:"restAddress",validators:[{key:"required",validator:{type:"rest-fields-required"}}]},{fieldName:"restHttpMethod",validators:[{key:"required",validator:{type:"rest-fields-required"}}]}]};var ee={httpMethods:Lr,style:jr,validations:zr};const Hr=S({components:{Card:q,Dropdown:F,KnValidationMessages:R,RequestHeadersTable:Ce,JsonPathTable:Or,Checkbox:ae,JsonItemsHelpDialog:$r,DirectAttributesHelpDialog:Tr,NgsiHelpDialog:Sr},props:{selectedDataset:{type:Object}},emits:["touched"],data(){return{restDescriptor:ee,dataset:{},v$:P(),ngsiHelpVisible:!1,jsonItemsHelpVisible:!1,directAttributesHelpVisible:!1,httpMethods:ee.httpMethods}},created(){this.dataset=this.selectedDataset},watch:{selectedDataset(){this.dataset=this.selectedDataset}},validations(){const t={"rest-fields-required":n=>this.dataset.dsTypeCd!="REST"||n};return{dataset:I("dataset",ee.validations.dataset,t)}},methods:{}}),Br={class:"p-fluid p-formgrid p-grid"},Qr={class:"p-field p-col-6"},Jr={class:"p-float-label"},Kr={for:"restAddress",class:"kn-material-input-label"},Gr={class:"p-field p-col-6"},Xr={class:"p-float-label"},Wr={for:"solrCollection",class:"kn-material-input-label"},Yr={class:"p-field p-col-12"},Zr={class:"p-float-label"},_r={for:"restRequestBody",class:"kn-material-input-label"},en={class:"p-field p-col-12"},tn={class:"p-float-label"},an={for:"scope",class:"kn-material-input-label"},on={class:"p-fluid p-formgrid p-grid"},rn={for:"restJsonPathItems",class:"kn-material-input-label"},nn={class:"p-field-checkbox"},sn={for:"binary"},ln={class:"p-field-checkbox"},dn={for:"binary"},cn={class:"p-fluid p-formgrid p-grid"},pn={class:"p-field p-col-4"},un={class:"p-float-label"},mn={for:"restOffset",class:"kn-material-input-label"},bn={class:"p-col-4"},vn={class:"p-float-label"},kn={for:"restFetchSize",class:"kn-material-input-label"},fn={class:"p-col-4"},hn={class:"p-float-label"},gn={for:"restMaxResults",class:"kn-material-input-label"};function yn(e,t,r,n,m,y){const i=s("InputText"),b=s("KnValidationMessages"),p=s("Dropdown"),f=s("Card"),d=s("RequestHeadersTable"),w=s("Button"),g=s("Checkbox"),h=s("JsonPathTable"),k=s("JsonItemsHelpDialog"),M=s("DirectAttributesHelpDialog"),c=s("NgsiHelpDialog");return v(),V(N,null,[a(f,{class:"p-m-2"},{content:l(()=>[o("form",Br,[o("div",Qr,[o("span",Jr,[a(i,{id:"restAddress",class:x(["kn-material-input",{"p-invalid":e.v$.dataset.restAddress.$invalid&&e.v$.dataset.restAddress.$dirty}]),type:"text",modelValue:e.v$.dataset.restAddress.$model,"onUpdate:modelValue":t[0]||(t[0]=T=>e.v$.dataset.restAddress.$model=T),modelModifiers:{trim:!0},onBlur:t[1]||(t[1]=T=>e.v$.dataset.restAddress.$touch()),onChange:t[2]||(t[2]=T=>e.$emit("touched"))},null,8,["modelValue","class"]),o("label",Kr,u(e.$t("managers.datasetManagement.restAddress"))+" * ",1)]),a(b,{class:"p-mt-1",vComp:e.v$.dataset.restAddress,additionalTranslateParams:{fieldName:e.$t("managers.datasetManagement.restAddress")}},null,8,["vComp","additionalTranslateParams"])]),o("div",Gr,[o("span",Xr,[a(i,{id:"solrCollection",class:"kn-material-input",modelValue:e.dataset.solrCollection,"onUpdate:modelValue":t[3]||(t[3]=T=>e.dataset.solrCollection=T),modelModifiers:{trim:!0},onChange:t[4]||(t[4]=T=>e.$emit("touched"))},null,8,["modelValue"]),o("label",Wr,u(e.$t("managers.datasetManagement.solrCollection")),1)])]),o("div",Yr,[o("span",Zr,[a(i,{id:"restRequestBody",class:"kn-material-input",maxLength:"2000",modelValue:e.dataset.restRequestBody,"onUpdate:modelValue":t[5]||(t[5]=T=>e.dataset.restRequestBody=T),modelModifiers:{trim:!0},onChange:t[6]||(t[6]=T=>e.$emit("touched"))},null,8,["modelValue"]),o("label",_r,u(e.$t("managers.datasetManagement.restRequestBody")),1)])]),o("div",en,[o("span",tn,[a(p,{id:"restHttpMethod",class:x(["kn-material-input",{"p-invalid":e.v$.dataset.restHttpMethod.$invalid&&e.v$.dataset.restHttpMethod.$dirty}]),options:e.httpMethods,optionLabel:"value",optionValue:"value",modelValue:e.v$.dataset.restHttpMethod.$model,"onUpdate:modelValue":t[7]||(t[7]=T=>e.v$.dataset.restHttpMethod.$model=T),onBeforeShow:t[8]||(t[8]=T=>e.v$.dataset.restHttpMethod.$touch())},null,8,["options","modelValue","class"]),o("label",an,u(e.$t("managers.datasetManagement.restHttpMethod"))+" * ",1)]),a(b,{vComp:e.v$.dataset.restHttpMethod,additionalTranslateParams:{fieldName:e.$t("managers.datasetManagement.restHttpMethod")}},null,8,["vComp","additionalTranslateParams"])])])]),_:1}),a(d,{selectedDataset:e.selectedDataset},null,8,["selectedDataset"]),a(f,{class:"p-mt-3"},{content:l(()=>[o("form",on,[o("div",{class:"p-col-12 p-field",style:A(e.restDescriptor.style.infoColumnsContainer)},[o("span",{class:"p-float-label",style:A(e.restDescriptor.style.maxWidth)},[a(i,{id:"restJsonPathItems",class:"kn-material-input",style:A(e.restDescriptor.style.maxWidth),modelValue:e.dataset.restJsonPathItems,"onUpdate:modelValue":t[9]||(t[9]=T=>e.dataset.restJsonPathItems=T),modelModifiers:{trim:!0},onChange:t[10]||(t[10]=T=>e.$emit("touched"))},null,8,["style","modelValue"]),o("label",rn,u(e.$t("managers.datasetManagement.restJsonPathItems")),1)],4),a(w,{icon:"fas fa-info-circle",class:"p-button-text p-button-rounded p-button-plain",onClick:t[11]||(t[11]=T=>e.jsonItemsHelpVisible=!0)})],4),o("div",{class:"p-col-12",style:A(e.restDescriptor.style.infoColumnsContainer)},[o("span",nn,[o("label",sn,u(e.$t("managers.datasetManagement.restDirectlyJSONAttributes"))+": ",1),a(g,{id:"binary",class:"p-ml-2",modelValue:e.dataset.restDirectlyJSONAttributes,"onUpdate:modelValue":t[12]||(t[12]=T=>e.dataset.restDirectlyJSONAttributes=T),binary:!0,onChange:t[13]||(t[13]=T=>e.$emit("touched"))},null,8,["modelValue"])]),a(w,{icon:"fas fa-info-circle",class:"p-button-text p-button-rounded p-button-plain",onClick:t[14]||(t[14]=T=>e.directAttributesHelpVisible=!0)})],4),o("div",{class:"p-col-12",style:A(e.restDescriptor.style.infoColumnsContainer)},[o("span",ln,[o("label",dn,u(e.$t("managers.datasetManagement.restNGSI"))+": ",1),a(g,{id:"binary",class:"p-ml-2",modelValue:e.dataset.restNGSI,"onUpdate:modelValue":t[15]||(t[15]=T=>e.dataset.restNGSI=T),binary:!0,onChange:t[16]||(t[16]=T=>e.$emit("touched"))},null,8,["modelValue"])]),a(w,{icon:"fas fa-info-circle",class:"p-button-text p-button-rounded p-button-plain",onClick:t[17]||(t[17]=T=>e.ngsiHelpVisible=!0)})],4)])]),_:1}),a(h,{selectedDataset:e.selectedDataset},null,8,["selectedDataset"]),a(f,{class:"p-mt-3"},{content:l(()=>[o("form",cn,[o("div",pn,[o("span",un,[a(i,{id:"restOffset",type:"number",class:"kn-material-input",modelValue:e.dataset.restOffset,"onUpdate:modelValue":t[18]||(t[18]=T=>e.dataset.restOffset=T),modelModifiers:{trim:!0},onChange:t[19]||(t[19]=T=>e.$emit("touched"))},null,8,["modelValue"]),o("label",mn,u(e.$t("managers.datasetManagement.restOffset")),1)])]),o("div",bn,[o("span",vn,[a(i,{id:"restFetchSize",type:"number",class:"kn-material-input",modelValue:e.dataset.restFetchSize,"onUpdate:modelValue":t[20]||(t[20]=T=>e.dataset.restFetchSize=T),modelModifiers:{trim:!0},onChange:t[21]||(t[21]=T=>e.$emit("touched"))},null,8,["modelValue"]),o("label",kn,u(e.$t("managers.datasetManagement.restFetchSize")),1)])]),o("div",fn,[o("span",hn,[a(i,{id:"restMaxResults",type:"number",class:"kn-material-input",modelValue:e.dataset.restMaxResults,"onUpdate:modelValue":t[22]||(t[22]=T=>e.dataset.restMaxResults=T),modelModifiers:{trim:!0},onChange:t[23]||(t[23]=T=>e.$emit("touched"))},null,8,["modelValue"]),o("label",gn,u(e.$t("managers.datasetManagement.restMaxResults")),1)])])])]),_:1}),a(k,{visible:e.jsonItemsHelpVisible,onClose:t[24]||(t[24]=T=>e.jsonItemsHelpVisible=!1)},null,8,["visible"]),a(M,{visible:e.directAttributesHelpVisible,onClose:t[25]||(t[25]=T=>e.directAttributesHelpVisible=!1)},null,8,["visible"]),a(c,{visible:e.ngsiHelpVisible,onClose:t[26]||(t[26]=T=>e.ngsiHelpVisible=!1)},null,8,["visible"])],64)}var wn=E(Hr,[["render",yn]]);const $n={dataset:[{fieldName:"sparqlEndpoint",validators:[{key:"required",validator:{type:"sparql-fields-required"}}]}]};var he={validations:$n};const Cn=S({components:{Card:q,VCodeMirror:_,KnValidationMessages:R},props:{selectedDataset:{type:Object}},emits:["touched"],data(){return{sparqlDescriptor:he,dataset:{},v$:P(),codeMirrorSparql:{},sparqlOptions:{mode:"application/sparql-query",lineWrapping:!0,indentWithTabs:!0,smartIndent:!0,matchBrackets:!0,theme:"eclipse",lineNumbers:!0}}},created(){this.loadDataset(),this.setupCodeMirror()},watch:{selectedDataset(){this.loadDataset()}},validations(){const t={"sparql-fields-required":n=>this.dataset.dsTypeCd!="SPARQL"||n};return{dataset:I("dataset",he.validations.dataset,t)}},methods:{loadDataset(){this.dataset=this.selectedDataset,this.dataset.sparqlQuery||(this.dataset.sparqlQuery="")},setupCodeMirror(){this.$refs.codeMirrorSparql&&(this.codeMirrorSparql=this.$refs.codeMirrorSparql.editor)}}}),Mn={class:"p-fluid p-formgrid p-grid"},Dn={class:"p-field p-col-12"},Tn={class:"p-float-label"},Vn={for:"sparqlEndpoint",class:"kn-material-input-label"},An={class:"p-field p-col-6"},xn={class:"p-float-label"},Sn={for:"sparqlDefaultGraphIri",class:"kn-material-input-label"},En={class:"p-field p-col-6"},qn={class:"p-float-label"},Nn={for:"sparqlExecutionTimeout",class:"kn-material-input-label"};function Pn(e,t,r,n,m,y){const i=s("InputText"),b=s("KnValidationMessages"),p=s("VCodeMirror"),f=s("Card");return v(),C(f,{class:"p-m-2"},{content:l(()=>[o("form",Mn,[o("div",Dn,[o("span",Tn,[a(i,{id:"sparqlEndpoint",class:x(["kn-material-input",{"p-invalid":e.v$.dataset.sparqlEndpoint.$invalid&&e.v$.dataset.sparqlEndpoint.$dirty}]),type:"text",modelValue:e.v$.dataset.sparqlEndpoint.$model,"onUpdate:modelValue":t[0]||(t[0]=d=>e.v$.dataset.sparqlEndpoint.$model=d),modelModifiers:{trim:!0},onBlur:t[1]||(t[1]=d=>e.v$.dataset.sparqlEndpoint.$touch()),onChange:t[2]||(t[2]=d=>e.$emit("touched"))},null,8,["modelValue","class"]),o("label",Vn,u(e.$t("managers.datasetManagement.sparqlEndpoint"))+" * ",1)]),a(b,{class:"p-mt-1",vComp:e.v$.dataset.sparqlEndpoint,additionalTranslateParams:{fieldName:e.$t("managers.datasetManagement.sparqlEndpoint")}},null,8,["vComp","additionalTranslateParams"])]),o("div",An,[o("span",xn,[a(i,{id:"sparqlDefaultGraphIri",class:"kn-material-input",modelValue:e.dataset.sparqlDefaultGraphIri,"onUpdate:modelValue":t[3]||(t[3]=d=>e.dataset.sparqlDefaultGraphIri=d),modelModifiers:{trim:!0},onChange:t[4]||(t[4]=d=>e.$emit("touched"))},null,8,["modelValue"]),o("label",Sn,u(e.$t("managers.datasetManagement.sparqlDefaultGraphIri")),1)])]),o("div",En,[o("span",qn,[a(i,{id:"sparqlExecutionTimeout",class:"kn-material-input",type:"number",modelValue:e.dataset.sparqlExecutionTimeout,"onUpdate:modelValue":t[5]||(t[5]=d=>e.dataset.sparqlExecutionTimeout=d),modelModifiers:{trim:!0},onChange:t[6]||(t[6]=d=>e.$emit("touched"))},null,8,["modelValue"]),o("label",Nn,u(e.$t("managers.datasetManagement.sparqlExecutionTimeout")),1)])])]),a(p,{class:"p-mt-2",ref:"codeMirrorSparql",value:e.dataset.sparqlQuery,"onUpdate:value":t[7]||(t[7]=d=>e.dataset.sparqlQuery=d),autoHeight:!0,options:e.sparqlOptions,onKeyup:t[8]||(t[8]=d=>e.$emit("touched"))},null,8,["value","options"])]),_:1})}var Rn=E(Cn,[["render",Pn]]);const In={dataset:[{fieldName:"restAddress",validators:[{key:"required",validator:{type:"solr-fields-required"}}]},{fieldName:"solrCollection",validators:[{key:"required",validator:{type:"solr-fields-required"}}]},{fieldName:"solrFieldList",validators:[{key:"required",validator:{type:"document-fields-required"}}]}]};var ge={validations:In};const Fn=S({name:"lovs-management-info-dialog",components:{Dialog:Q},emits:["close"],props:{visible:{type:Boolean}},data(){return{detailDescriptor:G}}}),Un=o("div",{class:"p-mt-3"},[$(" If you want to specify a single facet.query parameter just define in this way "),o("pre",null,"price:[500 TO *]"),$(" If you want to specify multiple facet.query parameters you need to add also the prefix facet.query= and separate the values with &. You should also use same encoding like you are writing an URL. For example "),o("pre",null,"facet.query=price:[*+TO+500]&facet.query=price:[500+TO+*]")],-1);function On(e,t,r,n,m,y){const i=s("Button"),b=s("Dialog");return v(),C(b,{header:e.$t("managers.datasetManagement.helpTitle"),style:A(e.detailDescriptor.style.infoDialog),visible:e.visible,modal:!0,class:"p-fluid kn-dialog--toolbar--primary",closable:!1},{footer:l(()=>[a(i,{class:"kn-button kn-button--primary",onClick:t[0]||(t[0]=p=>e.$emit("close"))},{default:l(()=>[$(u(e.$t("common.close")),1)]),_:1})]),default:l(()=>[Un]),_:1},8,["header","style","visible"])}var Ln=E(Fn,[["render",On]]);const jn=S({components:{Card:q,DataTable:H,Column:B},props:{selectedDataset:{type:Object}},computed:{disableDeleteAll(){return!this.dataset.restRequestAdditionalParameters||this.dataset.restRequestAdditionalParameters.length==0}},emits:["touched"],data(){return{tableDescriptor:O,dataset:{},expandTableCard:!1}},created(){this.dataset=this.selectedDataset},watch:{selectedDataset(){this.dataset=this.selectedDataset}},methods:{addNewParam(){this.dataset.restRequestAdditionalParameters||(this.dataset.restRequestAdditionalParameters=[]);const e={...O.newRequestHeader};this.dataset.restRequestAdditionalParameters.push(e)},deleteParam(e){this.$confirm.require({message:this.$t("common.toast.deleteMessage"),header:this.$t("common.uppercaseDelete"),icon:"pi pi-exclamation-triangle",accept:()=>this.dataset.restRequestAdditionalParameters=this.dataset.restRequestAdditionalParameters.filter(t=>e.data.name!==t.name)})},removeAllParams(){this.$confirm.require({message:this.$t("managers.datasetManagement.deleteAllRequestHeaderMsg"),header:this.$t("managers.datasetManagement.deleteAllRequestHeaderTitle"),icon:"pi pi-exclamation-triangle",accept:()=>this.dataset.restRequestAdditionalParameters=[]})},onCellEditComplete(e){this.dataset.restRequestAdditionalParameters[e.index]=e.newData}}});function zn(e,t,r,n,m,y){const i=s("Button"),b=s("Toolbar"),p=s("InputText"),f=s("Column"),d=s("DataTable"),w=s("Card");return v(),V(N,null,[a(b,{class:"kn-toolbar kn-toolbar--secondary p-mt-2 p-mx-2"},{start:l(()=>[e.expandTableCard?(v(),C(i,{key:1,icon:"fas fa-chevron-down",class:"p-button-text p-button-rounded p-button-plain",style:{color:"white"},onClick:t[1]||(t[1]=g=>e.expandTableCard=!1)})):(v(),C(i,{key:0,icon:"fas fa-chevron-right",class:"p-button-text p-button-rounded p-button-plain",style:{color:"white"},onClick:t[0]||(t[0]=g=>e.expandTableCard=!0)})),$(" "+u(e.$t("managers.datasetManagement.queryParamTable")),1)]),end:l(()=>[a(i,{icon:"fas fa-plus",class:"p-button-text p-button-rounded p-button-plain",onClick:e.addNewParam},null,8,["onClick"]),a(i,{icon:"fas fa-eraser",class:"p-button-text p-button-rounded p-button-plain",disabled:e.disableDeleteAll,onClick:e.removeAllParams},null,8,["disabled","onClick"])]),_:1}),z(a(w,{class:"p-mx-2"},{content:l(()=>[a(d,{class:"p-datatable-sm kn-table",editMode:"cell",value:e.dataset.restRequestAdditionalParameters,scrollable:!0,scrollHeight:"250px",dataKey:"versNum",responsiveLayout:"stack",breakpoint:"960px",onCellEditComplete:e.onCellEditComplete},{empty:l(()=>[$(u(e.$t("managers.datasetManagement.tableEmpty")),1)]),default:l(()=>[a(f,{field:"name",header:e.$t("kpi.alert.name"),sortable:!0},{editor:l(({data:g})=>[a(p,{class:"kn-material-input",style:A(e.tableDescriptor.style.columnStyle),modelValue:g.name,"onUpdate:modelValue":h=>g.name=h},null,8,["style","modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),a(f,{field:"value",header:e.$t("common.value"),sortable:!0},{editor:l(({data:g})=>[a(p,{class:"kn-material-input",style:A(e.tableDescriptor.style.columnStyle),modelValue:g.value,"onUpdate:modelValue":h=>g.value=h},null,8,["style","modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),a(f,{onRowClick:g=>!1},{body:l(g=>[a(i,{icon:"pi pi-trash",class:"p-button-link",onClick:h=>e.deleteParam(g)},null,8,["onClick"])]),_:1})]),_:1},8,["value","onCellEditComplete"])]),_:1},512),[[K,e.expandTableCard]])],64)}var Hn=E(jn,[["render",zn]]);const Bn=S({components:{Card:q,KnValidationMessages:R,FacetInfoDialog:Ln,RequestHeadersTable:Ce,QueryParamTable:Hn},props:{parentValid:{type:Boolean},selectedDataset:{type:Object},dataSources:{type:Array},businessModels:{type:Array}},emits:["touched"],data(){return{restDescriptor:ee,solrDescriptor:ge,dataset:{},v$:P(),facetQueryHelpVisible:!1}},created(){this.dataset=this.selectedDataset,this.dataset.dsTypeCd==="Solr"&&(!this.dataset.solrType||this.dataset.solrType==="FACETS")&&(this.dataset.solrType="DOCUMENTS")},watch:{selectedDataset(){this.dataset=this.selectedDataset}},validations(){const r={"solr-fields-required":m=>this.dataset.dsTypeCd!="Solr"||m,"document-fields-required":m=>this.dataset.solrType!="DOCUMENTS"||m};return{dataset:I("dataset",ge.validations.dataset,r)}},methods:{}}),Qn={class:"p-fluid p-formgrid p-grid"},Jn={class:"p-field p-col-6"},Kn={class:"p-float-label"},Gn={for:"restAddress",class:"kn-material-input-label"},Xn={class:"p-field p-col-6 p-float-label"},Wn={class:"p-float-label"},Yn={for:"solrCollection",class:"kn-material-input-label"},Zn={class:"p-field p-col-12 p-float-label"},_n={for:"restRequestBody",class:"kn-material-input-label"},es={key:0,class:"p-field p-col-12 p-float-label"},ts={for:"solrFieldList",class:"kn-material-input-label"};function as(e,t,r,n,m,y){const i=s("InputText"),b=s("KnValidationMessages"),p=s("Card"),f=s("RequestHeadersTable"),d=s("QueryParamTable"),w=s("FacetInfoDialog");return v(),V(N,null,[a(p,{class:"p-m-2"},{content:l(()=>[o("form",Qn,[o("div",Jn,[o("span",Kn,[a(i,{id:"restAddress",class:x(["kn-material-input",{"p-invalid":e.v$.dataset.restAddress.$invalid&&e.v$.dataset.restAddress.$dirty}]),type:"text",modelValue:e.v$.dataset.restAddress.$model,"onUpdate:modelValue":t[0]||(t[0]=g=>e.v$.dataset.restAddress.$model=g),modelModifiers:{trim:!0},onBlur:t[1]||(t[1]=g=>e.v$.dataset.restAddress.$touch()),onChange:t[2]||(t[2]=g=>e.$emit("touched"))},null,8,["modelValue","class"]),o("label",Gn,u(e.$t("managers.datasetManagement.restAddress"))+" * ",1)]),a(b,{class:"p-mt-1",vComp:e.v$.dataset.restAddress,additionalTranslateParams:{fieldName:e.$t("managers.datasetManagement.restAddress")}},null,8,["vComp","additionalTranslateParams"])]),o("div",Xn,[o("span",Wn,[a(i,{id:"solrCollection",class:x(["kn-material-input",{"p-invalid":e.v$.dataset.solrCollection.$invalid&&e.v$.dataset.solrCollection.$dirty}]),type:"text",modelValue:e.v$.dataset.solrCollection.$model,"onUpdate:modelValue":t[3]||(t[3]=g=>e.v$.dataset.solrCollection.$model=g),modelModifiers:{trim:!0},onBlur:t[4]||(t[4]=g=>e.v$.dataset.solrCollection.$touch()),onChange:t[5]||(t[5]=g=>e.$emit("touched"))},null,8,["modelValue","class"]),o("label",Yn,u(e.$t("managers.datasetManagement.solrCollection"))+" * ",1)]),a(b,{class:"p-mt-1",vComp:e.v$.dataset.solrCollection,additionalTranslateParams:{fieldName:e.$t("managers.datasetManagement.solrCollection")}},null,8,["vComp","additionalTranslateParams"])]),o("div",Zn,[a(i,{id:"restRequestBody",class:"kn-material-input",type:"text",maxLength:"2000",modelValue:e.dataset.restRequestBody,"onUpdate:modelValue":t[6]||(t[6]=g=>e.dataset.restRequestBody=g),modelModifiers:{trim:!0},onChange:t[7]||(t[7]=g=>e.$emit("touched"))},null,8,["modelValue"]),o("label",_n,u(e.$t("kpi.measureDefinition.query")),1)]),e.dataset.solrType=="DOCUMENTS"?(v(),V("div",es,[a(i,{id:"solrFieldList",class:x(["kn-material-input",{"p-invalid":e.v$.dataset.solrFieldList.$invalid&&e.v$.dataset.solrFieldList.$dirty}]),type:"text",modelValue:e.v$.dataset.solrFieldList.$model,"onUpdate:modelValue":t[8]||(t[8]=g=>e.v$.dataset.solrFieldList.$model=g),modelModifiers:{trim:!0},onBlur:t[9]||(t[9]=g=>e.v$.dataset.solrFieldList.$touch()),onChange:t[10]||(t[10]=g=>e.$emit("touched"))},null,8,["modelValue","class"]),o("label",ts,u(e.$t("managers.datasetManagement.solrFieldList"))+" * ",1),a(b,{class:"p-mt-1",vComp:e.v$.dataset.solrFieldList,additionalTranslateParams:{fieldName:e.$t("managers.datasetManagement.solrFieldList")}},null,8,["vComp","additionalTranslateParams"])])):D("",!0)])]),_:1}),a(f,{selectedDataset:e.selectedDataset},null,8,["selectedDataset"]),a(d,{selectedDataset:e.selectedDataset},null,8,["selectedDataset"]),a(w,{visible:e.facetQueryHelpVisible,onClose:t[11]||(t[11]=g=>e.facetQueryHelpVisible=!1)},null,8,["visible"])],64)}var os=E(Bn,[["render",as]]);const rs='[{"name": "tornado", "version": "6.0.3"}, {"name": "PyYAML", "version": "5.3"}, {"name": "Pillow", "version": "8.1.0"}, {"name": "MarkupSafe", "version": "1.1.1"}, {"name": "greenlet", "version": "0.4.15"}, {"name": "gevent", "version": "20.4.0"}, {"name": "cryptography", "version": "2.8"}, {"name": "cffi", "version": "1.14.0"}, {"name": "wheel", "version": "0.34.2"}, {"name": "Werkzeug", "version": "1.0.0"}, {"name": "urllib3", "version": "1.25.8"}, {"name": "typing-extensions", "version": "3.7.4.3"}, {"name": "requests", "version": "2.23.0"}, {"name": "request", "version": "2019.4.13"}, {"name": "query-string", "version": "2019.4.13"}, {"name": "PyJWT", "version": "1.7.1"}, {"name": "pycparser", "version": "2.19"}, {"name": "public", "version": "2019.4.13"}, {"name": "post", "version": "2019.4.13"}, {"name": "pip", "version": "20.3.3"}, {"name": "packaging", "version": "20.1"}, {"name": "monotonic", "version": "1.5"}, {"name": "Jinja2", "version": "2.11.1"}, {"name": "itsdangerous", "version": "1.1.0"}, {"name": "idna", "version": "2.9"}, {"name": "gunicorn", "version": "20.0.4"}, {"name": "get", "version": "2019.4.13"}, {"name": "Flask", "version": "1.1.1"}, {"name": "Flask-Cors", "version": "3.0.8"}, {"name": "eventlet", "version": "0.25.2"}, {"name": "dnspython", "version": "1.16.0"}, {"name": "Click", "version": "7.0"}, {"name": "chardet", "version": "3.0.4"}, {"name": "certifi", "version": "2019.11.28"}, {"name": "bokeh", "version": "2.2.3"}, {"name": "scipy", "version": "1.2.1"}, {"name": "pandas", "version": "0.24.1"}, {"name": "numpy", "version": "1.16.1"}, {"name": "matplotlib", "version": "3.0.2"}, {"name": "kiwisolver", "version": "1.0.1"}, {"name": "six", "version": "1.12.0"}, {"name": "setuptools", "version": "39.2.0"}, {"name": "pytz", "version": "2018.9"}, {"name": "python-dateutil", "version": "2.8.0"}, {"name": "pyparsing", "version": "2.3.1"}, {"name": "cycler", "version": "0.10.0"}]',ns='[["base","3.5.1"],["boot","1.3-20"],["class","7.3-14"],["cluster","2.0.7-1"],["codetools","0.2-15"],["compiler","3.5.1"],["datasets","3.5.1"],["foreign","0.8-70"],["graphics","3.5.1"],["grDevices","3.5.1"],["grid","3.5.1"],["KernSmooth","2.23-15"],["lattice","0.20-35"],["MASS","7.3-50"],["Matrix","1.2-14"],["methods","3.5.1"],["mgcv","1.8-24"],["nlme","3.1-137"],["nnet","7.3-12"],["parallel","3.5.1"],["rpart","4.1-13"],["spatial","7.3-11"],["splines","3.5.1"],["stats","3.5.1"],["stats4","3.5.1"],["survival","2.42-3"],["tcltk","3.5.1"],["tools","3.5.1"],["utils","3.5.1"]]',ss={dataset:[{fieldName:"dataframeName",validators:[{key:"required",validator:{type:"python-fields-required"}}]}]};var ye={pythonResponse:rs,rResponse:ns,validations:ss};const is=S({components:{Card:q,Dropdown:F,VCodeMirror:_,RadioButton:Ge,KnValidationMessages:R,Dialog:Q,DataTable:H,Column:B},props:{selectedDataset:{type:Object},pythonEnvironments:{type:Array},rEnvironments:{type:Array}},emits:["touched"],computed:{datasetTypes(){return this.dataset.pythonDatasetType=="python"?this.pythonEnvironments:this.rEnvironments}},data(){return{pythonDescriptor:ye,v$:P(),dataset:{},codeMirrorPython:{},pythonEnvLibs:null,libListVisible:!1,scriptOptions:{theme:"eclipse",lineWrapping:!0,lineNumbers:!0,mode:"text/x-python"}}},created(){this.loadDataset(),this.setupCodeMirror()},watch:{selectedDataset(){this.loadDataset()}},validations(){const t={"python-fields-required":n=>this.dataset.dsTypeCd!="Python/R"||n};return{dataset:I("dataset",ye.validations.dataset,t)}},methods:{loadDataset(){this.dataset=this.selectedDataset,this.dataset.pythonDatasetType||(this.dataset.pythonDatasetType="python"),this.dataset.pythonScript||(this.dataset.pythonScript="")},setupCodeMirror(){const e=setInterval(()=>{!this.$refs.codeMirrorPython||(this.codeMirrorPython=this.$refs.codeMirrorPython.editor,clearInterval(e))},200)},getEnvLibraries(){return this.dataset.pythonDatasetType=="python"?this.$http.get(`/knowage/restful-services/2.0/backendservices/widgets/python/libraries/${this.dataset.pythonEnvironment.label}`):this.$http.get(`/knowage/restful-services/2.0/backendservices/widgets/RWidget/libraries/${this.dataset.pythonEnvironment.label}`)},async checkEnvironment(){await this.$http,this.getEnvLibraries().then(e=>{this.dataset.pythonDatasetType=="python"?this.pythonEnvLibs=JSON.parse(e.data.result):this.pythonEnvLibs=JSON.parse(e.data.result),this.libListVisible=!0}).catch(()=>{})},updateValueFromLabel(e,t,r){const n=e.find(m=>m.label===r);n&&(this.dataset.pythonEnvironment[t]=n.value)},resetPythonEnv(){this.dataset.pythonEnvironment={label:"",value:""}}}}),ls={class:"p-field-radiobutton"},ds=o("label",{for:"Python"},"Python",-1),cs=o("label",{for:"R"},"R",-1),ps={class:"p-fluid p-formgrid p-grid p-mt-2"},us={class:"p-field p-col-6"},ms={class:"p-float-label"},bs={for:"pythonEnvironment",class:"kn-material-input-label"},vs={key:0,for:"pythonEnvironment",class:"p-error p-mt-2"},ks={class:"p-field p-col-6"},fs={class:"p-float-label"},hs={for:"dataframeName",class:"kn-material-input-label"},gs={class:"p-mt-3"},ys={key:0},ws={key:1},$s={key:0},Cs={key:1};function Ms(e,t,r,n,m,y){const i=s("RadioButton"),b=s("Dropdown"),p=s("InputText"),f=s("KnValidationMessages"),d=s("Button"),w=s("VCodeMirror"),g=s("Column"),h=s("DataTable"),k=s("Dialog"),M=s("Card");return v(),C(M,{class:"p-m-2"},{content:l(()=>[o("div",ls,[a(i,{name:"Python",value:"python",modelValue:e.dataset.pythonDatasetType,"onUpdate:modelValue":t[0]||(t[0]=c=>e.dataset.pythonDatasetType=c),onClick:e.resetPythonEnv},null,8,["modelValue","onClick"]),ds,a(i,{name:"R",class:"p-ml-3",value:"r",modelValue:e.dataset.pythonDatasetType,"onUpdate:modelValue":t[1]||(t[1]=c=>e.dataset.pythonDatasetType=c),onClick:e.resetPythonEnv},null,8,["modelValue","onClick"]),cs]),o("form",ps,[o("div",us,[o("span",ms,[a(b,{id:"pythonEnvironment",class:x(["kn-material-input",{"p-invalid":!e.dataset.pythonEnvironment.label||e.dataset.pythonEnvironment.label===""}]),options:e.datasetTypes,optionLabel:"label",optionValue:"label",modelValue:e.dataset.pythonEnvironment.label,"onUpdate:modelValue":t[2]||(t[2]=c=>e.dataset.pythonEnvironment.label=c),onChange:t[3]||(t[3]=c=>e.updateValueFromLabel(e.datasetTypes,"value",c.value))},null,8,["options","modelValue","class"]),o("label",bs,u(e.$t("managers.datasetManagement.environment"))+" * ",1)]),!e.dataset.pythonEnvironment.label||e.dataset.pythonEnvironment.label===""?(v(),V("small",vs,u(e.$t("managers.datasetManagement.envIsRequired")),1)):D("",!0)]),o("div",ks,[o("span",fs,[a(p,{id:"dataframeName",class:x(["kn-material-input",{"p-invalid":e.v$.dataset.dataframeName.$invalid&&e.v$.dataset.dataframeName.$dirty}]),type:"text",modelValue:e.v$.dataset.dataframeName.$model,"onUpdate:modelValue":t[4]||(t[4]=c=>e.v$.dataset.dataframeName.$model=c),modelModifiers:{trim:!0},onBlur:t[5]||(t[5]=c=>e.v$.dataset.dataframeName.$touch()),onChange:t[6]||(t[6]=c=>e.$emit("touched"))},null,8,["modelValue","class"]),o("label",hs,u(e.$t("managers.datasetManagement.dataframeName"))+" * ",1)]),a(f,{class:"p-mt-1",vComp:e.v$.dataset.dataframeName,additionalTranslateParams:{fieldName:e.$t("managers.datasetManagement.dataframeName")}},null,8,["vComp","additionalTranslateParams"])])]),a(d,{label:e.$t("managers.datasetManagement.checkEnvironment"),class:"p-button kn-button--primary",disabled:!e.dataset.pythonEnvironment.label,onClick:e.checkEnvironment},null,8,["label","disabled","onClick"]),a(w,{class:"p-mt-4",ref:"codeMirrorPython",value:e.dataset.pythonScript,"onUpdate:value":t[7]||(t[7]=c=>e.dataset.pythonScript=c),autoHeight:!0,options:e.scriptOptions,onKeyup:t[8]||(t[8]=c=>e.$emit("touched"))},null,8,["value","options"]),a(k,{header:e.$t("managers.datasetManagement.availableLibraries"),style:{width:"60vw"},visible:e.libListVisible,modal:!1,class:"p-fluid kn-dialog--toolbar--primary",closable:!1},{footer:l(()=>[a(d,{class:"kn-button kn-button--primary",onClick:t[9]||(t[9]=c=>e.libListVisible=!1)},{default:l(()=>[$(u(e.$t("common.close")),1)]),_:1})]),default:l(()=>[o("div",gs,[a(h,{class:"p-datatable-sm kn-table",value:e.pythonEnvLibs,scrollable:!0,responsiveLayout:"stack",breakpoint:"960px"},{default:l(()=>[a(g,{field:"name",header:e.$t("kpi.alert.name"),sortable:!0},{body:l(({data:c})=>[e.dataset.pythonDatasetType=="python"?(v(),V("span",ys)):D("",!0),$(" "+u(c.name)+" ",1),e.dataset.pythonDatasetType=="r"?(v(),V("span",ws)):D("",!0),$(" "+u(c[0]),1)]),_:1},8,["header"]),a(g,{field:"version",header:e.$t("common.version"),sortable:!0},{body:l(({data:c})=>[e.dataset.pythonDatasetType=="python"?(v(),V("span",$s)):D("",!0),$(" "+u(c.version)+" ",1),e.dataset.pythonDatasetType=="r"?(v(),V("span",Cs)):D("",!0),$(" "+u(c[1]),1)]),_:1},8,["header"])]),_:1},8,["value"])])]),_:1},8,["header","visible"])]),_:1})}var Ds=E(is,[["render",Ms]]);const Ts={dataset:[{fieldName:"flatTableName",validators:[{key:"required",validator:{type:"flat-fields-required"}}]},{fieldName:"dataSourceFlat",validators:[{key:"required",validator:{type:"flat-fields-required"}}]}]};var Vs={validations:Ts};const As=S({components:{Card:q,MonitoringDialog:Xe},props:{selectedDataset:{type:Object},dataSources:{type:Array}},emits:["touched"],data(){return{descriptor:Vs,dataset:{},availableDatasets:[],avroDatasets:[],showMonitoringDialog:!1}},setup(){return{store:j()}},created(){this.dataset=this.selectedDataset},watch:{selectedDataset(){this.dataset=this.selectedDataset}},methods:{async loadDataset(e){await this.$http.get(`/knowage/restful-services/1.0/datasets/dataset/id/${e}`).then(t=>{this.dataset=t.data[0]}).catch(()=>{})},routeToDataPreparation(){let e="";this.$confirm.require({header:this.$t("managers.datasetManagement.openDP"),message:this.$t("managers.datasetManagement.confirmMsg"),icon:"pi pi-exclamation-triangle",accept:()=>{this.$router.push(e)}})},async getAllAvroDataSets(){await this.$http.get("/knowage/restful-services/3.0/datasets/avro").then(e=>{this.avroDatasets=e.data}).catch(()=>{})},async prepareForDataPreparation(){await this.getAllAvroDataSets(),await this.openDataPreparation(this.selectedDataset)},isAvroReady(e){return this.avroDatasets.indexOf(e)>=0||(e&&this.avroDatasets.indexOf(e.toString()))>=0},openDataPreparation(e){e.dsTypeCd=="Prepared"?this.$http.get(`/knowage/restful-services/3.0/datasets/advanced/${e.id}`).then(t=>{let r=t.data.configuration.dataPrepInstanceId;this.$http.get(`/knowage-data-preparation/api/1.0/process/by-instance-id/${r}`).then(n=>{let m=n.data.definition,y=n.data.id,i=n.data.instance.dataSetId;this.isAvroReady(i)?this.$router.push({name:"data-preparation",params:{id:i,transformations:JSON.stringify(m),processId:y,instanceId:r,dataset:JSON.stringify(e)}}):this.store.setInfo({title:"Avro file is missing",msg:"Generate it again and then retry"})},()=>{this.store.setError({title:"Save error",msg:"Cannot create process"})})},()=>{this.store.setError({title:"Cannot open data preparation"})}):this.isAvroReady(e.id)?this.$router.push({name:"data-preparation",params:{id:e.id}}):this.store.setInfo({title:"Avro file is missing",msg:"Generate it again and then retry"})},async updateDatasetAndSave(e){this.showMonitoringDialog=!1,await this.$http.patch("/knowage-data-preparation/api/1.0/instance/"+e.instanceId,{config:e.config},{headers:{Accept:"application/json, */*"}}).then(()=>{this.loadDataset(this.selectedDataset.id)},()=>{this.store.setError({title:this.$t("common.error.saving"),msg:this.$t("managers.workspaceManagement.dataPreparation.errors.updatingSchedulation")})})}}}),xs={class:"p-fluid p-formgrid p-grid"},Ss={class:"p-field p-col-4"},Es={class:"p-field p-col-4"};function qs(e,t,r,n,m,y){const i=s("Button"),b=s("Card"),p=s("MonitoringDialog");return v(),V(N,null,[a(b,{class:"p-m-2"},{content:l(()=>[o("form",xs,[o("div",Ss,[a(i,{label:e.$t("managers.datasetManagement.monitoring"),class:"kn-button kn-button--primary",onClick:t[0]||(t[0]=f=>e.showMonitoringDialog=!0)},null,8,["label"])]),o("div",Es,[a(i,{label:e.$t("managers.datasetManagement.openDP"),class:"kn-button kn-button--primary",onClick:e.prepareForDataPreparation},null,8,["label","onClick"])])])]),_:1}),a(p,{visibility:e.showMonitoringDialog,dataset:e.selectedDataset,onClose:t[1]||(t[1]=f=>e.showMonitoringDialog=!1),onSave:e.updateDatasetAndSave},null,8,["visibility","dataset","onSave"])],64)}var Ns=E(As,[["render",qs]]);const Ps=S({components:{Card:q,Dropdown:F,KnValidationMessages:R,ParamTable:Lt,CkanDataset:hr,QbeDataset:ho,RestDataset:wn,JavaDataset:Xa,FlatDataset:xo,SolrDataset:os,QueryDataset:ja,ScriptDataset:ro,SparqlDataset:Rn,PythonDataset:Ds,FileDataset:wa,PreparedDataset:Ns},props:{parentValid:{type:Boolean},selectedDataset:{type:Object},datasetTypes:{type:Array},dataSources:{type:Array},businessModels:{type:Array},scriptTypes:{type:Array},pythonEnvironments:{type:Array},rEnvironments:{type:Array},activeTab:{type:Number}},computed:{},emits:["touched","fileUploaded","qbeSaved","queryEdited"],data(){return{typeTabDescriptor:ue,dataset:{},v$:P(),expandParamsCard:!0}},created(){this.dataset=this.selectedDataset},watch:{selectedDataset(){this.dataset=this.selectedDataset}},validations(){return{dataset:I("dataset",ue.validations.dataset)}},methods:{}}),Rs={key:0},Is=$(),Fs=o("b",null,"Federated",-1),Us={key:1,id:"is-not-federated"},Os={id:"dropdownContainer"},Ls={class:"p-float-label"},js={for:"scope",class:"kn-material-input-label"};function zs(e,t,r,n,m,y){const i=s("Dropdown"),b=s("KnValidationMessages"),p=s("Card"),f=s("FileDataset"),d=s("QueryDataset"),w=s("JavaDataset"),g=s("ScriptDataset"),h=s("QbeDataset"),k=s("FlatDataset"),M=s("CkanDataset"),c=s("RestDataset"),T=s("SparqlDataset"),xe=s("SolrDataset"),Se=s("PythonDataset"),Ee=s("PreparedDataset"),qe=s("ParamTable");return v(),V(N,null,[e.dataset.dsTypeCd=="Federated"?(v(),V("div",Rs,[o("label",null,u(e.$t("managers.datasetManagement.selectDatasetType"))+": ",1),Is,Fs])):(v(),V("div",Us,[a(p,{class:"p-m-2"},{content:l(()=>[o("div",Os,[o("span",Ls,[a(i,{id:"scope",class:x(["kn-material-input",{"p-invalid":e.v$.dataset.dsTypeCd.$invalid&&e.v$.dataset.dsTypeCd.$dirty}]),style:A(e.typeTabDescriptor.style.maxWidth),options:e.datasetTypes,optionLabel:"VALUE_CD",optionValue:"VALUE_CD",modelValue:e.v$.dataset.dsTypeCd.$model,"onUpdate:modelValue":t[0]||(t[0]=Z=>e.v$.dataset.dsTypeCd.$model=Z),onBeforeShow:t[1]||(t[1]=Z=>e.v$.dataset.dsTypeCd.$touch()),onChange:t[2]||(t[2]=Z=>{this.dataset.pars=[],this.dataset.restJsonPathAttributes=[],this.dataset.restRequestHeaders=[],e.$emit("touched")})},null,8,["style","options","modelValue","class"]),o("label",js,u(e.$t("managers.datasetManagement.selectDatasetType"))+" * ",1)]),a(b,{vComp:e.v$.dataset.dsTypeCd,additionalTranslateParams:{fieldName:e.$t("managers.datasetManagement.selectDatasetType")}},null,8,["vComp","additionalTranslateParams"])])]),_:1})])),e.dataset.dsTypeCd=="File"?(v(),C(f,{key:2,selectedDataset:e.selectedDataset,onFileUploaded:t[3]||(t[3]=Z=>e.$emit("fileUploaded"))},null,8,["selectedDataset"])):D("",!0),e.dataset.dsTypeCd=="Query"?(v(),C(d,{key:3,selectedDataset:e.selectedDataset,dataSources:e.dataSources,scriptTypes:e.scriptTypes,activeTab:e.activeTab,onQueryEdited:t[4]||(t[4]=Z=>e.$emit("queryEdited"))},null,8,["selectedDataset","dataSources","scriptTypes","activeTab"])):D("",!0),e.dataset.dsTypeCd=="Java Class"?(v(),C(w,{key:4,selectedDataset:e.selectedDataset},null,8,["selectedDataset"])):D("",!0),e.dataset.dsTypeCd=="Script"?(v(),C(g,{key:5,selectedDataset:e.selectedDataset,scriptTypes:e.scriptTypes,activeTab:e.activeTab},null,8,["selectedDataset","scriptTypes","activeTab"])):D("",!0),e.dataset.dsTypeCd=="Qbe"||e.dataset.dsTypeCd=="Federated"?(v(),C(h,{key:6,selectedDataset:e.selectedDataset,businessModels:e.businessModels,dataSources:e.dataSources,parentValid:e.parentValid},null,8,["selectedDataset","businessModels","dataSources","parentValid"])):D("",!0),e.dataset.dsTypeCd=="Flat"?(v(),C(k,{key:7,selectedDataset:e.selectedDataset,dataSources:e.dataSources},null,8,["selectedDataset","dataSources"])):D("",!0),e.dataset.dsTypeCd=="Ckan"?(v(),C(M,{key:8,selectedDataset:e.selectedDataset},null,8,["selectedDataset"])):D("",!0),e.dataset.dsTypeCd=="REST"?(v(),C(c,{key:9,selectedDataset:e.selectedDataset},null,8,["selectedDataset"])):D("",!0),e.dataset.dsTypeCd=="SPARQL"?(v(),C(T,{key:10,selectedDataset:e.selectedDataset},null,8,["selectedDataset"])):D("",!0),e.dataset.dsTypeCd=="Solr"?(v(),C(xe,{key:11,selectedDataset:e.selectedDataset},null,8,["selectedDataset"])):D("",!0),e.dataset.dsTypeCd=="Python/R"?(v(),C(Se,{key:12,selectedDataset:e.selectedDataset,pythonEnvironments:e.pythonEnvironments,rEnvironments:e.rEnvironments},null,8,["selectedDataset","pythonEnvironments","rEnvironments"])):D("",!0),e.dataset.dsTypeCd=="Prepared"?(v(),C(Ee,{key:13,selectedDataset:e.selectedDataset,pythonEnvironments:e.pythonEnvironments,rEnvironments:e.rEnvironments},null,8,["selectedDataset","pythonEnvironments","rEnvironments"])):D("",!0),e.dataset.dsTypeCd&&e.dataset.dsTypeCd!="File"&&e.dataset.dsTypeCd!="Flat"&&e.dataset.dsTypeCd!="Prepared"?(v(),C(qe,{key:14,selectedDataset:e.selectedDataset},null,8,["selectedDataset"])):D("",!0)],64)}var Hs=E(Ps,[["render",zs]]);/*!
 * vuex v4.0.0
 * (c) 2021 Evan You
 * @license MIT
 */var Bs="store",Qs=typeof window!="undefined"?window:typeof global!="undefined"?global:{},W=Qs.__VUE_DEVTOOLS_GLOBAL_HOOK__;function Js(e){!W||(e._devtoolHook=W,W.emit("vuex:init",e),W.on("vuex:travel-to-state",function(t){e.replaceState(t)}),e.subscribe(function(t,r){W.emit("vuex:mutation",t,r)},{prepend:!0}),e.subscribeAction(function(t,r){W.emit("vuex:action",t,r)},{prepend:!0}))}function Y(e,t){Object.keys(e).forEach(function(r){return t(e[r],r)})}function Me(e){return e!==null&&typeof e=="object"}function Ks(e){return e&&typeof e.then=="function"}function Gs(e,t){return function(){return e(t)}}var L=function(t,r){this.runtime=r,this._children=Object.create(null),this._rawModule=t;var n=t.state;this.state=(typeof n=="function"?n():n)||{}},De={namespaced:{configurable:!0}};De.namespaced.get=function(){return!!this._rawModule.namespaced};L.prototype.addChild=function(t,r){this._children[t]=r};L.prototype.removeChild=function(t){delete this._children[t]};L.prototype.getChild=function(t){return this._children[t]};L.prototype.hasChild=function(t){return t in this._children};L.prototype.update=function(t){this._rawModule.namespaced=t.namespaced,t.actions&&(this._rawModule.actions=t.actions),t.mutations&&(this._rawModule.mutations=t.mutations),t.getters&&(this._rawModule.getters=t.getters)};L.prototype.forEachChild=function(t){Y(this._children,t)};L.prototype.forEachGetter=function(t){this._rawModule.getters&&Y(this._rawModule.getters,t)};L.prototype.forEachAction=function(t){this._rawModule.actions&&Y(this._rawModule.actions,t)};L.prototype.forEachMutation=function(t){this._rawModule.mutations&&Y(this._rawModule.mutations,t)};Object.defineProperties(L.prototype,De);var X=function(t){this.register([],t,!1)};X.prototype.get=function(t){return t.reduce(function(r,n){return r.getChild(n)},this.root)};X.prototype.getNamespace=function(t){var r=this.root;return t.reduce(function(n,m){return r=r.getChild(m),n+(r.namespaced?m+"/":"")},"")};X.prototype.update=function(t){Te([],this.root,t)};X.prototype.register=function(t,r,n){var m=this;n===void 0&&(n=!0);var y=new L(r,n);if(t.length===0)this.root=y;else{var i=this.get(t.slice(0,-1));i.addChild(t[t.length-1],y)}r.modules&&Y(r.modules,function(b,p){m.register(t.concat(p),b,n)})};X.prototype.unregister=function(t){var r=this.get(t.slice(0,-1)),n=t[t.length-1],m=r.getChild(n);!m||!m.runtime||r.removeChild(n)};X.prototype.isRegistered=function(t){var r=this.get(t.slice(0,-1)),n=t[t.length-1];return r?r.hasChild(n):!1};function Te(e,t,r){if(t.update(r),r.modules)for(var n in r.modules){if(!t.getChild(n))return;Te(e.concat(n),t.getChild(n),r.modules[n])}}var U=function(t){var r=this;t===void 0&&(t={});var n=t.plugins;n===void 0&&(n=[]);var m=t.strict;m===void 0&&(m=!1),this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new X(t),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._makeLocalGettersCache=Object.create(null);var y=this,i=this,b=i.dispatch,p=i.commit;this.dispatch=function(g,h){return b.call(y,g,h)},this.commit=function(g,h,k){return p.call(y,g,h,k)},this.strict=m;var f=this._modules.root.state;oe(this,f,[],this._modules.root),le(this,f),n.forEach(function(w){return w(r)});var d=t.devtools!==void 0?t.devtools:!0;d&&Js(this)},ie={state:{configurable:!0}};U.prototype.install=function(t,r){t.provide(r||Bs,this),t.config.globalProperties.$store=this};ie.state.get=function(){return this._state.data};ie.state.set=function(e){};U.prototype.commit=function(t,r,n){var m=this,y=te(t,r,n),i=y.type,b=y.payload,p={type:i,payload:b},f=this._mutations[i];!f||(this._withCommit(function(){f.forEach(function(w){w(b)})}),this._subscribers.slice().forEach(function(d){return d(p,m.state)}))};U.prototype.dispatch=function(t,r){var n=this,m=te(t,r),y=m.type,i=m.payload,b={type:y,payload:i},p=this._actions[y];if(!!p){try{this._actionSubscribers.slice().filter(function(d){return d.before}).forEach(function(d){return d.before(b,n.state)})}catch{}var f=p.length>1?Promise.all(p.map(function(d){return d(i)})):p[0](i);return new Promise(function(d,w){f.then(function(g){try{n._actionSubscribers.filter(function(h){return h.after}).forEach(function(h){return h.after(b,n.state)})}catch{}d(g)},function(g){try{n._actionSubscribers.filter(function(h){return h.error}).forEach(function(h){return h.error(b,n.state,g)})}catch{}w(g)})})}};U.prototype.subscribe=function(t,r){return Ve(t,this._subscribers,r)};U.prototype.subscribeAction=function(t,r){var n=typeof t=="function"?{before:t}:t;return Ve(n,this._actionSubscribers,r)};U.prototype.watch=function(t,r,n){var m=this;return $e(function(){return t(m.state,m.getters)},r,Object.assign({},n))};U.prototype.replaceState=function(t){var r=this;this._withCommit(function(){r._state.data=t})};U.prototype.registerModule=function(t,r,n){n===void 0&&(n={}),typeof t=="string"&&(t=[t]),this._modules.register(t,r),oe(this,this.state,t,this._modules.get(t),n.preserveState),le(this,this.state)};U.prototype.unregisterModule=function(t){var r=this;typeof t=="string"&&(t=[t]),this._modules.unregister(t),this._withCommit(function(){var n=de(r.state,t.slice(0,-1));delete n[t[t.length-1]]}),Ae(this)};U.prototype.hasModule=function(t){return typeof t=="string"&&(t=[t]),this._modules.isRegistered(t)};U.prototype.hotUpdate=function(t){this._modules.update(t),Ae(this,!0)};U.prototype._withCommit=function(t){var r=this._committing;this._committing=!0,t(),this._committing=r};Object.defineProperties(U.prototype,ie);function Ve(e,t,r){return t.indexOf(e)<0&&(r&&r.prepend?t.unshift(e):t.push(e)),function(){var n=t.indexOf(e);n>-1&&t.splice(n,1)}}function Ae(e,t){e._actions=Object.create(null),e._mutations=Object.create(null),e._wrappedGetters=Object.create(null),e._modulesNamespaceMap=Object.create(null);var r=e.state;oe(e,r,[],e._modules.root,!0),le(e,r,t)}function le(e,t,r){var n=e._state;e.getters={},e._makeLocalGettersCache=Object.create(null);var m=e._wrappedGetters,y={};Y(m,function(i,b){y[b]=Gs(i,e),Object.defineProperty(e.getters,b,{get:function(){return y[b]()},enumerable:!0})}),e._state=Ue({data:t}),e.strict&&ei(e),n&&r&&e._withCommit(function(){n.data=null})}function oe(e,t,r,n,m){var y=!r.length,i=e._modules.getNamespace(r);if(n.namespaced&&(e._modulesNamespaceMap[i],e._modulesNamespaceMap[i]=n),!y&&!m){var b=de(t,r.slice(0,-1)),p=r[r.length-1];e._withCommit(function(){b[p]=n.state})}var f=n.context=Xs(e,i,r);n.forEachMutation(function(d,w){var g=i+w;Ys(e,g,d,f)}),n.forEachAction(function(d,w){var g=d.root?w:i+w,h=d.handler||d;Zs(e,g,h,f)}),n.forEachGetter(function(d,w){var g=i+w;_s(e,g,d,f)}),n.forEachChild(function(d,w){oe(e,t,r.concat(w),d,m)})}function Xs(e,t,r){var n=t==="",m={dispatch:n?e.dispatch:function(y,i,b){var p=te(y,i,b),f=p.payload,d=p.options,w=p.type;return(!d||!d.root)&&(w=t+w),e.dispatch(w,f)},commit:n?e.commit:function(y,i,b){var p=te(y,i,b),f=p.payload,d=p.options,w=p.type;(!d||!d.root)&&(w=t+w),e.commit(w,f,d)}};return Object.defineProperties(m,{getters:{get:n?function(){return e.getters}:function(){return Ws(e,t)}},state:{get:function(){return de(e.state,r)}}}),m}function Ws(e,t){if(!e._makeLocalGettersCache[t]){var r={},n=t.length;Object.keys(e.getters).forEach(function(m){if(m.slice(0,n)===t){var y=m.slice(n);Object.defineProperty(r,y,{get:function(){return e.getters[m]},enumerable:!0})}}),e._makeLocalGettersCache[t]=r}return e._makeLocalGettersCache[t]}function Ys(e,t,r,n){var m=e._mutations[t]||(e._mutations[t]=[]);m.push(function(i){r.call(e,n.state,i)})}function Zs(e,t,r,n){var m=e._actions[t]||(e._actions[t]=[]);m.push(function(i){var b=r.call(e,{dispatch:n.dispatch,commit:n.commit,getters:n.getters,state:n.state,rootGetters:e.getters,rootState:e.state},i);return Ks(b)||(b=Promise.resolve(b)),e._devtoolHook?b.catch(function(p){throw e._devtoolHook.emit("vuex:error",p),p}):b})}function _s(e,t,r,n){e._wrappedGetters[t]||(e._wrappedGetters[t]=function(y){return r(n.state,n.getters,y.state,y.getters)})}function ei(e){$e(function(){return e._state.data},function(){},{deep:!0,flush:"sync"})}function de(e,t){return t.reduce(function(r,n){return r[n]},e)}function te(e,t,r){return Me(e)&&e.type&&(r=t,t=e,e=e.type),{type:e,payload:t,options:r}}var ti=ri(function(e,t){var r={};return ai(t).forEach(function(n){var m=n.key,y=n.val;r[m]=function(){var b=this.$store.state,p=this.$store.getters;if(e){var f=ni(this.$store,"mapState",e);if(!f)return;b=f.context.state,p=f.context.getters}return typeof y=="function"?y.call(this,b,p):b[y]},r[m].vuex=!0}),r});function ai(e){return oi(e)?Array.isArray(e)?e.map(function(t){return{key:t,val:t}}):Object.keys(e).map(function(t){return{key:t,val:e[t]}}):[]}function oi(e){return Array.isArray(e)||Me(e)}function ri(e){return function(t,r){return typeof t!="string"?(r=t,t=""):t.charAt(t.length-1)!=="/"&&(t+="/"),e(t,r)}}function ni(e,t,r){var n=e._modulesNamespaceMap[r];return n}const si=S({components:{Card:q,InputSwitch:Ye,Checkbox:ae,KnValidationMessages:R,DatasetScheduler:Ke},props:{selectedDataset:{type:Object},transformationDataset:{type:Object},schedulingData:{type:Object}},computed:{...ti({user:"user"}),disablePersist(){return!!(this.dataset.pars&&this.dataset.pars.length>0)},isAbleToSeeIsScheduledToolbar(){return this.user.functionalities.includes("SchedulingDatasetManagement")&&this.dataset.isPersisted},isAbleToSeeDatasetScheduler(){return this.user.functionalities.includes("SchedulingDatasetManagement")&&this.dataset.isPersisted&&this.dataset.isScheduled}},emits:["touched"],data(){return{v$:P(),advancedCardDescriptor:ce,dataset:{},testInput:"testinput",testCheckbox:!0,isTransformable:!1}},created(){this.dataset=this.selectedDataset,this.isDatasetTransformable()},watch:{selectedDataset(){this.dataset=this.selectedDataset,this.isDatasetTransformable()}},validations(){const r={"transformable-field-required":m=>!this.isTransformable||m,"persist-field-required":m=>!this.dataset.isPersisted||m};return{dataset:I("dataset",ce.validations.advancedTab,r)}},methods:{isDatasetTransformable(){this.dataset.trasfTypeCd&&this.dataset.trasfTypeCd==this.transformationDataset.VALUE_CD?this.isTransformable=!0:this.isTransformable=!1},setTransformationType(){this.isTransformable?this.dataset.trasfTypeCd=this.transformationDataset.VALUE_CD:(this.dataset.trasfTypeCd&&(this.dataset.trasfTypeCd=""),this.dataset.pivotColName&&(this.dataset.pivotColName=""),this.dataset.pivotColValue&&(this.dataset.pivotColValue=""),this.dataset.pivotIsNumRows&&(this.dataset.pivotIsNumRows=""),this.dataset.pivotRowName&&(this.dataset.pivotRowName=""))}}}),ii={class:"p-fluid p-formgrid p-grid"},li={class:"p-field p-col-3"},di={class:"p-float-label"},ci={for:"pivotColName",class:"kn-material-input-label"},pi={class:"p-field p-col-3"},ui={class:"p-float-label"},mi={for:"pivotColValue",class:"kn-material-input-label"},bi={class:"p-field p-col-3"},vi={class:"p-float-label"},ki={for:"pivotRowName",class:"kn-material-input-label"},fi={class:"p-field-checkbox p-col-3"},hi={for:"pivotIsNumRows"},gi={key:1},yi={class:"p-fluid p-formgrid p-grid"},wi={class:"p-field p-col-3"},$i={class:"p-float-label"},Ci={for:"persistTableName",class:"kn-material-input-label"};function Mi(e,t,r,n,m,y){const i=s("InputSwitch"),b=s("Toolbar"),p=s("InputText"),f=s("KnValidationMessages"),d=s("Checkbox"),w=s("Card"),g=s("DatasetScheduler"),h=we("tooltip");return v(),V(N,null,[a(b,{class:"kn-toolbar kn-toolbar--secondary"},{start:l(()=>[a(i,{modelValue:e.isTransformable,"onUpdate:modelValue":t[0]||(t[0]=k=>e.isTransformable=k),onChange:e.setTransformationType,class:"p-mr-2"},null,8,["modelValue","onChange"]),o("span",null,u(e.$t("managers.datasetManagement.pivotTransformer")),1)]),_:1}),e.isTransformable?(v(),C(w,{key:0},{content:l(()=>[o("form",ii,[o("div",li,[o("span",di,[a(p,{id:"pivotColName",class:x(["kn-material-input",{"p-invalid":e.v$.dataset.pivotColName.$invalid&&e.v$.dataset.pivotColName.$dirty}]),type:"text",modelValue:e.v$.dataset.pivotColName.$model,"onUpdate:modelValue":t[1]||(t[1]=k=>e.v$.dataset.pivotColName.$model=k),modelModifiers:{trim:!0},onBlur:t[2]||(t[2]=k=>e.v$.dataset.pivotColName.$touch()),onChange:t[3]||(t[3]=k=>e.$emit("touched"))},null,8,["modelValue","class"]),o("label",ci,u(e.$t("managers.datasetManagement.pivotColName"))+" * ",1)]),a(f,{class:"p-mt-1",vComp:e.v$.dataset.pivotColName,additionalTranslateParams:{fieldName:e.$t("managers.datasetManagement.pivotColName")}},null,8,["vComp","additionalTranslateParams"])]),o("div",pi,[o("span",ui,[a(p,{id:"pivotColValue",class:x(["kn-material-input",{"p-invalid":e.v$.dataset.pivotColValue.$invalid&&e.v$.dataset.pivotColValue.$dirty}]),type:"text",modelValue:e.dataset.pivotColValue,"onUpdate:modelValue":t[4]||(t[4]=k=>e.dataset.pivotColValue=k),onBlur:t[5]||(t[5]=k=>e.v$.dataset.pivotColValue.$touch()),onChange:t[6]||(t[6]=k=>e.$emit("touched"))},null,8,["modelValue","class"]),o("label",mi,u(e.$t("managers.datasetManagement.pivotColValue"))+" * ",1)]),a(f,{class:"p-mt-1",vComp:e.v$.dataset.pivotColValue,additionalTranslateParams:{fieldName:e.$t("managers.datasetManagement.pivotColValue")}},null,8,["vComp","additionalTranslateParams"])]),o("div",bi,[o("span",vi,[a(p,{id:"pivotRowName",class:x(["kn-material-input",{"p-invalid":e.v$.dataset.pivotRowName.$invalid&&e.v$.dataset.pivotRowName.$dirty}]),type:"text",modelValue:e.dataset.pivotRowName,"onUpdate:modelValue":t[7]||(t[7]=k=>e.dataset.pivotRowName=k),onBlur:t[8]||(t[8]=k=>e.v$.dataset.pivotRowName.$touch()),onChange:t[9]||(t[9]=k=>e.$emit("touched"))},null,8,["modelValue","class"]),o("label",ki,u(e.$t("managers.datasetManagement.pivotRowName"))+" *",1)]),a(f,{class:"p-mt-1",vComp:e.v$.dataset.pivotRowName,additionalTranslateParams:{fieldName:e.$t("managers.datasetManagement.pivotRowName")}},null,8,["vComp","additionalTranslateParams"])]),o("span",fi,[o("label",hi,u(e.$t("managers.datasetManagement.pivotIsNumRows")),1),a(d,{id:"pivotIsNumRows",class:"p-ml-2",modelValue:e.dataset.pivotIsNumRows,"onUpdate:modelValue":t[10]||(t[10]=k=>e.dataset.pivotIsNumRows=k),binary:!0,onChange:t[11]||(t[11]=k=>e.$emit("touched"))},null,8,["modelValue"])])])]),_:1})):D("",!0),a(b,{class:"kn-toolbar kn-toolbar--secondary p-mt-3"},{start:l(()=>[a(i,{modelValue:e.dataset.isPersistedHDFS,"onUpdate:modelValue":t[12]||(t[12]=k=>e.dataset.isPersistedHDFS=k),class:"p-mr-2",onChange:t[13]||(t[13]=k=>e.$emit("touched"))},null,8,["modelValue"]),o("span",null,u(e.$t("managers.datasetManagement.isPersistedHDFS")),1)]),_:1}),e.dataset.dsTypeCd!="Flat"?(v(),V("div",gi,[a(b,{class:"kn-toolbar kn-toolbar--secondary p-mt-3"},{start:l(()=>[a(i,{modelValue:e.dataset.isPersisted,"onUpdate:modelValue":t[14]||(t[14]=k=>e.dataset.isPersisted=k),disabled:e.disablePersist,class:"p-mr-2",onChange:t[15]||(t[15]=k=>e.$emit("touched"))},null,8,["modelValue","disabled"]),z((v(),V("span",null,[$(u(e.$t("managers.datasetManagement.isPersisted")),1)])),[[h,{value:e.$t("managers.datasetManagement.peristenceWarning"),disabled:!e.disablePersist},void 0,{top:!0}]])]),_:1}),e.dataset.isPersisted?(v(),C(w,{key:0},{content:l(()=>[o("form",yi,[o("div",wi,[o("span",$i,[a(p,{id:"persistTableName",class:x(["kn-material-input",{"p-invalid":e.v$.dataset.persistTableName.$invalid&&e.v$.dataset.persistTableName.$dirty}]),type:"text",modelValue:e.dataset.persistTableName,"onUpdate:modelValue":t[16]||(t[16]=k=>e.dataset.persistTableName=k),onBlur:t[17]||(t[17]=k=>e.v$.dataset.persistTableName.$touch()),onChange:t[18]||(t[18]=k=>e.$emit("touched"))},null,8,["modelValue","class"]),o("label",Ci,u(e.$t("managers.datasetManagement.persistTableName"))+" *",1)]),a(f,{class:"p-mt-1",vComp:e.v$.dataset.persistTableName,additionalTranslateParams:{fieldName:e.$t("managers.datasetManagement.persistTableName")}},null,8,["vComp","additionalTranslateParams"])])]),e.isAbleToSeeIsScheduledToolbar?(v(),C(b,{key:0,class:"kn-toolbar kn-toolbar--default p-mt-3"},{start:l(()=>[a(i,{modelValue:e.dataset.isScheduled,"onUpdate:modelValue":t[19]||(t[19]=k=>e.dataset.isScheduled=k),class:"p-mr-2",onChange:t[20]||(t[20]=k=>e.$emit("touched"))},null,8,["modelValue"]),o("span",null,u(e.$t("managers.datasetManagement.isScheduled")),1)]),_:1})):D("",!0),e.isAbleToSeeDatasetScheduler?(v(),C(g,{key:1,selectedDataset:e.dataset,schedulingData:e.schedulingData},null,8,["selectedDataset","schedulingData"])):D("",!0)]),_:1})):D("",!0)])):D("",!0)],64)}var Di=E(si,[["render",Mi]]);const Ti=["name"],Vi={listTrashIcon:{height:"5px"},listbox:{height:"65vh"}};var Ai={filterFields:Ti,style:Vi};const xi=S({components:{Listbox:Oe},props:{selectedDataset:{type:Object},metaSourceResource:{type:Array},activeTab:{type:Number}},emits:["removeTables","addTables"],data(){return{linkTabDescriptor:Ai,availableResources:null,selectedResource:null,dataset:{},availableTables:[],selectedTables:[],tablesToRemove:[],tablesToAdd:[]}},setup(){return{store:j()}},created(){this.dataset=this.selectedDataset,this.getSelectedTables()},watch:{selectedDataset(){this.dataset=this.selectedDataset,this.getSelectedTables()},activeTab(){this.activeTab===3&&this.getAvailableSources()}},methods:{async getSelectedTables(){this.dataset.id&&this.$http.get(`/knowage/restful-services/2.0/metaDsRelationResource/dataset/${this.dataset.id}/`).then(e=>this.selectedTables=e.data).catch(e=>this.store.setError({title:this.$t("common.toast.error"),msg:e}))},async getAvailableSources(){this.$http.get("/knowage/restful-services/2.0/metaSourceResource/").then(e=>{e.data.length>0?(this.availableResources=[...e.data],this.availableResources.filter(t=>t.name===this.dataset.dataSource.toLowerCase()?this.getAvailableSourceTables(t.sourceId):"")):this.store.setInfo({title:this.$t("importExport.gallery.column.info"),msg:this.$t("managers.datasetManagement.noSourceTables")})}).catch(e=>this.store.setError({title:this.$t("common.toast.error"),msg:e}))},async getAvailableSourceTables(e){this.$http.get(`/knowage/restful-services/2.0/metaSourceResource/${e}/metatables/`).then(t=>{t.data.length>0?this.availableTables=this.removeSelectedTablesFromAvailable(t.data,this.selectedTables):this.store.setInfo({title:this.$t("importExport.gallery.column.info"),msg:this.$t("managers.datasetManagement.noTablesToLink")})}).catch(t=>this.store.setError({title:this.$t("common.toast.error"),msg:t}))},removeSelectedTablesFromAvailable(e,t){let r=t.map(m=>m.tableId);return e.filter(m=>!r.includes(m.tableId))},moveTableToList(e,t,r){const n=t.findIndex(m=>m.tableId===e);if(n>=0){const m=t[n];t.splice(n,1),r.unshift(m)}},addTableToSelectedList(e){e.deleted&&!e.added?(e.deleted=!1,this.tablesToRemove=this.tablesToRemove.filter(t=>e.tableId!==t.tableId)):(e.deleted=!1,e.added=!0,this.tablesToAdd.push(e)),this.moveTableToList(e.tableId,this.availableTables,this.selectedTables),this.$emit("addTables",this.tablesToAdd)},removeTableFromSelectedList(e){e.added&&!e.deleted?(delete e.added,this.tablesToAdd=this.tablesToAdd.filter(t=>e.tableId!==t.tableId)):(e.deleted=!0,this.tablesToRemove.push(e)),this.moveTableToList(e.tableId,this.selectedTables,this.availableTables),this.$emit("removeTables",this.tablesToRemove)}}}),Si={class:"p-grid p-m-2 table-list-container"},Ei={class:"p-col-6 p-d-flex p-flex-column"},qi=["onClick"],Ni={class:"kn-list-item-text"},Pi={class:"p-col-6 p-d-flex p-flex-column"},Ri=["onClick"],Ii={class:"kn-list-item-text"};function Fi(e,t,r,n,m,y){const i=s("Toolbar"),b=s("Listbox");return v(),V("div",Si,[o("div",Ei,[a(i,{class:"kn-toolbar kn-toolbar--secondary"},{start:l(()=>[$(u(e.$t("managers.datasetManagement.availableTables")),1)]),_:1}),a(b,{class:"kn-list link-list kn-flex",listStyle:e.linkTabDescriptor.style.listbox,options:e.availableTables,filter:!0,filterPlaceholder:e.$t("common.search"),optionLabel:"name",filterMatchMode:"contains",filterFields:e.linkTabDescriptor.filterFields,emptyFilterMessage:e.$t("common.info.noDataFound")},{option:l(p=>[o("div",{class:"kn-list-item",onClick:f=>e.addTableToSelectedList(p.option)},[o("div",Ni,[o("span",null,u(p.option.name),1)])],8,qi)]),_:1},8,["listStyle","options","filterPlaceholder","filterFields","emptyFilterMessage"])]),o("div",Pi,[a(i,{class:"kn-toolbar kn-toolbar--secondary"},{start:l(()=>[$(u(e.$t("managers.datasetManagement.selectedTables")),1)]),_:1}),a(b,{class:"kn-list link-list kn-flex",listStyle:e.linkTabDescriptor.style.listbox,options:e.selectedTables,filter:!0,filterPlaceholder:e.$t("common.search"),optionLabel:"name",filterMatchMode:"contains",filterFields:e.linkTabDescriptor.filterFields,emptyFilterMessage:e.$t("managers.datasetManagement.noLinkedTables")},{empty:l(()=>[$(u(e.$t("common.info.noDataFound")),1)]),option:l(p=>[o("div",{class:"kn-list-item",onClick:f=>e.removeTableFromSelectedList(p.option)},[o("div",Ii,[o("span",null,u(p.option.name),1)])],8,Ri)]),_:1},8,["listStyle","options","filterPlaceholder","filterFields","emptyFilterMessage"])])])}var Ui=E(xi,[["render",Fi],["__scopeId","data-v-2cd252e2"]]);const Oi=S({components:{Card:q,Column:B,DataTable:H,Message:Le,Dropdown:F,Checkbox:ae},props:{selectedDataset:{type:Object},showMetadataQueryInfoProp:{type:Boolean}},computed:{},emits:["touched"],data(){return{linkTabDescriptor:ne,fieldMetadataTypes:ne.fieldsMetadataTypes,valueTypes:ne.valueTypes,dataset:{},fieldsMetadata:[]}},setup(){return{store:j()}},created(){this.dataset=this.selectedDataset,this.dataset.meta&&this.exctractFieldsMetadata(this.dataset.meta.columns)},watch:{selectedDataset(){this.dataset=this.selectedDataset,this.dataset.meta&&this.exctractFieldsMetadata(this.dataset.meta.columns)}},methods:{exctractFieldsMetadata(e){var t={};for(var r in e){var n=t[e[r].column];n||(n={},t[e[r].column]=n,n.column=e[r].column),n[e[r].pname]=e[r].pvalue}var m=new Array;for(r in t)m.push(t[r]);this.fieldsMetadata=m},saveFieldsMetadata(e){this.warnForDuplicateSpatialFields(),this.applyMetadataChangesToFields(e)},applyMetadataChangesToFields(e){for(let t=0;t<this.fieldsMetadata.length;t++)for(let r=0;r<this.dataset.meta.columns.length;r++)this.fieldsMetadata[t].column==this.dataset.meta.columns[r].column&&this.dataset.meta.columns[r].pname==e&&(this.dataset.meta.columns[r].pvalue=this.fieldsMetadata[t][e])},warnForDuplicateSpatialFields(){var e=0;for(let t=0;t<this.fieldsMetadata.length;t++)if(this.fieldsMetadata[t].fieldType=="SPATIAL_ATTRIBUTE"&&(e++,e>1)){this.store.setError({title:this.$t("common.error.saving"),msg:this.$t("managers.datasetManagement.duplicateSpatialAttribute")});return}}}}),Li={key:1};function ji(e,t,r,n,m,y){const i=s("Message"),b=s("Toolbar"),p=s("Column"),f=s("Dropdown"),d=s("Checkbox"),w=s("DataTable"),g=s("Card");return v(),V(N,null,[e.showMetadataQueryInfoProp?(v(),C(i,{key:0,severity:"info",class:"p-mx-2",closable:!0},{default:l(()=>[$(u(e.$t("managers.datasetManagement.showMetadataQueryInfo")),1)]),_:1})):D("",!0),a(g,{class:"p-m-2"},{header:l(()=>[a(b,{class:"kn-toolbar kn-toolbar--secondary"},{start:l(()=>[$(u(e.$t("managers.datasetManagement.fieldsMetadata")),1)]),_:1})]),content:l(()=>[e.dataset.meta&&(e.dataset.meta.ccolumns||e.dataset.meta.dataset)?(v(),C(w,{key:0,class:"p-datatable-sm kn-table kn-table-small-input",autoLayout:!0,value:e.fieldsMetadata,responsiveLayout:"stack",breakpoint:"960px"},{default:l(()=>[a(p,{field:"fieldAlias",header:e.$t("managers.datasetManagement.fieldAlias"),sortable:!0},{body:l(({data:h})=>[$(u(h.fieldAlias),1)]),_:1},8,["header"]),a(p,{field:"Type",header:e.$t("importExport.catalogFunction.column.type"),sortable:!0},{body:l(({data:h})=>[a(f,{class:"kn-material-input",style:A(e.linkTabDescriptor.style.maxwidth),modelValue:h.Type,"onUpdate:modelValue":k=>h.Type=k,options:e.valueTypes,optionDisabled:"disabled",optionLabel:"value",optionValue:"name",onChange:e.saveFieldsMetadata,disabled:!0},null,8,["style","modelValue","onUpdate:modelValue","options","onChange"])]),_:1},8,["header"]),a(p,{field:"fieldType",header:e.$t("managers.datasetManagement.fieldType"),sortable:!0},{body:l(({data:h})=>[a(f,{class:"kn-material-input",style:A(e.linkTabDescriptor.style.maxwidth),modelValue:h.fieldType,"onUpdate:modelValue":k=>h.fieldType=k,options:e.fieldMetadataTypes,optionLabel:"value",optionValue:"value",onChange:t[0]||(t[0]=k=>e.saveFieldsMetadata("fieldType"))},null,8,["style","modelValue","onUpdate:modelValue","options"])]),_:1},8,["header"]),a(p,{field:"personal",header:e.$t("managers.datasetManagement.personal"),sortable:!0},{body:l(({data:h})=>[a(d,{id:"personal",modelValue:h.personal,"onUpdate:modelValue":k=>h.personal=k,binary:!0,onChange:t[1]||(t[1]=k=>e.saveFieldsMetadata("personal"))},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),a(p,{field:"decrypt",header:e.$t("managers.datasetManagement.decrypt"),sortable:!0},{body:l(({data:h})=>[a(d,{id:"decrypt",modelValue:h.decrypt,"onUpdate:modelValue":k=>h.decrypt=k,binary:!0,onChange:t[2]||(t[2]=k=>e.saveFieldsMetadata("decrypt"))},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),a(p,{field:"subjectId",header:e.$t("managers.datasetManagement.subjectId"),sortable:!0},{body:l(({data:h})=>[a(d,{id:"subjectId",modelValue:h.subjectId,"onUpdate:modelValue":k=>h.subjectId=k,binary:!0,onChange:t[3]||(t[3]=k=>e.saveFieldsMetadata("subjectId"))},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"])]),_:1},8,["value"])):D("",!0),!e.dataset.meta||e.dataset.meta.length==0?(v(),V("div",Li,[a(i,{severity:"info",closable:!1},{default:l(()=>[$(u(e.$t("managers.datasetManagement.metadataInfo")),1)]),_:1})])):D("",!0)]),_:1})],64)}var zi=E(Oi,[["render",ji]]);const Hi=S({components:{TabView:je,TabPanel:ze,DetailCard:Dt,AdvancedCard:Di,LinkCard:Ui,TypeCard:Hs,MetadataCard:zi,WorkspaceDataPreviewDialog:We},props:{id:{type:String,required:!1},scopeTypes:{type:Array,required:!0},categoryTypes:{type:Array,required:!0},datasetTypes:{type:Array,required:!0},transformationDataset:{type:Object,required:!0},scriptTypes:{type:Array,required:!0},dataSources:{type:Array,required:!0},businessModels:{type:Array,required:!0},pythonEnvironments:{type:Array,required:!0},rEnvironments:{type:Array,required:!0},metaSourceResource:{type:Array,required:!0},availableTags:{type:Array,required:!0},datasetToCloneId:{type:Number}},computed:{...He(j,{user:"user"}),buttonDisabled(){return this.v$.$invalid}},emits:["close","touched","loadingOlderVersion","olderVersionLoaded","updated","created","showSavingSpinner","hideSavingSpinner"],data(){return{detailViewDescriptor:G,v$:P(),tablesToAdd:[],tablesToRemove:[],selectedDataset:{},previewDataset:{},selectedDatasetVersions:[],filteredDatasetTypes:[],scheduling:{repeatInterval:null},touched:!1,loading:!1,loadingVersion:!1,showPreviewDialog:!1,showMetadataQueryInfo:!1,activeTab:0}},setup(){return{store:j()}},created(){this.getAllDatasetData()},watch:{id(){this.getAllDatasetData(),this.activeTab=0},datasetToCloneId(){this.cloneDatasetConfirm(this.datasetToCloneId)}},validations(){},methods:{async getSelectedDataset(){await this.$http.get(`/knowage/restful-services/1.0/datasets/dataset/id/${this.id}`).then(e=>{if(this.selectedDataset=e.data[0]?{...e.data[0]}:{},this.selectedDataset.restJsonPathAttributes&&(this.selectedDataset.restJsonPathAttributes=JSON.parse(this.selectedDataset.restJsonPathAttributes?this.selectedDataset.restJsonPathAttributes:"[]")),this.selectedDataset.restRequestHeaders&&(this.selectedDataset.restRequestHeaders=JSON.parse(this.selectedDataset.restRequestHeaders?this.selectedDataset.restRequestHeaders:"{}")),this.selectedDataset.restRequestHeaders){const t=Object.keys(this.selectedDataset.restRequestHeaders);this.selectedDataset.restRequestHeaders=t.map(r=>({name:r,value:this.selectedDataset.restRequestHeaders[r]}))}this.selectedDataset.pythonEnvironment&&(this.selectedDataset.pythonEnvironment=JSON.parse(this.selectedDataset.pythonEnvironment?this.selectedDataset.pythonEnvironment:"{}"))}).catch()},async getSelectedDatasetVersions(){await this.$http.get(`/knowage/restful-services/1.0/datasets/olderversions/${this.id}`).then(e=>{e.data.root?this.selectedDatasetVersions=e.data.root:this.selectedDatasetVersions=[]}).catch().finally(()=>this.loading=!1)},async getAllDatasetData(){this.id?(this.loading=!0,await this.getSelectedDataset(),await this.getSelectedDatasetVersions(),this.insertCurrentVersion(),this.filteredDatasetTypes=this.datasetTypes):(this.selectedDataset={...G.newDataset},this.selectedDatasetVersions=[],this.filteredDatasetTypes=this.datasetTypes.filter(e=>e.VALUE_CD!="Prepared"))},insertCurrentVersion(){if(this.selectedDatasetVersions.length===0){const e=this.datasetTypes.find(t=>t.VALUE_CD===this.selectedDataset.dsTypeCd);this.selectedDatasetVersions.push({type:e.VALUE_DS,userIn:this.selectedDataset.owner,versNum:0,dateIn:this.selectedDataset.dateIn,dsId:this.selectedDataset.id})}},cloneDatasetConfirm(e){this.$confirm.require({icon:"pi pi-exclamation-triangle",message:this.$t("kpi.kpiDefinition.confirmClone"),header:this.$t(" "),accept:()=>this.cloneDataset(e)})},async cloneDataset(e){await this.$http.get(`/knowage/restful-services/1.0/datasets/dataset/id/${e}`).then(async t=>{t.data[0].dsTypeCd==="File"&&await this.$http.put(`/knowage/restful-services/1.0/datasets/clone-file?fileName=${t.data[0].fileName}`),delete t.data[0].id,t.data[0].label="...",t.data[0].dsVersions=[],t.data[0].usedByNDocs=0,this.selectedDataset={...t.data[0]}})},async saveDataset(){var t,r;let e={...this.selectedDataset};((r=(t=this.user)==null?void 0:t.functionalities)==null?void 0:r.includes("DataPreparation"))&&e.id?await this.$http.get("/knowage-data-preparation/api/1.0/instance/dataset/"+e.id,{headers:{"X-Disable-Interceptor":"true"}}).then(n=>{n.data?this.$confirm.require({icon:"pi pi-exclamation-triangle",message:this.$t("managers.datasetManagement.dataPreparation.datasetInvolvedIntoDataPrep"),header:this.$t("managers.datasetManagement.saveTitle"),accept:()=>this.proceedOnSaving(e)}):this.proceedOnSaving(e)}).catch(n=>{n.response.status===404?this.proceedOnSaving(e):this.$store.commit("setError",{title:"Server error",msg:n.data.errors[0].message})}):this.proceedOnSaving(e)},async proceedOnSaving(e){this.$emit("showSavingSpinner"),(e.dsTypeCd.toLowerCase()=="rest"||e.dsTypeCd.toLowerCase()=="solr")&&(e.restRequestHeaders=(e.restRequestHeaders||[]).reduce((t,r)=>(t[r.name]=r.value,t),{})),e.pars||(e.pars=[]),e.pythonEnvironment&&(e.pythonEnvironment=JSON.stringify(e.pythonEnvironment)),e.meta?e.meta=await this.manageDatasetFieldMetadata(e.meta):e.meta=[],e.recalculateMetadata=!0,e.isScheduled&&(e.schedulingCronLine=await this.formatCronForSave()),await this.$http.post("/knowage/restful-services/1.0/datasets/",e,{headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json;charset=UTF-8"}}).then(async t=>{this.touched=!1,this.store.setInfo({title:this.$t("common.toast.createTitle"),msg:this.$t("common.toast.success")}),this.selectedDataset.id?this.$emit("updated"):this.$emit("created",t),await this.saveTags(e,t.data.id),await this.saveSchedulation(e,t.data.id),await this.saveLinks(t.data.id),await this.removeLinks(t.data.id),await this.getSelectedDataset()}).catch().finally(()=>this.$emit("hideSavingSpinner"))},async saveTags(e,t){let r={};r.versNum=e.versNum+1,r.tagsToAdd=e.tags,await this.$http.post(`/knowage/restful-services/2.0/datasets/${t}/dstags/`,r,{headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json;charset=UTF-8"}}).catch()},async saveSchedulation(e,t){e.isScheduled?await this.$http.post(`/knowage/restful-services/scheduleree/persistence/dataset/id/${t}`,e,{headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json;charset=UTF-8"}}).catch():await this.$http.delete(`/knowage/restful-services/scheduleree/persistence/dataset/label/${e.label}`).catch()},async saveLinks(e){this.tablesToAdd.length>0&&this.tablesToAdd.forEach(async t=>{t.added===!0&&(delete t.added,await this.$http.post(`/knowage/restful-services/2.0/metaDsRelationResource/${e}`,t,{headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json;charset=UTF-8"}}).catch())})},async removeLinks(e){this.tablesToRemove.length>0&&this.tablesToRemove.forEach(async t=>{t.deleted===!0&&await this.$http.delete(`/knowage/restful-services/2.0/metaDsRelationResource/${e}/${t.tableId}`,{headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json;charset=UTF-8"}}).catch()})},async manageDatasetFieldMetadata(e){if(e.columns!=null&&e.columns!=null){for(var t=new Array,r=new Array,n=0;n<e.columns.length;n++){var m=e.columns[n];r.push(m.column)}for(r=this.removeDuplicates(r),n=0;n<r.length;n++){var y={displayedName:"",name:"",fieldType:"",type:"",personal:!1,decrypt:!1,subjectId:!1},i=r[n];if(i.indexOf(":")!=-1){var b=i.split(":");y.displayedName=b[1]}else y.displayedName=i;y.name=i;for(var p=0;p<e.columns.length;p++)m=e.columns[p],m.column==i&&(m.pname.toUpperCase()=="type".toUpperCase()?y.type=m.pvalue:m.pname.toUpperCase()=="fieldType".toUpperCase()?y.fieldType=m.pvalue:m.pname.toUpperCase()=="personal".toUpperCase()?y.personal=m.pvalue:m.pname.toUpperCase()=="decrypt".toUpperCase()?y.decrypt=m.pvalue:m.pname.toUpperCase()=="subjectId".toUpperCase()&&(y.subjectId=m.pvalue));t.push(y)}return t}},checkFormulaForParams(){var e,t,r;((t=(e=this.selectedDataset)==null?void 0:e.query)==null?void 0:t.includes("${"))&&((r=this.selectedDataset)==null?void 0:r.isPersisted)?this.store.setError({title:this.$t("common.toast.errorTitle"),msg:this.$t("managers.datasetManagement.formulaParamError")}):this.saveDataset()},removeDuplicates(e){for(var t={},r=e.length-1;r>=0;r--)e[r]in t?e.splice(r,1):t[e[r]]=!0;return e},async formatCronForSave(){if(this.selectedDataset.isScheduled){this.selectedDataset.startDate==null&&(this.selectedDataset.startDate=new Date);var e=this.scheduling.repeatInterval,t="",r=0,n=this.stringifySchedulingValues(this.scheduling.minutesSelected&&this.scheduling.minutesSelected.length!=0,"minutesSelected"),m=this.stringifySchedulingValues(e!="minute"&&this.scheduling.hoursSelected&&this.scheduling.hoursSelected.length!=0,"hoursSelected"),y=this.stringifySchedulingValues((e==="day"||e==="month")&&this.scheduling.daysSelected&&this.scheduling.daysSelected.length!=0,"daysSelected"),i=this.stringifySchedulingValues(e==="month"&&this.scheduling.monthsSelected&&this.scheduling.monthsSelected.length!=0,"monthsSelected"),b=this.stringifySchedulingValues(e==="week"&&this.scheduling.weekdaysSelected&&this.scheduling.weekdaysSelected.length!=0,"weekdaysSelected");return y=="*"&&b!="*"?y="?":b="?",t=n+" "+m+" "+y+" "+i+" "+b,r+" "+t}},stringifySchedulingValues(e,t){var r="";if(e){for(var n=0;n<this.scheduling[t].length;n++)r+=""+this.scheduling[t][n],n<this.scheduling[t].length-1&&(r+=",");return r}else return r="*",r},async sendDatasetForPreview(){if(this.selectedDataset.dsTypeCd==="Solr"){this.previewDataset=JSON.parse(JSON.stringify(this.selectedDataset));let e={};if(this.previewDataset.dsTypeCd.toLowerCase()=="rest"||this.previewDataset.dsTypeCd.toLowerCase()=="solr")for(let t=0;t<this.previewDataset.restRequestHeaders.length;t++)e[this.previewDataset.restRequestHeaders[t].name]=this.previewDataset.restRequestHeaders[t].value;this.previewDataset.restRequestHeaders=JSON.stringify(e),this.previewDataset.restJsonPathAttributes&&this.previewDataset.restJsonPathAttributes.length>0?this.previewDataset.restJsonPathAttributes=JSON.stringify(this.previewDataset.restJsonPathAttributes):this.previewDataset.restJsonPathAttributes=[],this.previewDataset.pars||(this.previewDataset.pars=[]),this.previewDataset.pythonEnvironment&&(this.previewDataset.pythonEnvironment=JSON.stringify(this.previewDataset.pythonEnvironment)),this.previewDataset.meta?this.previewDataset.meta=await this.manageDatasetFieldMetadata(this.previewDataset.meta):this.previewDataset.meta=[],this.showPreviewDialog=!0}else this.previewDataset=this.selectedDataset,this.showPreviewDialog=!0},onAddLinkedTables(e){this.tablesToAdd=e,this.$emit("touched")},onRemoveLinkedTables(e){this.tablesToRemove=e,this.$emit("touched")},onOlderVersionLoaded(e){this.$emit("olderVersionLoaded"),this.selectedDataset={...e}}}}),Bi={class:"datasetDetail"};function Qi(e,t,r,n,m,y){const i=s("Button"),b=s("Toolbar"),p=s("DetailCard"),f=s("TabPanel"),d=s("TypeCard"),w=s("MetadataCard"),g=s("LinkCard"),h=s("AdvancedCard"),k=s("TabView"),M=s("WorkspaceDataPreviewDialog");return v(),V(N,null,[a(b,{class:"kn-toolbar kn-toolbar--primary p-m-0"},{start:l(()=>[$(u(e.selectedDataset.label),1)]),end:l(()=>[a(i,{label:e.$t("managers.lovsManagement.preview"),class:"p-button-text p-button-rounded p-button-plain",onClick:e.sendDatasetForPreview,disabled:e.buttonDisabled},null,8,["label","onClick","disabled"]),a(i,{icon:"pi pi-save",class:"p-button-text p-button-rounded p-button-plain",disabled:e.buttonDisabled,onClick:e.checkFormulaForParams},null,8,["disabled","onClick"]),a(i,{icon:"pi pi-times",class:"p-button-text p-button-rounded p-button-plain",onClick:t[0]||(t[0]=c=>e.$emit("close"))})]),_:1}),o("div",Bi,[a(k,{class:"tabview-custom kn-tab",activeIndex:e.activeTab,"onUpdate:activeIndex":t[8]||(t[8]=c=>e.activeTab=c),"data-test":"tab-view"},{default:l(()=>[a(f,null,{header:l(()=>[o("span",null,u(e.$t("managers.mondrianSchemasManagement.detail.title")),1)]),default:l(()=>[a(p,{scopeTypes:e.scopeTypes,categoryTypes:e.categoryTypes,selectedDataset:e.selectedDataset,selectedDatasetVersions:e.selectedDatasetVersions,availableTags:e.availableTags,loading:e.loading,onReloadVersions:e.getSelectedDatasetVersions,onLoadingOlderVersion:t[1]||(t[1]=c=>e.$emit("loadingOlderVersion")),onOlderVersionLoaded:e.onOlderVersionLoaded,onTouched:t[2]||(t[2]=c=>e.$emit("touched"))},null,8,["scopeTypes","categoryTypes","selectedDataset","selectedDatasetVersions","availableTags","loading","onReloadVersions","onOlderVersionLoaded"])]),_:1}),a(f,null,{header:l(()=>[o("span",null,u(e.$t("kpi.alert.type")),1)]),default:l(()=>[a(d,{activeTab:e.activeTab,selectedDataset:e.selectedDataset,datasetTypes:e.filteredDatasetTypes,dataSources:e.dataSources,businessModels:e.businessModels,scriptTypes:e.scriptTypes,parentValid:e.v$.$invalid,pythonEnvironments:e.pythonEnvironments,rEnvironments:e.rEnvironments,onFileUploaded:t[3]||(t[3]=c=>e.selectedDataset.fileUploaded=!0),onTouched:t[4]||(t[4]=c=>e.$emit("touched")),onQueryEdited:t[5]||(t[5]=c=>e.showMetadataQueryInfo=!0)},null,8,["activeTab","selectedDataset","datasetTypes","dataSources","businessModels","scriptTypes","parentValid","pythonEnvironments","rEnvironments"])]),_:1}),a(f,null,{header:l(()=>[o("span",null,u(e.$t("kpi.measureDefinition.metadata")),1)]),default:l(()=>[a(w,{selectedDataset:e.selectedDataset,showMetadataQueryInfoProp:e.showMetadataQueryInfo,onTouched:t[6]||(t[6]=c=>e.$emit("touched"))},null,8,["selectedDataset","showMetadataQueryInfoProp"])]),_:1}),e.selectedDataset.dsTypeCd=="Query"?(v(),C(f,{key:0},{header:l(()=>[o("span",null,u(e.$t("managers.glossary.glossaryUsage.link")),1)]),default:l(()=>[a(g,{selectedDataset:e.selectedDataset,metaSourceResource:e.metaSourceResource,activeTab:e.activeTab,onAddTables:e.onAddLinkedTables,onRemoveTables:e.onRemoveLinkedTables},null,8,["selectedDataset","metaSourceResource","activeTab","onAddTables","onRemoveTables"])]),_:1})):D("",!0),e.selectedDataset.dsTypeCd!="Prepared"?(v(),C(f,{key:1},{header:l(()=>[o("span",null,u(e.$t("cron.advanced")),1)]),default:l(()=>[a(h,{selectedDataset:e.selectedDataset,transformationDataset:e.transformationDataset,schedulingData:e.scheduling,onTouched:t[7]||(t[7]=c=>e.$emit("touched"))},null,8,["selectedDataset","transformationDataset","schedulingData"])]),_:1})):D("",!0)]),_:1},8,["activeIndex"]),a(M,{visible:e.showPreviewDialog,propDataset:e.previewDataset,onClose:t[9]||(t[9]=c=>e.showPreviewDialog=!1),previewType:"dataset",loadFromDatasetManagement:!0},null,8,["visible","propDataset"])])],64)}var bl=E(Hi,[["render",Qi],["__scopeId","data-v-98ac2fd6"]]);export{bl as default};
//# sourceMappingURL=DatasetManagementDetailView-89e28df7.js.map
