import{m as V}from"./WorkspaceDescriptor-d4693b02.js";import{D as O,W as R}from"./WorkspaceCard-6d9360d0.js";import{d as x,i as L,_ as D,r as n,o as i,h as s,w as a,f as r,g as k,t as p,a as M,n as N,l as U,q as j,s as X,ae as Q,y as _,c as f,A as v,D as w,B as y,C as $,z as q}from"./index-1e676509.js";import{s as J}from"./contextmenu.esm-4301c9fe.js";import{W as Y}from"./WorkspaceDocumentTree-9d70941c.js";import{W as K}from"./WorkspaceWarningDialog-b684933b.js";import{s as G}from"./breadcrumb.esm-bbffcb4d.js";import"./sidebar.esm-2131cfd1.js";import"./tree.esm-837306a6.js";const Z=[{field:"documentType",header:"importExport.gallery.column.type"},{field:"documentLabel",header:"importExport.catalogFunction.column.label"},{field:"documentName",header:"importExport.gallery.column.name"},{field:"documentDescription",header:"managers.businessModelManager.description"}];var H={columns:Z};const P={style:{width:"60vw"}};var ee={dialog:P};const oe=x({name:"workspace-repository-move-dialog",components:{Dialog:L,WorkspaceDocumentTree:Y},props:{visible:{type:Boolean},propFolders:{type:Array}},emits:["close","move"],data(){return{workspaceRepositoryMoveDialogDescriptor:ee,folders:[],selectedFolder:null}},watch:{propFolders(){this.loadFolders()}},created(){this.loadFolders()},methods:{loadFolders(){this.folders=this.propFolders},closeDialog(){this.selectedFolder=null,this.$emit("close")},moveDocument(){this.$emit("move",this.selectedFolder)},setSelectedFolder(e){this.selectedFolder=e}}}),te={class:"p-d-flex p-flex-row p-jc-end"};function re(e,o,d,m,u,C){const l=n("Toolbar"),g=n("WorkspaceDocumentTree"),b=n("Button"),h=n("Dialog");return i(),s(h,{class:"p-fluid kn-dialog--toolbar--primary",contentStyle:e.workspaceRepositoryMoveDialogDescriptor.dialog.style,visible:e.visible,modal:!0,closable:!1},{header:a(()=>[r(l,{class:"kn-toolbar kn-toolbar--primary p-p-0 p-m-0 p-col-12"},{start:a(()=>[k(p(e.$t("workspace.myRepository.destinationFolder")),1)]),_:1})]),footer:a(()=>[M("div",te,[r(b,{class:"kn-button kn-button--primary",onClick:e.closeDialog},{default:a(()=>[k(p(e.$t("common.cancel")),1)]),_:1},8,["onClick"]),r(b,{class:"kn-button kn-button--primary",onClick:e.moveDocument},{default:a(()=>[k(p(e.$t("common.move")),1)]),_:1},8,["onClick"])])]),default:a(()=>[r(g,{propFolders:e.folders,mode:"move",onFolderSelected:e.setSelectedFolder},null,8,["propFolders","onFolderSelected"])]),_:1},8,["contentStyle","visible"])}var ne=D(oe,[["render",re]]);const ae=x({name:"workspace-repository-breadcrumb",components:{Breadcrumb:G},props:{breadcrumbs:{type:Array}},emits:["breadcrumbClicked"],data(){return{home:{icon:"pi pi-home"},items:[]}},watch:{breadcrumbs(){this.loadBreadcrumbs()}},created(){this.loadBreadcrumbs()},methods:{loadBreadcrumbs(){this.items=this.breadcrumbs},selectBreadcrumb(e){const o=this.items.findIndex(d=>d.label===e.target.textContent);o!==-1&&(this.$emit("breadcrumbClicked",this.items[o]),this.items.splice(o+1))}}});function ie(e,o,d,m,u,C){const l=n("Breadcrumb");return i(),s(l,{class:"workspace-breadcrumbs",home:e.home,model:e.items},{item:a(({item:g})=>[M("span",{class:"workspace-breadcrumbs-item",onClick:o[0]||(o[0]=(...b)=>e.selectBreadcrumb&&e.selectBreadcrumb(...b))},p(g.label),1)]),_:1},8,["home","model"])}var le=D(ae,[["render",ie]]);const se=x({components:{DataTable:N,Column:U,DetailSidebar:O,WorkspaceCard:R,Menu:J,Message:j,WorkspaceRepositoryMoveDialog:ne,WorkspaceWarningDialog:K,WorkspaceRepositoryBreadcrumb:le},emits:["showMenu","reloadRepositoryMenu","toggleDisplayView","breadcrumbClicked","execute"],props:{selectedFolder:{type:Object},id:{type:String,required:!1},toggleCardDisplay:{type:Boolean},breadcrumbs:{type:Array},allFolders:{type:Array}},data(){return{mainDescriptor:V,loading:!1,showDetailSidebar:!1,documents:[],filteredDocuments:[],menuButtons:[],selectedDocument:{},columns:H.columns,searchWord:"",folders:[],moveDialogVisible:!1,warningDialogVisbile:!1,warningMessage:""}},watch:{id(){this.getFolderDocuments()},allFolders(){this.loadFolders()}},setup(){return{store:X()}},created(){this.loadFolders(),this.getFolderDocuments()},methods:{loadFolders(){this.folders=this.allFolders},getFolderDocuments(){return this.loading=!0,this.$http.get(`/knowage/restful-services/2.0/organizer/documents/${this.id}`).then(e=>{this.documents=[...e.data],this.filteredDocuments=[...this.documents]}).finally(()=>this.loading=!1)},formatDate(e){return Q(e,{dateStyle:"short",timeStyle:"short"})},showSidebar(e){this.selectedDocument=e,this.showDetailSidebar=!0},showMenu(e,o){this.selectedDocument=o,this.createMenuItems(),this.$refs.optionsMenu.toggle(e)},createMenuItems(){this.menuButtons=[],this.menuButtons.push({key:"3",label:this.$t("workspace.myRepository.moveDocument"),icon:"fas fa-share",command:()=>{this.moveDocumentToFolder(this.selectedDocument)}},{key:"4",label:this.$t("workspace.myAnalysis.menuItems.delete"),icon:"fas fa-trash",command:()=>{this.deleteDocumentConfirm(this.selectedDocument)}})},toggleDisplayView(){this.$emit("toggleDisplayView")},executeDocumentFromOrganizer(e){this.$emit("execute",e)},moveDocumentToFolder(e){this.selectedDocument=e,this.moveDialogVisible=!0},async handleDocumentMove(e){this.loading=!0,await this.$http.put(`/knowage/restful-services/2.0/organizer/documentsee/${this.selectedDocument.biObjId}/${this.selectedDocument.functId}/${e.id}`).then(()=>{this.store.setInfo({title:this.$t("common.toast.updateTitle"),msg:this.$t("common.toast.success")}),this.moveDialogVisible=!1,this.showDetailSidebar=!1,this.getFolderDocuments()}).catch(o=>{this.warningMessage=o,this.warningDialogVisbile=!0}),this.loading=!1},deleteDocumentConfirm(e){this.$confirm.require({message:this.$t("common.toast.deleteMessage"),header:this.$t("common.toast.deleteTitle"),icon:"pi pi-exclamation-triangle",accept:()=>this.deleteDocument(e)})},deleteDocument(e){this.loading=!0,this.$http.delete(`/knowage/restful-services/2.0/organizer/documents/${e.functId}/${e.biObjId}`).then(()=>{this.store.setInfo({title:this.$t("common.toast.deleteTitle"),msg:this.$t("common.toast.success")}),this.showDetailSidebar=!1,this.getFolderDocuments()}).catch(()=>{}),this.loading=!1},closeWarningDialog(){this.warningMessage="",this.warningDialogVisbile=!1},searchItems(){setTimeout(()=>{this.searchWord.trim().length?this.filteredDocuments=this.documents.filter(e=>{var o,d,m,u;return((o=e.documentType)==null?void 0:o.toLowerCase().includes(this.searchWord.toLowerCase()))||((d=e.documentLabel)==null?void 0:d.toLowerCase().includes(this.searchWord.toLowerCase()))||((m=e.documentName)==null?void 0:m.toLowerCase().includes(this.searchWord.toLowerCase()))||((u=e.documentDescription)==null?void 0:u.toLowerCase().includes(this.searchWord.toLowerCase()))}):this.filteredDocuments=[...this.documents]},250)}}}),de={class:"p-m-2 kn-overflow"},ce={key:1,class:"p-grid p-m-2","data-test":"card-container"};function pe(e,o,d,m,u,C){const l=n("Button"),g=n("Toolbar"),b=n("WorkspaceRepositoryBreadcrumb"),h=n("InputText"),A=n("Column"),F=n("DataTable"),z=n("Message"),E=n("WorkspaceCard"),W=n("DetailSidebar"),B=n("WorkspaceRepositoryMoveDialog"),S=n("WorkspaceWarningDialog"),T=n("Menu"),I=_("tooltip");return i(),f(y,null,[r(g,{class:"kn-toolbar kn-toolbar--secondary"},{start:a(()=>[r(l,{id:"showSidenavIcon",icon:"fas fa-bars",class:"p-button-text p-button-rounded p-button-plain",onClick:o[0]||(o[0]=t=>e.$emit("showMenu"))}),k(" "+p(e.$t("workspace.menuLabels.myRepository")),1)]),end:a(()=>[e.toggleCardDisplay?(i(),s(l,{key:0,icon:"fas fa-list",class:"p-button-text p-button-rounded p-button-plain",onClick:e.toggleDisplayView},null,8,["onClick"])):v("",!0),e.toggleCardDisplay?v("",!0):(i(),s(l,{key:1,icon:"fas fa-th-large",class:"p-button-text p-button-rounded p-button-plain",onClick:e.toggleDisplayView},null,8,["onClick"]))]),_:1}),r(b,{breadcrumbs:e.breadcrumbs,onBreadcrumbClicked:o[1]||(o[1]=t=>e.$emit("breadcrumbClicked",t))},null,8,["breadcrumbs"]),r(h,{class:"kn-material-input p-m-2",style:w(e.mainDescriptor.style.filterInput),modelValue:e.searchWord,"onUpdate:modelValue":o[2]||(o[2]=t=>e.searchWord=t),type:"text",placeholder:e.$t("common.search"),onInput:e.searchItems,"data-test":"search-input"},null,8,["style","modelValue","placeholder","onInput"]),M("div",de,[e.toggleCardDisplay?v("",!0):(i(),s(F,{key:0,class:"p-datatable-sm kn-table p-mx-2",value:e.filteredDocuments,loading:e.loading,dataKey:"biObjId",responsiveLayout:"stack",breakpoint:"600px","data-test":"documents-table"},{empty:a(()=>[k(p(e.$t("common.info.noDataFound")),1)]),filter:a(({filterModel:t})=>[r(h,{type:"text",modelValue:t.value,"onUpdate:modelValue":c=>t.value=c,class:"p-column-filter"},null,8,["modelValue","onUpdate:modelValue"])]),default:a(()=>[(i(!0),f(y,null,$(e.columns,t=>(i(),s(A,{field:t.field,header:e.$t(t.header),key:t.field,sortable:!0},null,8,["field","header"]))),128)),r(A,{class:"icon-cell",style:w(e.mainDescriptor.style.iconColumn)},{body:a(t=>[r(l,{icon:"fas fa-ellipsis-v",class:"p-button-link",onClick:c=>e.showMenu(c,t.data)},null,8,["onClick"]),q(r(l,{icon:"fas fa-info-circle",class:"p-button-link",onClick:c=>e.showSidebar(t.data),"data-test":"info-button-"+t.data.documentName},null,8,["onClick","data-test"]),[[I,e.$t("workspace.myModels.showInfo"),void 0,{left:!0}]]),r(l,{icon:"fas fa-play-circle",class:"p-button-link",onClick:c=>e.executeDocumentFromOrganizer(t.data)},null,8,["onClick"])]),_:1},8,["style"])]),_:1},8,["value","loading"])),e.toggleCardDisplay?(i(),f("div",ce,[e.filteredDocuments.length===0?(i(),s(z,{key:0,class:"kn-flex p-m-2",severity:"info",closable:!1,style:w(e.mainDescriptor.style.message)},{default:a(()=>[k(p(e.$t("common.info.noDataFound")),1)]),_:1},8,["style"])):(i(!0),f(y,{key:1},$(e.filteredDocuments,(t,c)=>(i(),s(E,{key:c,viewType:"repository",document:t,onExecuteDocumentFromOrganizer:e.executeDocumentFromOrganizer,onMoveDocumentToFolder:e.moveDocumentToFolder,onDeleteDocumentFromOrganizer:e.deleteDocumentConfirm,onOpenSidebar:e.showSidebar},null,8,["document","onExecuteDocumentFromOrganizer","onMoveDocumentToFolder","onDeleteDocumentFromOrganizer","onOpenSidebar"]))),128))])):v("",!0)]),r(W,{visible:e.showDetailSidebar,viewType:"repository",document:e.selectedDocument,onExecuteDocumentFromOrganizer:e.executeDocumentFromOrganizer,onMoveDocumentToFolder:e.moveDocumentToFolder,onDeleteDocumentFromOrganizer:e.deleteDocumentConfirm,onClose:o[3]||(o[3]=t=>e.showDetailSidebar=!1),"data-test":"detail-sidebar"},null,8,["visible","document","onExecuteDocumentFromOrganizer","onMoveDocumentToFolder","onDeleteDocumentFromOrganizer"]),r(B,{visible:e.moveDialogVisible,propFolders:e.folders,onClose:o[4]||(o[4]=t=>e.moveDialogVisible=!1),onMove:e.handleDocumentMove},null,8,["visible","propFolders","onMove"]),r(S,{visible:e.warningDialogVisbile,warningMessage:e.warningMessage,onClose:e.closeWarningDialog},null,8,["visible","warningMessage","onClose"]),r(T,{id:"optionsMenu",ref:"optionsMenu",model:e.menuButtons},null,8,["model"])],64)}var ye=D(se,[["render",pe]]);export{ye as default};
//# sourceMappingURL=WorkspaceRepositoryView-c6302039.js.map
