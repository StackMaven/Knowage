{"version":3,"file":"MeasureDefinition-f15f0984.js","sources":["../../../../modules/kpi/measureDefinition/MeasureDefinition.vue"],"sourcesContent":["<template>\r\n    <div class=\"kn-page\">\r\n        <Toolbar class=\"kn-toolbar kn-toolbar--primary\">\r\n            <template #start>\r\n                {{ $t('kpi.measureDefinition.title') }}\r\n            </template>\r\n            <template #end>\r\n                <KnFabButton icon=\"fas fa-plus\" @click=\"showForm(null, false)\" data-test=\"new-button\" />\r\n            </template>\r\n        </Toolbar>\r\n        <div class=\"kn-page-content\">\r\n            <ProgressBar mode=\"indeterminate\" class=\"kn-progress-bar\" v-if=\"loading\" data-test=\"progress-bar\" />\r\n            <KnHint v-if=\"measuresList.length === 0 && !loading\" :title=\"'kpi.measureDefinition.title'\" :hint=\"'kpi.measureDefinition.hint'\" data-test=\"measure-hint\"></KnHint>\r\n            <DataTable\r\n                v-else\r\n                :value=\"measuresList\"\r\n                rowGroupMode=\"rowspan\"\r\n                groupRowsBy=\"rule\"\r\n                :paginator=\"true\"\r\n                :rows=\"15\"\r\n                :loading=\"loading\"\r\n                class=\"p-datatable-sm kn-table\"\r\n                dataKey=\"id\"\r\n                v-model:filters=\"filters\"\r\n                :globalFilterFields=\"measureDefinitionDescriptor.globalFilterFields\"\r\n                responsiveLayout=\"stack\"\r\n                breakpoint=\"960px\"\r\n                @rowClick=\"showForm($event.data, false)\"\r\n                data-test=\"measures-table\"\r\n            >\r\n                <template #loading>\r\n                    {{ $t('common.info.dataLoading') }}\r\n                </template>\r\n                <template #header>\r\n                    <div class=\"table-header p-d-flex\">\r\n                        <span class=\"p-input-icon-left p-mr-3\">\r\n                            <i class=\"pi pi-search\" />\r\n                            <InputText class=\"kn-material-input\" v-model=\"filters['global'].value\" type=\"text\" :placeholder=\"$t('common.search')\" data-test=\"filterInput\" />\r\n                        </span>\r\n                    </div>\r\n                </template>\r\n                <Column class=\"kn-truncated\" :style=\"col.style\" v-for=\"col of measureDefinitionDescriptor.columns\" :field=\"col.field\" :header=\"$t(col.header)\" :key=\"col.field\" :sortable=\"true\"> </Column>\r\n                <Column :style=\"measureDefinitionDescriptor.table.iconColumn.style\">\r\n                    <template #body=\"slotProps\">\r\n                        <Button icon=\"pi pi-copy\" class=\"p-button-link\" @click=\"cloneKpiConfirm(slotProps.data)\" data-test=\"clone-button\" />\r\n                        <Button icon=\"pi pi-trash\" class=\"p-button-link\" @click=\"deleteMeasureConfirm(slotProps.data)\" :data-test=\"'delete-button-' + slotProps.data.id\" />\r\n                    </template>\r\n                </Column>\r\n            </DataTable>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { defineComponent } from 'vue'\r\nimport { iMeasure } from './MeasureDefinition'\r\nimport { filterDefault } from '@/helpers/commons/filterHelper'\r\nimport { AxiosResponse } from 'axios'\r\nimport Column from 'primevue/column'\r\nimport DataTable from 'primevue/datatable'\r\nimport KnFabButton from '@/components/UI/KnFabButton.vue'\r\nimport KnHint from '@/components/UI/KnHint.vue'\r\nimport measureDefinitionDescriptor from './MeasureDefinitionDescriptor.json'\r\nimport mainStore from '../../../App.store'\r\n\r\nexport default defineComponent({\r\n    name: 'measure-definition',\r\n    components: {\r\n        Column,\r\n        DataTable,\r\n        KnFabButton,\r\n        KnHint\r\n    },\r\n    data() {\r\n        return {\r\n            measureDefinitionDescriptor,\r\n            measuresList: [] as iMeasure[],\r\n            filters: { global: [filterDefault] } as Object,\r\n            loading: false\r\n        }\r\n    },\r\n    setup() {\r\n        const store = mainStore()\r\n        return { store }\r\n    },\r\n    async created() {\r\n        await this.loadPage()\r\n    },\r\n    methods: {\r\n        async loadPage() {\r\n            this.loading = true\r\n            await this.loadMeasures()\r\n            this.loading = false\r\n        },\r\n        async loadMeasures() {\r\n            this.measuresList = []\r\n            await this.$http.get(import.meta.env.VITE_RESTFUL_SERVICES_PATH + '1.0/kpi/listMeasure').then((response: AxiosResponse<any>) =>\r\n                response.data.forEach((measure) => {\r\n                    if (measure.category) {\r\n                        measure.categoryName = measure.translatedValueName\r\n                    }\r\n                    this.measuresList.push(measure)\r\n                })\r\n            )\r\n        },\r\n        showForm(measure: iMeasure, clone: Boolean) {\r\n            const path = measure ? `/measure-definition/edit?id=${measure.ruleId}&ruleVersion=${measure.ruleVersion}&clone=${clone}` : '/measure-definition/new-measure-definition'\r\n            this.$router.push(path)\r\n        },\r\n        cloneKpiConfirm(measure: iMeasure) {\r\n            this.$confirm.require({\r\n                header: this.$t('common.toast.cloneConfirmTitle'),\r\n                accept: () => this.showForm(measure, true)\r\n            })\r\n        },\r\n        deleteMeasureConfirm(measure: iMeasure) {\r\n            this.$confirm.require({\r\n                message: this.$t('common.toast.deleteMessage'),\r\n                header: this.$t('common.toast.deleteTitle'),\r\n                icon: 'pi pi-exclamation-triangle',\r\n                accept: () => this.deleteMeasure(measure)\r\n            })\r\n        },\r\n        async deleteMeasure(measure: iMeasure) {\r\n            await this.$http\r\n                .delete(import.meta.env.VITE_RESTFUL_SERVICES_PATH + `1.0/kpi/${measure.ruleId}/${measure.ruleVersion}/deleteRule`)\r\n                .then(() => {\r\n                    this.store.setInfo({\r\n                        title: this.$t('common.toast.deleteTitle'),\r\n                        msg: this.$t('common.toast.deleteSuccess')\r\n                    })\r\n                    this.loadPage()\r\n                })\r\n                .catch(() => {})\r\n        }\r\n    }\r\n})\r\n</script>\r\n"],"names":["Column","DataTable","mainStore","_openBlock","_createVNode","_withCtx","_createElementVNode","_createBlock","_createCommentVNode","_createElementBlock","_Fragment","_renderList","_normalizeStyle"],"mappings":"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"}