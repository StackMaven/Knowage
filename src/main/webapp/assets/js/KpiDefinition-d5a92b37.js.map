{"version":3,"file":"KpiDefinition-d5a92b37.js","sources":["../../../../modules/kpi/kpiDefinition/KpiDefinition.vue"],"sourcesContent":["<template>\r\n    <div class=\"kn-page\">\r\n        <div class=\"kn-page-content p-grid p-m-0\">\r\n            <div class=\"kn-list--column p-col-4 p-sm-4 p-md-3 p-p-0\">\r\n                <Toolbar class=\"kn-toolbar kn-toolbar--primary\">\r\n                    <template #start>\r\n                        {{ $t('kpi.kpiDefinition.title') }}\r\n                    </template>\r\n                    <template #end>\r\n                        <FabButton icon=\"fas fa-plus\" @click=\"showForm\" data-test=\"open-form-button\" />\r\n                    </template>\r\n                </Toolbar>\r\n                <ProgressBar mode=\"indeterminate\" class=\"kn-progress-bar\" v-if=\"loading\" data-test=\"progress-bar\" />\r\n                <Listbox v-if=\"!loading\" class=\"kn-list--column\" :options=\"kpiList\" :filter=\"true\" :filterPlaceholder=\"$t('common.search')\" optionLabel=\"name\" filterMatchMode=\"contains\" :filterFields=\"name\" :emptyFilterMessage=\"$t('common.info.noDataFound')\" @change=\"showForm\" data-test=\"kpi-list\">\r\n                    <template #empty>{{ $t('common.info.noDataFound') }}</template>\r\n                    <template #option=\"slotProps\">\r\n                        <div class=\"kn-list-item\" data-test=\"list-item\">\r\n                            <div class=\"kn-list-item-text\">\r\n                                <span>{{ slotProps.option.name }}</span>\r\n                                <span class=\"kn-list-item-text-secondary\" v-if=\"slotProps.option.category\">{{ slotProps.option.category.valueDescription }}</span>\r\n                            </div>\r\n                            <Button icon=\"far fa-copy\" class=\"p-button-text p-button-rounded p-button-plain\" @click.stop=\"emitCopyKpi(slotProps.option.id, slotProps.option.version)\" data-test=\"copy-button\" />\r\n                            <Button icon=\"far fa-trash-alt\" class=\"p-button-text p-button-rounded p-button-plain\" @click.stop=\"deleteKpiConfirm(slotProps.option.id, slotProps.option.version)\" data-test=\"delete-button\" />\r\n                        </div>\r\n                    </template>\r\n                </Listbox>\r\n            </div>\r\n\r\n            <div class=\"kn-list--column p-col-8 p-sm-8 p-md-9 p-p-0 p-m-0\">\r\n                <router-view :cloneKpiId=\"cloneKpiId\" :cloneKpiVersion=\"cloneKpiVersion\" @touched=\"touched = true\" @closed=\"onFormClose\" @kpiUpdated=\"reloadAndReroute\" @kpiCreated=\"reloadAndReroute\" @showDialog=\"displayInfoDialog\" @onGuideClose=\"showGuide = false\" />\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { defineComponent } from 'vue'\r\nimport { AxiosResponse } from 'axios'\r\nimport FabButton from '@/components/UI/KnFabButton.vue'\r\nimport Listbox from 'primevue/listbox'\r\nimport { formatDateWithLocale } from '@/helpers/commons/localeHelper'\r\nimport mainStore from '../../../App.store'\r\n\r\nexport default defineComponent({\r\n    name: 'tenant-management',\r\n    components: {\r\n        FabButton,\r\n        Listbox\r\n    },\r\n    data() {\r\n        return {\r\n            loading: false,\r\n            touched: false,\r\n            displayModal: false,\r\n            hintVisible: true,\r\n            cloneKpi: false,\r\n            kpiList: [] as any,\r\n            kpiToClone: {} as any,\r\n            cloneKpiId: Number,\r\n            cloneKpiVersion: Number\r\n        }\r\n    },\r\n    setup() {\r\n        const store = mainStore()\r\n        return { store }\r\n    },\r\n    async created() {\r\n        await this.getKpiList()\r\n    },\r\n    methods: {\r\n        async getKpiList() {\r\n            this.loading = true\r\n            return this.$http\r\n                .get(import.meta.env.VITE_RESTFUL_SERVICES_PATH + `1.0/kpi/listKpi`)\r\n                .then((response: AxiosResponse<any>) => {\r\n                    this.kpiList = [...response.data]\r\n                })\r\n                .finally(() => (this.loading = false))\r\n        },\r\n\r\n        deleteKpiConfirm(kpiId: number, kpiVersion: number) {\r\n            this.$confirm.require({\r\n                message: this.$t('common.toast.deleteMessage'),\r\n                header: this.$t('common.toast.deleteTitle'),\r\n                icon: 'pi pi-exclamation-triangle',\r\n                accept: () => this.deleteKpi(kpiId, kpiVersion)\r\n            })\r\n        },\r\n        async deleteKpi(kpiId: number, kpiVersion: number) {\r\n            await this.$http.delete(import.meta.env.VITE_RESTFUL_SERVICES_PATH + `1.0/kpi/${kpiId}/${kpiVersion}/deleteKpi`).then(() => {\r\n                this.store.setInfo({\r\n                    title: this.$t('common.toast.deleteTitle'),\r\n                    msg: this.$t('common.toast.deleteSuccess')\r\n                })\r\n                this.$router.push('/kpi-definition')\r\n                this.getKpiList()\r\n            })\r\n        },\r\n        showForm(event: any) {\r\n            const path = event.value ? `/kpi-definition/${event.value.id}/${event.value.version}` : '/kpi-definition/new-kpi'\r\n            this.hintVisible = false\r\n            if (!this.touched) {\r\n                this.$router.push(path)\r\n            } else {\r\n                this.$confirm.require({\r\n                    message: this.$t('common.toast.unsavedChangesMessage'),\r\n                    header: this.$t('common.toast.unsavedChangesHeader'),\r\n                    icon: 'pi pi-exclamation-triangle',\r\n                    accept: () => {\r\n                        this.touched = false\r\n                        this.$router.push(path)\r\n                    }\r\n                })\r\n            }\r\n        },\r\n        pageReload() {\r\n            this.touched = false\r\n            this.hintVisible = true\r\n        },\r\n        onFormClose() {\r\n            this.touched = false\r\n            this.hintVisible = true\r\n        },\r\n        formatDate(date) {\r\n            return formatDateWithLocale(date, { dateStyle: 'short', timeStyle: 'short' })\r\n        },\r\n        async reloadAndReroute(event) {\r\n            await this.getKpiList()\r\n\r\n            let kpiToLoad = this.kpiList.find((kpi) => {\r\n                if (kpi.name === event) return true\r\n            })\r\n            let path = ''\r\n            if (kpiToLoad) {\r\n                path = `/kpi-definition/${kpiToLoad.id}/${kpiToLoad.version}`\r\n            }\r\n            this.$router.push(path)\r\n\r\n            this.touched = false\r\n            this.hintVisible = false\r\n        },\r\n        emitCopyKpi(kpiId, kpiVersion) {\r\n            this.$router.push('/kpi-definition/new-kpi')\r\n            this.hintVisible = false\r\n            setTimeout(() => {\r\n                this.cloneKpiId = kpiId\r\n                this.cloneKpiVersion = kpiVersion\r\n            }, 200)\r\n        }\r\n    }\r\n})\r\n</script>\r\n"],"names":["FabButton","Listbox","mainStore","_openBlock","_createElementBlock","_createElementVNode","_createVNode","_withCtx","_createBlock","_createCommentVNode","_toDisplayString"],"mappings":"0JA2CA,KAAK,GAAa,EAAa,CAC3B,KAAM,oBACN,WAAY,CAAA,UACRA,EAAA,QACAC,CACJ,EACA,MAAO,CACI,MAAA,CACH,QAAS,GACT,QAAS,GACT,aAAc,GACd,YAAa,GACb,SAAU,GACV,QAAS,CAAC,EACV,WAAY,CAAC,EACb,WAAY,OACZ,gBAAiB,MAAA,CAEzB,EACA,OAAQ,CAEJ,MAAO,CAAA,MADOC,GACC,CACnB,EACA,KAAM,UAAU,CACZ,KAAM,MAAK,YACf,EACA,QAAS,CACL,KAAM,aAAa,CACf,YAAK,QAAU,GACR,KAAK,MACP,IAAI,2CAA8D,EAClE,KAAK,AAAC,GAAiC,CACpC,KAAK,QAAU,CAAC,GAAG,EAAS,IAAI,CACnC,CAAA,EACA,QAAQ,IAAO,KAAK,QAAU,EAAM,CAC7C,EAEA,iBAAiB,EAAe,EAAoB,CAChD,KAAK,SAAS,QAAQ,CAClB,QAAS,KAAK,GAAG,4BAA4B,EAC7C,OAAQ,KAAK,GAAG,0BAA0B,EAC1C,KAAM,6BACN,OAAQ,IAAM,KAAK,UAAU,EAAO,CAAU,CAAA,CACjD,CACL,EACA,KAAM,WAAU,EAAe,EAAoB,CACzC,KAAA,MAAK,MAAM,OAAO,qCAAwD,KAAS,aAAsB,EAAE,KAAK,IAAM,CACxH,KAAK,MAAM,QAAQ,CACf,MAAO,KAAK,GAAG,0BAA0B,EACzC,IAAK,KAAK,GAAG,4BAA4B,CAAA,CAC5C,EACI,KAAA,QAAQ,KAAK,iBAAiB,EACnC,KAAK,WAAW,CAAA,CACnB,CACL,EACA,SAAS,EAAY,CACX,KAAA,GAAO,EAAM,MAAQ,mBAAmB,EAAM,MAAM,MAAM,EAAM,MAAM,UAAY,0BACxF,KAAK,YAAc,GACf,AAAC,KAAK,QAGN,KAAK,SAAS,QAAQ,CAClB,QAAS,KAAK,GAAG,oCAAoC,EACrD,OAAQ,KAAK,GAAG,mCAAmC,EACnD,KAAM,6BACN,OAAQ,IAAM,CACV,KAAK,QAAU,GACV,KAAA,QAAQ,KAAK,CAAI,CAC1B,CAAA,CACH,EAVI,KAAA,QAAQ,KAAK,CAAI,CAY9B,EACA,YAAa,CACT,KAAK,QAAU,GACf,KAAK,YAAc,EACvB,EACA,aAAc,CACV,KAAK,QAAU,GACf,KAAK,YAAc,EACvB,EACA,WAAW,EAAM,CACb,MAAO,GAAqB,EAAM,CAAE,UAAW,QAAS,UAAW,QAAS,CAChF,EACA,KAAM,kBAAiB,EAAO,CAC1B,KAAM,MAAK,aAEX,GAAI,GAAY,KAAK,QAAQ,KAAK,AAAC,GAAQ,CACvC,GAAI,EAAI,OAAS,EAAc,MAAA,EAAA,CAClC,EACG,EAAO,GACX,AAAI,GACO,GAAA,mBAAmB,EAAU,MAAM,EAAU,WAEnD,KAAA,QAAQ,KAAK,CAAI,EAEtB,KAAK,QAAU,GACf,KAAK,YAAc,EACvB,EACA,YAAY,EAAO,EAAY,CACtB,KAAA,QAAQ,KAAK,yBAAyB,EAC3C,KAAK,YAAc,GACnB,WAAW,IAAM,CACb,KAAK,WAAa,EAClB,KAAK,gBAAkB,GACxB,GAAG,CACV,CACJ,CACJ,CAAC,KApJY,MAAM,cACF,MAAM,wFAaM,EAAM,CAAe,MAAA,eAAA,YAAA,8CAGZ,IAAK,EAAA,MAAA,oOAjBnCC,GA6BM,EAAAC,EAAA,MAAA,EAAA,CAAAC,EA5BF,MAuBM,EAAA,CAAAA,EAfQ,MAPD,EAAA,CAAAC,EACW,EACuB,CAAA,MAAA,gCAAA,EAAA,CAAA,MAAAC,EAAA,IAAA,wCAE5B,CAAA,EAAA,IACPA,EAA+E,IAAA,CAAAD,EAA/D,EAAa,CAAE,KAAA,cAAiB,QAAU,EAAA,SAAA,YAAA,6CAGF,CAAA,EAAA,EAAA,QAAAH,KAAAK,EAAA,EAAA,CAAnD,IAAI,EAAiB,KAAK,gBAAkC,MAAA,kBAAA,YAAA,kBACzDC,EAAO,GAAA,EAAA,EAAA,AAAA,EAAA,iBAAAN,GAAA,EAAAK,EAAA,EAAA,CAAE,IAAK,EAAoB,MAAO,kBAAY,QAAQ,EAAI,QAAG,OAAA,GAAwC,kBAAkB,EAAA,GAAA,eAAA,EAAC,YAAA,OAA4B,gBAAc,WAAO,aAAkB,EAAA,KAAkC,mBAAQ,EAAQ,GAAA,yBAAA,EAAE,SAAU,EAAA,SAAA,YAAA,UACjQ,EAAA,CAAA,MAAAD,EAAA,IAAA,wCACA,CAAA,EACP,OAAAA,EAAA,AAAA,GAAA,CAAAF,EACI,MAGM,EAAA,CAAAA,EAFF,MAAwC,EAAA,CAAAA,EACyB,OAAQ,KAAAK,EAAA,EAAA,OAAA,IAAA,EAAA,CAAA,EAAA,EAAA,OAAA,SAAAP,GAAA,EAAAC,EAAA,OAAA,EAAAM,EAAA,EAAA,OAAA,SAAA,gBAAA,EAAA,CAAA,GAAAD,EAAA,GAAA,EAAA,CAE7E,CAAA,EAAAH,EAAa,EAAa,CAAC,KAAK,cAAkD,MAAK,gDAAmE,UAAU,AAAa,GAAA,EAAA,YAAA,EAAA,OAAA,GAAA,EAAA,OAAA,OAAA,EAAA,CAAA,MAAA,CAAA,EAAA,YAAA,aACe,EAAA,KAAA,EAAA,CAAA,SAAA,CAAA,EAAAA,EAAnL,EAAkB,CAAC,KAAK,mBAAkD,MAAK,gDAAwE,UAAU,AAAe,GAAA,EAAA,iBAAA,EAAA,OAAA,GAAA,EAAA,OAAA,OAAA,EAAA,CAAA,MAAA,CAAA,EAAA,YAAA,gIAM7M,CAAA,EAC+PD,EAAA,MAAA,EAAA,CAAAC,EAAnO,EAAY,CAAG,WAAiB,EAAA,WAAkB,gBAAO,EAAA,gBAAmB,UAAQ,EAAW,IAAA,GAAA,GAAA,AAAA,GAAA,EAAA,QAAA,IAAG,SAAY,EAAA,YAAmB,aAAY,EAAA,iBAAmB,aAAY,EAAA,iBAAoB,aAAY,EAAA,kBAAA,eAAA,EAAA,IAAA,GAAA,GAAA,AAAA,GAAA,EAAA,UAAA"}