import{d as C,_ as N,r as d,o as k,h as v,w as u,g as x,t as h,a as t,z as T,Y as q,A as w,n as P,l as U,H as W,x as E,c as y,f as n,B as $,C as R,D as X,ad as Q,R as Y,y as J,K as G,G as I,i as z,V as Z,a5 as ee,s as V,X as ae}from"./index-1e676509.js";import{K as te}from"./KnHint-6d455703.js";import{s as B}from"./tree.esm-837306a6.js";import{K as oe,u as ne,c as re}from"./KnValidatonMessages-ebe48c72.js";import{f as A}from"./filterHelper-a723991a.js";const ie={id:"id",parentId:"parentId",dataField:"data",childrenField:"children",throwIfOrphans:!1,rootParentIds:{"":!0},nestedIds:!0};function le(e,a={}){const o={...ie,...a},i=[],b={},m=a.throwIfOrphans?new Set:null;for(const c of e){const p=o.nestedIds?F(c,o.id):c[o.id],r=o.nestedIds?F(c,o.parentId):c[o.parentId];if(o.rootParentIds[p])throw new Error(`The item array contains a node whose parentId both exists in another node and is in \`rootParentIds\` (\`itemId\`: "${p}", \`rootParentIds\`: ${Object.keys(o.rootParentIds).map(l=>`"${l}"`).join(", ")}).`);Object.prototype.hasOwnProperty.call(b,p)||(b[p]={[o.childrenField]:[]}),m&&m.delete(p),o.dataField?b[p][o.dataField]=c:b[p]={...c,[o.childrenField]:b[p][o.childrenField]},o.style&&(b[p].style=o.style);const f=b[p];r==null||o.rootParentIds[r]?i.push(f):(Object.prototype.hasOwnProperty.call(b,r)||(b[r]={[o.childrenField]:[]},m&&m.add(r)),b[r][o.childrenField].push(f))}if(m!=null&&m.size)throw new Error(`The items array contains orphans that point to the following parentIds: [${Array.from(m)}]. These parentIds do not exist in the items array. Hint: prevent orphans to result in an error by passing the following option: { throwIfOrphans: false }`);return i}function F(e,a){return a.split(".").reduce((o,i)=>o[i],e)}var de={"node-style":{padding:0}};const se=C({name:"menu-nodes-tree",components:{Tree:B},emits:["selectedMenuNode","unselectedMenuNode","deleteMenuNode","changeWithFather","moveUp","moveDown"],props:{elements:Array,loading:Boolean},watch:{elements:{handler:function(e){e=e.map(a=>(a.label=a.name,a.id=a.menuId,a.key=a.menuId,a)),this.menuElements=[{label:this.$t("common.home"),name:this.$t("common.home"),menuId:null,children:le(e,{dataField:null,style:this.menuNodesTreeDescriptor["node-style"]})}],this.expandAll()}},loading:{handler:function(e){this.load=e}}},data(){return{load:!1,menuElements:[],expandedKeys:[],selectedMenuNode:null,buttonsVisible:[],menuNodesTreeDescriptor:de}},methods:{expandAll(){for(let e of this.menuElements)this.expandNode(e);this.expandedKeys={...this.expandedKeys}},expandNode(e){if(e.children&&e.children.length){this.expandedKeys[e.key]=!0;for(let a of e.children)this.expandNode(a)}},canBeMovedUp(e){return e.prog!==1&&e.menuId},canBeMovedDown(e){if(e.menuId===null)return!1;let a=null;return e.parentId?a=this.findNode(e.parentId,this.menuElements):a=this.menuElements[0],a&&a.children&&a.children.length!==e.prog},findNode(e,a){for(let o of a){if(o.menuId===e)return o;const i=this.findNode(e,o.children);if(i)return i}return null},canBeDeleted(e){var a;return!(((a=e.children)==null?void 0:a.length)>0)},deleteMenuNode(e){this.$emit("deleteMenuNode",e)},changeWithFather(e){this.$emit("changeWithFather",e)},moveUp(e){this.$emit("moveUp",e)},moveDown(e){this.$emit("moveDown",e)},onElementSelect(e){this.$emit("selectedMenuNode",e.value)},onNodeSelect(e){this.$emit("selectedMenuNode",e)},onNodeUnselect(e){this.$emit("unselectedMenuNode",e)}}}),ce=["onMouseover","onMouseleave","data-test"],pe={class:"p-ml-2"};function be(e,a,o,i,b,m){const c=d("Button"),p=d("Tree");return k(),v(p,{loading:e.load,filter:!0,filterMode:"lenient",value:e.menuElements,expandedKeys:e.expandedKeys,selectionMode:"single",selectionKeys:e.selectedMenuNode,"onUpdate:selectionKeys":a[0]||(a[0]=r=>e.selectedMenuNode=r),metaKeySelection:!1,onNodeSelect:e.onNodeSelect,onNodeUnselect:e.onNodeUnselect,"data-test":"menu-nodes-tree",class:"kn-tree kn-flex toolbar-height",scrollHeight:"flex"},{empty:u(()=>[x(h(e.$t("common.info.noDataFound")),1)]),default:u(r=>[t("div",{class:"p-d-flex p-flex-row p-ai-center",onMouseover:f=>e.buttonsVisible[r.node.id]=!0,onMouseleave:f=>e.buttonsVisible[r.node.id]=!1,"data-test":"menu-nodes-tree-item-"+r.node.menuId},[t("span",null,h(r.node.name),1),T(t("div",pe,[r.node.parentId!=null?(k(),v(c,{key:0,icon:"pi pi-sort-alt",class:"p-button-link p-button-sm p-p-0",onClick:f=>e.changeWithFather(r.node.menuId),"data-test":"change-with-father-button-"+r.node.menuId},null,8,["onClick","data-test"])):w("",!0),e.canBeMovedUp(r.node)?(k(),v(c,{key:1,icon:"pi pi-arrow-up",class:"p-button-link p-button-sm p-p-0",onClick:f=>e.moveUp(r.node.menuId),"data-test":"move-up-button-"+r.node.menuId},null,8,["onClick","data-test"])):w("",!0),e.canBeMovedDown(r.node)?(k(),v(c,{key:2,icon:"pi pi-arrow-down",class:"p-button-link p-button-sm p-p-0",onClick:f=>e.moveDown(r.node.menuId),"data-test":"move-down-button-"+r.node.menuId},null,8,["onClick","data-test"])):w("",!0),e.canBeDeleted(r.node)?(k(),v(c,{key:3,icon:"far fa-trash-alt",class:"p-button-link p-button-sm p-p-0",onClick:f=>e.deleteMenuNode(r.node.menuId),"data-test":"delete-button-"+r.node.menuId},null,8,["onClick","data-test"])):w("",!0)],512),[[q,e.buttonsVisible[r.node.id]]])],40,ce)]),_:1},8,["loading","value","expandedKeys","selectionKeys","onNodeSelect","onNodeUnselect"])}var ue=N(se,[["render",be]]);const me=[{field:"DOCUMENT_NAME",header:"Name"},{field:"DOCUMENT_DESCR",header:"Description"}],ke={headers:{"Content-Type":"application/json"}},he=["DOCUMENT_NAME","DOCUMENT_DESCR"],fe={column:{style:{width:"18%","word-break":"break-all"}},iconColumn:{style:{"text-align":"end",width:"5%"}}},ge={style:{width:"60vw"}};var ve={columns:me,headers:ke,globalFilterFields:he,table:fe,form:ge};const we=C({name:"related-documents-list",components:{DataTable:P,Column:U,ProgressBar:W},emits:["selectedDocument"],props:{documents:Object,loading:Boolean},watch:{loading:{handler:function(e){this.load=e}}},data(){return{apiUrl:"/knowage/restful-services/2.0/",load:!1,relatedDocumentsList:[],filters:{global:[A],DOCUMENT_NAME:{operator:E.AND,constraints:[A]},DOCUMENT_DESCR:{operator:E.AND,constraints:[A]}},selectedDocument:null,menuConfigurationRelatedDocumentsDescriptor:ve}},async created(){await this.loadRelatedDocuments()},methods:{async loadRelatedDocuments(){this.load=!0,await this.$http.get(this.apiUrl+"documents/listDocument").then(e=>{this.relatedDocumentsList=e.data.item}).finally(()=>this.load=!1)},onDocumentSelect(e){this.$emit("selectedDocument",e.data)}}}),ye={class:"table-header"},xe={class:"p-input-icon-left"},Me=t("i",{class:"pi pi-search"},null,-1),Ne=["title"];function Ce(e,a,o,i,b,m){const c=d("ProgressBar"),p=d("InputText"),r=d("Column"),f=d("DataTable");return k(),y($,null,[n(c,{mode:"indeterminate",class:"kn-progress-bar",hidden:!e.load,"data-test":"related-docs-progress-bar"},null,8,["hidden"]),n(f,{value:e.relatedDocumentsList,selection:e.selectedProduct1,"onUpdate:selection":a[1]||(a[1]=l=>e.selectedProduct1=l),selectionMode:"single",onRowSelect:e.onDocumentSelect,paginator:!0,loading:e.load,rows:20,class:"p-datatable-sm kn-table",dataKey:"id",filters:e.filters,"onUpdate:filters":a[2]||(a[2]=l=>e.filters=l),filterDisplay:"menu",globalFilterFields:e.menuConfigurationRelatedDocumentsDescriptor.globalFilterFields,rowsPerPageOptions:[10,15,20],responsiveLayout:"stack",breakpoint:"960px",currentPageReportTemplate:e.$t("common.table.footer.paginated",{first:"{first}",last:"{last}",totalRecords:"{totalRecords}"}),"data-test":"related-documents-list"},{header:u(()=>[t("div",ye,[t("span",xe,[Me,n(p,{class:"kn-material-input",type:"text",modelValue:e.filters.global.value,"onUpdate:modelValue":a[0]||(a[0]=l=>e.filters.global.value=l),placeholder:e.$t("common.search"),badge:"0","data-test":"search-input"},null,8,["modelValue","placeholder"])])])]),empty:u(()=>[x(h(e.$t("common.info.noDataFound")),1)]),loading:u(()=>[x(h(e.$t("common.info.dataLoading")),1)]),default:u(()=>[(k(!0),y($,null,R(e.menuConfigurationRelatedDocumentsDescriptor.columns,l=>(k(),v(r,{field:l.field,header:e.$t(l.header),key:l.field,style:X(e.menuConfigurationRelatedDocumentsDescriptor.table.column.style),sortable:!0,class:"kn-truncated"},{filter:u(({filterModel:g})=>[n(p,{type:"text",modelValue:g.value,"onUpdate:modelValue":M=>g.value=M,class:"p-column-filter"},null,8,["modelValue","onUpdate:modelValue"])]),body:u(g=>[t("span",{title:g.data[l.field]},h(g.data[l.field]),9,Ne)]),_:2},1032,["field","header","style"]))),128))]),_:1},8,["value","selection","onRowSelect","loading","filters","globalFilterFields","currentPageReportTemplate"])],64)}var $e=N(we,[["render",Ce]]);const Ie=C({name:"roles-tab",components:{Card:Q,Column:U,DataTable:P},props:{rolesList:{type:Array},selected:Array,parentNodeRoles:{type:Array}},emits:["changed"],data(){return{selectedRoles:[],filters:{global:[A]}}},created(){this.selected&&(this.selectedRoles=this.selected)},watch:{selected:{handler:function(e){this.selectedRoles=e}}},methods:{onRowSelect(){this.$emit("changed",this.selectedRoles)},onRowUnselect(){this.$emit("changed",this.selectedRoles)},onAllRowSelectionChange(){setTimeout(()=>this.$emit("changed",this.selectedRoles),0)}},computed:{rolesListFiltered(){return this.rolesList?this.parentNodeRoles?this.rolesList.filter(e=>this.parentNodeRoles&&this.parentNodeRoles.findIndex(a=>a.id===e.id)>=0):this.rolesList:[]}}}),Ae={class:"table-header"},De={class:"p-input-icon-left"},Se=t("i",{class:"pi pi-search"},null,-1);function Ee(e,a,o,i,b,m){const c=d("Toolbar"),p=d("InputText"),r=d("Column"),f=d("DataTable"),l=d("Card");return k(),v(l,{class:"p-mx-auto"},{header:u(()=>[n(c,{class:"kn-toolbar kn-toolbar--secondary"},{start:u(()=>[x(h(e.$t("managers.menuManagement.roles")),1)]),_:1})]),content:u(()=>[n(f,{value:e.rolesListFiltered,filters:e.filters,"onUpdate:filters":a[1]||(a[1]=g=>e.filters=g),selection:e.selectedRoles,"onUpdate:selection":a[2]||(a[2]=g=>e.selectedRoles=g),class:"p-datatable-sm kn-table",dataKey:"id",responsiveLayout:"stack",breakpoint:"960px",onRowSelect:e.onRowSelect,onRowUnselect:e.onRowUnselect,onRowSelectAll:e.onAllRowSelectionChange,onRowUnselectAll:e.onAllRowSelectionChange},{empty:u(()=>[x(h(e.$t("common.info.noDataFound")),1)]),header:u(()=>[t("div",Ae,[t("span",De,[Se,n(p,{class:"kn-material-input",type:"text",modelValue:e.filters.global.value,"onUpdate:modelValue":a[0]||(a[0]=g=>e.filters.global.value=g),placeholder:e.$t("common.search"),badge:"0","data-test":"search-input"},null,8,["modelValue","placeholder"])])])]),default:u(()=>[n(r,{selectionMode:"multiple",dataKey:"id",style:{width:"50px"}}),n(r,{field:"name",header:e.$t("common.name")},null,8,["header"])]),_:1},8,["value","filters","selection","onRowSelect","onRowUnselect","onRowSelectAll","onRowUnselectAll"])]),_:1})}var Fe=N(Ie,[["render",Ee]]),L={name:"ToggleButton",emits:["update:modelValue","change","click","focus","blur"],props:{modelValue:Boolean,onIcon:String,offIcon:String,onLabel:{type:String,default:"Yes"},offLabel:{type:String,default:"No"},iconPos:{type:String,default:"left"},disabled:{type:Boolean,default:!1},tabindex:{type:Number,default:null},inputId:{type:String,default:null},inputClass:{type:String,default:null},inputStyle:{type:null,default:null},inputProps:{type:null,default:null},"aria-labelledby":{type:String,default:null},"aria-label":{type:String,default:null}},methods:{onClick(e){this.disabled||(this.$emit("update:modelValue",!this.modelValue),this.$emit("change",e),this.$emit("click",e))},onFocus(e){this.$emit("focus",e)},onBlur(e){this.$emit("blur",e)}},computed:{buttonClass(){return{"p-button p-togglebutton p-component":!0,"p-button-icon-only":this.hasIcon&&!this.hasLabel,"p-disabled":this.disabled,"p-highlight":this.modelValue===!0}},iconClass(){return[this.modelValue?this.onIcon:this.offIcon,"p-button-icon",{"p-button-icon-left":this.iconPos==="left"&&this.label,"p-button-icon-right":this.iconPos==="right"&&this.label}]},hasLabel(){return this.onLabel&&this.onLabel.length>0&&this.offLabel&&this.offLabel.length>0},hasIcon(){return this.onIcon&&this.onIcon.length>0&&this.offIcon&&this.offIcon.length>0},label(){return this.hasLabel?this.modelValue?this.onLabel:this.offLabel:"&nbsp;"}},directives:{ripple:Y}};const Te={class:"p-hidden-accessible"},Pe=["id","checked","value","aria-labelledby","aria-label"],Ue={class:"p-button-label"};function Re(e,a,o,i,b,m){const c=J("ripple");return T((k(),y("div",{class:I(m.buttonClass),onClick:a[2]||(a[2]=p=>m.onClick(p))},[t("span",Te,[t("input",G({id:o.inputId,type:"checkbox",role:"switch",class:o.inputClass,style:o.inputStyle,checked:o.modelValue,value:o.modelValue,"aria-labelledby":e.ariaLabelledby,"aria-label":e.ariaLabel,onFocus:a[0]||(a[0]=p=>m.onFocus(p)),onBlur:a[1]||(a[1]=p=>m.onBlur(p))},o.inputProps),null,16,Pe)]),m.hasIcon?(k(),y("span",{key:0,class:I(m.iconClass)},null,2)):w("",!0),t("span",Ue,h(m.label),1)],2)),[[c]])}L.render=Re;const ze=C({name:"document-browser-tree",components:{Tree:B,ToggleButton:L},emits:["selectedDocumentNode"],props:{selected:null,loading:Boolean},watch:{selected:{handler:function(e){this.checkValueIsPath(e)&&this.preselectNodeKey(this.flatTree,e)}},loading:{handler:function(e){this.load=e}}},data(){return{apiUrl:"/knowage/restful-services/2.0/",load:!1,preselectedNodeKey:null,nodes:[],expandedKeys:{},flatTree:[]}},async created(){await this.loadFunctionalities(),this.checkValueIsPath(this.selected)&&this.preselectNodeKey(this.flatTree,this.selected)},methods:{flattenTree(e,a){let o=[Object.assign({},e)];return delete o[0][a],e[a]&&e[a].length>0?o.concat(e[a].map(i=>this.flattenTree(i,a)).reduce((i,b)=>i.concat(b),[])):o},checkValueIsPath(e){if(e&&this.nodes[0]){var a=e.indexOf("/");return a!=-1}},preselectNodeKey(e,a){for(let o of e)if(o.path==a){let i={};i[o.key]=!0,this.preselectedNodeKey=i}},toggleExpandCollapse(){Object.keys(this.expandedKeys).length===0?this.expandAll():this.collapseAll()},expandAll(){if(!!this.nodes){for(let e of this.nodes)this.expandNode(e);this.expandedKeys={...this.expandedKeys}}},collapseAll(){this.expandedKeys={}},expandNode(e){if(e.children&&e.children.length){this.expandedKeys[e.key]=!0;for(let a of e.children)this.expandNode(a)}},onNodeSelect(e){this.$emit("selectedDocumentNode",e.path)},async loadFunctionalities(){this.load=!0,await this.$http.get(this.apiUrl+"menu/functionalities").then(e=>{var a,o;this.nodes=e.data?(a=e.data.functionality)==null?void 0:a.map(i=>this.createNodes(i)):[],this.flatTree=(o=this.nodes)==null?void 0:o.map(i=>this.flattenTree(i,"children")).reduce((i,b)=>i.concat(b),[])}).finally(()=>{this.load=!1,this.expandAll()})},createNodes(e){const a={};return a.label=e.name,a.name=e.name,a.key=e.id,a.icon="pi pi-fw pi-folder",a.path=e.path,a.children=e.childs?e.childs.map(o=>this.createNodes(o)):[],a}}}),Ve={style:{"margin-bottom":"1em"}},Be={class:"kn-list-item"},Le=["data-test"];function je(e,a,o,i,b,m){const c=d("ToggleButton"),p=d("Tree");return k(),y($,null,[t("div",Ve,[n(c,{onLabel:e.$t("common.expand"),offLabel:e.$t("common.collapse"),onIcon:"pi pi-plus",offIcon:"pi pi-minus",style:{width:"10em"},onClick:e.toggleExpandCollapse},null,8,["onLabel","offLabel","onClick"])]),n(p,{value:e.nodes,expandedKeys:e.expandedKeys,selectionMode:"single",selectionKeys:e.preselectedNodeKey,"onUpdate:selectionKeys":a[0]||(a[0]=r=>e.preselectedNodeKey=r),metaKeySelection:!1,onNodeSelect:e.onNodeSelect,"data-test":e.document-e.browser-e.tree},{empty:u(()=>[x(h(e.$t("common.info.noDataFound")),1)]),default:u(r=>[t("div",Be,[t("div",{class:"kn-list-item-text","data-test":"document-browser-tree-item-"+r.node.id},[t("span",null,h(r.node.name),1)],8,Le)])]),_:1},8,["value","expandedKeys","selectionKeys","onNodeSelect","data-test"])],64)}var Ke=N(ze,[["render",je]]);const He={name:"image-to-base64-icon",emits:["selectedImageBase64","wrongInput"],data(){return{image:"",remoteUrl:""}},methods:{handleImage(e){const a=e.target.files[0];if(this.isFileImage(a)){const o=a;this.createBase64Image(o)}else this.$toast.add({severity:"error",summary:this.$t("common.error.incompatibleType"),detail:this.$t("common.error.allowedFileTypes")+" .ico, .svg, .png",life:5e3}),this.$emit("wrongInput",!0)},createBase64Image(e){const a=new FileReader;a.onload=o=>{this.image=o.target.result,this.sendImageToParent()},a.readAsDataURL(e)},sendImageToParent(){const{image:e}=this;this.$emit("wrongInput",!1),this.$emit("selectedImageBase64",e)},isFileImage(e){return e&&["image/svg","image/ico","image/png"].includes(e.type)}}},_e=["src"],Oe=["src"];function qe(e,a,o,i,b,m){return k(),y("div",null,[t("img",{style:{},src:b.image,alt:""},null,8,_e),t("input",{onChange:a[0]||(a[0]=(...c)=>m.handleImage&&m.handleImage(...c)),type:"file"},null,32),t("img",{src:b.remoteUrl,alt:""},null,8,Oe)])}var We=N(He,[["render",qe]]);const D=[{id:1,name:"ad",value:"f641"},{id:2,name:"adjust",value:"f042"},{id:3,name:"air-freshener",value:"f5d0"},{id:4,name:"align-center",value:"f037"},{id:5,name:"align-justify",value:"f039"},{id:6,name:"align-left",value:"f036"},{id:7,name:"align-right",value:"f038"},{id:8,name:"allergies",value:"f461"},{id:9,name:"ambulance",value:"f0f9"},{id:10,name:"anchor",value:"f13d"},{id:11,name:"angle-double-down",value:"f103"},{id:12,name:"angle-double-left",value:"f100"},{id:13,name:"angle-double-right",value:"f101"},{id:14,name:"angle-double-up",value:"f102"},{id:15,name:"angle-down",value:"f107"},{id:16,name:"angle-left",value:"f104"},{id:17,name:"angle-right",value:"f105"},{id:18,name:"angle-up",value:"f106"},{id:19,name:"angry",value:"f556"},{id:20,name:"ankh",value:"f644"},{id:21,name:"apple-alt",value:"f5d1"},{id:22,name:"archway",value:"f557"},{id:23,name:"arrow-circle-up",value:"f0aa"},{id:24,name:"arrow-down",value:"f063"},{id:25,name:"arrow-left",value:"f060"},{id:26,name:"arrow-right",value:"f061"},{id:27,name:"arrow-up",value:"f062"},{id:28,name:"arrows-alt",value:"f0b2"},{id:29,name:"arrows-alt-h",value:"f337"},{id:30,name:"arrows-alt-v",value:"f338"},{id:31,name:"asterisk",value:"f069"},{id:32,name:"at",value:"f1fa"},{id:33,name:"atlas",value:"f558"},{id:34,name:"atom",value:"f5d2"},{id:35,name:"audio-description",value:"f29e"},{id:36,name:"award",value:"f559"},{id:37,name:"backspace",value:"f55a"},{id:38,name:"backward",value:"f04a"},{id:39,name:"balance-scale",value:"f24e"},{id:40,name:"ban",value:"f05e"},{id:41,name:"band-aid",value:"f462"},{id:42,name:"barcode",value:"f02a"},{id:43,name:"bars",value:"f0c9"},{id:44,name:"baseball-ball",value:"f433"},{id:45,name:"basketball-ball",value:"f434"},{id:46,name:"bath",value:"f2cd"},{id:47,name:"battery-empty",value:"f244"},{id:48,name:"battery-full",value:"f240"},{id:49,name:"battery-half",value:"f242"},{id:50,name:"battery-quarter",value:"f243"},{id:51,name:"battery-three-quarters",value:"f241"},{id:52,name:"bed",value:"f236"},{id:53,name:"beer",value:"f0fc"},{id:54,name:"bell",value:"f0f3"},{id:55,name:"bell-slash",value:"f1f6"},{id:56,name:"bezier-curve",value:"f55b"},{id:57,name:"bible",value:"f647"},{id:58,name:"bicycle",value:"f206"},{id:59,name:"binoculars",value:"f1e5"},{id:60,name:"birthday-cake",value:"f1fd"},{id:61,name:"blender",value:"f517"},{id:62,name:"blind",value:"f29d"},{id:63,name:"bold",value:"f032"},{id:64,name:"bolt",value:"f0e7"},{id:65,name:"bomb",value:"f1e2"},{id:66,name:"bone",value:"f5d7"},{id:67,name:"bong",value:"f55c"},{id:68,name:"book",value:"f02d"},{id:69,name:"book-open",value:"f518"},{id:70,name:"book-reader",value:"f5da"},{id:71,name:"bookmark",value:"f02e"},{id:72,name:"bowling-ball",value:"f436"},{id:73,name:"box",value:"f466"},{id:74,name:"box-open",value:"f49e"},{id:75,name:"boxes",value:"f468"},{id:76,name:"braille",value:"f2a1"},{id:77,name:"brain",value:"f5dc"},{id:78,name:"briefcase",value:"f0b1"},{id:79,name:"briefcase-medical",value:"f469"},{id:80,name:"broadcast-tower",value:"f519"},{id:81,name:"broom",value:"f51a"},{id:82,name:"brush",value:"f55d"},{id:83,name:"bug",value:"f188"},{id:84,name:"building",value:"f1ad"},{id:85,name:"bullhorn",value:"f0a1"},{id:86,name:"bullseye",value:"f140"},{id:87,name:"burn",value:"f46a"},{id:88,name:"bus",value:"f207"},{id:89,name:"bus-alt",value:"f55e"},{id:90,name:"business-time",value:"f64a"},{id:91,name:"calculator",value:"f1ec"},{id:92,name:"calendar",value:"f133"},{id:95,name:"calendar-minus",value:"f272"},{id:96,name:"calendar-plus",value:"f271"},{id:97,name:"calendar-times",value:"f273"},{id:98,name:"camera",value:"f030"},{id:99,name:"camera-retro",value:"f083"},{id:100,name:"cannabis",value:"f55f"},{id:101,name:"capsules",value:"f46b"},{id:102,name:"car",value:"f1b9"},{id:103,name:"car-alt",value:"f5de"},{id:104,name:"car-battery",value:"f5df"},{id:105,name:"address-book",value:"f2b9"},{id:106,name:"address-card",value:"f2bb"},{id:107,name:"arrow-alt-circle-down",value:"f358"},{id:108,name:"arrow-alt-circle-left",value:"f359"},{id:109,name:"arrow-alt-circle-right",value:"f35a"},{id:110,name:"arrow-alt-circle-up",value:"f35b"},{id:116,name:"calendar-alt",value:"f073"},{id:117,name:"calendar-check",value:"f274"},{id:118,name:"calendar-minus",value:"f272"},{id:119,name:"calendar-plus",value:"f271"},{id:120,name:"calendar-times",value:"f273"},{id:121,name:"caret-square-down",value:"f150"},{id:122,name:"caret-square-left",value:"f191"},{id:123,name:"caret-square-right",value:"f152"},{id:124,name:"caret-square-up",value:"f151"},{id:125,name:"chart-bar",value:"f080"},{id:126,name:"check-circle",value:"f058"},{id:127,name:"check-square",value:"f14a"},{id:128,name:"circle",value:"f111"},{id:129,name:"clipboard",value:"f328"},{id:130,name:"clock",value:"f017"},{id:131,name:"clone",value:"f24d"},{id:132,name:"closed-captioning",value:"f20a"},{id:133,name:"comment",value:"f075"},{id:134,name:"comment-alt",value:"f27a"},{id:135,name:"comments",value:"f086"},{id:136,name:"compass",value:"f14e"},{id:137,name:"copy",value:"f0c5"},{id:138,name:"copyright",value:"f1f9"},{id:139,name:"credit-card",value:"f09d"},{id:140,name:"dot-circle",value:"f192"},{id:141,name:"edit",value:"f044"},{id:142,name:"envelope",value:"f0e0"},{id:143,name:"envelope-open",value:"f2b6"},{id:144,name:"eye-slash",value:"f070"},{id:145,name:"file",value:"f15b"},{id:146,name:"file-alt",value:"f15c"},{id:147,name:"file-archive",value:"f1c6"},{id:148,name:"file-audio",value:"f1c7"},{id:149,name:"file-code",value:"f1c9"},{id:150,name:"file-excel",value:"f1c3"},{id:151,name:"file-image",value:"f1c5"},{id:152,name:"file-pdf",value:"f1c1"},{id:153,name:"file-powerpoint",value:"f1c4"},{id:154,name:"file-video",value:"f1c8"},{id:155,name:"file-word",value:"f1c2"},{id:156,name:"flag",value:"f024"},{id:157,name:"folder",value:"f07b"},{id:158,name:"folder-open",value:"f07c"},{id:159,name:"frown",value:"f119"},{id:160,name:"futbol",value:"f1e3"},{id:161,name:"gem",value:"f3a5"},{id:162,name:"hand-lizard",value:"f258"},{id:163,name:"hand-paper",value:"f256"},{id:164,name:"hand-peace",value:"f25b"},{id:165,name:"hand-point-down",value:"f0a7"},{id:166,name:"hand-point-left",value:"f0a5"},{id:167,name:"hand-point-right",value:"f0a4"},{id:168,name:"hand-point-up",value:"f0a6"},{id:169,name:"hand-pointer",value:"f25a"},{id:170,name:"hand-rock",value:"f255"},{id:171,name:"hand-scissors",value:"f257"},{id:172,name:"hand-spock",value:"f259"},{id:173,name:"handshake",value:"f2b5"},{id:174,name:"hdd",value:"f0a0"},{id:175,name:"heart",value:"f004"},{id:176,name:"hospital",value:"f0f8"},{id:177,name:"hourglass",value:"f254"},{id:178,name:"id-badge",value:"f2c1"},{id:179,name:"id-card",value:"f2c2"},{id:180,name:"image",value:"f03e"},{id:181,name:"images",value:"f302"},{id:182,name:"keyboard",value:"f11c"},{id:183,name:"lemon",value:"f094"},{id:184,name:"life-ring",value:"f1cd"},{id:185,name:"lightbulb",value:"f0eb"},{id:186,name:"list-alt",value:"f022"},{id:187,name:"map",value:"f279"},{id:188,name:"meh",value:"f11a"},{id:189,name:"minus-square",value:"f146"},{id:190,name:"money-bill-alt",value:"f3d1"},{id:191,name:"moon",value:"f186"},{id:192,name:"newspaper",value:"f1ea"},{id:193,name:"object-group",value:"f247"},{id:194,name:"object-ungroup",value:"f248"},{id:195,name:"paper-plane",value:"f1d8"},{id:196,name:"pause-circle",value:"f28b"},{id:197,name:"play-circle",value:"f144"},{id:198,name:"plus-square",value:"f0fe"},{id:199,name:"question-circle",value:"f059"},{id:200,name:"registered",value:"f25d"},{id:201,name:"save",value:"f0c7"},{id:202,name:"share-square",value:"f14d"},{id:203,name:"smile",value:"f118"},{id:204,name:"snowflake",value:"f2dc"},{id:205,name:"square",value:"f0c8"},{id:206,name:"star",value:"f005"},{id:207,name:"star-half",value:"f089"},{id:208,name:"sticky-note",value:"f249"},{id:209,name:"stop-circle",value:"f28d"},{id:210,name:"sun",value:"f185"},{id:211,name:"thumbs-down",value:"f165"},{id:212,name:"thumbs-up",value:"f164"},{id:213,name:"times-circle",value:"f057"},{id:214,name:"trash-alt",value:"f2ed"},{id:215,name:"user",value:"f007"},{id:216,name:"user-circle",value:"f2bd"},{id:217,name:"window-close",value:"f410"},{id:218,name:"window-maximize",value:"f2d0"},{id:219,name:"window-minimize",value:"f2d1"},{id:220,name:"window-restore",value:"f2d2"}];const Xe=C({name:"IconPicker",emits:["chooseIcon","closeFontAwesomeModal"],components:{Dialog:z,KnImageToBase64IconPicker:We},props:["showModal"],watch:{showModal:{handler:function(e){this.modalShown=e}}},data(){return{modalShown:!1,disableChoosen:!1,selected:"",chosenIcon:{},icons:D}},methods:{getIcon(e){this.selected=e.name,this.chosenIcon=e,this.disableChoosen=!1},chooseIcon(){this.chosenIcon&&this.$emit("chooseIcon",this.chosenIcon)},closeModal(){this.$emit("closeFontAwesomeModal")},filterIcons(e){const a=e.target.value.trim();let o=[];a.length>3?o=D.filter(i=>{const b=new RegExp(a,"gi");return i.name.match(b)}):a.length===0&&(this.icons=D),o.length>0&&(this.icons=o)},toggleDisableChooseButton(e){this.disableChoosen=e},onBase64ImageSelection(e){this.choosenIcon=e,this.$emit("chooseIcon",e)}}}),Qe={id:"iconPicker"},Ye={class:"p-mt-2 p-field"},Je={class:"p-inputgroup"},Ge={class:"p-float-label"},Ze={for:"searchIcon"},ea={class:"p-mt-4"},aa={class:"iconPicker__icons"},ta=t("p",null,"fontawesome",-1),oa=["onClick"];function na(e,a,o,i,b,m){const c=d("KnImageToBase64IconPicker"),p=d("InputText"),r=d("Button"),f=d("Dialog");return k(),v(f,{header:e.$t("managers.menuManagement.chooseIcon"),visible:e.modalShown,"onUpdate:visible":a[1]||(a[1]=l=>e.modalShown=l),style:{width:"50vw"},modal:!0,closable:!1},{footer:u(()=>[n(r,{label:"Cancel",icon:"pi pi-times",onClick:e.closeModal,class:"p-button-text"},null,8,["onClick"]),n(r,{label:"Choose",icon:"pi pi-check",disabled:e.disableChoosen,onClick:e.chooseIcon,autofocus:""},null,8,["disabled","onClick"])]),default:u(()=>[n(c,{onSelectedImageBase64:e.onBase64ImageSelection,onWrongInput:e.toggleDisableChooseButton},null,8,["onSelectedImageBase64","onWrongInput"]),t("div",Qe,[t("div",Ye,[t("div",Je,[t("span",Ge,[n(p,{id:"searchIcon",type:"text",onKeyup:a[0]||(a[0]=l=>e.filterIcons(l)),class:"p-inputtext p-component kn-material-input"}),t("label",Ze,h(e.$t("common.search")),1)])])]),t("div",ea,[t("div",aa,[ta,(k(!0),y($,null,R(e.icons,l=>(k(),y("a",{href:"#",onClick:Z(g=>e.getIcon(l),["stop","prevent"]),class:I(`item ${e.selected===l.name?"selected":""}`),key:l.value},[t("i",{class:I("fas fa-"+l.name)},null,2)],10,oa))),128))])])])]),_:1},8,["header","visible"])}var ra=N(Xe,[["render",na]]);const ia=[{field:"name",header:"Name"},{field:"descr",header:"Description"}],la={style:{width:"60vw"}},da={headers:{"Content-Type":"application/json"}},sa=[{name:"Empty",value:0},{name:"A static page",value:3},{name:"A document",value:1},{name:"An external app.",value:2},{name:"A functionality",value:4}],ca=[{name:"Document Browser",value:"DocumentUserBrowser"},{name:"My Workspace",value:"WorkspaceManagement"}],pa={column:{style:{width:"40%"}},iconColumn:{style:{"text-align":"end"}}},ba=[{name:"Most Recent",value:"recent"},{name:"Documents",value:"documents"},{name:"Data sets",value:"datasets"},{name:"Models",value:"models"},{name:"Analysis",value:"analysis"},{name:"Schedulation",value:"schedulation"}];var S={columns:ia,form:la,headers:da,menuNodeContent:sa,menuNodeContentFunctionalies:ca,table:pa,workspaceOptions:ba};const ua={menuNode:[{fieldName:"name",validators:[{key:"required"},{key:"maximumCharacters",validator:{params:{max:100},type:"maxLength"}},{key:"regex",validator:{type:"extendedAlphanumericRegex"}}]},{fieldName:"descr",validators:[{key:"required"},{key:"maximumCharacters",validator:{params:{max:100},type:"maxLength"}},{key:"regex",validator:{type:"extendedAlphanumericRegex"}}]},{fieldName:"menuNodeContent",validators:[{key:"required"}]},{fieldName:"staticPage",validators:[]},{fieldName:"externalApplicationUrl",validators:[{key:"maximumCharacters",validator:{params:{max:1e3},type:"maxLength"}}]},{fieldName:"functionality",validators:[]},{fieldName:"objId",validators:[]},{fieldName:"document",validators:[{key:"maximumCharacters",validator:{params:{max:100},type:"maxLength"}}]},{fieldName:"objParameters",validators:[{key:"maximumCharacters",validator:{params:{max:1e3},type:"maxLength"}}]},{fieldName:"initialPath",validators:[]}]};var ma={validations:ua};const ka={fieldsList:["functionality","initialPath","externalApplicationUrl","staticPage","document","objId","objParameters"],filedsToSave:[{fields:[],menuNodeContent:0},{fields:["document","objId","objParameters"],menuNodeContent:1},{fields:["externalApplicationUrl"],menuNodeContent:2},{fields:["staticPage"],menuNodeContent:3},{fields:["functionality","initialPath"],menuNodeContent:4}]};var ha={importantfields:ka};const fa=C({name:"profile-attributes-detail",components:{Dropdown:ee,DocumentBrowserTree:Ke,RelatedDocumentList:$e,KnValidationMessages:oe,Dialog:z,FontAwesomePicker:ra,RolesCard:Fe},props:{roles:{type:Array},selectedMenuNode:{type:Object,required:!0},selectedRoles:{type:Array},staticPagesList:{type:Array},menuNodes:{type:Array},parentNodeRoles:{type:Array}},computed:{formValid(){return this.v$.$invalid}},watch:{selectedMenuNode:{handler:function(e){this.v$.$reset(),this.loadNode(e)}},selectedRoles:{handler:function(e){this.menuNode.roles=e}},menuNodes(){this.loadNodes()}},emits:["refreshRecordSet","closesForm","dataChanged"],data(){return{v$:ne(),apiUrl:"/knowage/restful-services/2.0/",menuNode:{},loading:!1,hideForm:!1,documentHidden:!0,staticPageHidden:!0,externalAppHidden:!0,functionalityHidden:!0,workspaceInitialHidden:!0,documentTreeHidden:!0,dirty:!1,displayModal:!1,chooseIconModalShown:!1,relatedDocuments:[],selectedRelatedDocument:null,selectedIcon:null,selectedFunctionality:{},menuNodeContent:S.menuNodeContent,workspaceOptions:S.workspaceOptions,menuNodeContentFunctionalies:S.menuNodeContentFunctionalies,menuManagementElementDetailDescriptor:ha.importantfields,nodes:[]}},validations(){return{menuNode:re("menuNode",ma.validations.menuNode)}},setup(){return{store:V()}},async created(){this.loadNodes(),this.selectedMenuNode&&this.loadNode(this.selectedMenuNode)},methods:{loadNodes(){this.nodes=this.menuNodes},resetForm(){Object.keys(this.menuNode).forEach(e=>delete this.menuNode[e])},openRelatedDocumentModal(){this.displayModal=!0},closeRelatedDocumentModal(){this.displayModal=!1},showForm(){this.resetForm(),this.hideForm=!1},clearSelectedIcon(){this.selectedIcon="",this.menuNode.custIcon=null,this.menuNode.icon=null},setSelectedRoles(e){this.menuNode.roles=e},toggleDocument(){this.functionalityHidden=this.staticPageHidden=this.externalAppHidden=this.documentTreeHidden=this.workspaceInitialHidden=!0,this.documentHidden=!1},toggleStaticPage(){this.functionalityHidden=this.externalAppHidden=this.documentHidden=this.documentTreeHidden=this.workspaceInitialHidden=!0,this.staticPageHidden=!1},toggleExternalApp(){this.functionalityHidden=this.documentHidden=this.staticPageHidden=this.documentTreeHidden=this.workspaceInitialHidden=!0,this.externalAppHidden=!1},toggleFunctionality(){this.externalAppHidden=this.documentHidden=this.staticPageHidden=!0,this.functionalityHidden=!1,this.menuNode.functionality=="WorkspaceManagement"?this.toggleWorkspaceInitial():this.menuNode.functionality=="DocumentUserBrowser"&&this.toggleDocumentTreeSelect()},isIconSelectorShown(e){if(e.level==1)return!0},isFaIconShown(e){if(e.level==1&&e.icon!=null)return!0},isCustomIconShown(e){if(e.level==1&&e.custIcon!=null)return!0},toggleEmpty(){this.functionalityHidden=this.externalAppHidden=this.documentHidden=this.staticPageHidden=this.documentTreeHidden=this.workspaceInitialHidden=!0},toggleWorkspaceInitial(){this.workspaceInitialHidden=!1,this.documentTreeHidden=!0},toggleDocumentTreeSelect(){this.documentTreeHidden=!1,this.workspaceInitialHidden=!0},onMenuNodeChange(e){e.$model==1?this.toggleDocument():e.$model==3?this.toggleStaticPage():e.$model==2?this.toggleExternalApp():e.$model==4?this.toggleFunctionality():this.toggleEmpty()},onFunctionalityTypeChange(e){e.$model=="WorkspaceManagement"?this.toggleWorkspaceInitial():e.$model=="DocumentUserBrowser"&&this.toggleDocumentTreeSelect()},openFontAwesomeSelectionModal(){this.chooseIconModalShown=!0},closeFontAwesomeSelectionModal(){this.chooseIconModalShown=!1},setBase64Image(e){this.menuNode.icon=null,this.menuNode.custIcon={id:null,className:"custom",unicode:null,category:"custom",label:"logo.png",src:e,visible:!0},this.selectedIcon=e},onChoosenIcon(e){typeof e=="string"?this.setBase64Image(e):(this.menuNode.icon={id:e.id,className:"fas fa-"+e.name,unicode:e.value,category:"solid",label:"",src:null,visible:!0},this.menuNode.custIcon=null,this.selectedIcon=this.menuNode.icon.className="fas fa-"+e.name,this.menuNode.icon.id=e.id),this.closeFontAwesomeSelectionModal()},onDocumentSelect(e){this.menuNode.objId=e.DOCUMENT_ID,this.menuNode.document=e.DOCUMENT_NAME,this.closeRelatedDocumentModal()},async save(){if(this.checkIfNodeExists()){this.store.setError({title:this.$t("managers.menuManagement.info.errorTitle"),msg:this.$t("managers.menuManagement.info.duplicateErrorMessage")});return}let e;this.menuNode.menuId!=null?e=await this.$http.put(this.apiUrl+"menu/"+this.menuNode.menuId,this.getMenuDataForSave()):e=await this.$http.post(this.apiUrl+"menu/",this.getMenuDataForSave()),e.status==200&&(e.data.errors?this.store.setError({title:this.$t("managers.menuManagement.info.errorTitle"),msg:this.$t("managers.menuManagement.info.errorMessage")}):this.store.setInfo({title:this.$t("managers.menuManagement.info.saveTitle"),msg:this.$t("managers.menuManagement.info.saveMessage")})),this.$emit("refreshRecordSet"),this.resetForm()},checkIfNodeExists(){let e=!1;const a=this.getMenuDataForSave();a.parentId||(a.parentId=null);for(let o=0;o<this.nodes.length;o++){const i=this.nodes[o];if(i.menuId!=a.menuId&&i.parentId===a.parentId&&i.name===a.name){e=!0;break}}return e},closeForm(){this.$emit("closesForm")},onAttributeSelect(e){this.populateForm(e.data)},populateForm(e){this.hideForm=!1,this.menuNode={...e},e.objId&&this.getDocumentNameByID(e.objId),e.custIcon!=null?this.selectedIcon=e.custIcon.src:e.icon!=null?this.selectedIcon=e.icon.className:this.selectedIcon=null,this.menuNode.functionality!=null?(this.menuNode.menuNodeContent=4,this.toggleFunctionality()):this.menuNode.externalApplicationUrl!=null?(this.menuNode.menuNodeContent=2,this.toggleExternalApp()):this.menuNode.objId!=null?(this.menuNode.menuNodeContent=1,this.toggleDocument()):this.menuNode.staticPage!=null&&this.menuNode.staticPage!=""?(this.menuNode.menuNodeContent=3,this.toggleStaticPage()):(this.menuNode.menuNodeContent=0,this.toggleEmpty())},getMenuDataForSave(){const e={...this.menuNode},a=this.menuManagementElementDetailDescriptor.fieldsList,o=this.menuManagementElementDetailDescriptor.filedsToSave[e.menuNodeContent];return a.forEach(i=>!o.fields.includes(i)&&(e[i]=null)),delete e.menuNodeContent,e.parentId||(e.parentId=null),e},async getDocumentNameByID(e){await this.$http.get(this.apiUrl+"documents/"+e).then(a=>{this.menuNode.document=a.data.name})},onStaticPageSelect(){this.menuNode.initialPath=this.menuNode.functionality=this.menuNode.objParameters=this.menuNode.objId=this.menuNode.externalApplicationUrl=null},onDataChange(e){e.$touch(),this.$emit("dataChanged")},loadNode(e){if(e.menuId===null){this.resetForm();return}this.populateForm(e)},onSelectedDocumentNode(e){this.menuNode.initialPath=e}}}),ga={class:"p-grid p-m-0 p-fluid kn-page-content"},va={class:"p-col-12"},wa={ref:"menu-configuration-form",class:"p-p-3"},ya={class:"p-field p-mb-5"},xa={class:"p-inputgroup"},Ma={class:"p-float-label"},Na={for:"name"},Ca={class:"p-field p-mb-5"},$a={class:"p-inputgroup"},Ia={class:"p-float-label"},Aa=["src"],Da={for:"descr"},Sa={id:"descr-help"},Ea={class:"p-field p-mb-5"},Fa={class:"p-inputgroup"},Ta={class:"p-float-label"},Pa={for:"menuNodeContent"},Ua=["hidden"],Ra={class:"p-field"},za={class:"p-inputgroup"},Va={class:"p-float-label"},Ba={for:"staticPage"},La=["hidden"],ja={class:"p-inputgroup"},Ka={class:"p-float-label"},Ha={for:"externalApplicationUrl"},_a=["hidden"],Oa={class:"p-field p-mb-5"},qa={class:"p-inputgroup"},Wa={class:"p-float-label"},Xa={for:"objId"},Qa={class:"p-field p-mb-5"},Ya={class:"p-inputgroup"},Ja={class:"p-float-label"},Ga={for:"objParameters"},Za=["hidden"],et={class:"p-inputgroup"},at={class:"p-float-label"},tt={for:"functionality"},ot=["hidden"],nt={class:"p-inputgroup"},rt={class:"p-float-label"},it={for:"initialPath"},lt=["hidden"],dt={class:"p-col-12"};function st(e,a,o,i,b,m){const c=d("Button"),p=d("Toolbar"),r=d("ProgressBar"),f=d("InputText"),l=d("KnValidationMessages"),g=d("FontAwesomePicker"),M=d("Dropdown"),j=d("RelatedDocumentList"),K=d("Dialog"),H=d("DocumentBrowserTree"),_=d("Card"),O=d("RolesCard");return k(),y($,null,[n(p,{class:"kn-toolbar kn-toolbar--secondary"},{start:u(()=>[x(h(e.menuNode.name),1)]),end:u(()=>[n(c,{icon:"pi pi-save",class:"p-button-text p-button-rounded p-button-plain",onClick:e.save,disabled:e.formValid},null,8,["onClick","disabled"]),n(c,{class:"p-button-text p-button-rounded p-button-plain",icon:"pi pi-times",onClick:e.closeForm},null,8,["onClick"])]),_:1}),e.loading?(k(),v(r,{key:0,mode:"indeterminate",class:"kn-progress-bar","data-test":"progress-bar"})):w("",!0),t("div",ga,[t("div",va,[n(_,null,{content:u(()=>[t("form",wa,[t("div",ya,[t("div",xa,[t("span",Ma,[n(f,{id:"name",type:"text",modelValue:e.v$.menuNode.name.$model,"onUpdate:modelValue":a[0]||(a[0]=s=>e.v$.menuNode.name.$model=s),modelModifiers:{trim:!0},onChange:a[1]||(a[1]=s=>e.onDataChange(e.v$.menuNode.name)),class:"p-inputtext p-component kn-material-input"},null,8,["modelValue"]),t("label",Na,h(e.$t("managers.menuManagement.form.name"))+" *",1)])]),n(l,{vComp:e.v$.menuNode.name,additionalTranslateParams:{fieldName:e.$t("managers.menuManagement.form.name")}},null,8,["vComp","additionalTranslateParams"])]),t("div",Ca,[t("div",$a,[t("span",Ia,[n(f,{id:"descr",type:"text",modelValue:e.v$.menuNode.descr.$model,"onUpdate:modelValue":a[2]||(a[2]=s=>e.v$.menuNode.descr.$model=s),modelModifiers:{trim:!0},onBlur:a[3]||(a[3]=s=>e.onDataChange(e.v$.menuNode.descr)),class:"p-inputtext p-component kn-material-input","aria-describedby":"descr-help"},null,8,["modelValue"]),e.isIconSelectorShown(e.menuNode)&&(e.menuNode.icon!=null||e.menuNode.custIcon!=null)?(k(),v(c,{key:0,icon:"pi pi-times",onClick:e.clearSelectedIcon},null,8,["onClick"])):w("",!0),e.isCustomIconShown(e.menuNode)?(k(),v(c,{key:1},{default:u(()=>[t("img",{style:{"max-height":"26px","max-width":"26px"},src:e.selectedIcon},null,8,Aa)]),_:1})):w("",!0),e.isFaIconShown(e.menuNode)?(k(),v(c,{key:2},{default:u(()=>[t("i",{class:I(e.selectedIcon)},null,2)]),_:1})):w("",!0),e.isIconSelectorShown(e.menuNode)?(k(),v(c,{key:3,class:"p-button",onClick:a[4]||(a[4]=s=>e.openFontAwesomeSelectionModal())},{default:u(()=>[x(h(e.$t("managers.menuManagement.chooseIcon").toUpperCase()),1)]),_:1})):w("",!0),t("label",Da,h(e.$t("managers.menuManagement.description"))+" *",1)])]),t("small",Sa,h(e.$t("managers.menuManagement.descrHelp")),1),n(l,{vComp:e.v$.menuNode.descr,additionalTranslateParams:{fieldName:e.$t("managers.menuManagement.description")}},null,8,["vComp","additionalTranslateParams"])]),n(g,{showModal:e.chooseIconModalShown,onChooseIcon:e.onChoosenIcon,onCloseFontAwesomeModal:e.closeFontAwesomeSelectionModal},null,8,["showModal","onChooseIcon","onCloseFontAwesomeModal"]),t("div",Ea,[t("div",Fa,[t("span",Ta,[n(M,{id:"menuNodeContent",modelValue:e.v$.menuNode.menuNodeContent.$model,"onUpdate:modelValue":a[5]||(a[5]=s=>e.v$.menuNode.menuNodeContent.$model=s),options:e.menuNodeContent,onChange:a[6]||(a[6]=s=>e.onMenuNodeChange(e.v$.menuNode.menuNodeContent)),optionLabel:"name",optionValue:"value",class:"p-dropdown p-component p-inputwrapper p-inputwrapper-filled kn-material-input"},null,8,["modelValue","options"]),t("label",Pa,h(e.$t("managers.menuManagement.form.menuNodeContent"))+" *",1)])]),n(l,{vComp:e.v$.menuNode.menuNodeContent,additionalTranslateParams:{fieldName:e.$t("managers.menuManagement.form.menuNodeContent")}},null,8,["vComp","additionalTranslateParams"])]),t("div",{class:"p-field p-mb-5",hidden:e.staticPageHidden},[t("div",Ra,[t("div",za,[t("span",Va,[n(M,{id:"staticPage",modelValue:e.v$.menuNode.staticPage.$model,"onUpdate:modelValue":a[7]||(a[7]=s=>e.v$.menuNode.staticPage.$model=s),options:e.staticPagesList,onChange:a[8]||(a[8]=s=>e.onStaticPageSelect(e.v$.menuNode.staticPage)),optionLabel:"name",optionValue:"name",class:"p-dropdown p-component p-inputwrapper p-inputwrapper-filled kn-material-input"},null,8,["modelValue","options"]),t("label",Ba,h(e.$t("managers.menuManagement.form.staticPage"))+" *",1)])]),n(l,{vComp:e.v$.menuNode.staticPage,additionalTranslateParams:{fieldName:e.$t("managers.menuManagement.form.staticPage")}},null,8,["vComp","additionalTranslateParams"])])],8,Ua),t("div",{class:"p-field p-mb-5",hidden:e.externalAppHidden},[t("div",ja,[t("span",Ka,[n(f,{id:"externalApplicationUrl",type:"text",modelValue:e.v$.menuNode.externalApplicationUrl.$model,"onUpdate:modelValue":a[9]||(a[9]=s=>e.v$.menuNode.externalApplicationUrl.$model=s),modelModifiers:{trim:!0},onBlur:a[10]||(a[10]=s=>e.onDataChange(e.v$.menuNode.externalApplicationUrl)),class:"p-inputtext p-component kn-material-input"},null,8,["modelValue"]),t("label",Ha,h(e.$t("managers.menuManagement.form.externalApplicationUrl"))+" *",1)])]),n(l,{vComp:e.v$.menuNode.externalApplicationUrl,additionalTranslateParams:{fieldName:e.$t("managers.menuManagement.form.externalApplicationUrl")}},null,8,["vComp","additionalTranslateParams"])],8,La),t("div",{hidden:e.documentHidden},[t("div",Oa,[t("div",qa,[t("span",Wa,[n(f,{id:"selectedDocument",type:"text",modelValue:e.v$.menuNode.document.$model,"onUpdate:modelValue":a[11]||(a[11]=s=>e.v$.menuNode.document.$model=s),modelModifiers:{trim:!0},onBlur:a[12]||(a[12]=s=>e.onDataChange(e.v$.menuNode.document)),class:"p-inputtext p-component kn-material-input"},null,8,["modelValue"]),n(f,{hidden:!0,id:"objId",type:"text",modelValue:e.v$.menuNode.objId.$model,"onUpdate:modelValue":a[13]||(a[13]=s=>e.v$.menuNode.objId.$model=s),modelModifiers:{trim:!0},onBlur:a[14]||(a[14]=s=>e.onDataChange(e.v$.menuNode.objId)),class:"p-inputtext p-component kn-material-input"},null,8,["modelValue"]),n(c,{icon:"pi pi-search",class:"p-button",onClick:a[15]||(a[15]=s=>e.openRelatedDocumentModal())}),t("label",Xa,h(e.$t("managers.menuManagement.form.document"))+" *",1)])]),n(l,{vComp:e.v$.menuNode.document,additionalTranslateParams:{fieldName:e.$t("managers.menuManagement.form.document")}},null,8,["vComp","additionalTranslateParams"])]),t("div",Qa,[t("div",Ya,[t("span",Ja,[n(f,{id:"objParameters",type:"text",modelValue:e.v$.menuNode.objParameters.$model,"onUpdate:modelValue":a[16]||(a[16]=s=>e.v$.menuNode.objParameters.$model=s),modelModifiers:{trim:!0},onBlur:a[17]||(a[17]=s=>e.onDataChange(e.v$.menuNode.objParameters)),class:"p-inputtext p-component kn-material-input"},null,8,["modelValue"]),t("label",Ga,h(e.$t("managers.menuManagement.form.objParameters")),1)])]),n(l,{vComp:e.v$.menuNode.objParameters,additionalTranslateParams:{fieldName:e.$t("managers.menuManagement.form.objParameters")}},null,8,["vComp","additionalTranslateParams"])]),n(K,{header:e.$t("managers.menuManagement.selectDocument"),visible:e.displayModal,"onUpdate:visible":a[18]||(a[18]=s=>e.displayModal=s),style:{width:"50vw"},modal:!0},{default:u(()=>[n(j,{loading:e.loading,onSelectedDocument:e.onDocumentSelect,"data-test":"related-documents-list"},null,8,["loading","onSelectedDocument"])]),_:1},8,["header","visible"])],8,_a),t("div",{class:"p-field p-mb-5",hidden:e.functionalityHidden},[t("div",et,[t("span",at,[n(M,{id:"functionality",modelValue:e.v$.menuNode.functionality.$model,"onUpdate:modelValue":a[19]||(a[19]=s=>e.v$.menuNode.functionality.$model=s),options:e.menuNodeContentFunctionalies,onChange:a[20]||(a[20]=s=>e.onFunctionalityTypeChange(e.v$.menuNode.functionality)),optionLabel:"name",optionValue:"value",class:"p-dropdown p-component p-inputwrapper p-inputwrapper-filled kn-material-input"},null,8,["modelValue","options"]),t("label",tt,h(e.$t("managers.menuManagement.form.functionality"))+"*",1)])]),n(l,{vComp:e.v$.menuNode.functionality,additionalTranslateParams:{fieldName:e.$t("managers.menuManagement.form.functionality")}},null,8,["vComp","additionalTranslateParams"])],8,Za),t("div",{class:"p-field p-mb-5",hidden:e.workspaceInitialHidden},[t("div",nt,[t("span",rt,[n(M,{id:"initialPath",modelValue:e.v$.menuNode.initialPath.$model,"onUpdate:modelValue":a[21]||(a[21]=s=>e.v$.menuNode.initialPath.$model=s),options:e.workspaceOptions,optionLabel:"name",optionValue:"value",class:"p-dropdown p-component p-inputwrapper p-inputwrapper-filled kn-material-input"},null,8,["modelValue","options"]),t("label",it,h(e.$t("managers.menuManagement.form.initialPath"))+" *",1)])])],8,ot),t("div",{class:"p-field p-mb-5",hidden:e.documentTreeHidden},[t("p",null,"Open document browser on "+h(e.v$.menuNode.initialPath.$model),1),n(H,{selected:e.v$.menuNode.initialPath.$model,onSelectedDocumentNode:e.onSelectedDocumentNode,loading:e.loading},null,8,["selected","onSelectedDocumentNode","loading"])],8,lt)],512)]),_:1})]),t("div",dt,[n(O,{hidden:e.hideForm,rolesList:e.roles,parentNodeRoles:e.parentNodeRoles,selected:e.selectedMenuNode.roles,onChanged:a[22]||(a[22]=s=>e.setSelectedRoles(s))},null,8,["hidden","rolesList","parentNodeRoles","selected"])])])],64)}var ct=N(fa,[["render",st],["__scopeId","data-v-4abad167"]]);const pt=C({name:"menu-management",components:{MenuNodesTree:ue,MenuElementsDetail:ct,KnFabButton:ae,KnHint:te},data(){return{apiUrl:"/knowage/restful-services/2.0/",menuNodes:[],staticPagesList:[],selectedMenuNode:{},parentNodeRoles:[],loading:!1,hideForm:!0,dirty:!1,roles:[]}},setup(){return{store:V()}},async created(){await this.loadMenuNodes(),await this.loadRoles(),await this.loadStaticPages()},methods:{async loadRoles(){this.loading=this.hideForm=!0,this.dirty=!1,await this.$http.get(this.apiUrl+"roles").then(e=>{this.roles=e.data}).finally(()=>this.loading=!1)},showForm(){if(this.hideForm=!1,Object.keys(this.selectedMenuNode).length===0&&this.selectedMenuNode.constructor===Object)this.selectedMenuNode={},this.initMenuNode();else{let e=this.selectedMenuNode;this.selectedMenuNode={},this.initMenuNode(),this.selectedMenuNode.parentId=e.id}},initMenuNode(){this.selectedMenuNode.level=0,this.selectedMenuNode.icon={},this.selectedMenuNode.roles=[],this.selectedMenuNode.custIcon=this.selectedMenuNode.externalApplicationUrl=this.selectedMenuNode.functionality=this.selectedMenuNode.initialPath=this.selectedMenuNode.objId=this.selectedMenuNode.objParameters=this.selectedMenuNode.staticPage=this.selectedMenuNode.parentId=null,this.selectedMenuNode.hideSliders=this.selectedMenuNode.hideToolbar=this.selectedMenuNode.viewIcons=!1},closeForm(){this.hideForm=!0},async loadMenuNodes(){this.loading=!0,this.hideForm=!0,this.dirty=!1,await this.$http.get(this.apiUrl+"menu").then(e=>{this.menuNodes=e.data}).finally(()=>this.loading=!1)},async loadStaticPages(){this.loading=!0,this.hideForm=!0,this.dirty=!1,await this.$http.get(this.apiUrl+"menu/htmls").then(e=>{this.staticPagesList=e.data}).finally(()=>this.loading=!1)},onNodeSelect(e){this.dirty?this.$confirm.require({message:this.$t("common.toast.unsavedChangesMessage"),header:this.$t("common.toast.unsavedChangesHeader"),icon:"pi pi-exclamation-triangle",accept:()=>{this.dirty=!1,e?this.prepareFormData(e):this.hideForm=!0}}):e&&e.menuId?this.prepareFormData(e):(this.selectedMenuNode={...e},this.parentNodeRoles=null,this.hideForm=!0)},onNodeUnselect(){this.selectedMenuNode={},this.initMenuNode()},onNodeDelete(e){this.deleteNode(e)},onChangeWithFather(e){this.changeWithFather(e)},onMoveUp(e){this.moveUp(e)},onMoveDown(e){this.moveDown(e)},async changeWithFather(e){this.loading=!0,this.axios.get(this.apiUrl+"menu/changeWithFather/"+e).then(()=>{this.loadMenuNodes()}).finally(()=>{this.loading=!1})},async moveUp(e){this.loading=!0,this.axios.get(this.apiUrl+"menu/moveUp/"+e).then(()=>{this.loadMenuNodes()}).finally(()=>{this.loading=!1})},async moveDown(e){this.loading=!0,this.axios.get(this.apiUrl+"menu/moveDown/"+e).then(()=>{this.loadMenuNodes()}).finally(()=>{this.loading=!1})},async deleteNode(e){this.$confirm.require({message:this.$t("common.toast.deleteMessage"),header:this.$t("common.toast.deleteConfirmTitle"),icon:"pi pi-exclamation-triangle",accept:async()=>{this.loading=!0,this.axios.delete(this.apiUrl+"menu/"+e).then(()=>{this.store.setInfo({title:this.$t("managers.menuManagement.info.deleteTitle"),msg:this.$t("managers.menuManagement.info.deleteMessage")}),this.loadMenuNodes()}).finally(()=>{this.loading=!1})}})},prepareFormData(e){if(this.hideForm&&(this.hideForm=!1),this.selectedMenuNode={...e,staticPage:e.staticPage},this.parentNodeRoles=null,e.parentId){const a=this.menuNodes.find(o=>o.menuId===e.parentId);a&&(this.parentNodeRoles=a.roles)}}}}),bt={class:"kn-page"},ut={class:"kn-page-content p-grid p-m-0"},mt={class:"kn-list--column p-col-4 p-sm-4 p-md-3 p-p-0 p-d-flex p-flex-column"},kt={class:"p-col-8 p-sm-8 p-md-9 p-p-0 p-m-0 kn-page"};function ht(e,a,o,i,b,m){const c=d("KnFabButton"),p=d("Toolbar"),r=d("ProgressBar"),f=d("MenuNodesTree"),l=d("KnHint"),g=d("MenuElementsDetail");return k(),y("div",bt,[t("div",ut,[t("div",mt,[n(p,{class:"kn-toolbar kn-toolbar--primary"},{start:u(()=>[x(h(e.$t("managers.menuManagement.title")),1)]),end:u(()=>[n(c,{icon:"fas fa-plus",onClick:a[0]||(a[0]=M=>e.showForm()),"data-test":"open-form-button"})]),_:1}),e.loading?(k(),v(r,{key:0,mode:"indeterminate",class:"kn-progress-bar","data-test":"progress-bar"})):w("",!0),n(f,{elements:e.menuNodes,loading:e.loading,onDeleteMenuNode:e.onNodeDelete,onSelectedMenuNode:e.onNodeSelect,onUnselectedMenuNode:e.onNodeUnselect,onChangeWithFather:e.onChangeWithFather,onMoveUp:e.onMoveUp,onMoveDown:e.onMoveDown,"data-test":"menu-nodes-tree"},null,8,["elements","loading","onDeleteMenuNode","onSelectedMenuNode","onUnselectedMenuNode","onChangeWithFather","onMoveUp","onMoveDown"])]),t("div",kt,[e.hideForm?(k(),v(l,{key:0,title:"managers.menuManagement.title",hint:"managers.menuManagement.hint"},null,8,["title","hint"])):w("",!0),e.hideForm?w("",!0):(k(),v(g,{key:1,selectedRoles:e.selectedMenuNode.roles,parentNodeRoles:e.parentNodeRoles,roles:e.roles,selectedMenuNode:e.selectedMenuNode,menuNodes:e.menuNodes,staticPagesList:e.staticPagesList,onRefreshRecordSet:e.loadMenuNodes,onClosesForm:e.closeForm,onDataChanged:a[1]||(a[1]=M=>e.dirty=!0),hidden:e.hideForm},null,8,["selectedRoles","parentNodeRoles","roles","selectedMenuNode","menuNodes","staticPagesList","onRefreshRecordSet","onClosesForm","hidden"]))])])])}var xt=N(pt,[["render",ht]]);export{xt as default};
//# sourceMappingURL=MenuManagement-3e433753.js.map
