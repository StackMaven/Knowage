import{d as z,i as L,_ as T,r as d,o as i,h as y,w as l,f as n,g as A,t as o,a as t,a5 as B,bc as W,c as b,A as u,q as R,D as N,C as X,B as j,l as Y,n as q,y as J,z as S,G as I,Y as V,p as F,b as U,a4 as aa,v as H,u as G,s as Q,W as ea,ad as ta}from"./index-1e676509.js";import{s as K}from"./tree.esm-837306a6.js";import{s as oa}from"./multiselect.esm-ce4000f7.js";import{s as ra}from"./menu.esm-6bee86d0.js";import{s as na}from"./calendar.esm-60a451ba.js";import{s as ia}from"./radiobutton.esm-c3e6fa9b.js";import{K as da}from"./KnCron-7fa39115.js";import{s as O}from"./checkbox.esm-fa6c8259.js";import{s as P,a as _}from"./accordiontab.esm-2c1b3232.js";import"./inputswitch.esm-80317a38.js";import"./KnCronDescriptor-98645843.js";const la="960px",ca={"text-align":"end",width:"10%"},sa={width:"20%"},pa="stack",ba=15,ka={message:{"align-items":"center",display:"flex","justify-content":"center","text-align":"center"}};var ua={breakpoint:la,iconColumnStyle:ca,nameColumnStyle:sa,responsiveLayout:pa,rows:ba,styles:ka};const ma={style:{width:"60vw"}},ga={style:{padding:"0"}};var va={dialog:ma,node:ga};const fa=z({name:"scheduler-documents-selection-dialog",components:{Dialog:L,Tree:K},props:{propFiles:{type:Array},visible:{type:Boolean}},emits:["documentSelected","close"],data(){return{schedulerDocumentsSelectionDialogDescriptor:va,files:[],documents:[],nodes:[],selectedDocumentsKeys:{},selectedDocument:null}},watch:{propFiles(){this.loadTree()}},created(){this.loadTree()},methods:{loadTree(){this.loadFiles(),this.createNodeTree(),this.removeEmptyFolders()},loadFiles(){this.files=this.propFiles},createNodeTree(){this.nodes=[];const a=[];this.files.forEach(e=>{const r={key:e.id,id:e.id,parentId:e.parentId,label:e.name,children:this.formatFolderChildren(e.biObjects),data:e,style:this.schedulerDocumentsSelectionDialogDescriptor.node.style,icon:"pi pi-folder",selectable:!1};a.filter(g=>r.id===g.parentId).forEach(g=>r.children.push(g)),this.attachFolderToTree(r,a)})},formatFolderChildren(a){const e=[];return a.forEach(r=>{r.visible&&e.push({key:r.id,icon:"pi pi-file",id:r.id,label:r.name,data:r,selectable:!0})}),e},attachFolderToTree(a,e){var r,c;if(a.parentId){let g=null;for(let h=0;h<e.length;h++)if(a.parentId===e[h].id){(r=e[h].children)==null||r.push(a);break}for(let h=0;h<this.nodes.length;h++)if(g=this.findParentFolder(a,this.nodes[h]),g){(c=g.children)==null||c.push(a);break}g||e.push(a)}else this.nodes.push(a)},findParentFolder(a,e){if(a.parentId===e.id)return e;{let r=null;if(e.children)for(let c=0;c<e.children.length&&(r=this.findParentFolder(a,e.children[c]),!r);c++);return r}},filterDocuments(a,e){var r;if(a.children&&a.children.length>0){this.sortDocumentChildren(a);for(let c=a.children.length-1;c>=0;c--)this.filterDocuments(a.children[c],a)}if(((r=a.children)==null?void 0:r.length)==0&&e&&e.children){const c=e.children,g=c.findIndex(h=>h.id===a.id);c.splice(g,1)}},sortDocumentChildren(a){var e;(e=a.children)==null||e.sort((r,c)=>r.icon>c.icon?-1:1)},removeEmptyFolders(){var a;for(let e=0;e<this.nodes.length;e++)this.filterDocuments(this.nodes[e],null),((a=this.nodes[e].children)==null?void 0:a.length)===0&&(this.nodes[e].selectable=!1)},setOpenFolderIcon(a){a.icon="pi pi-folder-open"},setClosedFolderIcon(a){a.icon="pi pi-folder"},setSelectedDocument(a){this.selectedDocument=a.data},removeSelectedDocument(){this.selectedDocument=null},closeDialog(){this.selectedDocumentsKeys={},this.selectedDocument=null,this.$emit("close")},addDocument(){this.$emit("documentSelected",this.selectedDocument),this.selectedDocumentsKeys={},this.selectedDocument=null}}}),ha={class:"p-d-flex p-flex-row p-jc-end"};function wa(a,e,r,c,g,h){const s=d("Toolbar"),f=d("Tree"),v=d("Button"),p=d("Dialog");return i(),y(p,{class:"p-fluid kn-dialog--toolbar--primary",contentStyle:a.schedulerDocumentsSelectionDialogDescriptor.dialog.style,visible:a.visible,modal:!0,closable:!1},{header:l(()=>[n(s,{class:"kn-toolbar kn-toolbar--primary p-p-0 p-m-0 p-col-12"},{start:l(()=>[A(o(a.$t("managers.scheduler.selectDocument")),1)]),_:1})]),footer:l(()=>[t("div",ha,[n(v,{class:"kn-button kn-button--primary",onClick:a.closeDialog},{default:l(()=>[A(o(a.$t("common.cancel")),1)]),_:1},8,["onClick"]),n(v,{class:"kn-button kn-button--primary",onClick:a.addDocument},{default:l(()=>[A(o(a.$t("common.add")),1)]),_:1},8,["onClick"])])]),default:l(()=>[n(f,{id:"document-tree",value:a.nodes,selectionMode:"single",selectionKeys:a.selectedDocumentsKeys,"onUpdate:selectionKeys":e[0]||(e[0]=w=>a.selectedDocumentsKeys=w),metaKeySelection:!1,filter:!0,filterMode:"lenient",onNodeSelect:e[1]||(e[1]=w=>a.setSelectedDocument(w)),onNodeUnselect:a.removeSelectedDocument,onNodeExpand:e[2]||(e[2]=w=>a.setOpenFolderIcon(w)),onNodeCollapse:e[3]||(e[3]=w=>a.setClosedFolderIcon(w))},null,8,["value","selectionKeys","onNodeUnselect"])]),_:1},8,["contentStyle","visible"])}var xa=T(fa,[["render",wa]]);const ya={style:{padding:"0",width:"60vw"}},Ma={message:{"align-items":"center",display:"flex","justify-content":"center","text-align":"center"}};var Aa={dialog:ya,styles:Ma};const Ca=z({name:"scheduler-document-parameter-form",components:{Dropdown:B,MultiSelect:oa},props:{propParameter:{type:Object},roles:{type:Array},formulas:{type:Array},documentLabel:{type:String}},emits:["loading"],data(){return{parameter:null,triggerStrategies:[{value:"fixed",label:this.$t("managers.scheduler.fixedValuesStrategy")},{value:"loadAtRuntime",label:this.$t("managers.scheduler.loadAtRuntimeStrategy")},{value:"formula",label:this.$t("managers.scheduler.useFormulaStrategy")}],triggerIterations:[{value:!0,label:this.$t("managers.scheduler.iterateOnParameterValues")},{value:!1,label:this.$t("managers.scheduler.doNotIterateOnParameterValues")}],parameterValues:{},rolesOptions:[],formulaOptions:[],loading:!1}},watch:{async propParameter(){this.loadParameter(),await this.formatParameter()},roles(){this.loadRoles()},formulas(){this.loadFormulas()}},async created(){this.loadRoles(),this.loadParameter(),await this.formatParameter(),this.loadFormulas()},methods:{loadParameter(){this.parameter=this.propParameter},async formatParameter(){var a;if(this.parameter.type==="fixed")await this.loadParameterValues(),!((a=this.parameterValues)!=null&&a.manualInput)&&this.parameter.value&&(this.parameter.manualInput=!1,this.parameter.selectedValues=this.parameter.value.split(";").map(e=>e.trim()));else if(this.parameter.type==="loadAtRuntime"&&this.parameter.value){for(let e=0;e<this.rolesOptions.length;e++)if(this.parameter.value.endsWith(this.rolesOptions[e].role)){this.parameter.value=this.rolesOptions[e].userAndRole;break}}},async loadParameterValues(){var a,e;this.loading=!0,this.$emit("loading",!0),await W.get(`/knowage/restful-services/2.0/documents/${this.documentLabel}/parameters/${(a=this.parameter)==null?void 0:a.id}/values?role=${(e=this.parameter)==null?void 0:e.role}`).then(r=>this.parameterValues=r.data).catch(()=>{}),this.$emit("loading",!1),this.loading=!1},loadRoles(){this.rolesOptions=this.roles},loadFormulas(){this.formulaOptions=this.formulas},formatSelectedValues(){this.parameter.value="";for(let a=0;a<this.parameter.selectedValues.length;a++)this.parameter.value+=this.parameter.selectedValues[a],this.parameter.value+=a===this.parameter.selectedValues.length-1?" ":"; "},async onParameterTypeChange(){this.parameter.value="",this.parameter.selectedValues=[],this.parameter.type==="fixed"&&await this.loadParameterValues()}}}),Da={class:"parameter-card"},$a={key:0},Ea={class:"p-grid p-ai-center"},za={class:"p-m-0 p-col-12 p-md-12 p-lg-4 p-xl-4"},Ta={class:"kn-material-input-label"},Sa={key:0,class:"p-m-0 p-col-12 p-md-12 p-lg-4 p-xl-4"},Ia={key:0},Na={class:"kn-material-input-label"},Va={key:1},ja={class:"kn-material-input-label"},La={key:1,class:"p-m-0 p-col-12 p-md-12 p-lg-4 p-xl-4"},Fa={class:"kn-material-input-label"},Ua={key:2,class:"p-m-0 p-col-12 p-md-12 p-lg-4 p-xl-4"},Oa={class:"kn-material-input-label"},Pa={class:"p-m-0 p-col-12 p-md-12 p-lg-4 p-xl-4"},_a={class:"kn-material-input-label"};function Ba(a,e,r,c,g,h){const s=d("Dropdown"),f=d("InputText"),v=d("MultiSelect");return i(),b("div",Da,[a.parameter&&!a.loading?(i(),b("div",$a,[t("h2",null,o(a.parameter.name),1),t("div",Ea,[t("div",za,[t("span",null,[t("label",Ta,o(a.$t("managers.scheduler.parameterValueType")),1),n(s,{class:"kn-material-input",modelValue:a.parameter.type,"onUpdate:modelValue":e[0]||(e[0]=p=>a.parameter.type=p),options:a.parameter.temporal?a.triggerStrategies:a.triggerStrategies.slice(0,2),optionLabel:"label",optionValue:"value",onChange:a.onParameterTypeChange},null,8,["modelValue","options","onChange"])])]),a.parameter.type==="fixed"?(i(),b("div",Sa,[a.parameterValues.manualInput?(i(),b("span",Ia,[t("label",Na,o(a.$t("common.values")),1),n(f,{class:"kn-material-input",modelValue:a.parameter.value,"onUpdate:modelValue":e[1]||(e[1]=p=>a.parameter.value=p)},null,8,["modelValue"])])):(i(),b("span",Va,[t("label",ja,o(a.$t("common.values")),1),n(v,{class:"kn-material-input",modelValue:a.parameter.selectedValues,"onUpdate:modelValue":e[2]||(e[2]=p=>a.parameter.selectedValues=p),options:a.parameterValues.values,onChange:a.formatSelectedValues},null,8,["modelValue","options","onChange"])]))])):a.parameter.type==="loadAtRuntime"?(i(),b("div",La,[t("span",null,[t("label",Fa,o(a.$t("common.role")),1),n(s,{class:"kn-material-input",modelValue:a.parameter.value,"onUpdate:modelValue":e[3]||(e[3]=p=>a.parameter.value=p),options:a.rolesOptions,optionLabel:"role",optionValue:"userAndRole"},null,8,["modelValue","options"])])])):a.parameter.type==="formula"?(i(),b("div",Ua,[t("span",null,[t("label",Oa,o(a.$t("managers.scheduler.selectFormula")),1),n(s,{class:"kn-material-input",modelValue:a.parameter.value,"onUpdate:modelValue":e[4]||(e[4]=p=>a.parameter.value=p),options:a.formulaOptions,optionLabel:"description",optionValue:"name"},null,8,["modelValue","options"])])])):u("",!0),t("div",Pa,[t("span",null,[t("label",_a,o(a.$t("managers.scheduler.iterations")),1),n(s,{class:"kn-material-input",modelValue:a.parameter.iterative,"onUpdate:modelValue":e[5]||(e[5]=p=>a.parameter.iterative=p),options:a.triggerIterations,optionLabel:"label",optionValue:"value"},null,8,["modelValue","options"])])])])])):u("",!0)])}var Ra=T(Ca,[["render",Ba],["__scopeId","data-v-73ae53aa"]]);const Xa=z({name:"scheduler-document-parameter-dialog",components:{Dialog:L,Message:R,SchedulerDocumentParameterForm:Ra},props:{propParameters:{type:Array},roles:{type:Array},deletedParams:{type:Array},documentLabel:{type:String}},emits:["documentSelected","close","setParameters"],data(){return{schedulerDocumentParameterDialogDescriptor:Aa,parameters:[],formulas:[],loading:!1}},computed:{deletedParamsMessage(){var e;let a="";return(e=this.deletedParams)==null||e.forEach(r=>a+=r.name+" "),a}},watch:{propParameters:{handler(){this.loadParameters()},deep:!0}},async created(){this.loadParameters(),await this.loadFormulas()},methods:{loadParameters(){var a;this.parameters=[],(a=this.propParameters)==null||a.forEach(e=>this.parameters.push({...e})),this.parameters.sort((e,r)=>e.name>r.name?1:-1)},closeDialog(){this.parameters=[],this.$emit("close")},async loadFormulas(){await this.$http.get("/knowage/restful-services/2.0/formulas/").then(a=>this.formulas=a.data)},setParameters(){this.$emit("setParameters",this.parameters)},setLoading(a){this.loading=a}}}),Ja={class:"p-d-flex p-flex-row p-jc-end"};function Qa(a,e,r,c,g,h){const s=d("Toolbar"),f=d("ProgressBar"),v=d("Message"),p=d("SchedulerDocumentParameterForm"),w=d("Button"),M=d("Dialog");return i(),y(M,{class:"p-fluid kn-dialog--toolbar--primary",contentStyle:a.schedulerDocumentParameterDialogDescriptor.dialog.style,visible:a.visible,modal:!0,closable:!1},{header:l(()=>[n(s,{class:"kn-toolbar kn-toolbar--primary p-p-0 p-m-0 p-col-12"},{start:l(()=>[A(o(a.$t("managers.scheduler.documentParameter")),1)]),_:1})]),footer:l(()=>[t("div",Ja,[n(w,{class:"kn-button kn-button--primary",onClick:a.closeDialog},{default:l(()=>[A(o(a.$t("common.cancel")),1)]),_:1},8,["onClick"]),n(w,{class:"kn-button kn-button--primary",onClick:a.setParameters},{default:l(()=>[A(o(a.$t("common.set")),1)]),_:1},8,["onClick"])])]),default:l(()=>[a.loading?(i(),y(f,{key:0,class:"kn-progress-bar",mode:"indeterminate"})):u("",!0),a.deletedParams.length>0?(i(),y(v,{key:1,class:"p-m-2",severity:"warn",closable:!1,style:N(a.schedulerDocumentParameterDialogDescriptor.styles.message)},{default:l(()=>[A(o(a.deletedParamsMessage),1)]),_:1},8,["style"])):u("",!0),(i(!0),b(j,null,X(a.parameters,(k,C)=>(i(),y(p,{key:C,class:"p-m-3",propParameter:k,roles:a.roles,formulas:a.formulas,documentLabel:a.documentLabel,onLoading:e[0]||(e[0]=x=>a.setLoading(x))},null,8,["propParameter","roles","formulas","documentLabel"]))),128))]),_:1},8,["contentStyle","visible"])}var Ya=T(Xa,[["render",Qa]]);const qa=z({name:"scheduler-documents-table",components:{Column:Y,DataTable:q,Message:R,SchedulerDocumentsSelectionDialog:xa,SchedulerDocumentParameterDialog:Ya},props:{jobDocuments:{type:Array}},emits:["loading"],data(){return{schedulerDocumentsTableDescriptor:ua,documents:[],files:[],documentsSelectionDialogVisible:!1,selectedDocument:null,documentParameterDialogVisible:!1,roles:[],parameterWithValues:[],deletedParams:[],documentLabel:""}},watch:{jobDocuments(){this.loadDocuments()}},created(){this.loadDocuments()},methods:{loadDocuments(){this.documents=this.jobDocuments},checkIfParameterValuesSet(a){let e=!0;if(a){for(let r=0;r<a.length;r++)if(!a[r].value){e=!1;break}}return e},removeDocumentConfirm(a){this.$confirm.require({message:this.$t("common.toast.deleteMessage"),header:this.$t("common.toast.deleteTitle"),icon:"pi pi-exclamation-triangle",accept:()=>this.removeDocument(a)})},removeDocument(a){this.documents.splice(a,1)},async openDocumentsSelectionDialog(){this.$emit("loading",!0),this.files.length===0&&await this.$http.get("/knowage/restful-services/scheduleree/folders/?includeDocs=true").then(a=>this.files=a.data),this.documentsSelectionDialogVisible=!0,this.$emit("loading",!1)},onDocumentSelected(a){this.documentsSelectionDialogVisible=!1,a&&this.loadDocumentData(a,!0)},async loadDocumentData(a,e){var h,s;if(this.$emit("loading",!0),a!=null&&a.parametersTouched){this.$emit("loading",!1);return}const r=(h=a.label)!=null?h:a.name,c=await this.loadDocumentInfo(r);this.roles=await this.loadSelectedDocumentRoles(c);const g=await this.loadSelectedDocumentParameters(r);this.updateDocumentParameters(a,g),c.condensedParameters=this.updateCondensedParameters(g),this.selectedDocument={name:r,nameTitle:c.label,condensedParameters:c.condensedParameters,parameters:a.parameters},(s=this.selectedDocument.parameters)==null||s.forEach(f=>{var v;return f.role=(v=this.roles[0])==null?void 0:v.role}),e&&this.documents.push(this.selectedDocument),this.$emit("loading",!1)},updateDocumentParameters(a,e){var r;if(!a.parameters)a.parameters=e;else{this.deletedParams=[];for(let c=0;c<e.length;c++){const g=(r=a.parameters)==null?void 0:r.findIndex(h=>h.name===e[c].name);g===-1?this.deletedParams.push(a.parameters[c]):(a.parameters[g].id=e[c].id,a.parameters[g].temporal=e[c].temporal)}}},async loadDocumentInfo(a){let e=null;return await this.$http.get(`/knowage/restful-services/1.0/documents/${a}`).then(r=>e=r.data),e},async loadSelectedDocumentRoles(a){let e=[],r=[];return await this.$http.get(`/knowage/restful-services/2.0/documents/${a.id}/userroles`).then(c=>e=c.data),e.forEach(c=>{const g=c.split("|");r.push({userAndRole:c,user:g[0],role:g[1]})}),r},async loadSelectedDocumentParameters(a){let e=[];return await this.$http.get(`/knowage/restful-services/2.0/documents/${a}/parameters`).then(r=>e=r.data),e=e.map(r=>({id:r.parID,name:r.parameterUrlName,value:"",type:"fixed",iterative:!1,temporal:r.parameter.temporal,documentLabel:a})),e},updateCondensedParameters(a){let e="";for(let r=0;r<a.length;r++)a[r].type==="fixed"&&(e+=" "+a[r].name+" = "+a[r].value,e+=r===a.length-1?" ":" | ");return e},async openDocumentParameterDialog(a){this.selectedDocument=a,this.parameterWithValues=a.parameters,await this.loadDocumentData(a,!1),this.documentLabel=this.selectedDocument.name,this.documentParameterDialogVisible=!0},closeDocumentParameterDialog(){this.$emit("loading",!1),this.selectedDocument=null,this.documentParameterDialogVisible=!1},onParametersSet(a){this.selectedDocument.parameters=a,this.selectedDocument.condensedParameters=this.updateCondensedParameters(a),this.selectedDocument.parametersTouched=!0;const e=this.documents.findIndex(r=>r.name===this.selectedDocument.name);e!==-1&&(this.documents[e]=this.selectedDocument),this.documentParameterDialogVisible=!1}}}),Ha={key:0},Ga={key:1},Ka=["data-test"],Za=A(" >");function Wa(a,e,r,c,g,h){var x,$;const s=d("Button"),f=d("Toolbar"),v=d("Message"),p=d("Column"),w=d("DataTable"),M=d("SchedulerDocumentsSelectionDialog"),k=d("SchedulerDocumentParameterDialog"),C=J("tooltip");return i(),b("div",null,[n(f,{class:"kn-toolbar kn-toolbar--secondary"},{start:l(()=>[A(o(a.$t("common.documents")),1)]),end:l(()=>[n(s,{class:"kn-button p-button-text p-button-rounded",onClick:a.openDocumentsSelectionDialog},{default:l(()=>[A(o(a.$t("common.add")),1)]),_:1},8,["onClick"])]),_:1}),((x=a.documents)==null?void 0:x.length)===0?(i(),y(v,{key:0,class:"p-m-4",severity:"info",closable:!1,style:N(a.schedulerDocumentsTableDescriptor.styles.message)},{default:l(()=>[A(o(a.$t("managers.scheduler.noDocumentsInfo")),1)]),_:1},8,["style"])):(i(),y(w,{key:1,id:"documents-datatable",value:a.documents,paginator:!0,rows:a.schedulerDocumentsTableDescriptor.rows,class:"p-datatable-sm kn-table p-m-2",dataKey:"name",responsiveLayout:a.schedulerDocumentsTableDescriptor.responsiveLayout,breakpoint:a.schedulerDocumentsTableDescriptor.breakpoint,"data-test":"documents-table"},{default:l(()=>[n(p,{class:"kn-truncated",header:a.$t("common.name"),style:N(a.schedulerDocumentsTableDescriptor.nameColumnStyle)},{body:l(m=>[A(o(m.data.name),1)]),_:1},8,["header","style"]),n(p,{header:a.$t("common.parameters")},{body:l(m=>{var D;return[a.checkIfParameterValuesSet(m.data.parameters)?(i(),b("span",Ha,o(m.data.condensedParameters),1)):S((i(),b("span",Ga,[t("i",{class:"pi pi-exclamation-triangle kn-warning-icon","data-test":"warning-icon-"+m.data.name},null,8,Ka)])),[[C,a.$t("managers.scheduler.parametersWarningTooltip"),void 0,{top:!0}]]),((D=m.data.parameters)==null?void 0:D.length)>0?(i(),y(s,{key:2,icon:"pi pi-pencil",class:"p-button-link",onClick:In=>a.openDocumentParameterDialog(m.data)},null,8,["onClick"])):u("",!0)]}),default:l(()=>[Za]),_:1},8,["header"]),n(p,{style:N(a.schedulerDocumentsTableDescriptor.iconColumnStyle)},{body:l(m=>[n(s,{icon:"pi pi-trash",class:"p-button-link",onClick:D=>a.removeDocumentConfirm(m.index)},null,8,["onClick"])]),_:1},8,["style"])]),_:1},8,["value","rows","responsiveLayout","breakpoint"])),n(M,{visible:a.documentsSelectionDialogVisible,propFiles:a.files,onClose:e[0]||(e[0]=m=>a.documentsSelectionDialogVisible=!1),onDocumentSelected:a.onDocumentSelected},null,8,["visible","propFiles","onDocumentSelected"]),n(k,{visible:a.documentParameterDialogVisible,propParameters:($=a.selectedDocument)==null?void 0:$.parameters,roles:a.roles,deletedParams:a.deletedParams,onClose:a.closeDocumentParameterDialog,onSetParameters:a.onParametersSet,documentLabel:a.documentLabel},null,8,["visible","propParameters","roles","deletedParams","onClose","onSetParameters","documentLabel"])])}var ae=T(qa,[["render",Wa]]);const ee="960px",te={"text-align":"end",width:"10%"},oe="stack",re=15,ne={message:{"align-items":"center",display:"flex","justify-content":"center","text-align":"center"}};var ie={breakpoint:ee,iconColumnStyle:te,responsiveLayout:oe,rows:re,styles:ne};const de={style:{padding:0,width:"80vw"}},le={style:{width:"60vw"}};var Z={dialog:de,warningDialog:le};const ce={advancedDayDropdown:{width:"100px"},calendarInput:{width:"75%"},cardContainer:{width:"100%"},intervalInput:{"min-width":"200px"},timePicker:{"border-color":"transparent",height:"40px"}},se=[{label:"managers.scheduler.singleExecution",value:"single"},{label:"managers.scheduler.schedulerExecution",value:"scheduler"},{label:"managers.scheduler.eventExecution",value:"event"}];var pe={style:ce,types:se};const be=z({name:"scheduler-timing-output-timing-tab",components:{Calendar:na,Dropdown:B,KnCron:da,RadioButton:ia},props:{propTrigger:{type:Object},datasets:{type:Array}},emits:["cronValid"],data(){return{schedulerTimingOutputTimingTabDescriptor:pe,trigger:null,triggerType:"single",eventTypes:[{value:"rest",label:this.$t("managers.scheduler.restService")},{value:"contextbroker",label:this.$t("managers.scheduler.contextBroker")},{value:"dataset",label:this.$t("common.dataset")}],selectedDataset:null,validCron:!0,descriptionDirty:!1}},watch:{propTrigger(){this.loadTrigger()}},computed:{validDates(){let a=!0;const e=new Date;return this.trigger.endDateTiming&&this.trigger.endDateTiming.valueOf()<e.valueOf()&&(a=!1),this.trigger.endDateTiming&&this.trigger.endDateTiming.valueOf()<this.trigger.startTimeTiming.valueOf()&&(a=!1),this.$emit("cronValid",a),a}},created(){this.loadTrigger()},methods:{loadTrigger(){var a;this.trigger=this.propTrigger,this.trigger.triggerDescription=this.trigger.triggerName,this.setTriggerType(),this.setTriggerDates(),this.triggerType==="scheduler"&&this.setCronFrequency(),(a=this.trigger.chrono.parameter)!=null&&a.dataset&&(this.trigger.chrono.parameter.dataset=+this.trigger.chrono.parameter.dataset)},setTriggerType(){switch(this.trigger.chrono.type){case"single":this.triggerType="single";break;case"event":this.triggerType="event";break;default:this.triggerType="scheduler"}},setTriggerDates(){this.trigger.startDateTiming=this.trigger.zonedStartTime?new Date(this.trigger.zonedStartTime):new Date,this.trigger.startTimeTiming=this.trigger.zonedStartTime?new Date(this.trigger.zonedStartTime):new Date,this.trigger.startDateTiming.setHours(0),this.trigger.startDateTiming.setMinutes(0),this.trigger.zonedStartTime||(this.trigger.zonedStartTime=this.trigger.startTimeTiming),this.trigger.endDateTiming=this.trigger.zonedEndTime?new Date(this.trigger.zonedEndTime):null,this.trigger.endTimeTiming=this.trigger.zonedEndTime?new Date(this.trigger.zonedEndTime):null,this.trigger.endTimeTiming&&(this.trigger.endDateTiming.setHours(0),this.trigger.endDateTiming.setMinutes(0)),this.trigger.zonedEndTime||(this.trigger.zonedEndTime=this.trigger.endTimeTiming)},setCronFrequency(){const a=this.trigger.zonedStartTime?new Date(this.trigger.zonedStartTime):new Date,e=this.trigger.zonedEndTime?new Date(this.trigger.zonedEndTime):null;this.trigger.frequency={cron:this.trigger.chrono,startDate:a.valueOf(),startTime:a.getHours()+":"+a.getMinutes(),endDate:e?e.valueOf():null,endTime:e?e.getHours()+":"+e.getMinutes():""}},formatFrequency(){switch(this.trigger.chrono={type:this.triggerType,parameter:{type:""}},this.trigger.chrono.type){case"single":delete this.trigger.endDateTiming,delete this.trigger.endTimeTiming;break;case"scheduler":this.setCronFrequency()}},setCronValid(a){this.validCron=a},setTriggerName(){this.descriptionDirty=!0,this.trigger.triggerName=this.trigger.triggerDescription.substring(0,100)},setStartDate(){var a,e;this.trigger.zonedStartTime=this.trigger.startDateTiming,this.trigger.zonedStartTime instanceof Date&&this.trigger.startTimeTiming instanceof Date&&(this.trigger.zonedStartTime.setHours((a=this.trigger.startTimeTiming)==null?void 0:a.getHours()),this.trigger.zonedStartTime.setMinutes((e=this.trigger.startTimeTiming)==null?void 0:e.getMinutes()))},setEndDate(){this.trigger.zonedEndTime=this.trigger.endDateTiming,this.trigger.zonedEndTime instanceof Date&&this.trigger.endTimeTiming instanceof Date&&(this.trigger.zonedEndTime.setHours(this.trigger.endTimeTiming.getHours()),this.trigger.zonedEndTime.setMinutes(this.trigger.endTimeTiming.getMinutes()))}}}),ke={key:0,class:"p-d-flex p-flex-row"},ue={class:"kn-flex p-m-4"},me={class:"kn-material-input-label"},ge={class:"p-d-flex p-flex-row kn-flex p-jc-around p-ai-center"},ve=["for"],fe={class:"p-mt-4"},he={key:0,class:"p-d-flex p-flex-row p-m-4"},we={class:"p-d-flex p-ai-center p-m-2","data-test":"single-execution-trigger"},xe={class:"p-col-5"},ye={for:"startDateTiming",class:"kn-material-input-label"},Me={key:0,class:"p-error p-grid"},Ae={class:"p-col-12"},Ce={class:"p-col-7 p-d-flex p-ai-center"},De={for:"startTime",class:"kn-material-input-label p-m-2"},$e={key:0,class:"p-d-flex p-ai-center p-m-2","data-test":"event-trigger-endDate"},Ee={class:"p-col-5"},ze={for:"endDateTiming",class:"kn-material-input-label"},Te={key:0,class:"p-error p-grid"},Se={class:"p-col-12"},Ie={class:"p-col-7 p-d-flex p-ai-center"},Ne={for:"endTime",class:"kn-material-input-label p-m-2"},Ve={key:1,class:"p-my-4","data-test":"event-trigger"},je={class:"p-m-4"},Le={class:"kn-material-input-label"},Fe={key:0},Ue={class:"p-d-flex p-flex-row"},Oe={class:"kn-flex p-m-4"},Pe={class:"kn-material-input-label"},_e={class:"kn-flex p-m-4"},Be={class:"kn-material-input-label"},Re={key:2,"data-test":"scheduler-trigger"};function Xe(a,e,r,c,g,h){const s=d("InputText"),f=d("RadioButton"),v=d("Toolbar"),p=d("Calendar"),w=d("Dropdown"),M=d("KnCron");return i(),b(j,null,[a.trigger?(i(),b("div",ke,[t("div",ue,[t("span",null,[t("label",me,o(a.$t("managers.scheduler.timingDescription"))+" *",1),n(s,{class:I(["kn-material-input p-inputtext-sm",{"p-invalid":a.descriptionDirty&&(!a.trigger.triggerDescription||a.trigger.triggerDescription.length===0)}]),modelValue:a.trigger.triggerDescription,"onUpdate:modelValue":e[0]||(e[0]=k=>a.trigger.triggerDescription=k),maxLength:500,onInput:a.setTriggerName,onBlur:e[1]||(e[1]=k=>a.descriptionDirty=!0)},null,8,["modelValue","class","onInput"]),t("div",null,[S(t("div",{class:"p-error p-grid p-m-2"},o(a.$t("common.validation.required",{fieldName:a.$t("managers.scheduler.timingDescription")})),513),[[V,a.descriptionDirty&&(!a.trigger.triggerDescription||a.trigger.triggerDescription.length===0)]])])])]),t("div",ge,[(i(!0),b(j,null,X(a.schedulerTimingOutputTimingTabDescriptor.types,k=>(i(),b("div",{key:k.value},[n(f,{id:k.value,name:"type",value:k.value,class:"p-mr-2",modelValue:a.triggerType,"onUpdate:modelValue":e[2]||(e[2]=C=>a.triggerType=C),onChange:a.formatFrequency,"data-test":"trigger-type-button-"+k.value},null,8,["id","value","modelValue","onChange","data-test"]),t("label",{for:k.value,class:"kn-material-input-label"},o(a.$t(k.label)),9,ve)]))),128))])])):u("",!0),t("div",fe,[n(v,{class:"kn-toolbar kn-toolbar--secondary"},{start:l(()=>[A(o(a.$t("managers.scheduler.timeWindow")),1)]),_:1}),a.triggerType!=="scheduler"?(i(),b("div",he,[t("div",we,[t("div",xe,[t("span",null,[t("label",ye,o(a.$t("cron.startDate")+":"),1),n(p,{id:"startDateTiming",class:"kn-material-input custom-timepicker",style:N(a.schedulerTimingOutputTimingTabDescriptor.style.calendarInput),modelValue:a.trigger.startDateTiming,"onUpdate:modelValue":e[3]||(e[3]=k=>a.trigger.startDateTiming=k),showIcon:!0,manualInput:!0,onChange:a.setStartDate,onDateSelect:a.setStartDate},null,8,["style","modelValue","onChange","onDateSelect"])]),a.validDates?u("",!0):(i(),b("div",Me,[t("small",Ae,o(a.$t("managers.scheduler.dateError")),1)]))]),t("div",Ce,[t("label",De,o(a.$t("cron.startTime")+":"),1),t("span",null,[n(p,{id:"startTime",class:"kn-material-input custom-timepicker",style:N(a.schedulerTimingOutputTimingTabDescriptor.style.timePicker),modelValue:a.trigger.startTimeTiming,"onUpdate:modelValue":e[4]||(e[4]=k=>a.trigger.startTimeTiming=k),showTime:!0,manualInput:!0,timeOnly:!0,hourFormat:"24",onChange:a.setStartDate,onDateSelect:a.setStartDate},null,8,["style","modelValue","onChange","onDateSelect"])])])]),a.triggerType==="event"?(i(),b("div",$e,[t("div",Ee,[t("span",null,[t("label",ze,o(a.$t("cron.endDate")+":"),1),n(p,{id:"endDateTiming",class:"kn-material-input custom-timepicker",style:N(a.schedulerTimingOutputTimingTabDescriptor.style.calendarInput),modelValue:a.trigger.endDateTiming,"onUpdate:modelValue":e[5]||(e[5]=k=>a.trigger.endDateTiming=k),showIcon:!0,manualInput:!0,onChange:a.setEndDate,onDateSelect:a.setEndDate},null,8,["style","modelValue","onChange","onDateSelect"])]),a.validDates?u("",!0):(i(),b("div",Te,[t("small",Se,o(a.$t("managers.scheduler.dateError")),1)]))]),t("div",Ie,[t("label",Ne,o(a.$t("cron.endTime")+":"),1),t("span",null,[n(p,{id:"endTime",class:"kn-material-input custom-timepicker",style:N(a.schedulerTimingOutputTimingTabDescriptor.style.timePicker),modelValue:a.trigger.endTimeTiming,"onUpdate:modelValue":e[6]||(e[6]=k=>a.trigger.endTimeTiming=k),showTime:!0,manualInput:!0,timeOnly:!0,hourFormat:"24",onChange:a.setEndDate,onDateSelect:a.setEndDate},null,8,["style","modelValue","onChange","onDateSelect"])])])])):u("",!0)])):u("",!0),a.triggerType==="event"?(i(),b("div",Ve,[n(v,{class:"kn-toolbar kn-toolbar--secondary"},{start:l(()=>[A(o(a.$t("common.details")),1)]),_:1}),t("div",je,[t("span",null,[t("label",Le,o(a.$t("managers.scheduler.eventType")),1),n(w,{class:"kn-material-input",modelValue:a.trigger.chrono.parameter.type,"onUpdate:modelValue":e[7]||(e[7]=k=>a.trigger.chrono.parameter.type=k),options:a.eventTypes,optionLabel:"label",optionValue:"value"},null,8,["modelValue","options"])])]),a.trigger.chrono.parameter&&a.trigger.chrono.parameter.type==="dataset"?(i(),b("div",Fe,[n(v,{class:"kn-toolbar kn-toolbar--secondary"},{start:l(()=>[A(o(a.$t("common.dataset")),1)]),_:1}),t("div",Ue,[t("div",Oe,[t("span",null,[t("label",Pe,o(a.$t("managers.scheduler.datasetVerification")),1),n(w,{class:"kn-material-input",modelValue:a.trigger.chrono.parameter.dataset,"onUpdate:modelValue":e[8]||(e[8]=k=>a.trigger.chrono.parameter.dataset=k),options:a.datasets,optionLabel:"label",optionValue:"id.dsId",filter:!0,filterMatchMode:"contains",filterFields:["label"]},null,8,["modelValue","options"])])]),t("div",_e,[t("span",null,[t("label",Be,o(a.$t("managers.scheduler.frequencyMinutes")),1),n(s,{class:"kn-material-input p-inputtext-sm",type:"number",modelValue:a.trigger.chrono.parameter.frequency,"onUpdate:modelValue":e[9]||(e[9]=k=>a.trigger.chrono.parameter.frequency=k)},null,8,["modelValue"])])])])])):u("",!0)])):u("",!0),a.triggerType==="scheduler"?(i(),b("div",Re,[a.trigger&&a.trigger.frequency?(i(),y(M,{key:0,frequency:a.trigger.frequency,onCronValid:e[10]||(e[10]=k=>a.setCronValid(k))},null,8,["frequency"])):u("",!0)])):u("",!0)])],64)}var Je=T(be,[["render",Xe]]);const Qe={document:{descriptionMaxLength:100,nameMaxLength:100},file:{destinationFolderMaxLength:100,nameMaxLength:100,zipFileNameMaxLength:100},javaClass:{classPathMaxLength:100},mail:{expressionMaxLength:100,fileNameMaxLength:100,mailSubjectMaxLength:100,mailTextMaxLength:2e3,mailToMaxLength:1e3,zipMailNameMaxLength:100},snapshot:{descriptionMaxLength:100,nameMaxLength:100}},Ye={message:{"align-items":"center",display:"flex","justify-content":"center","text-align":"center"}};var E={accordion:Qe,styles:Ye};const qe=z({name:"scheduler-snapshot-accordion",components:{Accordion:P,AccordionTab:_},props:{propDocument:{type:Object}},data(){return{schedulerTimingOutputOutputTabDescriptor:E,document:null,snapshotNameDirty:!1}},computed:{nameHelp(){var a,e;return((e=(a=this.document.snapshotname)==null?void 0:a.length)!=null?e:"0")+" / "+E.accordion.snapshot.nameMaxLength},descriptionHelp(){var a,e;return((e=(a=this.document.snapshotdescription)==null?void 0:a.length)!=null?e:"0")+" / "+E.accordion.snapshot.descriptionMaxLength}},watch:{propDocument(){this.loadDocument()}},created(){this.loadDocument()},methods:{loadDocument(){this.document=this.propDocument,this.document.invalid.invalidSnapshot=!1,this.validateDocument()},setNameValidation(){this.snapshotNameDirty=!0,this.validateDocument()},validateDocument(){this.document.invalid.invalidSnapshot=!this.document.snapshotname||this.document.snapshotname.length===0}}}),He=a=>(F("data-v-2aff20c7"),a=a(),U(),a),Ge=He(()=>t("i",{class:"fa fa-camera"},null,-1)),Ke={class:"p-m-2"},Ze={key:0,class:"pi pi-exclamation-triangle kn-warning-icon","data-test":"warning-icon"},We={key:0},at={class:"p-d-flex p-flex-row"},et={id:"snapshot-name-container",class:"p-m-2"},tt={class:"kn-material-input-label"},ot={class:"p-d-flex p-flex-row p-jc-between"},rt={class:"name-help p-m-0"},nt={class:"p-m-2"},it={class:"kn-material-input-label"},dt={class:"p-m-2"},lt={class:"kn-material-input-label"},ct={class:"p-d-flex p-jc-end"};function st(a,e,r,c,g,h){const s=d("InputText"),f=d("AccordionTab"),v=d("Accordion");return i(),y(v,{activeIndex:0},{default:l(()=>[n(f,null,{header:l(()=>{var p;return[Ge,t("span",Ke,o(a.$t("managers.scheduler.saveAsSnapshot")),1),(p=a.document.invalid)!=null&&p.invalidSnapshot?(i(),b("i",Ze)):u("",!0)]}),default:l(()=>[a.document?(i(),b("div",We,[t("div",at,[t("div",et,[t("span",null,[t("label",tt,o(a.$t("common.name"))+" *",1),n(s,{class:I(["kn-material-input",{"p-invalid":a.snapshotNameDirty&&(!a.document.snapshotname||a.document.snapshotname.length===0)}]),modelValue:a.document.snapshotname,"onUpdate:modelValue":e[0]||(e[0]=p=>a.document.snapshotname=p),maxLength:a.schedulerTimingOutputOutputTabDescriptor.accordion.snapshot.nameMaxLength,onInput:a.setNameValidation,onBlur:a.setNameValidation},null,8,["modelValue","class","maxLength","onInput","onBlur"])]),t("div",ot,[t("div",null,[S(t("div",{class:"p-error p-grid p-m-2"},o(a.$t("common.validation.required",{fieldName:a.$t("common.name")})),513),[[V,a.snapshotNameDirty&&(!a.document.snapshotname||a.document.snapshotname.length===0)]])]),t("p",rt,o(a.nameHelp),1)])]),t("div",nt,[t("span",null,[t("label",it,o(a.$t("managers.scheduler.historyLength")),1),n(s,{class:"kn-material-input",type:"number",modelValue:a.document.snapshothistorylength,"onUpdate:modelValue":e[1]||(e[1]=p=>a.document.snapshothistorylength=p)},null,8,["modelValue"])])])]),t("div",dt,[t("span",null,[t("label",lt,o(a.$t("common.description")),1),n(s,{class:"kn-material-input",modelValue:a.document.snapshotdescription,"onUpdate:modelValue":e[2]||(e[2]=p=>a.document.snapshotdescription=p),maxLength:a.schedulerTimingOutputOutputTabDescriptor.accordion.snapshot.descriptionMaxLength},null,8,["modelValue","maxLength"])]),t("div",ct,[t("small",null,o(a.descriptionHelp),1)])])])):u("",!0)]),_:1})]),_:1})}var pt=T(qe,[["render",st],["__scopeId","data-v-2aff20c7"]]);const bt=z({name:"scheduler-file-accordion",components:{Accordion:P,AccordionTab:_,Checkbox:O},props:{propDocument:{type:Object},functionalities:{type:Array},datasets:{type:Array},jobInfo:{type:Object}},data(){return{schedulerTimingOutputOutputTabDescriptor:E,document:null,fileNameDirty:!1}},computed:{fileNameHelp(){var a,e;return((e=(a=this.document.fileName)==null?void 0:a.length)!=null?e:"0")+" / "+E.accordion.file.nameMaxLength},destinationFolderHelp(){var a,e;return((e=(a=this.document.destinationfolder)==null?void 0:a.length)!=null?e:"0")+" / "+E.accordion.file.destinationFolderMaxLength},zipFileNameHelp(){var a,e;return((e=(a=this.document.zipFileName)==null?void 0:a.length)!=null?e:"0")+" / "+E.accordion.file.zipFileNameMaxLength}},watch:{propDocument(){this.loadDocument()}},created(){this.loadDocument()},methods:{loadDocument(){this.document=this.propDocument,this.document.invalid.invalidFile=!1,this.validateDocument()},setFileNameValidation(){this.fileNameDirty=!0,this.validateDocument()},validateDocument(){this.document.invalid.invalidFile=!this.document.fileName||this.document.fileName.length===0}}}),kt=a=>(F("data-v-220d3a12"),a=a(),U(),a),ut=kt(()=>t("i",{class:"pi pi-file"},null,-1)),mt={class:"p-m-2"},gt={key:0,class:"pi pi-exclamation-triangle kn-warning-icon","data-test":"warning-icon"},vt={key:0},ft={class:"p-m-2"},ht={class:"kn-material-input-label"},wt={class:"p-d-flex p-flex-row p-jc-between"},xt={class:"name-help p-m-0"},yt={class:"p-m-2"},Mt={class:"kn-material-input-label"},At={class:"p-d-flex p-jc-end"},Ct={class:"p-m-2"},Dt={class:"p-ml-2"},$t={key:0,class:"kn-flex p-mx-2 p-my-4"},Et={class:"kn-material-input-label"},zt={class:"p-d-flex p-jc-end"};function Tt(a,e,r,c,g,h){const s=d("InputText"),f=d("Checkbox"),v=d("AccordionTab"),p=d("Accordion");return i(),y(p,{activeIndex:0},{default:l(()=>[n(v,null,{header:l(()=>{var w;return[ut,t("span",mt,o(a.$t("managers.scheduler.saveAsFile")),1),(w=a.document.invalid)!=null&&w.invalidFile?(i(),b("i",gt)):u("",!0)]}),default:l(()=>[a.document?(i(),b("div",vt,[t("div",ft,[t("span",null,[t("label",ht,o(a.$t("common.fileName"))+" *",1),n(s,{class:I(["kn-material-input p-inputtext-sm",{"p-invalid":a.fileNameDirty&&(!a.document.fileName||a.document.fileName.length===0)}]),modelValue:a.document.fileName,"onUpdate:modelValue":e[0]||(e[0]=w=>a.document.fileName=w),maxLength:a.schedulerTimingOutputOutputTabDescriptor.accordion.file.nameMaxLength,onInput:a.setFileNameValidation,onBlur:a.setFileNameValidation},null,8,["modelValue","class","maxLength","onInput","onBlur"])]),t("div",wt,[t("div",null,[S(t("div",{class:"p-error p-grid p-m-2"},o(a.$t("common.validation.required",{fieldName:a.$t("common.fileName")})),513),[[V,a.fileNameDirty&&(!a.document.fileName||a.document.fileName.length===0)]])]),t("p",xt,o(a.fileNameHelp),1)])]),t("div",yt,[t("span",null,[t("label",Mt,o(a.$t("managers.scheduler.destinationFolder")),1),n(s,{class:"kn-material-input p-inputtext-sm",modelValue:a.document.destinationfolder,"onUpdate:modelValue":e[1]||(e[1]=w=>a.document.destinationfolder=w),maxLength:a.schedulerTimingOutputOutputTabDescriptor.accordion.file.destinationFolderMaxLength},null,8,["modelValue","maxLength"])]),t("div",At,[t("small",null,o(a.destinationFolderHelp),1)])]),t("div",Ct,[n(f,{modelValue:a.document.zipFileDocument,"onUpdate:modelValue":e[2]||(e[2]=w=>a.document.zipFileDocument=w),binary:!0},null,8,["modelValue"]),t("span",Dt,o(a.$t("managers.scheduler.zipFileDocument")),1)]),a.document.zipFileDocument?(i(),b("div",$t,[t("span",null,[t("label",Et,o(a.$t("managers.scheduler.zipFileName")),1),n(s,{class:"kn-material-input p-inputtext-sm",modelValue:a.document.zipFileName,"onUpdate:modelValue":e[3]||(e[3]=w=>a.document.zipFileName=w),maxLength:a.schedulerTimingOutputOutputTabDescriptor.accordion.file.zipFileNameMaxLength},null,8,["modelValue","maxLength"])]),t("div",zt,[t("small",null,o(a.zipFileNameHelp),1)])])):u("",!0)])):u("",!0)]),_:1})]),_:1})}var St=T(bt,[["render",Tt],["__scopeId","data-v-220d3a12"]]);const It={style:{padding:"0"}};var Nt={node:It};const Vt=z({name:"scheduler-document-accordion-tree",components:{Checkbox:O,Tree:K},props:{propFunctionalities:{type:Array},propSelectedFolders:{type:Array}},data(){return{schedulerDocumentAccordionTreeDescriptor:Nt,functionalities:[],selectedFolders:[],nodes:[],expandedKeys:{}}},watch:{propFunctionalities(){this.loadFunctionalities(),this.createNodeTree(),this.expandAll()},propSelectedFolders(){this.loadSelectedFolders()}},created(){this.loadFunctionalities(),this.createNodeTree(),this.expandAll(),this.loadSelectedFolders()},methods:{loadFunctionalities(){this.functionalities=this.propFunctionalities},loadSelectedFolders(){this.selectedFolders=this.propSelectedFolders?[...this.propSelectedFolders]:[]},createNodeTree(){this.nodes=this.formatFunctionality(this.functionalities)},formatFunctionality(a){return a.map(e=>(e={key:e.id,id:e.id,label:e.name,children:e.childs,data:e,style:this.schedulerDocumentAccordionTreeDescriptor.node.style,customIcon:e.childs?"pi pi-folder-open":"pi pi-folder"},e.children&&e.children.length>0&&(e.children=this.formatFunctionality(e.children)),e))},expandAll(){for(let a of this.nodes)this.expandNode(a);this.expandedKeys={...this.expandedKeys}},expandNode(a){if(a.children&&a.children.length){this.expandedKeys[a.key]=!0;for(let e of a.children)this.expandNode(e)}},setOpenFolderIcon(a){a.customIcon="pi pi-folder-open"},setClosedFolderIcon(a){a.customIcon="pi pi-folder"},emitSelectedFolders(){this.$emit("selected",this.selectedFolders)}}}),jt={class:"kn-material-input-label"};function Lt(a,e,r,c,g,h){const s=d("Checkbox"),f=d("Tree");return i(),b("div",null,[t("label",jt,o(a.$t("managers.scheduler.documentsTree")),1),n(f,{class:"documents-tree p-mt-2",value:a.nodes,expandedKeys:a.expandedKeys,onNodeExpand:e[1]||(e[1]=v=>a.setOpenFolderIcon(v)),onNodeCollapse:e[2]||(e[2]=v=>a.setClosedFolderIcon(v))},{default:l(v=>[t("i",{class:I(v.node.customIcon)},null,2),n(s,{class:"p-ml-2",name:"folders",modelValue:a.selectedFolders,"onUpdate:modelValue":e[0]||(e[0]=p=>a.selectedFolders=p),value:v.node.id,onChange:a.emitSelectedFolders},null,8,["modelValue","value","onChange"]),t("b",null,o(v.node.label),1)]),_:1},8,["value","expandedKeys"])])}var Ft=T(Vt,[["render",Lt],["__scopeId","data-v-4259d2a8"]]);const Ut=z({name:"scheduler-document-accordion",components:{Accordion:P,AccordionTab:_,Checkbox:O,Dropdown:B,SchedulerDocumentAccordionTree:Ft},props:{propDocument:{type:Object},functionalities:{type:Array},datasets:{type:Array},jobInfo:{type:Object}},data(){return{schedulerTimingOutputOutputTabDescriptor:E,document:null,drivers:[],documentNameDirty:!1,datasetFolderLabelDrity:!1,datasetFolderParameterDirty:!1}},computed:{nameHelp(){var a,e;return((e=(a=this.document.documentname)==null?void 0:a.length)!=null?e:"0")+" / "+E.accordion.document.nameMaxLength},descriptionHelp(){var a,e;return((e=(a=this.document.documentdescription)==null?void 0:a.length)!=null?e:"0")+" / "+E.accordion.document.descriptionMaxLength}},watch:{propDocument(){this.loadDocument(),this.loadDrivers()}},created(){this.loadDocument(),this.loadDrivers()},methods:{loadDocument(){this.document=this.propDocument,this.document.invalid.invalidDocument=!1,this.validateDocument(null)},loadDrivers(){var e,r;const a=(e=this.jobInfo)==null?void 0:e.documents.findIndex(c=>c.label===this.document.label);a!==-1&&(this.drivers=(r=this.jobInfo)==null?void 0:r.documents[a].parameters)},setSelectedFolders(a){this.document.funct=a,this.validateDocument(null)},validateDocument(a){var g,h,s;a&&(this[a]=!0);const e=!this.document.documentname||this.document.documentname.length===0,r=this.document.useFolderDataset&&(!this.document.datasetFolderLabel||((g=this.document.datasetFolderLabel)==null?void 0:g.length)===0||!this.document.datasetFolderParameter||((h=this.document.datasetFolderParameter)==null?void 0:h.length)===0),c=this.document.useFixedFolder&&(!this.document.funct||((s=this.document.funct)==null?void 0:s.length)===0);this.document.invalid.invalidDocument=e||r||c}}}),Ot=a=>(F("data-v-310a37e6"),a=a(),U(),a),Pt=Ot(()=>t("i",{class:"fa fa-file"},null,-1)),_t={class:"p-m-2"},Bt={key:0,class:"pi pi-exclamation-triangle kn-warning-icon","data-test":"warning-icon"},Rt={key:0},Xt={class:"p-m-2"},Jt={class:"kn-material-input-label"},Qt={class:"p-d-flex p-flex-row p-jc-between"},Yt={class:"name-help p-m-0"},qt={class:"p-m-2"},Ht={class:"kn-material-input-label"},Gt={class:"p-d-flex p-jc-end"},Kt={class:"p-m-2"},Zt={class:"p-ml-2"},Wt={key:0,class:"p-mt-4"},ao={key:1,class:"p-m-2"},eo={class:"p-my-4"},to={class:"p-ml-2"},oo={key:2,class:"p-mt-4"},ro={class:"p-m-2"},no={class:"kn-material-input-label"},io={key:0,class:"p-error p-grid p-m-2"},lo={class:"p-m-2"},co={class:"kn-material-input-label"},so={key:0,class:"p-error p-grid p-m-2"};function po(a,e,r,c,g,h){const s=d("InputText"),f=d("Checkbox"),v=d("SchedulerDocumentAccordionTree"),p=d("Dropdown"),w=d("AccordionTab"),M=d("Accordion"),k=J("tooltip");return i(),y(M,{activeIndex:0},{default:l(()=>[n(w,null,{header:l(()=>{var C;return[Pt,t("span",_t,o(a.$t("managers.scheduler.saveAsDocument")),1),(C=a.document.invalid)!=null&&C.invalidDocument?(i(),b("i",Bt)):u("",!0)]}),default:l(()=>{var C,x,$,m;return[a.document?(i(),b("div",Rt,[t("div",Xt,[t("span",null,[t("label",Jt,o(a.$t("common.name"))+" *",1),n(s,{class:I(["kn-material-input",{"p-invalid":a.documentNameDirty&&(!a.document.documentname||a.document.documentname.length===0)}]),modelValue:a.document.documentname,"onUpdate:modelValue":e[0]||(e[0]=D=>a.document.documentname=D),maxLength:a.schedulerTimingOutputOutputTabDescriptor.accordion.document.nameMaxLength,onInput:e[1]||(e[1]=D=>a.validateDocument("documentNameDirty")),onBlur:e[2]||(e[2]=D=>a.validateDocument("documentNameDirty"))},null,8,["modelValue","class","maxLength"])]),t("div",Qt,[t("div",null,[S(t("div",{class:"p-error p-grid p-m-2"},o(a.$t("common.validation.required",{fieldName:a.$t("common.name")})),513),[[V,a.documentNameDirty&&(!a.document.documentname||a.document.documentname.length===0)]])]),t("p",Yt,o(a.nameHelp),1)])]),t("div",qt,[t("span",null,[t("label",Ht,o(a.$t("common.description")),1),n(s,{class:"kn-material-input",modelValue:a.document.documentdescription,"onUpdate:modelValue":e[3]||(e[3]=D=>a.document.documentdescription=D),maxLength:a.schedulerTimingOutputOutputTabDescriptor.accordion.document.descriptionMaxLength},null,8,["modelValue","maxLength"])]),t("div",Gt,[t("small",null,o(a.descriptionHelp),1)])]),t("div",Kt,[n(f,{modelValue:a.document.useFixedFolder,"onUpdate:modelValue":e[4]||(e[4]=D=>a.document.useFixedFolder=D),binary:!0,onChange:a.validateDocument},null,8,["modelValue","onChange"]),t("span",Zt,o(a.$t("managers.scheduler.fixedFolder")),1)]),a.document.useFixedFolder?(i(),b("div",Wt,[n(v,{propFunctionalities:a.functionalities,propSelectedFolders:a.document.funct,onSelected:a.setSelectedFolders},null,8,["propFunctionalities","propSelectedFolders","onSelected"])])):u("",!0),a.drivers.length>0?(i(),b("div",ao,[S((i(),b("div",eo,[n(f,{modelValue:a.document.useFolderDataset,"onUpdate:modelValue":e[5]||(e[5]=D=>a.document.useFolderDataset=D),binary:!0},null,8,["modelValue"]),t("span",to,o(a.$t("managers.scheduler.folderFromDataset")),1)])),[[k,`${a.$t("managers.scheduler.useFolderDatasetHint.partOne")}:
                            ${a.$t("managers.scheduler.useFolderDatasetHint.partTwo")} ${a.$t("managers.scheduler.useFolderDatasetHint.partThree")}`]])])):u("",!0),a.document.useFolderDataset?(i(),b("div",oo,[t("div",ro,[t("span",null,[t("label",no,o(a.$t("managers.scheduler.datasetVerification"))+" *",1),n(p,{class:I(["kn-material-input",{"p-invalid":a.datasetFolderLabelDrity&&(!a.document.datasetFolderLabel||((C=a.document.datasetFolderLabel)==null?void 0:C.length)===0)}]),modelValue:a.document.datasetFolderLabel,"onUpdate:modelValue":e[6]||(e[6]=D=>a.document.datasetFolderLabel=D),options:a.datasets,optionLabel:"label",optionValue:"label",filter:!0,filterMatchMode:"contains",filterFields:["label"],onBlur:e[7]||(e[7]=D=>a.validateDocument("datasetFolderLabelDrity")),onChange:e[8]||(e[8]=D=>a.validateDocument("datasetFolderLabelDrity"))},null,8,["modelValue","options","class"]),a.datasetFolderLabelDrity&&(!a.document.datasetFolderLabel||((x=a.document.datasetFolderLabel)==null?void 0:x.length)===0)?(i(),b("div",io,o(a.$t("common.validation.required",{fieldName:a.$t("managers.scheduler.datasetVerification")})),1)):u("",!0)])]),t("div",lo,[t("span",null,[t("label",co,o(a.$t("common.driver"))+" *",1),n(p,{class:I(["kn-material-input",{"p-invalid":a.datasetFolderParameterDirty&&(!a.document.datasetFolderParameter||(($=a.document.datasetFolderParameter)==null?void 0:$.length)===0)}]),modelValue:a.document.datasetFolderParameter,"onUpdate:modelValue":e[9]||(e[9]=D=>a.document.datasetFolderParameter=D),options:a.drivers,onBlur:e[10]||(e[10]=D=>a.validateDocument("datasetFolderParameterDirty")),onChange:e[11]||(e[11]=D=>a.validateDocument("datasetFolderParameterDirty"))},null,8,["modelValue","options","class"]),a.datasetFolderParameterDirty&&(!a.document.datasetFolderParameter||((m=a.document.datasetFolderParameter)==null?void 0:m.length)===0)?(i(),b("div",so,o(a.$t("common.validation.required",{fieldName:a.$t("common.driver")})),1)):u("",!0)])])])):u("",!0)])):u("",!0)]}),_:1})]),_:1})}var bo=T(Ut,[["render",po],["__scopeId","data-v-310a37e6"]]);const ko=z({name:"scheduler-java-class-accordion",components:{Accordion:P,AccordionTab:_},props:{propDocument:{type:Object},functionalities:{type:Array},datasets:{type:Array},jobInfo:{type:Object}},data(){return{schedulerTimingOutputOutputTabDescriptor:E,document:null,javaClassPathDirty:!1}},computed:{javaClassPathHelp(){var a,e;return((e=(a=this.document.javaclasspath)==null?void 0:a.length)!=null?e:"0")+" / "+E.accordion.javaClass.classPathMaxLength}},watch:{propDocument(){this.loadDocument()}},created(){this.loadDocument()},methods:{loadDocument(){this.document=this.propDocument,this.document.invalid.invalidJavaClass=!1,this.validateDocument()},setJavaClassPathValidation(){this.javaClassPathDirty=!0,this.validateDocument()},validateDocument(){this.document.invalid.invalidJavaClass=!this.document.javaclasspath||this.document.javaclasspath.length===0}}}),uo=a=>(F("data-v-3e92dc01"),a=a(),U(),a),mo=uo(()=>t("i",{class:"fab fa-java"},null,-1)),go={class:"p-m-2"},vo={key:0,class:"pi pi-exclamation-triangle kn-warning-icon","data-test":"warning-icon"},fo={key:0},ho={class:"p-m-2"},wo={class:"kn-material-input-label"},xo={class:"p-d-flex p-flex-row p-jc-between"},yo={class:"name-help p-m-0"};function Mo(a,e,r,c,g,h){const s=d("InputText"),f=d("AccordionTab"),v=d("Accordion");return i(),y(v,{activeIndex:0},{default:l(()=>[n(f,null,{header:l(()=>[mo,t("span",go,o(a.$t("managers.scheduler.sendToJavaClass")),1),a.document.invalid.invalidJavaClass?(i(),b("i",vo)):u("",!0)]),default:l(()=>[a.document?(i(),b("div",fo,[t("div",ho,[t("span",null,[t("label",wo,o(a.$t("managers.scheduler.classPath"))+" *",1),n(s,{class:I(["kn-material-input",{"p-invalid":a.javaClassPathDirty&&(!a.document.javaclasspath||a.document.javaclasspath.length===0)}]),modelValue:a.document.javaclasspath,"onUpdate:modelValue":e[0]||(e[0]=p=>a.document.javaclasspath=p),maxLength:a.schedulerTimingOutputOutputTabDescriptor.accordion.javaClass.classPathMaxLength,onInput:a.setJavaClassPathValidation,onBlur:a.setJavaClassPathValidation},null,8,["modelValue","class","maxLength","onInput","onBlur"])]),t("div",xo,[t("div",null,[S(t("div",{class:"p-error p-grid p-m-2"},o(a.$t("common.validation.required",{fieldName:a.$t("managers.scheduler.classPath")})),513),[[V,a.javaClassPathDirty&&(!a.document.javaclasspath||a.document.javaclasspath.length===0)]])]),t("p",yo,o(a.javaClassPathHelp),1)])])])):u("",!0)]),_:1})]),_:1})}var Ao=T(ko,[["render",Mo],["__scopeId","data-v-3e92dc01"]]);const Co=z({name:"scheduler-mail-accordion",components:{Accordion:P,AccordionTab:_,Checkbox:O,Dropdown:B},props:{propDocument:{type:Object},functionalities:{type:Array},datasets:{type:Array},jobInfo:{type:Object}},data(){return{schedulerTimingOutputOutputTabDescriptor:E,document:null,drivers:[],subjectDirty:!1,mailTextDirty:!1,fixedRecipientsListDirty:!1,expressionDirty:!1,datasetLabelDirty:!1,datasetParameterDirty:!1}},computed:{mailToHelp(){var a,e;return((e=(a=this.document.mailtos)==null?void 0:a.length)!=null?e:"0")+" / "+E.accordion.mail.mailToMaxLength},expresionHelp(){var a,e;return((e=(a=this.document.expression)==null?void 0:a.length)!=null?e:"0")+" / "+E.accordion.mail.expressionMaxLength},zipMailNameHelp(){var a,e;return((e=(a=this.document.zipMailName)==null?void 0:a.length)!=null?e:"0")+" / "+E.accordion.mail.zipMailNameMaxLength},mailSubjectHelp(){var a,e;return((e=(a=this.document.mailsubj)==null?void 0:a.length)!=null?e:"0")+" / "+E.accordion.mail.mailSubjectMaxLength},fileNameHelp(){var a,e;return((e=(a=this.document.containedFileName)==null?void 0:a.length)!=null?e:"0")+" / "+E.accordion.mail.fileNameMaxLength},mailTextHelp(){var a,e;return((e=(a=this.document.mailtxt)==null?void 0:a.length)!=null?e:"0")+" / "+E.accordion.mail.mailTextMaxLength}},watch:{propDocument(){this.loadData()}},created(){this.loadData()},methods:{loadData(){this.loadDocument(),this.loadDrivers()},loadDocument(){this.document=this.propDocument,!this.document.useFixedRecipients&&!this.document.useExpression&&!this.document.useDataset&&(this.document.useFixedRecipients=!0),this.document.invalid.invalidMail=!1,this.validateDocument(null)},loadDrivers(){var e,r;const a=(e=this.jobInfo)==null?void 0:e.documents.findIndex(c=>c.label===this.document.label);a!==-1&&(this.drivers=(r=this.jobInfo)==null?void 0:r.documents[a].parameters)},removeDocumentExpressionAndDatasets(){this.validateDocument(null),this.document.useFixedRecipients&&(this.resetExpression(),this.resetFolderDataset())},removeDocumentFixedRecipientsAndDatasets(){this.validateDocument(null),this.document.useExpression&&(this.resetFixedRecipients(),this.resetFolderDataset())},removeDocumentFixedRecipientsAndExpression(){this.validateDocument(null),this.document.useDataset&&(this.resetFixedRecipients(),this.resetExpression())},resetFixedRecipients(){this.document.useFixedRecipients&&(this.document.useFixedRecipients=!1,delete this.document.mailtos)},resetExpression(){this.document.useExpression&&(this.document.useExpression=!1,delete this.document.expression)},resetFolderDataset(){this.document.useDataset&&(this.document.useDataset=!1,delete this.document.useDataset.datasetLabel,delete this.document.useDataset.parameters)},validateDocument(a){var s,f;a&&(this[a]=!0);const e=!this.document.mailsubj||this.document.mailsubj.length===0,r=!this.document.mailtxt||this.document.mailtxt.length===0,c=this.document.useFixedRecipients&&(!this.document.mailtos||this.document.mailtos.length===0),g=this.document.useExpression&&(!this.document.expression||this.document.expression.length===0),h=this.document.useDataset&&(!this.document.datasetLabel||((s=this.document.datasetLabel)==null?void 0:s.length)===0||!this.document.datasetParameter||((f=this.document.datasetParameter)==null?void 0:f.length)===0);this.document.invalid.invalidMail=e||r||c||g||h}}}),Do=a=>(F("data-v-dcdc791c"),a=a(),U(),a),$o=Do(()=>t("i",{class:"fa fa-envelope"},null,-1)),Eo={class:"p-m-4"},zo={key:0,class:"pi pi-exclamation-triangle kn-warning-icon","data-test":"warning-icon"},To={key:0},So={class:"p-m-4"},Io={class:"p-ml-2"},No={key:0,class:"p-m-4"},Vo={class:"kn-material-input-label"},jo={class:"p-d-flex p-flex-row p-jc-between"},Lo={class:"max-length-help p-m-0"},Fo={key:1,class:"p-m-4"},Uo={class:"p-my-4"},Oo=["innerHTML"],Po={key:0},_o={class:"kn-material-input-label"},Bo={class:"p-my-2"},Ro={class:"kn-material-input-label"},Xo={class:"p-m-4"},Jo=["innerHTML"],Qo={key:2,class:"p-m-4"},Yo={class:"kn-material-input-label"},qo={class:"p-d-flex p-flex-row p-jc-between"},Ho={class:"max-length-help p-m-0"},Go={class:"p-m-4"},Ko=["innerHTML"],Zo={class:"p-m-4"},Wo=["innerHTML"],ar={key:3,class:"p-m-4"},er={class:"kn-material-input-label"},tr={class:"p-d-flex p-jc-end"},or={class:"p-m-4"},rr=["innerHTML"],nr={class:"p-m-4"},ir={class:"kn-material-input-label"},dr={class:"p-d-flex p-flex-row p-jc-between"},lr={class:"max-length-help p-m-0"},cr={class:"p-m-4"},sr={class:"kn-material-input-label"},pr={class:"p-d-flex p-jc-end"},br={class:"p-m-4"},kr={class:"kn-material-input-label"},ur={class:"p-d-flex p-flex-row p-jc-between"},mr={class:"max-length-help p-m-0"};function gr(a,e,r,c,g,h){const s=d("Checkbox"),f=d("InputText"),v=d("Dropdown"),p=d("AccordionTab"),w=d("Accordion"),M=J("tooltip");return i(),y(w,{activeIndex:0},{default:l(()=>[n(p,null,{header:l(()=>{var k;return[$o,t("span",Eo,o(a.$t("managers.scheduler.sendMail")),1),(k=a.document.invalid)!=null&&k.invalidMail?(i(),b("i",zo)):u("",!0)]}),default:l(()=>{var k,C,x,$;return[a.document?(i(),b("div",To,[S((i(),b("div",So,[n(s,{modelValue:a.document.useFixedRecipients,"onUpdate:modelValue":e[0]||(e[0]=m=>a.document.useFixedRecipients=m),binary:!0,onChange:a.removeDocumentExpressionAndDatasets},null,8,["modelValue","onChange"]),t("span",Io,o(a.$t("managers.scheduler.fixedRecipientsList")),1)])),[[M,a.$t("managers.scheduler.fixedRecipientsListHelp")]]),a.document.useFixedRecipients?(i(),b("div",No,[t("span",null,[t("label",Vo,o(a.$t("managers.scheduler.mailTo"))+" *",1),n(f,{class:I(["kn-material-input p-inputtext-sm",{"p-invalid":a.fixedRecipientsListDirty&&(!a.document.mailtos||a.document.mailtos.length===0)}]),modelValue:a.document.mailtos,"onUpdate:modelValue":e[1]||(e[1]=m=>a.document.mailtos=m),maxLength:a.schedulerTimingOutputOutputTabDescriptor.accordion.mail.mailToMaxLength,onInput:e[2]||(e[2]=m=>a.validateDocument("fixedRecipientsListDirty")),onBlur:e[3]||(e[3]=m=>a.validateDocument("fixedRecipientsListDirty"))},null,8,["modelValue","class","maxLength"])]),t("div",jo,[t("div",null,[S(t("div",{class:"p-error p-grid p-m-4"},o(a.$t("common.validation.required",{fieldName:a.$t("managers.scheduler.fixedRecipientsList")})),513),[[V,a.fixedRecipientsListDirty&&(!a.document.mailtos||a.document.mailtos.length===0)]])]),t("p",Lo,o(a.mailToHelp),1)])])):u("",!0),a.drivers.length>0?(i(),b("div",Fo,[S((i(),b("div",Uo,[n(s,{modelValue:a.document.useDataset,"onUpdate:modelValue":e[4]||(e[4]=m=>a.document.useDataset=m),binary:!0,onChange:a.removeDocumentFixedRecipientsAndExpression},null,8,["modelValue","onChange"]),t("span",{class:"p-ml-2",innerHTML:a.$t("managers.scheduler.useDatasetList")},null,8,Oo)])),[[M,a.$t("managers.scheduler.useDatasetListHelp")]]),a.document.useDataset?(i(),b("div",Po,[t("div",null,[t("span",null,[t("label",_o,o(a.$t("managers.scheduler.datasetVerification"))+" *",1),n(v,{class:I(["kn-material-input",{"p-invalid":a.datasetLabelDirty&&(!a.document.datasetLabel||((k=a.document.datasetLabel)==null?void 0:k.length)===0)}]),modelValue:a.document.datasetLabel,"onUpdate:modelValue":e[5]||(e[5]=m=>a.document.datasetLabel=m),options:a.datasets,optionLabel:"label",optionValue:"label",filter:!0,filterMatchMode:"contains",filterFields:["label"],onBlur:e[6]||(e[6]=m=>a.validateDocument("datasetLabelDirty")),onChange:e[7]||(e[7]=m=>a.validateDocument("datasetLabelDirty"))},null,8,["modelValue","class","options"]),S(t("div",{class:"p-error p-grid p-m-4"},o(a.$t("common.validation.required",{fieldName:a.$t("managers.scheduler.datasetVerification")})),513),[[V,a.datasetLabelDirty&&(!a.document.datasetLabel||((C=a.document.datasetLabel)==null?void 0:C.length)===0)]])])]),t("div",Bo,[t("span",null,[t("label",Ro,o(a.$t("common.parameter"))+" *",1),n(v,{class:I(["kn-material-input",{"p-invalid":a.datasetParameterDirty&&(!a.document.datasetParameter||((x=a.document.datasetParameter)==null?void 0:x.length)===0)}]),modelValue:a.document.datasetParameter,"onUpdate:modelValue":e[8]||(e[8]=m=>a.document.datasetParameter=m),options:a.drivers,onBlur:e[9]||(e[9]=m=>a.validateDocument("datasetParameterDirty")),onChange:e[10]||(e[10]=m=>a.validateDocument("datasetParameterDirty"))},null,8,["modelValue","class","options"]),S(t("div",{class:"p-error p-grid p-m-4"},o(a.$t("common.validation.required",{fieldName:a.$t("common.parameter")})),513),[[V,a.datasetParameterDirty&&(!a.document.datasetParameter||(($=a.document.datasetParameter)==null?void 0:$.length)===0)]])])])])):u("",!0)])):u("",!0),S((i(),b("div",Xo,[n(s,{modelValue:a.document.useExpression,"onUpdate:modelValue":e[11]||(e[11]=m=>a.document.useExpression=m),binary:!0,onChange:a.removeDocumentFixedRecipientsAndDatasets},null,8,["modelValue","onChange"]),t("span",{class:"p-ml-2",innerHTML:a.$t("managers.scheduler.useExpression")},null,8,Jo)])),[[M,a.$t("managers.scheduler.useExpressionHelp")]]),a.document.useExpression?(i(),b("div",Qo,[t("span",null,[t("label",Yo,o(a.$t("managers.scheduler.expression"))+" *",1),n(f,{class:I(["kn-material-input p-inputtext-sm",{"p-invalid":a.expressionDirty&&(!a.document.expression||a.document.expression.length===0)}]),modelValue:a.document.expression,"onUpdate:modelValue":e[12]||(e[12]=m=>a.document.expression=m),maxLength:a.schedulerTimingOutputOutputTabDescriptor.accordion.mail.expressionMaxLength,onInput:e[13]||(e[13]=m=>a.validateDocument("expressionDirty")),onBlur:e[14]||(e[14]=m=>a.validateDocument("expressionDirty"))},null,8,["modelValue","class","maxLength"])]),t("div",qo,[t("div",null,[S(t("div",{class:"p-error p-grid p-m-4"},o(a.$t("common.validation.required",{fieldName:a.$t("managers.scheduler.expression")})),513),[[V,a.expressionDirty&&(!a.document.expression||a.document.expression.length===0)]])]),t("p",Ho,o(a.expresionHelp),1)])])):u("",!0),t("div",Go,[n(s,{modelValue:a.document.uniqueMail,"onUpdate:modelValue":e[15]||(e[15]=m=>a.document.uniqueMail=m),binary:!0},null,8,["modelValue"]),t("span",{class:"p-ml-2",innerHTML:a.$t("managers.scheduler.uniqueMail")},null,8,Ko)]),t("div",Zo,[n(s,{modelValue:a.document.zipMailDocument,"onUpdate:modelValue":e[16]||(e[16]=m=>a.document.zipMailDocument=m),binary:!0},null,8,["modelValue"]),t("span",{class:"p-ml-2",innerHTML:a.$t("managers.scheduler.zipMailDocument")},null,8,Wo)]),a.document.zipMailDocument?(i(),b("div",ar,[t("span",null,[t("label",er,o(a.$t("managers.scheduler.zipFileName")),1),n(f,{class:"kn-material-input p-inputtext-sm",modelValue:a.document.zipMailName,"onUpdate:modelValue":e[17]||(e[17]=m=>a.document.zipMailName=m),maxLength:a.schedulerTimingOutputOutputTabDescriptor.accordion.mail.zipMailNameMaxLength},null,8,["modelValue","maxLength"])]),t("div",tr,[t("small",null,o(a.zipMailNameHelp),1)])])):u("",!0),t("div",or,[n(s,{modelValue:a.document.reportNameInSubject,"onUpdate:modelValue":e[18]||(e[18]=m=>a.document.reportNameInSubject=m),binary:!0},null,8,["modelValue"]),t("span",{class:"p-ml-2",innerHTML:a.$t("managers.scheduler.reportNameInSubject")},null,8,rr)]),t("div",nr,[t("span",null,[t("label",ir,o(a.$t("managers.scheduler.mailSubject"))+" *",1),n(f,{class:I(["kn-material-input p-inputtext-sm",{"p-invalid":a.subjectDirty&&(!a.document.mailsubj||a.document.mailsubj.length===0)}]),modelValue:a.document.mailsubj,"onUpdate:modelValue":e[19]||(e[19]=m=>a.document.mailsubj=m),maxLength:a.schedulerTimingOutputOutputTabDescriptor.accordion.mail.mailSubjectMaxLength,onInput:e[20]||(e[20]=m=>a.validateDocument("subjectDirty")),onBlur:e[21]||(e[21]=m=>a.validateDocument("subjectDirty"))},null,8,["modelValue","class","maxLength"])]),t("div",dr,[t("div",null,[S(t("div",{class:"p-error p-grid p-m-4"},o(a.$t("common.validation.required",{fieldName:a.$t("managers.scheduler.mailSubject")})),513),[[V,a.subjectDirty&&(!a.document.mailsubj||a.document.mailsubj.length===0)]])]),t("p",lr,o(a.mailSubjectHelp),1)])]),t("div",cr,[t("span",null,[t("label",sr,o(a.$t("common.fileName")),1),n(f,{class:"kn-material-input p-inputtext-sm",modelValue:a.document.containedFileName,"onUpdate:modelValue":e[22]||(e[22]=m=>a.document.containedFileName=m),maxLength:a.schedulerTimingOutputOutputTabDescriptor.accordion.mail.fileNameMaxLength},null,8,["modelValue","maxLength"])]),t("div",pr,[t("small",null,o(a.fileNameHelp),1)])]),t("div",br,[t("span",null,[t("label",kr,o(a.$t("managers.scheduler.mailText"))+" *",1),n(f,{class:I(["kn-material-input p-inputtext-sm",{"p-invalid":a.mailTextDirty&&(!a.document.mailtxt||a.document.mailtxt.length===0)}]),modelValue:a.document.mailtxt,"onUpdate:modelValue":e[23]||(e[23]=m=>a.document.mailtxt=m),maxLength:a.schedulerTimingOutputOutputTabDescriptor.accordion.mail.mailTextMaxLength,placeholder:a.$t("managers.scheduler.mailTextMessage"),onInput:e[24]||(e[24]=m=>a.validateDocument("mailTextDirty")),onBlur:e[25]||(e[25]=m=>a.validateDocument("mailTextDirty"))},null,8,["modelValue","class","maxLength","placeholder"])]),t("div",ur,[t("div",null,[S(t("div",{class:"p-error p-grid p-m-4"},o(a.$t("common.validation.required",{fieldName:a.$t("managers.scheduler.mailMessage")})),513),[[V,a.mailTextDirty&&(!a.document.mailtxt||a.document.mailtxt.length===0)]])]),t("p",mr,o(a.mailTextHelp),1)])])])):u("",!0)]}),_:1})]),_:1})}var vr=T(Co,[["render",gr],["__scopeId","data-v-dcdc791c"]]);const fr=z({name:"scheduler-tming-output-document-detail",components:{Checkbox:O,SchedulerSnapshotAccordion:pt,SchedulerFileAccordion:St,SchedulerJavaClassAccordion:Ao,SchedulerDocumentAccordion:bo,SchedulerMailAccordion:vr},props:{propDocument:{type:Object},functionalities:{type:Array},datasets:{type:Array},jobInfo:{type:Object}},data(){return{document:null}},watch:{propDocument(){this.loadDocument()}},created(){this.loadDocument()},methods:{loadDocument(){this.document=this.propDocument,this.document.invalid={}},removeProperty(a){this.document[a]||delete this.document[a],this.document.invalid&&this.resetInvalid(a)},resetInvalid(a){switch(a){case"saveassnapshot":this.document.invalid.invalidSnapshot=!1;break;case"saveasfile":this.document.invalid.invalidFile=!1;break;case"saveasdocument":this.document.invalid.invalidDocument=!1;break;case"sendtojavaclass":this.document.invalid.invalidJavaClass=!1;break;case"sendmail":this.document.invalid.invalidMail=!1}}}}),hr={class:"p-d-flex p-flex-row p-m-2"},wr={class:"p-m-2"},xr={class:"p-ml-2"},yr={class:"p-m-2"},Mr={class:"p-ml-2"},Ar={class:"p-m-2"},Cr={class:"p-ml-2"},Dr={class:"p-m-2"},$r={class:"p-ml-2"},Er={class:"p-m-2"},zr={class:"p-ml-2"},Tr={key:0};function Sr(a,e,r,c,g,h){const s=d("Checkbox"),f=d("SchedulerSnapshotAccordion"),v=d("SchedulerFileAccordion"),p=d("SchedulerDocumentAccordion"),w=d("SchedulerJavaClassAccordion"),M=d("SchedulerMailAccordion");return i(),b("div",null,[t("div",hr,[t("div",wr,[n(s,{modelValue:a.document.saveassnapshot,"onUpdate:modelValue":e[0]||(e[0]=k=>a.document.saveassnapshot=k),binary:!0,onChange:e[1]||(e[1]=k=>a.removeProperty("saveassnapshot")),"data-test":"snapshot-checkbox"},null,8,["modelValue"]),t("span",xr,o(a.$t("managers.scheduler.saveAsSnapshot")),1)]),t("div",yr,[n(s,{modelValue:a.document.saveasfile,"onUpdate:modelValue":e[2]||(e[2]=k=>a.document.saveasfile=k),binary:!0,onChange:e[3]||(e[3]=k=>a.removeProperty("saveasfile")),"data-test":"file-checkbox"},null,8,["modelValue"]),t("span",Mr,o(a.$t("managers.scheduler.saveAsFile")),1)]),t("div",Ar,[n(s,{modelValue:a.document.saveasdocument,"onUpdate:modelValue":e[4]||(e[4]=k=>a.document.saveasdocument=k),binary:!0,onChange:e[5]||(e[5]=k=>a.removeProperty("saveasdocument")),"data-test":"document-checkbox"},null,8,["modelValue"]),t("span",Cr,o(a.$t("managers.scheduler.saveAsDocument")),1)]),t("div",Dr,[n(s,{modelValue:a.document.sendtojavaclass,"onUpdate:modelValue":e[6]||(e[6]=k=>a.document.sendtojavaclass=k),binary:!0,onChange:e[7]||(e[7]=k=>a.removeProperty("sendtojavaclass")),"data-test":"java-checkbox"},null,8,["modelValue"]),t("span",$r,o(a.$t("managers.scheduler.sendToJavaClass")),1)]),t("div",Er,[n(s,{modelValue:a.document.sendmail,"onUpdate:modelValue":e[8]||(e[8]=k=>a.document.sendmail=k),binary:!0,onChange:e[9]||(e[9]=k=>a.removeProperty("sendmail")),"data-test":"mail-checkbox"},null,8,["modelValue"]),t("span",zr,o(a.$t("managers.scheduler.sendMail")),1)])]),a.document?(i(),b("div",Tr,[a.document.saveassnapshot?(i(),y(f,{key:0,class:"p-m-3",propDocument:a.document,"data-test":"snapshot-accordion"},null,8,["propDocument"])):u("",!0),a.document.saveasfile?(i(),y(v,{key:1,class:"p-m-3",propDocument:a.document,"data-test":"file-accordion"},null,8,["propDocument"])):u("",!0),a.document.saveasdocument?(i(),y(p,{key:2,class:"p-m-3",propDocument:a.document,functionalities:a.functionalities,datasets:a.datasets,jobInfo:a.jobInfo,"data-test":"document-accordion"},null,8,["propDocument","functionalities","datasets","jobInfo"])):u("",!0),a.document.sendtojavaclass?(i(),y(w,{key:3,class:"p-m-3",propDocument:a.document,"data-test":"java-accordion"},null,8,["propDocument"])):u("",!0),a.document.sendmail?(i(),y(M,{key:4,class:"p-m-3",propDocument:a.document,datasets:a.datasets,jobInfo:a.jobInfo,"data-test":"mail-accordion"},null,8,["propDocument","datasets","jobInfo"])):u("",!0)])):u("",!0)])}var Ir=T(fr,[["render",Sr]]);const Nr=z({name:"scheduler-timing-output-output-tab",components:{Listbox:aa,Message:R,SchedulerTimingOutputDocumentDetail:Ir},props:{propDocuments:{type:Array},functionalities:{type:Array},datasets:{type:Array},jobInfo:{type:Object}},data(){return{schedulerTimingOutputOutputTabDescriptor:E,documents:[],selectedDocument:null}},watch:{propDocuments(){this.loadDocuments()}},async created(){this.loadDocuments()},methods:{loadDocuments(){this.documents=this.propDocuments},showDocumentDetail(a){this.selectedDocument=a},documentInvalid(a){return a.invalid&&(a.invalid.invalidSnapshot||a.invalid.invalidFile||a.invalid.invalidJavaClass||a.invalid.invalidMail||a.invalid.invalidDocument)||!a.saveassnapshot&&!a.saveasfile&&!a.saveasdocument&&!a.sendtojavaclass&&!a.sendmail}}}),Vr={class:"p-d-flex p-flex-row"},jr={class:"p-col-4 p-sm-4 p-md-3 p-p-0"},Lr={class:"kn-list-item"},Fr={class:"kn-list-item-text"},Ur={key:0,class:"pi pi-exclamation-triangle kn-warning-icon"},Or={class:"p-col-8 p-sm-8 p-md-9 p-p-0"};function Pr(a,e,r,c,g,h){const s=d("Listbox"),f=d("SchedulerTimingOutputDocumentDetail"),v=d("Message");return i(),b("div",Vr,[t("div",jr,[n(s,{class:"kn-list--column",options:a.documents,onChange:e[0]||(e[0]=p=>a.showDocumentDetail(p.value))},{empty:l(()=>[A(o(a.$t("common.info.noDataFound")),1)]),option:l(p=>[t("div",Lr,[t("div",Fr,[t("span",null,o(p.option.label),1)]),a.documentInvalid(p.option)?(i(),b("i",Ur)):u("",!0)])]),_:1},8,["options"])]),t("div",Or,[a.selectedDocument?(i(),y(f,{key:0,propDocument:a.selectedDocument,functionalities:a.functionalities,datasets:a.datasets,jobInfo:a.jobInfo},null,8,["propDocument","functionalities","datasets","jobInfo"])):(i(),y(v,{key:1,class:"p-m-4",severity:"info",closable:!1,style:N(a.schedulerTimingOutputOutputTabDescriptor.styles.message)},{default:l(()=>[A(o(a.$t("managers.scheduler.noDocumentSelected")),1)]),_:1},8,["style"]))])])}var _r=T(Nr,[["render",Pr]]);const Br=z({name:"scheduler-timing-output-warning-dialog",components:{Dialog:L},props:{visible:{type:Boolean},warningTitle:{type:String},warningMessage:{type:String}},emits:["close"],data(){return{schedulerTimingOutputDetailDialogDescriptor:Z}},created(){},methods:{}}),Rr={class:"p-m-2"};function Xr(a,e,r,c,g,h){const s=d("Button"),f=d("Dialog");return i(),y(f,{style:N(a.schedulerTimingOutputDetailDialogDescriptor.warningDialog.style),header:a.warningTitle,visible:a.visible,modal:!0,class:"p-fluid kn-dialog--toolbar--primary",closable:!1},{footer:l(()=>[n(s,{class:"kn-button kn-button--primary",onClick:e[0]||(e[0]=v=>a.$emit("close"))},{default:l(()=>[A(o(a.$t("common.close")),1)]),_:1})]),default:l(()=>[t("div",Rr,o(a.warningMessage),1)]),_:1},8,["style","header","visible"])}var Jr=T(Br,[["render",Xr]]);const Qr=z({name:"scheduler-timing-output-detail-dialog",components:{Dialog:L,SchedulerTimingOutputTimingTab:Je,SchedulerTimingOutputOutputTab:_r,SchedulerTimingOutputWarningDialog:Jr,TabView:H,TabPanel:G},props:{visible:{type:Boolean},propTrigger:{type:Object}},emits:["close","saved"],data(){return{schedulerTimingOutputDetailDialogDescriptor:Z,trigger:null,info:null,validCron:!0,datasets:[],jobInfo:null,functionalities:[],warningVisible:!1,warningTitle:null,warningMessage:null,operation:"create",loading:!1}},computed:{saveDisabled(){var e;let a=!1;if(!this.trigger.triggerDescription||this.trigger.triggerDescription.length===0||!this.validCron)return!0;for(let r=0;r<((e=this.trigger.documents)==null?void 0:e.length);r++)if(this.trigger.documents[r].invalid&&(this.trigger.documents[r].invalid.invalidSnapshot||this.trigger.documents[r].invalid.invalidFile||this.trigger.documents[r].invalid.invalidJavaClass||this.trigger.documents[r].invalid.invalidMail||this.trigger.documents[r].invalid.invalidDocument)||!this.trigger.documents[r].saveassnapshot&&!this.trigger.documents[r].saveasfile&&!this.trigger.documents[r].saveasdocument&&!this.trigger.documents[r].sendtojavaclass&&!this.trigger.documents[r].sendmail){a=!0;break}return a}},watch:{async propTrigger(){this.loadTrigger(),await this.loadJobInfo()}},setup(){return{store:Q()}},async created(){this.loadTrigger(),await this.loadDatasets(),await this.loadJobInfo()},methods:{loadTrigger(){this.trigger=this.propTrigger?{...this.propTrigger}:{}},async loadDatasets(){await this.$http.get("/knowage/restful-services/2.0/datasets/?asPagedList=true").then(a=>this.datasets=a.data.item)},async loadJobInfo(){var a;this.trigger.jobName&&await this.$http.get(`/knowage/restful-services/scheduleree/getJob?jobName=${this.trigger.jobName}&jobGroup=${this.trigger.jobGroup}&triggerName=${this.trigger.triggerName}&triggerGroup=${this.trigger.triggerGroup}`).then(e=>{this.jobInfo=e.data.job,this.functionalities=e.data.functionality}),this.trigger.documents||(this.trigger={...this.trigger,documents:(a=this.jobInfo)==null?void 0:a.documents})},setCronValid(a){this.validCron=a},closeDialog(){this.trigger=null,this.jobInfo=null,this.functionalities=[],this.$emit("close")},async saveTrigger(){this.loading=!0;const a=this.formatTrigger();await this.$http.post("/knowage/restful-services/scheduleree/saveTrigger",a,{headers:{"X-Disable-Errors":"true"}}).then(e=>{var r;e.data.Errors?this.setWarningMessage((r=e.data.Errors[0])!=null?r:"default error"):(this.store.setInfo({title:this.$t("common.toast."+this.operation+"Title"),msg:this.$t("common.toast.success")}),this.$emit("saved"))}).catch(e=>{this.setWarningMessage(e)}),this.loading=!1},setWarningMessage(a){this.warningTitle=this.$t("common.toast."+this.operation+"Title"),this.warningVisible=!0,this.warningMessage=this.getErrorMessage(a)},getErrorMessage(a){switch(a){case"errors.trigger.missingDataSet":return this.$t("managers.scheduler.missingDataSet");case"errors.trigger.missingDataSetParameter":return this.$t("managers.scheduler.missingDataSetParameter");case"Empty name":return this.$t("managers.scheduler.emptyName");case"sbi.scheduler.schedulation.error.alreadyPresent":return this.$t("managers.scheduler.triggerAlreadyPresent");case"Error in setting java class ":return this.$t("managers.scheduler.javaClassError");default:return this.$t("managers.scheduler.savingTriggerGenericError")}},formatTrigger(){const a={...this.trigger,documents:this.trigger.documents.map(e=>({...e}))};return this.trigger.frequency&&(a.frequency={...this.trigger.frequency,cron:{...this.trigger.frequency.cron,parameter:{type:this.trigger.frequency.cron.type,parameter:{...this.trigger.frequency.cron.parameter}}}}),a.triggerGroup||(a.triggerGroup=""),a._endTime=new Date().getHours()+":"+new Date().getMinutes(),a.chrono.type==="single"?delete a.chrono.parameter:a.chrono.type!=="event"&&this.formatCron(a),(!a.endDateTiming||!a.zonedEndTime)&&delete a.zonedEndTime,this.deleteTriggerProps(a),this.formatTriggerDocuments(a),a},deleteTriggerProps(a){["startDateTiming","startTimeTiming","endDateTiming","endTimeTiming","startDate","startTime","startDateRFC3339","endDate","endTime"].forEach(r=>delete a[r])},formatCron(a){a.chrono=this.trigger.frequency.cron,a.zonedStartTime=new Date(this.trigger.frequency.startDate),a.frequency.endDate?(a.zonedEndTime=new Date(this.trigger.frequency.endDate),a.endDateTiming=a.zonedEndTime):(a.zonedEndtime=null,a.endDateTiming=null)},formatTriggerDocuments(a){a.documents.forEach((e,r)=>{var c;e.label=e.name,e.labelId=(c=e.labelId)!=null?c:e.id+"__"+(r+1)})}}}),Yr={class:"p-d-flex p-flex-row p-jc-end"};function qr(a,e,r,c,g,h){const s=d("Toolbar"),f=d("ProgressBar"),v=d("SchedulerTimingOutputTimingTab"),p=d("TabPanel"),w=d("SchedulerTimingOutputOutputTab"),M=d("TabView"),k=d("SchedulerTimingOutputWarningDialog"),C=d("Button"),x=d("Dialog");return i(),y(x,{class:"p-fluid kn-dialog--toolbar--primary",contentStyle:a.schedulerTimingOutputDetailDialogDescriptor.dialog.style,visible:a.visible,modal:!0,closable:!1},{header:l(()=>[n(s,{class:"kn-toolbar kn-toolbar--primary p-p-0 p-m-0 p-col-12"},{start:l(()=>[A(o(a.$t("managers.scheduler.timingAndOutput")),1)]),_:1}),a.loading?(i(),y(f,{key:0,class:"kn-progress-bar",mode:"indeterminate"})):u("",!0)]),footer:l(()=>[t("div",Yr,[n(C,{class:"kn-button kn-button--primary",onClick:a.closeDialog},{default:l(()=>[A(o(a.$t("common.cancel")),1)]),_:1},8,["onClick"]),n(C,{class:"kn-button kn-button--primary",disabled:a.saveDisabled,onClick:a.saveTrigger},{default:l(()=>[A(o(a.$t("common.save")),1)]),_:1},8,["disabled","onClick"])])]),default:l(()=>[n(M,{id:"timing-tabs"},{default:l(()=>[n(p,null,{header:l(()=>[t("span",null,o(a.$t("managers.scheduler.timing")),1)]),default:l(()=>[n(v,{propTrigger:a.trigger,datasets:a.datasets,onCronValid:e[0]||(e[0]=$=>a.setCronValid($))},null,8,["propTrigger","datasets"])]),_:1}),n(p,null,{header:l(()=>[t("span",null,o(a.$t("common.output")),1)]),default:l(()=>[n(w,{propDocuments:a.trigger.documents,functionalities:a.functionalities,datasets:a.datasets,jobInfo:a.jobInfo},null,8,["propDocuments","functionalities","datasets","jobInfo"])]),_:1})]),_:1}),n(k,{visible:a.warningVisible,warningTitle:a.warningTitle,warningMessage:a.warningMessage,onClose:e[1]||(e[1]=$=>a.warningVisible=!1)},null,8,["visible","warningTitle","warningMessage"])]),_:1},8,["contentStyle","visible"])}var Hr=T(Qr,[["render",qr]]);const Gr={style:{width:"80vw"}};var Kr={dialog:Gr};const Zr=z({name:"scheduler-timing-output-info-dialog",components:{Dialog:L,TabView:H,TabPanel:G},props:{visible:{type:Boolean},triggerInfo:{type:Object}},emits:["close"],data(){return{schedulerTimingOutputInfoDialogDescriptor:Kr,info:null}},watch:{triggerInfo(){this.loadTriggerInfo()}},created(){this.loadTriggerInfo()},methods:{loadTriggerInfo(){this.info=this.triggerInfo},closeDialog(){this.$emit("close")}}}),Wr={class:"document-label"},an={key:0,class:"p-d-flex p-flex-row p-ai-center"},en={class:"kn-flex"},tn={class:"info-value"},on={key:1,class:"p-d-flex p-flex-row p-ai-center"},rn={class:"kn-flex"},nn={class:"info-value"},dn={key:2,class:"p-d-flex p-flex-row p-ai-center"},ln={class:"kn-flex"},cn={class:"info-value"},sn={key:3,class:"p-d-flex p-flex-row p-ai-center"},pn={class:"kn-flex"},bn={class:"info-value"},kn={key:4,class:"p-d-flex p-flex-row p-ai-center"},un={class:"kn-flex"},mn={class:"info-value"},gn={class:"p-d-flex p-flex-row p-jc-end"};function vn(a,e,r,c,g,h){const s=d("Toolbar"),f=d("TabPanel"),v=d("TabView"),p=d("Button"),w=d("Dialog");return i(),y(w,{class:"p-fluid kn-dialog--toolbar--primary",contentStyle:a.schedulerTimingOutputInfoDialogDescriptor.dialog.style,visible:a.visible,modal:!0,closable:!1},{header:l(()=>[n(s,{class:"kn-toolbar kn-toolbar--primary p-p-0 p-m-0 p-col-12"},{start:l(()=>[A(o(a.$t("managers.scheduler.schedulationInformations")),1)]),_:1})]),footer:l(()=>[t("div",gn,[n(p,{class:"kn-button kn-button--primary",onClick:a.closeDialog},{default:l(()=>[A(o(a.$t("common.cancel")),1)]),_:1},8,["onClick"])])]),default:l(()=>[a.info?(i(),y(v,{key:0},{default:l(()=>[(i(!0),b(j,null,X(a.info.documents,(M,k)=>(i(),y(f,{key:k},{header:l(()=>[t("span",Wr,o(M.label),1)]),default:l(()=>[M.mailtos?(i(),b("div",an,[t("h4",en,o(a.$t("managers.scheduler.mailTo"))+":",1),t("p",tn,o(M.mailtos),1)])):u("",!0),M.zipMailName?(i(),b("div",on,[t("h4",rn,o(a.$t("managers.scheduler.attachedZip"))+":",1),t("p",nn,o(M.zipMailName),1)])):u("",!0),M.mailsubj?(i(),b("div",dn,[t("h4",ln,o(a.$t("managers.scheduler.mailSubject"))+":",1),t("p",cn,o(M.mailsubj),1)])):u("",!0),M.containedFileName?(i(),b("div",sn,[t("h4",pn,o(a.$t("managers.scheduler.containedFileName"))+":",1),t("p",bn,o(M.containedFileName),1)])):u("",!0),M.mailtxt?(i(),b("div",kn,[t("h4",un,o(a.$t("managers.scheduler.mailText"))+":",1),t("p",mn,o(M.mailtxt),1)])):u("",!0)]),_:2},1024))),128))]),_:1})):u("",!0)]),_:1},8,["contentStyle","visible"])}var fn=T(Zr,[["render",vn],["__scopeId","data-v-822788fe"]]);const hn=z({name:"scheduler-timing-output-table",components:{Column:Y,DataTable:q,Message:R,Menu:ra,SchedulerTimingOutputDetailDialog:Hr,SchedulerTimingOutputInfoDialog:fn},props:{job:{type:Object,required:!0}},emits:["loading","triggerSaved"],data(){return{schedulerTimingOutputTableDescriptor:ie,triggers:[],items:[],triggerInfo:null,triggerInfoDialogVisible:!1,triggerDetailDialogVisible:!1}},watch:{job(){this.loadTriggers()}},setup(){return{store:Q()}},created(){this.loadTriggers()},methods:{loadTriggers(){var a;this.triggers=(a=this.job)==null?void 0:a.triggers},getFormatedDate(a,e){return ea(a,e)},rowClass(a){return this.isTriggerActive(a)?"trigger-active":"trigger-inactive"},isTriggerActive(a){let e=!0;const r=new Date().getTime(),c=new Date(a.triggerZonedStartTime).getTime(),g=a.triggerZonedEndTime?new Date(a.triggerZonedEndTime).getTime():null;return a.triggerIsPaused&&(e=!1),(a.triggerChronType==="Single"&&c<r||g&&(g<r||c>r))&&(e=!1),e},toggle(a,e){this.createMenuItems(e),this.$refs.menu.toggle(a)},createMenuItems(a){this.items=[],this.items.push({label:this.$t("managers.scheduler.info"),icon:"fa fa-info",command:()=>this.getTriggerInfo(a,!0)}),this.items.push({label:this.$t("managers.scheduler.detail"),icon:"pi pi-pencil",command:()=>this.showTriggerDetail(a)}),this.items.push({label:this.$t("managers.scheduler.execute"),icon:"fa fa-play",command:()=>this.triggerExecuteConfirm(a)}),a.triggerIsPaused?this.items.push({label:this.$t("managers.scheduler.resumeSchedulation"),icon:"fa fa-unlock",command:()=>this.triggerPauseConfirm(a)}):this.items.push({label:this.$t("managers.scheduler.pauseSchedulation"),icon:"fa fa-lock",command:()=>this.triggerPauseConfirm(a)})},async getTriggerInfo(a,e){this.$emit("loading",!0),a?await this.$http.post(`/knowage/restful-services/scheduleree/getTriggerInfo?jobName=${a.jobName}&jobGroup=${a.jobGroup}&triggerName=${a.triggerName}&triggerGroup=${a.triggerGroup}`).then(r=>{this.triggerInfo=r.data}).catch(()=>{}):this.triggerInfo={jobName:this.job.jobName,jobGroup:this.job.jobGroup,chrono:{type:"single",parameter:{}},documents:null},this.triggerInfoDialogVisible=e,this.$emit("loading",!1)},async showTriggerDetail(a){await this.getTriggerInfo(a,!1),this.triggerDetailDialogVisible=!0},triggerExecuteConfirm(a){this.$confirm.require({message:this.$t("managers.scheduler.executeNow"),header:this.$t("managers.scheduler.confirmHeader"),icon:"pi pi-exclamation-triangle",accept:async()=>await this.executeTrigger(a)})},async executeTrigger(a){this.$emit("loading",!0),await this.$http.post(`/knowage/restful-services/scheduleree/executeTrigger?jobName=${a.jobName}&jobGroup=${a.jobGroup}&triggerName=${a.triggerName}&triggerGroup=${a.triggerGroup}`).then(e=>{e.data.resp==="ok"&&this.store.setInfo({title:this.$t("common.information"),msg:this.$t("managers.scheduler.schedulationExecuted")})}).catch(()=>{}),this.$emit("loading",!1)},triggerPauseConfirm(a){this.$confirm.require({message:a.triggerIsPaused?this.$t("managers.scheduler.resumeSchedulation"):this.$t("managers.scheduler.pauseSchedulation"),header:this.$t("managers.scheduler.confirmHeader"),icon:"pi pi-exclamation-triangle",accept:async()=>await this.pauseTrigger(a)})},async pauseTrigger(a){this.$emit("loading",!0);const e=a.triggerIsPaused?"resumeTrigger":"pauseTrigger";await this.$http.post(`/knowage/restful-services/scheduleree/${e}?jobName=${a.jobName}&jobGroup=${a.jobGroup}&triggerName=${a.triggerName}&triggerGroup=${a.triggerGroup}`).then(r=>{r.data.resp==="ok"&&(this.store.setInfo({title:this.$t("common.information"),msg:a.triggerIsPaused?this.$t("managers.scheduler.schedulationResumed"):this.$t("managers.scheduler.schedulationPaused")}),a.triggerIsPaused=e==="pauseTrigger")}).catch(()=>{}),this.$emit("loading",!1)},deleteTriggerConfirm(a){this.$confirm.require({message:this.$t("common.toast.deleteMessage"),header:this.$t("common.toast.deleteTitle"),icon:"pi pi-exclamation-triangle",accept:async()=>await this.deleteTrigger(a.trigger,a.index)})},async deleteTrigger(a,e){this.$emit("loading",!0),await this.$http.post(`/knowage/restful-services/scheduleree/deleteTrigger?jobName=${a.jobName}&jobGroup=${a.jobGroup}&triggerName=${a.triggerName}&triggerGroup=${a.triggerGroup}`).then(r=>{r.data.resp==="ok"&&(this.store.setInfo({title:this.$t("common.toast.deleteTitle"),msg:this.$t("common.toast.deleteSuccess")}),this.triggers.splice(e,1))}).catch(()=>{}),this.$emit("loading",!1)},onSave(){this.triggerDetailDialogVisible=!1,this.$emit("triggerSaved")}}});function wn(a,e,r,c,g,h){const s=d("Button"),f=d("Toolbar"),v=d("Message"),p=d("Column"),w=d("Menu"),M=d("DataTable"),k=d("SchedulerTimingOutputInfoDialog"),C=d("SchedulerTimingOutputDetailDialog");return i(),b("div",null,[n(f,{class:"kn-toolbar kn-toolbar--secondary"},{start:l(()=>[A(o(a.$t("managers.scheduler.timingAndOutput")),1)]),end:l(()=>[n(s,{class:"kn-button p-button-text p-button-rounded",onClick:e[0]||(e[0]=x=>a.showTriggerDetail(null))},{default:l(()=>[A(o(a.$t("common.add")),1)]),_:1})]),_:1}),a.triggers.length===0?(i(),y(v,{key:0,class:"p-m-4",severity:"info",closable:!1,style:N(a.schedulerTimingOutputTableDescriptor.styles.message)},{default:l(()=>[A(o(a.$t("managers.scheduler.noTriggersInfo")),1)]),_:1},8,["style"])):(i(),y(M,{key:1,id:"triggers-datatable",value:a.triggers,paginator:!0,rows:a.schedulerTimingOutputTableDescriptor.rows,class:"p-datatable-sm kn-table p-m-2",dataKey:"triggerName",responsiveLayout:a.schedulerTimingOutputTableDescriptor.responsiveLayout,breakpoint:a.schedulerTimingOutputTableDescriptor.breakpoint,rowClass:a.rowClass},{default:l(()=>[n(p,{class:"kn-truncated",header:a.$t("common.name")},{body:l(x=>[t("span",null,o(x.data.triggerName),1)]),_:1},8,["header"]),n(p,{class:"kn-truncated",header:a.$t("common.type")},{body:l(x=>[A(o(x.data.triggerChronType),1)]),_:1},8,["header"]),n(p,{class:"kn-truncated",header:a.$t("cron.startDate")},{body:l(x=>[A(o(a.getFormatedDate(x.data.triggerZonedStartTime,"DD/MM/YYYY HH:mm")),1)]),_:1},8,["header"]),n(p,{class:"kn-truncated",header:a.$t("cron.endDate")},{body:l(x=>[A(o(x.data.triggerZonedEndTime?a.getFormatedDate(x.data.triggerZonedEndTime,"DD/MM/YYYY HH:mm"):""),1)]),_:1},8,["header"]),n(p,{class:"kn-truncated",header:a.$t("common.paused")},{body:l(x=>[A(o(x.data.triggerIsPaused?a.$t("common.yes"):a.$t("common.no")),1)]),_:1},8,["header"]),n(p,{style:N(a.schedulerTimingOutputTableDescriptor.iconColumnStyle)},{body:l(x=>[n(s,{class:"p-button-link p-button-sm",icon:"fa fa-ellipsis-v",onClick:$=>a.toggle($,x.data),"aria-haspopup":"true","aria-controls":"overlay_menu"},null,8,["onClick"]),n(w,{ref:"menu",model:a.items,popup:!0,"data-test":"menu"},null,8,["model"]),n(s,{icon:"pi pi-trash",class:"p-button-link",onClick:$=>a.deleteTriggerConfirm({trigger:x.data,index:x.index})},null,8,["onClick"])]),_:1},8,["style"])]),_:1},8,["value","rows","responsiveLayout","breakpoint","rowClass"])),n(k,{visible:a.triggerInfoDialogVisible,triggerInfo:a.triggerInfo,onClose:e[1]||(e[1]=x=>a.triggerInfoDialogVisible=!1)},null,8,["visible","triggerInfo"]),n(C,{visible:a.triggerDetailDialogVisible,propTrigger:a.triggerInfo,onClose:e[2]||(e[2]=x=>a.triggerDetailDialogVisible=!1),onSaved:a.onSave},null,8,["visible","propTrigger","onSaved"])])}var xn=T(hn,[["render",wn]]);const yn=z({name:"scheduler-detail",components:{Card:ta,SchedulerDocumentsTable:ae,SchedulerTimingOutputTable:xn},props:{id:{type:String},clone:{type:String},selectedJob:{type:Object}},emits:["documentSaved","close"],data(){return{job:null,jobNameDirty:!1,operation:"create",loading:!1}},watch:{selectedJob(){this.loadJob()}},computed:{saveDisabled(){var a,e;return this.job&&(!this.job.jobName||((a=this.job.documents)==null?void 0:a.length)===0||this.job.edit&&((e=this.job.triggers)==null?void 0:e.length)===0)},testReadonly(){return!!(this.job&&this.job.edit)}},setup(){return{store:Q()}},created(){this.loadJob()},methods:{loadJob(){this.job={...this.selectedJob}},setLoading(a){this.loading=a},async saveJob(){this.loading=!0;const a={...this.job};this.formatJob(),await this.$http.post("/knowage/restful-services/scheduleree/saveJob",this.job).then(e=>{var r,c;e.data.resp==="ok"&&(this.store.setInfo({title:this.$t("common.toast."+this.operation+"Title"),msg:this.$t("common.toast.success")}),this.$router.push(`/scheduler/edit-package-schedule?id=${(r=this.job)==null?void 0:r.jobName}&clone=false`),this.$emit("documentSaved",(c=this.job)==null?void 0:c.jobName))}).catch(()=>{this.job=a}),this.loading=!1},formatJob(){var a,e,r;(a=this.job)==null||delete a.edit,(e=this.job)==null||delete e.numberOfDocuments,(r=this.job)==null||r.documents.forEach(c=>{var g;return(g=c.parameters)==null?void 0:g.forEach(h=>h.value=h.value.trim())})},closeJobDetail(){this.job=null,this.jobNameDirty=!1,this.$emit("close"),this.$router.push("/scheduler")}}}),Mn={key:0,class:"p-fluid p-formgrid p-grid p-m-4"},An={class:"p-field p-col-6 p-mb-6"},Cn={class:"p-float-label"},Dn={for:"jobName",class:"kn-material-input-label"},$n={key:0,class:"p-error"},En={class:"p-field p-col-6 p-mb-6"},zn={class:"p-float-label"},Tn={for:"jobDescription",class:"kn-material-input-label"};function Sn(a,e,r,c,g,h){const s=d("Button"),f=d("Toolbar"),v=d("ProgressBar"),p=d("InputText"),w=d("SchedulerDocumentsTable"),M=d("SchedulerTimingOutputTable"),k=d("Card");return i(),b(j,null,[n(f,{class:"kn-toolbar kn-toolbar--primary p-m-0"},{start:l(()=>[A(o(a.job.jobName),1)]),end:l(()=>[n(s,{icon:"pi pi-save",class:"p-button-text p-button-rounded p-button-plain",disabled:a.saveDisabled,onClick:a.saveJob,"data-test":"save-button"},null,8,["disabled","onClick"]),n(s,{icon:"pi pi-times",class:"p-button-text p-button-rounded p-button-plain",onClick:a.closeJobDetail},null,8,["onClick"])]),_:1}),a.loading?(i(),y(v,{key:0,mode:"indeterminate",class:"kn-progress-bar","data-test":"progress-bar"})):u("",!0),a.job?(i(),y(k,{key:1,id:"scheduler-detail-card",class:"p-m-2"},{content:l(()=>{var C,x;return[a.job?(i(),b("form",Mn,[t("div",An,[t("span",Cn,[n(p,{id:"jobName",class:I(["kn-material-input",{"p-invalid":((C=a.job.jobName)==null?void 0:C.length)===0&&a.jobNameDirty}]),modelValue:a.job.jobName,"onUpdate:modelValue":e[0]||(e[0]=$=>a.job.jobName=$),modelModifiers:{trim:!0},maxLength:"80",disabled:a.testReadonly,onBlur:e[1]||(e[1]=$=>a.jobNameDirty=!0),"data-test":"name-input"},null,8,["modelValue","class","disabled"]),t("label",Dn,o(a.$t("managers.scheduler.packageName"))+" *",1)]),((x=a.job.jobName)==null?void 0:x.length)===0&&a.jobNameDirty?(i(),b("small",$n,o(a.$t("common.validation.required",{fieldName:a.$t("managers.scheduler.packageName")})),1)):u("",!0)]),t("div",En,[t("span",zn,[n(p,{id:"jobDescription",class:"kn-material-input",maxLength:"120",modelValue:a.job.jobDescription,"onUpdate:modelValue":e[2]||(e[2]=$=>a.job.jobDescription=$),modelModifiers:{trim:!0}},null,8,["modelValue"]),t("label",Tn,o(a.$t("managers.scheduler.packageDescription")),1)])])])):u("",!0),n(w,{class:"p-mt-4",jobDocuments:a.job.documents,onLoading:a.setLoading},null,8,["jobDocuments","onLoading"]),a.job.edit?(i(),y(M,{key:1,class:"p-mt-4",job:a.job,onLoading:a.setLoading,onTriggerSaved:e[3]||(e[3]=$=>a.$emit("triggerSaved"))},null,8,["job","onLoading"])):u("",!0)]}),_:1})):u("",!0)],64)}var Xn=T(yn,[["render",Sn]]);export{Xn as default};
//# sourceMappingURL=SchedulerDetail-77797373.js.map
