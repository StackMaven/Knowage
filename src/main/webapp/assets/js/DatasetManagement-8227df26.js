import{_ as y,d as b,X as T,aj as v,s as D,r as s,o as n,c as k,h as r,A as l,a as i,f as o,w as d,g as C,t as w,V as c}from"./index-1e676509.js";import{K as S}from"./KnListBox-94855720.js";import"./menu.esm-6bee86d0.js";const $={avatar:{property:"dsTypeCd",values:{Ckan:{icon:"fas fa-database",style:{"background-color":"#ffc107",color:"white"}},Custom:{icon:"fas fa-database",style:{"background-color":"#607d8b",color:"white"}},Federated:{icon:"fas fa-database",style:{"background-color":"#795548",color:"white"}},File:{icon:"fas fa-file",style:{"background-color":"#2196f3",color:"white"}},Flat:{icon:"fas fa-database",style:{"background-color":"#9e9e9e",color:"white"}},"Java Class":{icon:"fab fa-java",style:{"background-color":"#ffcc80",color:"white"}},Prepared:{icon:"fas fa-database",style:{"background-color":"#673ab7",color:"white"}},"Python/R":{icon:"fab fa-python",style:{"background-color":"#ffb300",color:"white"}},Qbe:{icon:"fas fa-list",style:{"background-color":"#ffc107",color:"white"}},Query:{icon:"fas fa-table",style:{"background-color":"#004ba0",color:"white"}},REST:{icon:"fas fa-exchange-alt",style:{"background-color":"#3f51b5",color:"white"}},SPARQL:{icon:"fas fa-database",style:{"background-color":"#009688",color:"white"}},Script:{icon:"fab fa-js-square",style:{"background-color":"#fdd835",color:"white"}},Solr:{icon:"fas fa-database",style:{"background-color":"#673ab7",color:"white"}}}},badgeField:"usedByNDocs",badgeSeverity:"info",buttons:[{emits:"clone",icon:"far fa-copy",label:"common.clone"},{emits:"delete",icon:"far fa-trash-alt",label:"common.delete"}],defaultSortField:"label",filterFields:["label","name","tags"],interaction:{parameterLabel:"id",parameterValue:"id",type:"event"},sortFields:["label","name",{label:"type",name:"dsTypeCd"}],textField:"name",titleField:"label"};var E={knListSettings:$};const B=b({name:"dataset-management",components:{FabButton:T,KnListBox:S,ProgressSpinner:v},data(){return{mainDescriptor:E,loading:!1,listOfDatasets:[],reverseOrdering:!1,loadingVersion:!1,columnOrdering:"",touched:!1,scopeTypes:[],categoryTypes:[],datasetTypes:[],transformationDataset:{},scriptTypes:[],dataSources:[],businessModels:[],pythonEnvironments:[],rEnvironments:[],metaSourceResource:[],tags:[],datasetToCloneId:null}},setup(){return{store:D()}},created(){this.getAllPersistentData()},methods:{getEnvironmentByConfiguration(e){return this.$http.get(`/knowage/restful-services/2.0/configs/category/${e}`)},buildEnvironments(e){return e.map(t=>({label:t.label,value:t.valueCheck}))},async getEnvironmentData(){this.getEnvironmentByConfiguration("PYTHON_CONFIGURATION").then(e=>this.pythonEnvironments=this.buildEnvironments(e.data)),this.getEnvironmentByConfiguration("R_CONFIGURATION").then(e=>this.rEnvironments=this.buildEnvironments(e.data))},getDomainByType(e){return this.$http.get(`/knowage/restful-services/domains/listValueDescriptionByType?DOMAIN_TYPE=${e}`)},async getDomainData(){this.getDomainByType("DS_SCOPE").then(e=>this.scopeTypes=e.data),this.getDomainByType("DATASET_CATEGORY").then(e=>this.categoryTypes=e.data),this.getDomainByType("DATA_SET_TYPE").then(e=>this.datasetTypes=e.data.filter(t=>t.VALUE_CD!="Custom"&&t.VALUE_CD!="Federated")),this.getDomainByType("TRANSFORMER_TYPE").then(e=>this.transformationDataset=e.data[0]),this.getDomainByType("SCRIPT_TYPE").then(e=>this.scriptTypes=e.data)},async getDatasources(){this.$http.get("/knowage/restful-services/2.0/datasources").then(e=>this.dataSources=e.data)},async getBusinessModels(){this.$http.get("/knowage/restful-services/2.0/businessmodels").then(e=>this.businessModels=e.data)},async getMetaSourceResource(){this.$http.get("/knowage/restful-services/2.0/metaSourceResource/").then(e=>this.metaSourceResource=e.data)},async getTags(){this.$http.get("/knowage/restful-services/2.0/tags/").then(e=>this.tags=e.data)},async getDatasets(){let e='{"reverseOrdering":false,"columnOrdering":""}';this.$http.get("/knowage/restful-services/3.0/datasets/catalog?offset=0&fetchSize=0&ordering="+encodeURI(e)).then(t=>this.listOfDatasets=[...t.data.root]).finally(()=>this.loading=!1)},async getAllPersistentData(){this.loading=!0,await this.getEnvironmentData(),await this.getDomainData(),await this.getMetaSourceResource(),await this.getDatasources(),await this.getBusinessModels(),await this.getTags(),await this.getDatasets()},showDetail(e){const t=e.item?`/dataset-management/${e.item.id}`:"/dataset-management/new-dataset";this.dirtyCheck(t)},closeDetailConfirm(){const e="/dataset-management";this.dirtyCheck(e)},dirtyCheck(e){this.touched?this.$confirm.require({message:this.$t("common.toast.unsavedChangesMessage"),header:this.$t("common.toast.unsavedChangesHeader"),icon:"pi pi-exclamation-triangle",accept:()=>{this.touched=!1,this.$router.push(e)}}):this.$router.push(e)},deleteDataset(e){this.$confirm.require({message:this.$t("common.toast.deleteMessage"),header:this.$t("common.uppercaseDelete"),icon:"pi pi-exclamation-triangle",accept:()=>{this.$http.delete(`/knowage/restful-services/1.0/datasets/${e.item.label}/`).then(()=>{this.store.setInfo({title:this.$t("common.toast.deleteTitle"),msg:this.$t("common.toast.deleteSuccess")}),this.loading=!0,this.getDatasets(),e.item.id==this.$route.params.id&&(this.$router.push("/dataset-management"),this.touched=!1)}).catch()}})},emitCloneDataset(e){this.$router.push("/dataset-management/new-dataset"),setTimeout(()=>{this.datasetToCloneId=e.item.id},200)},onCreate(e){this.touched=!1,this.getDatasets(),this.$router.push(`/dataset-management/${e.data.id}`)},onUpdate(){this.touched=!1,this.getDatasets()}}}),R={class:"kn-page"},O={class:"kn-page-content p-grid p-m-0"},F={class:"kn-list--column p-col-4 p-sm-4 p-md-3 p-p-0"},P={class:"p-col-8 p-sm-8 p-md-9 p-p-0 p-m-0 kn-router-view"};function V(e,t,M,A,I,L){const p=s("ProgressSpinner"),h=s("FabButton"),g=s("Toolbar"),m=s("ProgressBar"),u=s("KnListBox"),f=s("router-view");return n(),k("div",R,[e.loadingVersion?(n(),r(p,{key:0,class:"kn-progress-spinner"})):l("",!0),i("div",O,[i("div",F,[o(g,{class:"kn-toolbar kn-toolbar--primary"},{start:d(()=>[C(w(e.$t("managers.datasetManagement.title")),1)]),end:d(()=>[o(h,{icon:"fas fa-plus",onClick:e.showDetail,"data-test":"open-form-button"},null,8,["onClick"])]),_:1}),e.loading?(n(),r(m,{key:0,mode:"indeterminate",class:"kn-progress-bar","data-test":"progress-bar"})):l("",!0),o(u,{options:e.listOfDatasets,settings:e.mainDescriptor.knListSettings,onClick:e.showDetail,onClone:c(e.emitCloneDataset,["stop"]),onDelete:c(e.deleteDataset,["stop"])},null,8,["options","settings","onClick","onClone","onDelete"])]),i("div",P,[o(f,{scopeTypes:e.scopeTypes,categoryTypes:e.categoryTypes,datasetTypes:e.datasetTypes,transformationDataset:e.transformationDataset,scriptTypes:e.scriptTypes,dataSources:e.dataSources,businessModels:e.businessModels,pythonEnvironments:e.pythonEnvironments,rEnvironments:e.rEnvironments,metaSourceResource:e.metaSourceResource,datasetToCloneId:e.datasetToCloneId,availableTags:e.tags,onLoadingOlderVersion:t[0]||(t[0]=a=>e.loadingVersion=!0),onOlderVersionLoaded:t[1]||(t[1]=a=>e.loadingVersion=!1),onTouched:t[2]||(t[2]=a=>e.touched=!0),onCreated:e.onCreate,onUpdated:e.onUpdate,onShowSavingSpinner:t[3]||(t[3]=a=>e.loadingVersion=!0),onHideSavingSpinner:t[4]||(t[4]=a=>e.loadingVersion=!1),onClose:e.closeDetailConfirm},null,8,["scopeTypes","categoryTypes","datasetTypes","transformationDataset","scriptTypes","dataSources","businessModels","pythonEnvironments","rEnvironments","metaSourceResource","datasetToCloneId","availableTags","onCreated","onUpdated","onClose"])])])])}var K=y(B,[["render",V]]);export{K as default};
//# sourceMappingURL=DatasetManagement-8227df26.js.map
