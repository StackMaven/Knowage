import{_ as h,d as u,X as g,s as f,r as o,o as l,c as $,a as n,f as s,w as a,g as b,t as k,h as R,A as F,V as v}from"./index-1e676509.js";import{K as w}from"./KnListBox-94855720.js";import"./menu.esm-6bee86d0.js";const C=["name","roleTypeCD"],_={buttons:[{emits:"delete",icon:"fas fa-trash-alt",label:"common.delete"}],defaultSortField:"name",filterFields:["name"],interaction:{type:"event"},sortFields:["name"],textField:"roleTypeCD",titleField:"name"};var B={filterFields:C,knListSettings:_};const y=u({name:"roles-management",components:{FabButton:g,KnListBox:w},data(){return{roles:[],loading:!1,touched:!1,rolesDecriptor:B,hiddenForm:!1,dirty:!1,publicRole:null}},setup(){return{store:f()}},async created(){await this.loadAllRoles()},methods:{async loadAllRoles(){this.loading=!0,await this.$http.get("/knowage/restful-services/2.0/roles").then(e=>{this.roles=e.data,this.checkAllRolesForPublicRole()}).finally(()=>this.loading=!1)},checkAllRolesForPublicRole(){this.publicRole=null,this.roles.forEach(e=>{e.isPublic&&(this.publicRole=e)})},showForm(e){const t=e.item?`/roles-management/${e.item.id}`:"/roles-management/new-role";this.touched?this.$confirm.require({message:this.$t("common.toast.unsavedChangesMessage"),header:this.$t("common.toast.unsavedChangesHeader"),icon:"pi pi-exclamation-triangle",accept:()=>{this.touched=!1,this.$router.push(t)}}):this.$router.push(t)},deleteRoleConfirm(e){!e.item||this.$confirm.require({message:this.$t("common.toast.deleteMessage"),header:this.$t("common.toast.deleteTitle"),icon:"pi pi-exclamation-triangle",accept:()=>this.deleteRole(e.item.id)})},async deleteRole(e){await this.$http.delete("/knowage/restful-services/2.0/roles/"+e,{headers:{"X-Disable-Errors":"true"}}).then(()=>{this.store.setInfo({title:this.$t("common.toast.deleteTitle"),msg:this.$t("common.toast.deleteSuccess")}),this.$router.push("/roles-management"),this.loadAllRoles()}).catch(t=>{t&&this.store.setError({title:this.$t("common.toast.deleteTitle"),msg:this.$t("common.error.deleting")})})},pageReload(){this.touched=!1,this.loadAllRoles()}}}),T={class:"kn-page"},D={class:"kn-page-content p-grid p-m-0"},A={class:"kn-list--column p-col-4 p-sm-4 p-md-3 p-p-0"},L={class:"p-col-8 p-sm-8 p-md-9 p-p-0 p-m-0 kn-router-view"};function S(e,t,K,M,P,V){const i=o("FabButton"),r=o("Toolbar"),c=o("ProgressBar"),d=o("KnListBox"),m=o("router-view");return l(),$("div",T,[n("div",D,[n("div",A,[s(r,{class:"kn-toolbar kn-toolbar--primary"},{start:a(()=>[b(k(e.$t("managers.rolesManagement.title")),1)]),end:a(()=>[s(i,{icon:"fas fa-plus",onClick:e.showForm,"data-test":"open-form-button"},null,8,["onClick"])]),_:1}),e.loading?(l(),R(c,{key:0,mode:"indeterminate",class:"kn-progress-bar","data-test":"progress-bar"})):F("",!0),s(d,{class:"kn-height-full",options:e.roles,settings:e.rolesDecriptor.knListSettings,onClick:e.showForm,onDelete:v(e.deleteRoleConfirm,["stop"])},null,8,["options","settings","onClick","onDelete"])]),n("div",L,[s(m,{publicRole:e.publicRole,onTouched:t[0]||(t[0]=p=>e.touched=!0),onClosed:t[1]||(t[1]=p=>e.touched=!1),onInserted:e.pageReload},null,8,["publicRole","onInserted"])])])])}var q=h(y,[["render",S]]);export{q as default};
//# sourceMappingURL=RolesManagement-4ff4f3e1.js.map
