{"version":3,"file":"Timespan-ac1b48d3.js","sources":["../../../../modules/managers/timespan/Timespan.vue"],"sourcesContent":["<template>\r\n    <div class=\"kn-page\">\r\n        <div class=\"kn-page-content p-grid p-m-0\">\r\n            <div class=\"kn-list--column p-col-4 p-sm-4 p-md-3 p-p-0\">\r\n                <Toolbar class=\"kn-toolbar kn-toolbar--primary\">\r\n                    <template #start>\r\n                        {{ $t('managers.timespan.title') }}\r\n                    </template>\r\n                    <template #end>\r\n                        <FabButton icon=\"fas fa-plus\" @click=\"showTimespanDetails(null, false)\" />\r\n                    </template>\r\n                </Toolbar>\r\n                <ProgressBar v-if=\"loading\" class=\"kn-progress-bar\" mode=\"indeterminate\" data-test=\"progress-bar\" />\r\n                <KnListBox :options=\"timespans\" :settings=\"timespanDescriptor.knListSettings\" @click=\"showTimespanDetails($event, false)\" @clone.stop=\"showTimespanDetails($event, true)\" @delete.stop=\"deleteTimespanConfirm\" />\r\n            </div>\r\n\r\n            <div class=\"p-col-8 p-sm-8 p-md-9 p-p-0 p-m-0 kn-router-view\">\r\n                <router-view :categories=\"categories\" :timespans=\"timespans\" @timespanCreated=\"onTimespanCreated\" />\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { defineComponent } from 'vue'\r\nimport { iTimespan, iCategory } from './Timespan'\r\nimport { AxiosResponse } from 'axios'\r\nimport FabButton from '@/components/UI/KnFabButton.vue'\r\nimport KnListBox from '@/components/UI/KnListBox/KnListBox.vue'\r\nimport timespanDescriptor from './TimespanDescriptor.json'\r\nimport mainStore from '../../../App.store'\r\n\r\nexport default defineComponent({\r\n    name: 'timespan',\r\n    components: { KnListBox, FabButton },\r\n    data() {\r\n        return {\r\n            timespanDescriptor,\r\n            timespans: [] as iTimespan[],\r\n            categories: [] as iCategory[],\r\n            loading: false\r\n        }\r\n    },\r\n    setup() {\r\n        const store = mainStore()\r\n        return { store }\r\n    },\r\n    async created() {\r\n        await this.loadTimespans()\r\n        await this.loadCategories()\r\n    },\r\n    methods: {\r\n        async loadTimespans() {\r\n            this.loading = true\r\n            await this.$http.get(import.meta.env.VITE_RESTFUL_SERVICES_PATH + `1.0/timespan/listDynTimespan`).then(\r\n                (response: AxiosResponse<any>) =>\r\n                    (this.timespans = response.data?.map((timespan: iTimespan) => {\r\n                        return { ...timespan, isCloneable: timespan.type === 'temporal' }\r\n                    }))\r\n            )\r\n            this.loading = false\r\n        },\r\n        async loadCategories() {\r\n            this.loading = true\r\n            await this.$http.get(import.meta.env.VITE_RESTFUL_SERVICES_PATH + `domains/listValueDescriptionByType?DOMAIN_TYPE=TIMESPAN_CATEGORY`).then((response: AxiosResponse<any>) => (this.categories = response.data))\r\n            this.loading = false\r\n        },\r\n        showTimespanDetails(event: any, clone: boolean) {\r\n            const url = event ? `/timespan/edit-timespan?id=${event.item?.id}&clone=${clone}` : '/timespan/new-timespan'\r\n            this.$router.push(url)\r\n        },\r\n        deleteTimespanConfirm(event: any) {\r\n            this.$confirm.require({\r\n                message: this.$t('common.toast.deleteMessage'),\r\n                header: this.$t('common.toast.deleteTitle'),\r\n                icon: 'pi pi-exclamation-triangle',\r\n                accept: async () => {\r\n                    await this.deleteTimespan(event.item.id)\r\n                }\r\n            })\r\n        },\r\n        async deleteTimespan(id: number) {\r\n            this.loading = true\r\n            await this.$http\r\n                .post(import.meta.env.VITE_RESTFUL_SERVICES_PATH + `1.0/timespan/deleteTimespan?ID=${id}`)\r\n                .then((response: AxiosResponse<any>) => {\r\n                    if (response.data?.Status === 'OK') {\r\n                        this.store.setInfo({\r\n                            title: this.$t('common.toast.deleteTitle'),\r\n                            msg: this.$t('common.toast.deleteSuccess')\r\n                        })\r\n                        this.removeTimespan(id)\r\n                        this.$router.push('/timespan')\r\n                    }\r\n                })\r\n                .catch((error) => {\r\n                    this.store.setError({\r\n                        title: this.$t('common.toast.deleteTitle'),\r\n                        msg: error?.message\r\n                    })\r\n                })\r\n            this.loading = false\r\n        },\r\n        removeTimespan(id: number) {\r\n            const index = this.timespans.findIndex((timespan: iTimespan) => timespan.id === id)\r\n            if (index !== -1) this.timespans.splice(index, 1)\r\n        },\r\n        onTimespanCreated() {\r\n            this.loadTimespans()\r\n        }\r\n    }\r\n})\r\n</script>\r\n"],"names":["FabButton","mainStore","_openBlock","_createElementBlock","_createElementVNode","_createVNode","_withCtx","_createBlock","_createCommentVNode","_withModifiers"],"mappings":"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"}