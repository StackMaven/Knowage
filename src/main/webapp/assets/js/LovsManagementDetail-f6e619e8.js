import{d as B}from"./base64-d3a217e7.js";import{X as q}from"./x2js-1de3b703.js";import{K as oe,u as j,c as ae}from"./KnValidatonMessages-ebe48c72.js";import{d as M,ad as X,a5 as P,_ as L,r,o as m,h as w,w as n,a as o,f as a,G as V,t as k,ah as W,c as f,A as S,l as U,n as F,g as i,D as $,p as re,b as ne,i as O,q as ie,C as _,B as D,a4 as K,x as N,s as le,z as E,Y as I,y as se}from"./index-1e676509.js";import{f as A}from"./filterHelper-a723991a.js";import{s as de}from"./textarea.esm-32051d54.js";import{s as ce}from"./checkbox.esm-fa6c8259.js";import{s as pe}from"./radiobutton.esm-c3e6fa9b.js";const be={lov:[{fieldName:"label",validators:[{key:"required"},{key:"custom_unique_label",validator:{type:"custom-unique-label"}}]},{fieldName:"name",validators:[{key:"required"},{key:"custom_unique_name",validator:{type:"custom-unique-name"}}]},{fieldName:"itypeCd",validators:[{key:"required"}]}]};var Y={validations:be};const ue=M({name:"lovs-management-detail-card",components:{Card:X,Dropdown:P,KnValidationMessages:oe},props:{selectedLov:{type:Object},lovs:{type:Array,required:!0},listOfInputTypes:{type:Array}},emits:["touched","typeChanged"],data(){return{lovsManagementDetailCardValidation:Y,lov:{},v$:j()}},validations(){const e={"custom-unique-label":s=>this.fieldNotUnique(s,"label"),"custom-unique-name":s=>this.fieldNotUnique(s,"name")};return{lov:ae("lov",Y.validations.lov,e)}},watch:{selectedLov(){this.loadLov()}},async created(){this.loadLov()},methods:{loadLov(){this.lov=this.selectedLov},fieldNotUnique(e,t){return this.lovs.findIndex(b=>b[t]===e&&b.id!=this.lov.id)===-1},typeChanged(){this.$emit("touched"),this.$emit("typeChanged")}}}),ke={class:"p-fluid p-ai-end p-formgrid p-grid"},me={class:"p-field p-col-5 p-mb-5"},ve={class:"p-float-label"},ge={for:"label",class:"kn-material-input-label"},he={class:"p-field p-col-5 p-mb-5"},fe={class:"p-float-label"},ye={for:"name",class:"kn-material-input-label"},we={class:"p-field p-col-2 p-mb-5"},xe={for:"typeLovDropdown",class:"kn-material-input-label"},Me={class:"p-field p-col-12 p-mb-5"},Le={class:"p-float-label"},Ce={for:"description",class:"kn-material-input-label"};function Te(e,t,s,b,h,y){const c=r("InputText"),p=r("KnValidationMessages"),u=r("Dropdown"),v=r("Card");return m(),w(v,{class:"p-m-2"},{content:n(()=>[o("form",ke,[o("div",me,[o("span",ve,[a(c,{id:"label",class:V(["kn-material-input",{"p-invalid":e.v$.lov.label.$invalid&&e.v$.lov.label.$dirty}]),type:"text",modelValue:e.v$.lov.label.$model,"onUpdate:modelValue":t[0]||(t[0]=g=>e.v$.lov.label.$model=g),modelModifiers:{trim:!0},maxLength:"20",onBlur:t[1]||(t[1]=g=>e.v$.lov.label.$touch()),onInput:t[2]||(t[2]=g=>e.$emit("touched"))},null,8,["modelValue","class"]),o("label",ge,k(e.$t("common.label"))+" * ",1)]),a(p,{vComp:e.v$.lov.label,additionalTranslateParams:{fieldName:e.$t("common.label")},specificTranslateKeys:{custom_unique_label:"managers.lovsManagement.lovLabelNotUnique"}},null,8,["vComp","additionalTranslateParams","specificTranslateKeys"])]),o("div",he,[o("span",fe,[a(c,{id:"name",class:V(["kn-material-input",{"p-invalid":e.v$.lov.name.$invalid&&e.v$.lov.name.$dirty}]),type:"text",modelValue:e.v$.lov.name.$model,"onUpdate:modelValue":t[3]||(t[3]=g=>e.v$.lov.name.$model=g),modelModifiers:{trim:!0},maxLength:"50",onBlur:t[4]||(t[4]=g=>e.v$.lov.name.$touch()),onInput:t[5]||(t[5]=g=>e.$emit("touched"))},null,8,["modelValue","class"]),o("label",ye,k(e.$t("common.name"))+" * ",1)]),a(p,{vComp:e.v$.lov.name,additionalTranslateParams:{fieldName:e.$t("common.name")},specificTranslateKeys:{custom_unique_name:"managers.lovsManagement.lovNameNotUnique"}},null,8,["vComp","additionalTranslateParams","specificTranslateKeys"])]),o("div",we,[o("span",null,[o("label",xe,k(e.$t("managers.lovsManagement.lovType"))+" * ",1),a(u,{id:"typeLovDropdown",class:V(["kn-material-input",{"p-invalid":e.v$.lov.itypeCd.$invalid&&e.v$.lov.itypeCd.$dirty}]),modelValue:e.v$.lov.itypeCd.$model,"onUpdate:modelValue":t[6]||(t[6]=g=>e.v$.lov.itypeCd.$model=g),options:e.listOfInputTypes,optionLabel:"VALUE_NM",optionValue:"VALUE_CD",placeholder:e.$t("managers.lovsManagement.lovTypePlaceholder"),"aria-label":"dropdown",onBeforeShow:t[7]||(t[7]=g=>e.v$.lov.itypeCd.$touch()),onChange:e.typeChanged},null,8,["class","modelValue","options","placeholder","onChange"])]),a(p,{vComp:e.v$.lov.itypeCd,additionalTranslateParams:{fieldName:e.$t("managers.lovsManagement.lovType")}},null,8,["vComp","additionalTranslateParams"])]),o("div",Me,[o("span",Le,[a(c,{id:"description",class:"kn-material-input",type:"text",modelValue:e.lov.description,"onUpdate:modelValue":t[8]||(t[8]=g=>e.lov.description=g),modelModifiers:{trim:!0},maxLength:"160",onInput:t[9]||(t[9]=g=>e.$emit("touched"))},null,8,["modelValue"]),o("label",Ce,k(e.$t("managers.lovsManagement.description")),1)])])])]),_:1})}var Se=L(ue,[["render",Te]]);const Ae={paginationEnd:20,paginationLimit:20,paginationStart:0};var J={defaultPagination:Ae};const $e=M({name:"lovs-management-query",components:{Dropdown:P,VCodeMirror:W},props:{selectedLov:{type:Object,required:!0},selectedQuery:{type:Object},datasources:{type:Array},codeInput:{type:Object}},emits:["touched"],data(){return{lov:{},query:{},code:"",dirty:!1,codeMirror:{},options:{mode:"text/x-mysql",indentWithTabs:!0,smartIndent:!0,lineWrapping:!0,matchBrackets:!0,autofocus:!0,theme:"eclipse",lineNumbers:!0},cursorPosition:null}},watch:{selectedLov(){this.loadLov(),this.loadSelectedQuery(),this.setupCodeMirror()},codeInput(){var e;this.setupCodeMirror(),this.cursorPosition=this.codeMirror.getCursor(),this.codeMirror.replaceRange("${"+((e=this.codeInput)==null?void 0:e.code)+"}",this.cursorPosition)}},computed:{lovType(){return this.selectedLov.itypeCd}},async created(){this.loadLov(),this.loadSelectedQuery(),this.setupCodeMirror()},methods:{loadLov(){this.lov=this.selectedLov},loadSelectedQuery(){var e;this.query=this.selectedQuery,this.query&&(this.code=(e=this.query.query)!=null?e:"")},setupCodeMirror(){this.$refs.codeMirror&&(this.codeMirror=this.$refs.codeMirror.cminstance)},onKeyUp(){this.query.query=this.code,this.$emit("touched")}}}),Ee={class:"p-fluid p-m-4"},Ve={for:"dataSource",class:"kn-material-input-label","aria-label":"dropdown"},De={key:0,class:"p-error p-grid"},Oe={class:"p-col-12"},Ne={key:0,class:"p-mt-4"},Ie={class:"kn-material-input-label"};function Pe(e,t,s,b,h,y){const c=r("Dropdown"),p=r("VCodeMirror");return m(),f("div",Ee,[o("div",null,[o("span",null,[o("label",Ve,k(e.$t("managers.lovsManagement.dataSource"))+" * ",1),a(c,{id:"dataSource",class:V(["kn-material-input",{"p-invalid":!e.query.datasource&&e.dirty}]),modelValue:e.query.datasource,"onUpdate:modelValue":t[0]||(t[0]=u=>e.query.datasource=u),options:e.datasources,optionLabel:"label",optionValue:"label",placeholder:e.$t("managers.lovsManagement.placeholderDatasource"),"aria-label":"dropdown",onBeforeShow:t[1]||(t[1]=u=>e.dirty=!0),onChange:t[2]||(t[2]=u=>e.$emit("touched"))},null,8,["class","modelValue","options","placeholder"])]),!e.query.datasource&&e.dirty?(m(),f("div",De,[o("small",Oe,k(e.$t("common.validation.required",{fieldName:e.$t("managers.lovsManagement.dataSource")})),1)])):S("",!0)]),e.query.datasource?(m(),f("div",Ne,[o("label",Ie,k(e.$t("managers.lovsManagement.queryDefinition")),1),a(p,{ref:"codeMirror",class:"p-mt-2",value:e.code,"onUpdate:value":t[3]||(t[3]=u=>e.code=u),autoHeight:!0,options:e.options,onKeyup:e.onKeyUp},null,8,["value","options","onKeyup"])])):S("",!0)])}var Ue=L($e,[["render",Pe]]);const Fe=M({name:"lovs-management-script",components:{Dropdown:P,VCodeMirror:W},props:{selectedLov:{type:Object,required:!0},selectedScript:{type:Object,required:!0},listOfScriptTypes:{type:Array}},emits:["touched"],data(){return{lov:{},script:{},code:"",dirty:!1,codeMirror:{},options:{mode:"",indentWithTabs:!0,smartIndent:!0,lineWrapping:!0,matchBrackets:!0,autofocus:!0,theme:"eclipse",lineNumbers:!0}}},watch:{selectedLov(){this.loadLov(),this.loadSelectedScript()}},computed:{lovType(){return this.selectedLov.itypeCd}},created(){this.loadLov(),this.loadSelectedScript(),this.setupCodeMirror()},methods:{loadLov(){this.lov=this.selectedLov},loadSelectedScript(){var e;this.script=this.selectedScript,this.script&&(this.code=(e=this.script.text)!=null?e:""),this.options.mode=this.script.type==="ECMAScript"?"text/javascript":"text/x-groovy"},onKeyUp(){this.$emit("touched"),this.script.text=this.code},onLanguageChanged(e){const t=e==="ECMAScript"?"text/javascript":"text/x-groovy";setTimeout(()=>{this.setupCodeMirror(),this.codeMirror.setOption("mode",t)},250),this.$emit("touched")},setupCodeMirror(){this.$refs.codeMirror&&(this.codeMirror=this.$refs.codeMirror.cminstance)}}}),ze={class:"p-fluid p-m-4"},Re={for:"language",class:"kn-material-input-label","aria-label":"dropdown"},Je={key:0,class:"p-error p-grid"},_e={class:"p-col-12"},Be={key:0,class:"p-mt-4"},Ye={class:"kn-material-input-label"};function Qe(e,t,s,b,h,y){const c=r("Dropdown"),p=r("VCodeMirror");return m(),f("div",ze,[o("div",null,[o("span",null,[o("label",Re,k(e.$t("managers.lovsManagement.language"))+" * ",1),a(c,{id:"language",class:V(["kn-material-input",{"p-invalid":!e.script.language&&e.dirty}]),modelValue:e.script.language,"onUpdate:modelValue":t[0]||(t[0]=u=>e.script.language=u),options:e.listOfScriptTypes,optionLabel:"VALUE_NM",optionValue:"VALUE_CD",placeholder:e.$t("managers.lovsManagement.placeholderScript"),"aria-label":"dropdown",onBeforeShow:t[1]||(t[1]=u=>e.dirty=!0),onChange:t[2]||(t[2]=u=>e.onLanguageChanged(u.value))},null,8,["class","modelValue","options","placeholder"])]),!e.script.language&&e.dirty?(m(),f("div",Je,[o("small",_e,k(e.$t("common.validation.required",{fieldName:e.$t("managers.lovsManagement.language")})),1)])):S("",!0)]),e.script.language?(m(),f("div",Be,[o("label",Ye,k(e.$t("managers.lovsManagement.script")),1),a(p,{ref:"codeMirror",class:"p-mt-2",value:e.code,"onUpdate:value":t[3]||(t[3]=u=>e.code=u),autoHeight:!0,options:e.options,onKeyup:e.onKeyUp},null,8,["value","options","onKeyup"])])):S("",!0)])}var qe=L(Fe,[["render",Qe]]);const je=["VALUE","DESCRIPTION"],Xe={iconColumn:{style:{"text-align":"end",width:"10%"}},inputColumnStyle:{width:"30%"},reorderColumn:{headerStyle:{width:"3rem"}},textAreaColumnStyle:{width:"60%"}};var We={globalFilterFields:je,table:Xe};const Ke=M({name:"lovs-management-fixed-lovs-table",components:{Column:U,DataTable:F,Textarea:de},props:{listForFixLov:{type:Array}},emits:["touched","sorted"],data(){return{lovsManagementFixedLovsTableDescriptor:We,selectedValue:{},values:[],filters:{global:[A]}}},created(){this.load()},methods:{load(){this.values=this.listForFixLov},addFixedValue(){this.values.push({VALUE:"",DESCRIPTION:""})},setPositionOnReorder(e){this.values=e.value,this.$emit("sorted",this.values)},deleteValueConfirm(e){this.$confirm.require({message:this.$t("common.toast.deleteMessage"),header:this.$t("common.toast.deleteTitle"),icon:"pi pi-exclamation-triangle",accept:()=>{this.deleteValue(e)}})},deleteValue(e){this.values.splice(e,1)},onCellEditComplete(e){this.values[e.index]=e.newData}}}),z=e=>(re("data-v-198a06ba"),e=e(),ne(),e),Ge={class:"table-header"},Ze={class:"table-header p-d-flex p-ai-center p-jc-between"},He={id:"search-container",class:"p-input-icon-left p-mr-3"},et=z(()=>o("i",{class:"pi pi-search"},null,-1)),tt=z(()=>o("i",{class:"pi pi-pencil edit-icon"},null,-1)),ot={class:"p-mr-2","data-test":"value-body"},at=z(()=>o("i",{class:"pi pi-pencil edit-icon"},null,-1)),rt=z(()=>o("i",{class:"pi pi-pencil edit-icon"},null,-1)),nt={class:"p-mr-2","data-test":"description-body"},it=z(()=>o("i",{class:"pi pi-pencil edit-icon"},null,-1));function lt(e,t,s,b,h,y){const c=r("InputText"),p=r("Button"),u=r("Column"),v=r("Textarea"),g=r("DataTable");return m(),w(g,{value:e.values,class:"p-datatable-sm kn-table p-m-5",editMode:"cell",filters:e.filters,"onUpdate:filters":t[3]||(t[3]=d=>e.filters=d),globalFilterFields:e.lovsManagementFixedLovsTableDescriptor.globalFilterFields,responsiveLayout:"stack",breakpoint:"960px",onRowReorder:e.setPositionOnReorder,onCellEditComplete:e.onCellEditComplete,"data-test":"values-list"},{empty:n(()=>[i(k(e.$t("common.info.noDataFound")),1)]),loading:n(()=>[i(k(e.$t("common.info.dataLoading")),1)]),header:n(()=>[o("div",Ge,[o("div",Ze,[o("span",He,[et,a(c,{class:"kn-material-input",modelValue:e.filters.global.value,"onUpdate:modelValue":t[0]||(t[0]=d=>e.filters.global.value=d),type:"text",placeholder:e.$t("common.search"),"data-test":"filter-input"},null,8,["modelValue","placeholder"])]),a(p,{id:"add-fixed-value-button",class:"kn-button kn-button--primary",label:e.$t("managers.lovsManagement.add"),onClick:e.addFixedValue,"data-test":"new-button"},null,8,["label","onClick"])])])]),default:n(()=>[a(u,{rowReorder:!0,headerStyle:e.lovsManagementFixedLovsTableDescriptor.table.reorderColumn.headerStyle,reorderableColumn:!1},null,8,["headerStyle"]),a(u,{class:"kn-truncated p-mr-2",style:$(e.lovsManagementFixedLovsTableDescriptor.table.inputColumnStyle),field:"VALUE",header:e.$t("managers.lovsManagement.value")},{editor:n(d=>[a(c,{class:"p-mr-2",type:"text",modelValue:d.data[d.column.props.field],"onUpdate:modelValue":l=>d.data[d.column.props.field]=l,modelModifiers:{trim:!0},maxLength:"20",onInput:t[1]||(t[1]=l=>e.$emit("touched")),"data-test":"value-input"},null,8,["modelValue","onUpdate:modelValue"]),tt]),body:n(d=>[o("span",ot,k(d.data.VALUE),1),at]),_:1},8,["style","header"]),a(u,{class:"kn-truncated",style:$(e.lovsManagementFixedLovsTableDescriptor.table.textAreaColumnStyle),field:"DESCRIPTION",header:e.$t("managers.lovsManagement.description")},{editor:n(d=>[a(v,{class:"p-mr-2",type:"text",modelValue:d.data[d.column.props.field],"onUpdate:modelValue":l=>d.data[d.column.props.field]=l,modelModifiers:{trim:!0},maxLength:"160",rows:"2",cols:"80",onInput:t[2]||(t[2]=l=>e.$emit("touched")),"data-test":"description-input"},null,8,["modelValue","onUpdate:modelValue"]),rt]),body:n(d=>[o("span",nt,k(d.data.DESCRIPTION),1),it]),_:1},8,["style","header"]),a(u,{style:$(e.lovsManagementFixedLovsTableDescriptor.table.iconColumn.style)},{body:n(d=>[a(p,{icon:"pi pi-trash",class:"p-button-link",onClick:l=>e.deleteValueConfirm(d.index),"data-test":"delete-button-"+d.index},null,8,["onClick","data-test"])]),_:1},8,["style"])]),_:1},8,["value","filters","globalFilterFields","onRowReorder","onCellEditComplete"])}var st=L(Ke,[["render",lt],["__scopeId","data-v-198a06ba"]]);const dt=M({name:"lovs-management-java-class-input",components:{},props:{selectedJavaClass:{type:Object}},data(){return{javaClass:{},dirty:!1}},watch:{selectedJavaClass(){this.loadJavaClass()}},created(){this.loadJavaClass()},methods:{loadJavaClass(){this.javaClass=this.selectedJavaClass}}}),ct={class:"p-fluid p-m-4"},pt={class:"p-float-label"},bt={for:"javaClassName",class:"kn-material-input-label"},ut={key:0,class:"p-error p-grid"},kt={class:"p-col-12"};function mt(e,t,s,b,h,y){const c=r("InputText");return m(),f("div",ct,[o("span",pt,[a(c,{id:"javaClassName",class:V(["kn-material-input",{"p-invalid":!e.javaClass.name&&e.dirty}]),type:"text",modelValue:e.javaClass.name,"onUpdate:modelValue":t[0]||(t[0]=p=>e.javaClass.name=p),modelModifiers:{trim:!0},maxLength:"160",onBlur:t[1]||(t[1]=p=>e.dirty=!0),onInput:t[2]||(t[2]=p=>e.$emit("touched"))},null,8,["modelValue","class"]),o("label",bt,k(e.$t("managers.lovsManagement.javaClassName"))+" * ",1)]),!e.javaClass.name&&e.dirty?(m(),f("div",ut,[o("small",kt,k(e.$t("common.validation.required",{fieldName:e.$t("managers.lovsManagement.javaClassName")})),1)])):S("",!0)])}var vt=L(dt,[["render",mt]]);const gt={style:{width:"60vw"}};var ht={dialog:gt};const ft=M({name:"lovs-management-info-dialog",components:{Dialog:O},emits:["close"],props:{visible:{type:Boolean},infoTitle:{type:String},lovType:{type:Object}},data(){return{lovsManagementInfoDialogDescriptor:ht,lovItemEnum:G}},created(){},methods:{}}),yt={key:0},wt=o("p",null," The script must be written using Groovy or Javascript languages. ",-1),xt=o("p",null,[i(" The script must return an XML string containing a list of values with the syntax shown below. If the script instead returns a single value this is automatically enveloped in such XML. <ROWS>"),o("br"),i(' <ROW value="value1" ... />'),o("br"),i(' <ROW value="value2" ... />'),o("br"),i(" ..."),o("br"),i(" </ROWS> ")],-1),Mt=o("p",null,"Scripts can be parametrized with profile attributes, called with syntax ${name_attribute}; these can have a sinle or a multi value:",-1),Lt=o("p",null,[i("A profile multi-value attribute is registered in authorization.xml file, and its value is written with syntax: "),o("i",null,"{splitter {value_1 splitter value_2 splitter ... value_n}};")],-1),Ct=o("p",null,"For groovy and javascript scripts some functions are added by system that let user to include a value in XML string and to treat multi-values attribute:",-1),Tt=o("p",null,[o("b",null,"returnValue(value_to_return)"),i(": Returns the value with the following syntax")],-1),St=o("hr",null,null,-1),At=o("hr",null,null,-1),$t=i(" <ROWS>"),Et=o("br",null,null,-1),Vt=i(' <ROW value="valueAttribute1" />'),Dt=o("br",null,null,-1),Ot=i(" </ROWS> "),Nt=o("p",null,[o("b",null,"getListFromMultiValueProfileAttribute(String nameAttribute)"),i(': Returns list of values of a multi value profile attribute with following syntax (parameter must be enclosed between "") <ROWS>'),o("br"),i(' <ROW value="value1" ... />'),o("br"),i(' <ROW value="value2" ... />'),o("br"),i(" ..."),o("br"),i(" </ROWS> ")],-1),It=o("p",null,[o("b",null,"Example:"),i(),o("i",null,'getListFromMultiValueProfileAttribute("${multi_value_attribute}")')],-1),Pt=o("p",null,[o("b",null,"getMultiValueProfileAttribute(String nameAttribute, String prefix, String newSplitter, String suffix)"),i(' : Return list f values of multi value attribute, preceded by the prefix, separated by the new splitter and followed by suffix (parameter must be enclosed between "")'),o("br"),o("b",null,"Example:"),i(" select ... where "),o("i",null,' column ${multi_value_attribute( "in (" ; "," ; ") ") })')],-1),Ut=[wt,xt,Mt,Lt,Ct,Tt,St,At,$t,Et,Vt,Dt,Ot,Nt,It,Pt],Ft={key:1},zt=o("p",null,[i(" Column names with dots or aggregator functions are not allowed, if you need them use alias (as)."),o("br"),o("b",null,"Example:"),i(" select sum(column) as name_colum, select column.column as name_column ")],-1),Rt=o("p",null,[i(" To use a single value profile attribute into the query use "),o("b",null,"${name_profile_attribute}"),o("br"),o("b",null,"Example:"),i(" select ... where column = '${name_profile_attribute}'). ")],-1),Jt=o("p",null,[i(" To use a multi value profile attribute use "),o("b",null,"${name_profile_attribute(prefix;splitter;suffix)}"),i(" The profile attribute will be replaced by prefix+(list of values separated by the splitter)+suffix."),o("br"),o("b",null,"Example:"),i(" select ... where column ${name_profile_attribute( in (';',';') )}) ")],-1),_t=[zt,Rt,Jt],Bt={key:2},Yt=o("p",null,[i("To insert a single value profile attribute into a fix lov value use "),o("b",null,"${name_profile_attribute}"),i(".")],-1),Qt=i(" To insert a multi value profile attribute into a fix lov value use "),qt=o("b",null,"${name_profile_attribute(prefix;splitter;suffix)}",-1),jt=i("."),Xt=o("br",null,null,-1),Wt=i(" The profile attribute will be replaced by prefix+(list of values separated by the splitter)+suffix"),Kt=o("br",null,null,-1),Gt=o("b",null,"Example:",-1),Zt=i(" ${name_profile_attribute( in (';',';') )} "),Ht=[Yt,Qt,qt,jt,Xt,Wt,Kt,Gt,Zt],eo={key:3},to=o("p",null," The java class must implement the interface it.eng.spagobi.bo.javaClassLovs.IJavaClassLov. This interface has two methods: getValues(IEngUserProfile profile): the method returns an xml string containing the list of values. The xml string must be formatted using the xml structure reported below getNamesOfProfileAttributeRequired(): the method returns a java list containing the names of profile attributes used by the class. If the class doesn't use profile attributes simply returns an empty list. ",-1),oo=o("p",null,[o("b",null,"Xml structure of the returned string")],-1),ao=o("hr",null,null,-1),ro=o("hr",null,null,-1),no=o("p",null,[i(" <ROWS>"),o("br"),i(' <ROW nameAttribute1="valueAttribute1" nameAttribute2="valueAttribute2" ... />'),o("br"),i(' <ROW nameAttribute1="valueAttribute1" nameAttribute2="valueAttribute2" ... />'),o("br"),i(" ..."),o("br"),i(" All the rows must have the same attributes !"),o("br"),i(" ..."),o("br"),i(" </ROWS> ")],-1),io=[to,oo,ao,ro,no];function lo(e,t,s,b,h,y){const c=r("Button"),p=r("Dialog");return m(),w(p,{style:$(e.lovsManagementInfoDialogDescriptor.dialog.style),header:e.infoTitle,visible:e.visible,modal:!0,class:"p-fluid kn-dialog--toolbar--primary",closable:!1},{footer:n(()=>[a(c,{class:"kn-button kn-button--primary",onClick:t[0]||(t[0]=u=>e.$emit("close"))},{default:n(()=>[i(k(e.$t("common.close")),1)]),_:1})]),default:n(()=>[e.lovType===e.lovItemEnum.SCRIPT?(m(),f("div",yt,Ut)):e.lovType===e.lovItemEnum.QUERY?(m(),f("div",Ft,_t)):e.lovType===e.lovItemEnum.FIX_LOV?(m(),f("div",Bt,Ht)):e.lovType===e.lovItemEnum.JAVA_CLASS?(m(),f("div",eo,io)):S("",!0)]),_:1},8,["style","header","visible"])}var so=L(ft,[["render",lo]]);const co=M({name:"lovs-management-preview-dialog",components:{Column:U,DataTable:F,Dialog:O,Message:ie},emits:["close","pageChanged"],props:{visible:{type:Boolean},dataForPreview:{type:Object,required:!0},pagination:{type:Object}},data(){return{columns:[],rows:[],lazyParams:{},sorted:"ASC"}},watch:{dataForPreview(){this.loadData()}},created(){this.loadData()},methods:{loadData(){var e;(e=this.dataForPreview.metaData)!=null&&e.fields&&this.formatColumns(),this.loadPagination(),this.rows=this.dataForPreview.root},formatColumns(){this.columns=[];for(let e=0;e<this.dataForPreview.metaData.fields.length;e++)this.columns.push({field:this.dataForPreview.metaData.fields[e].name,header:this.dataForPreview.metaData.fields[e].name})},loadPagination(){this.lazyParams=this.pagination},onPage(e){this.lazyParams={paginationStart:e.first,paginationLimit:e.rows,paginationEnd:e.first+e.rows,size:this.lazyParams.size},this.$emit("pageChanged",this.lazyParams)},onSort(){this.sorted==="DESC"?(this.rows=this.rows.sort((e,t)=>e.sortField>t.sortField?1:-1),this.sorted="ASC"):(this.rows=this.rows.sort((e,t)=>e.sortField<t.sortField?1:-1),this.sorted="DESC")}}});function po(e,t,s,b,h,y){const c=r("Message"),p=r("Column"),u=r("DataTable"),v=r("Button"),g=r("Dialog");return m(),w(g,{header:e.$t("managers.lovsManagement.preview"),visible:e.visible,modal:!0,class:"lovPreviewDialog kn-dialog--toolbar--primary",closable:!1},{footer:n(()=>[a(v,{class:"kn-button kn-button--primary",onClick:t[1]||(t[1]=d=>e.$emit("close"))},{default:n(()=>[i(k(e.$t("common.close")),1)]),_:1})]),default:n(()=>[a(c,{class:"p-m-4",severity:"info",closable:!1},{default:n(()=>[i(k(e.$t("managers.lovsManagement.filterNullValues")),1)]),_:1}),a(u,{value:e.rows,class:"p-datatable-sm kn-table",dataKey:"field",scrollHeight:"flex",scrollable:!0,scrollDirection:"both",lazy:!0,paginator:!0,rows:15,totalRecords:e.lazyParams.size,responsiveLayout:"stack",breakpoint:"960px",onPage:t[0]||(t[0]=d=>e.onPage(d)),onSort:e.onSort},{empty:n(()=>[i(k(e.$t("common.info.noDataFound")),1)]),default:n(()=>[(m(!0),f(D,null,_(e.columns,d=>(m(),w(p,{class:"kn-truncated",field:d.field,header:d.header,key:d.field,sortable:!0,style:{"flex-grow":"1","flex-basis":"200px"}},null,8,["field","header"]))),128))]),_:1},8,["value","totalRecords","onSort"])]),_:1},8,["header","visible"])}var bo=L(co,[["render",po]]);const uo={style:{width:"60vw"}},ko=["attributeName"],mo={style:{"max-height":"450px"}};var vo={dialog:uo,filterFields:ko,listBox:mo};const go=M({name:"lovs-management-info-dialog",components:{Dialog:O,Listbox:K},emits:["close","selected"],props:{visible:{type:Boolean},profileAttributes:{type:Array}},data(){return{lovsManagementProfileAttributesListDescriptor:vo}},created(){},methods:{}}),ho={class:"kn-list-item"},fo={class:"kn-list-item-text"};function yo(e,t,s,b,h,y){const c=r("Listbox"),p=r("Button"),u=r("Dialog");return m(),w(u,{style:$(e.lovsManagementProfileAttributesListDescriptor.dialog.style),header:e.$t("managers.lovsManagement.profileAttributes"),visible:e.visible,modal:!0,class:"p-fluid kn-dialog--toolbar--primary",closable:!1},{footer:n(()=>[a(p,{class:"kn-button kn-button--primary",onClick:t[1]||(t[1]=v=>e.$emit("close"))},{default:n(()=>[i(k(e.$t("common.close")),1)]),_:1})]),default:n(()=>[a(c,{class:"kn-list",options:e.profileAttributes,listStyle:e.lovsManagementProfileAttributesListDescriptor.listBox.style,filter:!0,filterPlaceholder:e.$t("common.search"),optionLabel:"name",filterMatchMode:"contains",filterFields:e.lovsManagementProfileAttributesListDescriptor.filterFields,emptyFilterMessage:e.$t("common.info.noDataFound"),onChange:t[0]||(t[0]=v=>e.$emit("selected",v.value.attributeName))},{empty:n(()=>[i(k(e.$t("common.info.noDataFound")),1)]),option:n(v=>[o("div",ho,[o("div",fo,[o("span",null,k(v.option.attributeName),1)])])]),_:1},8,["options","listStyle","filterPlaceholder","filterFields","emptyFilterMessage"])]),_:1},8,["style","header","visible"])}var wo=L(go,[["render",yo]]);const xo=[{name:"Simple",value:"simple"},{name:"Tree",value:"tree"},{name:"Tree selectable inner nodes",value:"treeinner"}];var Mo={treeTypes:xo};const Lo=["name"];var Co={globalFilterFields:Lo};const To=M({name:"lovs-management-simple-datatable",components:{Checkbox:ce,Column:U,DataTable:F,RadioButton:pe},props:{tableData:{type:Object},treeListTypeModel:{type:Object,required:!0}},emits:["modelChanged"],data(){return{lovsManagementSimpleDatatableDescriptor:Co,filters:{global:[A]},data:{},model:{},selectedValue:null,selectedDescription:null,selectedVisible:[],visibleOptions:[]}},watch:{tableData(){this.loadData()},treeListTypeModel(){this.loadModel()}},created(){this.loadData(),this.loadSelectedModel(),this.loadModel()},methods:{loadData(){this.data=this.tableData,this.visibleOptions=[],this.data&&this.data.length>0&&this.data.forEach(e=>this.visibleOptions.push(e.name))},loadModel(){this.model=this.treeListTypeModel},loadSelectedModel(){this.selectedValue=this.treeListTypeModel["VALUE-COLUMN"],this.selectedDescription=this.treeListTypeModel["DESCRIPTION-COLUMN"],this.selectedVisible=[],this.treeListTypeModel["VISIBLE-COLUMNS"].split(",").forEach(e=>{e&&this.selectedVisible.push(e)})},setSelectedValue(){this.model["VALUE-COLUMN"]=this.selectedValue,this.$emit("modelChanged",this.model)},setSelectedDescription(){this.model["DESCRIPTION-COLUMN"]=this.selectedDescription,this.$emit("modelChanged",this.model)},setSelectedVisible(){this.model["VISIBLE-COLUMNS"]=this.selectedVisible.toString(),this.$emit("modelChanged",this.model)}}}),So={class:"table-header"},Ao={class:"p-input-icon-left"},$o=o("i",{class:"pi pi-search"},null,-1);function Eo(e,t,s,b,h,y){const c=r("InputText"),p=r("Column"),u=r("RadioButton"),v=r("Checkbox"),g=r("DataTable");return m(),w(g,{value:e.data,class:"p-datatable-sm kn-table",dataKey:"field",filters:e.filters,"onUpdate:filters":t[4]||(t[4]=d=>e.filters=d),globalFilterFields:e.lovsManagementSimpleDatatableDescriptor.globalFilterFields,responsiveLayout:"stack",breakpoint:"960px",onPage:t[5]||(t[5]=d=>e.onPage(d))},{header:n(()=>[o("div",So,[o("span",Ao,[$o,a(c,{class:"kn-material-input",type:"text",modelValue:e.filters.global.value,"onUpdate:modelValue":t[0]||(t[0]=d=>e.filters.global.value=d),placeholder:e.$t("common.search"),badge:"0","data-test":"search-input"},null,8,["modelValue","placeholder"])])])]),empty:n(()=>[i(k(e.$t("common.info.noDataFound")),1)]),default:n(()=>[a(p,{class:"kn-truncated",field:"name",header:e.$t("common.name")},null,8,["header"]),a(p,{header:e.$t("managers.lovsManagement.value")},{body:n(d=>[a(u,{modelValue:e.selectedValue,"onUpdate:modelValue":t[1]||(t[1]=l=>e.selectedValue=l),name:"value",value:d.data.name,onChange:e.setSelectedValue},null,8,["modelValue","value","onChange"])]),_:1},8,["header"]),a(p,{header:e.$t("common.description")},{body:n(d=>[a(u,{modelValue:e.selectedDescription,"onUpdate:modelValue":t[2]||(t[2]=l=>e.selectedDescription=l),name:"description",value:d.data.name,onChange:e.setSelectedDescription},null,8,["modelValue","value","onChange"])]),_:1},8,["header"]),a(p,{header:e.$t("managers.lovsManagement.visible")},{body:n(d=>[a(v,{modelValue:e.selectedVisible,"onUpdate:modelValue":t[3]||(t[3]=l=>e.selectedVisible=l),name:"visible",value:d.data.name,onChange:e.setSelectedVisible},null,8,["modelValue","value","onChange"])]),_:1},8,["header"])]),_:1},8,["value","filters","globalFilterFields"])}var Vo=L(To,[["render",Eo]]);const Do=["name"],Oo={style:{"max-height":"450px"}},No={iconColumn:{style:{"text-align":"end",width:"10%"}}};var Io={filterFields:Do,listBox:Oo,table:No};const Po=M({name:"lovs-management-tree",components:{Column:U,DataTable:F,Dropdown:P,Listbox:K},props:{listData:{type:Object},treeModel:{type:Array}},emits:["modelChanged"],data(){return{lovsManagementTreeDescriptor:Io,data:{},selectedValues:[],options:[]}},watch:{listData(){this.loadData(),this.loadModel()},treeModel(){this.loadData(),this.loadModel()}},created(){this.loadData(),this.loadModel()},methods:{loadData(){this.data=this.listData,this.options=[],this.data.forEach(e=>this.options.push({name:e.name,label:e.name}))},loadModel(){this.selectedValues=this.treeModel,this.removeUnusedSelectedValues()},removeUnusedSelectedValues(){for(let e=0;e<this.selectedValues.length;e++)this.data.findIndex(s=>s.name===this.selectedValues[e].value)===-1&&this.selectedValues.splice(e,1)},setSelectedValue(e){this.selectedValues.findIndex(s=>s.level===e.name)===-1&&this.selectedValues.push({level:e.name,value:e.name,description:e.name}),this.$emit("modelChanged",this.selectedValues)},removeValueConfirm(e){this.$confirm.require({message:this.$t("common.toast.deleteMessage"),header:this.$t("common.toast.deleteTitle"),icon:"pi pi-exclamation-triangle",accept:()=>{this.removeValue(e)}})},removeValue(e){this.selectedValues.splice(e,1),this.$emit("modelChanged",this.selectedValues)},onCellEditComplete(e){this.selectedValues[e.index]=e.newData}}}),Uo={class:"p-d-flex p-flex-row"},Fo={class:"p-col-3"},zo={class:"kn-list-item"},Ro={class:"kn-list-item-text"},Jo={class:"p-col-9"},_o=o("i",{class:"pi pi-pencil edit-icon"},null,-1),Bo={class:"p-mr-2"},Yo=o("i",{class:"pi pi-pencil edit-icon"},null,-1),Qo=o("i",{class:"pi pi-pencil edit-icon"},null,-1),qo={class:"p-mr-2"},jo=o("i",{class:"pi pi-pencil edit-icon"},null,-1);function Xo(e,t,s,b,h,y){const c=r("Toolbar"),p=r("Listbox"),u=r("Column"),v=r("Dropdown"),g=r("Button"),d=r("DataTable");return m(),f("div",Uo,[o("div",Fo,[a(c,{class:"kn-toolbar kn-toolbar--primary"},{start:n(()=>[i(k(e.$t("managers.lovsManagement.fields")),1)]),_:1}),a(p,{class:"kn-list",options:e.data,listStyle:e.lovsManagementTreeDescriptor.listBox.style,filter:!0,filterPlaceholder:e.$t("common.search"),optionLabel:"name",filterMatchMode:"contains",filterFields:e.lovsManagementTreeDescriptor.filterFields,emptyFilterMessage:e.$t("common.info.noDataFound"),onChange:t[0]||(t[0]=l=>e.setSelectedValue(l.value))},{empty:n(()=>[i(k(e.$t("common.info.noDataFound")),1)]),option:n(l=>[o("div",zo,[o("div",Ro,[o("span",null,k(l.option.name),1)])])]),_:1},8,["options","listStyle","filterPlaceholder","filterFields","emptyFilterMessage"])]),o("div",Jo,[a(c,{class:"kn-toolbar kn-toolbar--primary"},{start:n(()=>[i(k(e.$t("managers.lovsManagement.definition")),1)]),_:1}),a(d,{value:e.selectedValues,class:"p-datatable-sm kn-table",editMode:"cell",responsiveLayout:"stack",breakpoint:"960px",onCellEditComplete:e.onCellEditComplete},{empty:n(()=>[i(k(e.$t("common.info.noDataFound")),1)]),default:n(()=>[a(u,{class:"kn-truncated",field:"level",header:e.$t("managers.lovsManagement.level")},null,8,["header"]),a(u,{class:"kn-truncated p-mr-2",field:"value",header:e.$t("managers.lovsManagement.value")},{editor:n(l=>[a(v,{class:"p-mr-2",modelValue:l.data[l.column.props.field],"onUpdate:modelValue":T=>l.data[l.column.props.field]=T,modelModifiers:{trim:!0},optionLabel:"name",optionValue:"name",options:e.options},null,8,["modelValue","onUpdate:modelValue","options"]),_o]),body:n(l=>[o("span",Bo,k(l.data.value),1),Yo]),_:1},8,["header"]),a(u,{class:"kn-truncated p-mr-2",field:"description",header:e.$t("managers.lovsManagement.description")},{editor:n(l=>[a(v,{class:"p-mr-2",modelValue:l.data[l.column.props.field],"onUpdate:modelValue":T=>l.data[l.column.props.field]=T,modelModifiers:{trim:!0},optionLabel:"name",optionValue:"name",options:e.options},null,8,["modelValue","onUpdate:modelValue","options"]),Qo]),body:n(l=>[o("span",qo,k(l.data.description),1),jo]),_:1},8,["header"]),a(u,{style:$(e.lovsManagementTreeDescriptor.table.iconColumn.style)},{body:n(l=>[a(g,{icon:"pi pi-trash",class:"p-button-link",onClick:T=>e.removeValueConfirm(l.index)},null,8,["onClick"])]),_:1},8,["style"])]),_:1},8,["value","onCellEditComplete"])])])}var Wo=L(Po,[["render",Xo]]);const Ko=M({name:"lovs-management-test-dialog",components:{Dialog:O,Dropdown:P,LovsManagementSimpleDatatable:Vo,LovsManagementTree:Wo},emits:["close","pageChanged","save"],props:{visible:{type:Boolean},testModel:{type:Object},testLovModel:{type:Array},selectedLov:{type:Object},testLovTreeModel:{type:Array}},data(){return{lovsManagementTestDialogDescriptor:Mo,lov:{},treeListTypeModel:{},model:{},treeModel:{}}},computed:{buttonDisabled(){return this.treeListTypeModel.LOVTYPE!=="simple"?this.treeModel.length===0:!1}},watch:{selectedLov(){this.loadLov()},testModel(){this.loadTypeModel()},testLovModel(){this.loadModel()},testLovTreeModel(){this.loadTreeModel()}},created(){this.loadLov(),this.loadTypeModel(),this.loadModel(),this.loadTreeModel()},methods:{loadLov(){this.lov=this.selectedLov},loadTypeModel(){this.treeListTypeModel={...this.testModel}},loadModel(){this.model=[...this.testLovModel]},loadTreeModel(){this.treeModel=[...this.testLovTreeModel]},resetValues(){this.treeModel=[],this.treeListTypeModel.LOVTYPE==="simple"?(delete this.treeListTypeModel["VALUE-COLUMNS"],delete this.treeListTypeModel["DESCRIPTION-COLUMNS"],this.treeListTypeModel["VALUE-COLUMN"]="",this.treeListTypeModel["DESCRIPTION-COLUMN"]=""):(delete this.treeListTypeModel["VALUE-COLUMN"],delete this.treeListTypeModel["DESCRIPTION-COLUMN"],this.treeListTypeModel["VALUE-COLUMNS"]="",this.treeListTypeModel["DESCRIPTION-COLUMNS"]=""),this.treeListTypeModel["VISIBLE-COLUMNS"]=""},onSave(){this.$emit("save",{treeListTypeModel:this.treeListTypeModel,model:this.model,treeModel:this.treeModel})},onModelChange(e){this.treeListTypeModel=e},onTreeModelChange(e){this.treeModel=e}}}),Go={class:"p-fluid p-m-4"},Zo={for:"treeType",class:"kn-material-input-label","aria-label":"dropdown"};function Ho(e,t,s,b,h,y){const c=r("Dropdown"),p=r("LovsManagementSimpleDatatable"),u=r("LovsManagementTree"),v=r("Button"),g=r("Dialog");return m(),w(g,{header:e.$t("managers.lovsManagement.test"),visible:e.visible,modal:!0,class:"testLovDialog p-fluid kn-dialog--toolbar--primary",closable:!1},{footer:n(()=>[a(v,{class:"kn-button kn-button--secondary",onClick:t[3]||(t[3]=d=>e.$emit("close"))},{default:n(()=>[i(k(e.$t("common.close")),1)]),_:1}),a(v,{class:"kn-button kn-button--primary",onClick:e.onSave,disabled:e.buttonDisabled},{default:n(()=>[i(k(e.$t("common.save")),1)]),_:1},8,["onClick","disabled"])]),default:n(()=>[o("div",Go,[o("div",null,[o("span",null,[o("label",Zo,k(e.$t("managers.lovsManagement.testTreeType"))+" * ",1),a(c,{id:"treeType",class:"kn-material-input",modelValue:e.treeListTypeModel.LOVTYPE,"onUpdate:modelValue":t[0]||(t[0]=d=>e.treeListTypeModel.LOVTYPE=d),options:e.lovsManagementTestDialogDescriptor.treeTypes,optionLabel:"name",optionValue:"value",onChange:e.resetValues},null,8,["modelValue","options","onChange"])])])]),e.treeListTypeModel.LOVTYPE==="simple"?(m(),w(p,{key:0,tableData:e.model,treeListTypeModel:e.treeListTypeModel,onModelChanged:t[1]||(t[1]=d=>e.onModelChange(d))},null,8,["tableData","treeListTypeModel"])):(m(),w(u,{key:1,listData:e.model,treeModel:e.treeModel,onModelChanged:t[2]||(t[2]=d=>e.onTreeModelChange(d))},null,8,["listData","treeModel"]))]),_:1},8,["header","visible"])}var ea=L(Ko,[["render",Ho]]);const ta={style:{width:"60vw"}},oa={parameter:"managers.lovsManagement.parameterDependencyText",profile:"managers.lovsManagement.profileDependencyText"};var aa={dialog:ta,info:oa};const ra=M({name:"lovs-management-params-dialog",components:{Dialog:O},emits:["close","preview","test"],props:{visible:{type:Boolean},dependenciesList:{type:Array},mode:{type:String}},data(){return{lovsManagementParamsDialogDescriptor:aa}},created(){},methods:{}}),na={class:"p-float-label"},ia={class:"kn-material-input-label"};function la(e,t,s,b,h,y){const c=r("InputText"),p=r("Button"),u=r("Dialog");return m(),w(u,{style:$(e.lovsManagementParamsDialogDescriptor.dialog.style),header:e.$t("managers.lovsManagement.dependenciesTitle"),visible:e.visible,modal:!0,class:"p-fluid kn-dialog--toolbar--primary",closable:!1},{footer:n(()=>[a(p,{class:"kn-button kn-button--primary",onClick:t[0]||(t[0]=v=>e.mode==="preview"?e.$emit("preview"):e.$emit("test"))},{default:n(()=>[i(k(e.mode==="preview"?e.$t("managers.lovsManagement.preview"):e.$t("managers.lovsManagement.test")),1)]),_:1}),a(p,{class:"kn-button kn-button--primary",onClick:t[1]||(t[1]=v=>e.$emit("close"))},{default:n(()=>[i(k(e.$t("common.close")),1)]),_:1})]),default:n(()=>[(m(!0),f(D,null,_(e.dependenciesList,(v,g)=>(m(),f("div",{key:g},[o("p",null,k(e.$t(e.lovsManagementParamsDialogDescriptor.info[v.type])),1),o("div",null,[o("span",na,[a(c,{class:"kn-material-input",type:"text",modelValue:v.value,"onUpdate:modelValue":d=>v.value=d,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"]),o("label",ia,k(v.name),1)])])]))),128))]),_:1},8,["style","header","visible"])}var sa=L(ra,[["render",la]]);const da=[{field:"name",header:"common.name"},{field:"label",header:"common.label"},{field:"description",header:"common.category"},{field:"owner",header:"common.owner"},{field:"scope",header:"common.scope"}],ca=["label","name","description","owner","scope"];var Q={columns:da,globalFilterFields:ca};const pa=M({name:"lovs-management-dataset",components:{Dialog:O,DataTable:F,Column:U},props:{dataset:Object},data(){return{lovsManagementDatasetDescriptor:Q,dirty:!1,showDatasetsDialog:!1,datasets:[],selectedDataset:{},columns:Q.columns,filters:{global:[A],label:{operator:N.AND,constraints:[A]},name:{operator:N.AND,constraints:[A]},description:{operator:N.AND,constraints:[A]},owner:{operator:N.AND,constraints:[A]},scope:{operator:N.AND,constraints:[A]}}}},async created(){this.loadDataset(),await this.loadDatasets()},watch:{dataset(){this.loadDataset()}},methods:{async loadDatasets(){await this.$http.get("/knowage/restful-services/1.0/datasets/datasetsforlov/").then(e=>this.datasets=e.data)},loadDataset(){this.selectedDataset={...this.dataset}},onSave(){this.showDatasetsDialog=!1,this.$emit("selected",this.selectedDataset)}}}),ba={key:0,class:"p-fluid p-formgrid p-grid"},ua={class:"p-field p-col-6 p-float-label"},ka={for:"datasetLabel",class:"kn-material-input-label"},ma={class:"p-field p-col-5 p-float-label"},va={for:"datasetName",class:"kn-material-input-label"},ga={class:"p-field"},ha=i("Select Dataset"),fa={class:"table-header"},ya={class:"p-input-icon-left"},wa=o("i",{class:"pi pi-search"},null,-1),xa=["title"];function Ma(e,t,s,b,h,y){const c=r("InputText"),p=r("Button"),u=r("Toolbar"),v=r("Column"),g=r("DataTable"),d=r("Dialog");return m(),f(D,null,[e.selectedDataset?(m(),f("div",ba,[o("span",ua,[a(c,{id:"datasetLabel",class:"kn-material-input",type:"text",modelValue:e.selectedDataset.label,"onUpdate:modelValue":t[0]||(t[0]=l=>e.selectedDataset.label=l),modelModifiers:{trim:!0},disabled:""},null,8,["modelValue"]),o("label",ka,k(e.$t("common.label"))+" * ",1)]),o("span",ma,[a(c,{id:"datasetName",class:"kn-material-input",type:"text",modelValue:e.selectedDataset.name,"onUpdate:modelValue":t[1]||(t[1]=l=>e.selectedDataset.name=l),modelModifiers:{trim:!0},disabled:""},null,8,["modelValue"]),o("label",va,k(e.$t("common.name"))+" * ",1)]),o("span",ga,[a(p,{icon:"pi pi-search-plus",class:"p-button-text p-button-rounded p-button-plain",onClick:t[2]||(t[2]=l=>e.showDatasetsDialog=!0)})])])):S("",!0),a(d,{visible:e.showDatasetsDialog,modal:!0,class:"full-screen-dialog p-fluid kn-dialog--toolbar--primary",closable:!1,position:"right",baseZIndex:1,autoZIndex:!0},{header:n(()=>[a(u,{class:"kn-toolbar kn-toolbar--primary p-m-0 p-col"},{start:n(()=>[ha]),end:n(()=>[a(p,{icon:"pi pi-save",class:"p-button-text p-button-rounded p-button-plain",disabled:e.buttonDisabled,onClick:e.onSave,"data-test":"submit-button"},null,8,["disabled","onClick"]),a(p,{icon:"pi pi-times",class:"p-button-text p-button-rounded p-button-plain",onClick:t[3]||(t[3]=l=>e.showDatasetsDialog=!1),"data-test":"close-button"})]),_:1})]),default:n(()=>[a(g,{value:e.datasets,paginator:!0,class:"p-datatable-sm kn-table p-ml-2 p-mr-2",dataKey:"id",filters:e.filters,"onUpdate:filters":t[5]||(t[5]=l=>e.filters=l),filterDisplay:"menu",globalFilterFields:e.lovsManagementDatasetDescriptor.globalFilterFields,rows:20,responsiveLayout:"stack",breakpoint:"960px",currentPageReportTemplate:e.$t("common.table.footer.paginated",{first:"{first}",last:"{last}",totalRecords:"{totalRecords}"}),selection:e.selectedDataset,"onUpdate:selection":t[6]||(t[6]=l=>e.selectedDataset=l),selectionMode:"single"},{header:n(()=>[o("div",fa,[o("span",ya,[wa,a(c,{class:"kn-material-input",type:"text",modelValue:e.filters.global.value,"onUpdate:modelValue":t[4]||(t[4]=l=>e.filters.global.value=l),placeholder:e.$t("common.search"),badge:"0","data-test":"search-input"},null,8,["modelValue","placeholder"])])])]),empty:n(()=>[i(k(e.$t("common.info.noDataFound")),1)]),default:n(()=>[(m(!0),f(D,null,_(e.columns,l=>(m(),w(v,{field:l.field,header:e.$t(l.header),key:l.field,sortable:!0,style:$(l.style),class:"kn-truncated"},{filter:n(({filterModel:T})=>[a(c,{type:"text",modelValue:T.value,"onUpdate:modelValue":R=>T.value=R,class:"p-column-filter"},null,8,["modelValue","onUpdate:modelValue"])]),body:n(T=>[o("span",{title:T.data[l.field]},k(T.data[l.field]),9,xa)]),_:2},1032,["field","header","style"]))),128))]),_:1},8,["value","filters","globalFilterFields","currentPageReportTemplate","selection"])]),_:1},8,["visible"])],64)}var La=L(pa,[["render",Ma]]);const Ca=M({name:"lovs-management-wizard-card",components:{Card:X,LovsManagementParamsDialog:sa,LovsManagementInfoDialog:so,LovsManagementQuery:Ue,LovsManagementScript:qe,LovsManagementFixedLovsTable:st,LovsManagementJavaClassInput:vt,LovsManagementDataset:La,LovsManagementPreviewDialog:bo,LovsManagementProfileAttributesList:wo,LovsManagementTestDialog:ea},props:{selectedLov:{type:Object,required:!0},selectedQuery:{type:Object},datasources:{type:Array,required:!0},selectedScript:{type:Object},listOfScriptTypes:{type:Array},listForFixLov:{type:Array},selectedJavaClass:{type:Object},selectedDataset:{type:Object},profileAttributes:{type:Array},save:{type:Boolean},previewDisabled:{type:Boolean}},emits:["touched","save","created","selectedDataset"],data(){return{lovsManagementWizardCardDescriptor:J,lov:{},toolbarTitle:"",infoTitle:"",previewDialogVisible:!1,infoDialogVisible:!1,profileAttributesDialogVisible:!1,codeInput:{code:null,changed:!1},dependenciesList:[],pagination:J.defaultPagination,dataForPreview:{},tableModelForTest:{},testDialogVisible:!1,testLovModel:[],treeListTypeModel:{},formatedValues:[],formatedDescriptionValues:[],formatedVisibleValues:[],formatedInvisibleValues:[],testLovTreeModel:[],paramsDialogVisible:!1,operation:"create",testValid:!1,sendSave:!1,dependenciesReady:!1,touchedForTest:!1,x2js:new q,paramsDialogMode:"preview"}},watch:{lovType(){this.onLovTypeChanged()},selectedLov(){this.loadLov(),this.onLovTypeChanged()},async save(){this.sendSave=!0,this.touchedForTest||(this.buildTestTable(),this.formatForTest()),this.testValid&&!this.touchedForTest?await this.handleSubmit(!0):await this.checkForDependencies(!1)}},computed:{lovType(){return this.selectedLov.itypeCd}},setup(){return{store:le()}},async created(){this.loadLov(),this.onLovTypeChanged()},methods:{loadLov(){this.lov=this.selectedLov,this.lov.id&&(this.testValid=!0)},onLovTypeChanged(){switch(this.lovType){case"SCRIPT":this.toolbarTitle=this.$t("managers.lovsManagement.scriptWizard"),this.infoTitle=this.$t("managers.lovsManagement.infoSyntax"),this.lov.lovProviderJSON.SCRIPTLOV||(this.lov.lovProviderJSON={SCRIPTLOV:{"DESCRIPTION-COLUMN":"","INVISIBLE-COLUMNS":"",LANGUAGE:"",LOVTYPE:"simple",SCRIPT:"","TREE-LEVELS-COLUMNS":"","VALUE-COLUMN":"","VISIBLE-COLUMNS":""}});break;case"QUERY":this.toolbarTitle=this.$t("managers.lovsManagement.queryWizard"),this.infoTitle=this.$t("managers.lovsManagement.infoSyntax"),this.lov.lovProviderJSON.QUERY||(this.lov.lovProviderJSON={QUERY:{CONNECTION:"","DESCRIPTION-COLUMN":"","INVISIBLE-COLUMNS":"",STMT:"",LOVTYPE:"simple","VALUE-COLUMN":"","VISIBLE-COLUMNS":"",decoded_STMT:""}});break;case"FIX_LOV":this.toolbarTitle=this.$t("managers.lovsManagement.fixedListWizard"),this.infoTitle=this.$t("managers.lovsManagement.infoRules"),this.lov.lovProviderJSON.FIXLISTLOV||(this.lov.lovProviderJSON={FIXLISTLOV:{"DESCRIPTION-COLUMN":"",ROWS:{},"INVISIBLE-COLUMNS":"",LABEL:"",LOVTYPE:"simple","VALUE-COLUMN":"","VISIBLE-COLUMNS":""}});break;case"JAVA_CLASS":this.toolbarTitle=this.$t("managers.lovsManagement.javaClassWizard"),this.infoTitle=this.$t("managers.lovsManagement.infoRules"),this.lov.lovProviderJSON.JAVACLASSLOV||(this.lov.lovProviderJSON={JAVACLASSLOV:{"DESCRIPTION-COLUMN":"",ROWS:{},"INVISIBLE-COLUMNS":"",LABEL:"",LOVTYPE:"simple","VALUE-COLUMN":"","VISIBLE-COLUMNS":""}});break;case"DATASET":this.toolbarTitle=this.$t("managers.lovsManagement.datasetWizard"),this.lov.lovProviderJSON.DATASET||(this.lov.lovProviderJSON={DATASET:{"DESCRIPTION-COLUMN":"",ID:"","INVISIBLE-COLUMNS":"",LABEL:"",LOVTYPE:"simple","VALUE-COLUMN":"","VISIBLE-COLUMNS":""}})}},setCodeInput(e){this.codeInput={code:e,changed:!this.codeInput.changed}},async checkForDependencies(e){this.formatForTest();let t=[];if(await this.$http.post("/knowage/restful-services/2.0/lovs/checkdependecies",{provider:this.x2js.js2xml(this.lov.lovProviderJSON)}).then(s=>{t=s.data}).catch(s=>{this.store.setError({title:this.$t("common.toast.errorTitle"),msg:s})}).finally(()=>this.touchedForTest=!1),t.length>0&&!this.dependenciesReady){this.dependenciesList=[];for(let s=0;s<t.length;s++)this.dependenciesList.push({name:t[s].name,type:t[s].type});this.paramsDialogMode=e?"preview":"test",this.paramsDialogVisible=!0}else await this.previewLov(this.pagination,!1,e),this.buildTestTable(),this.validateLov(this.lov)},async previewLov(e,t,s){this.pagination=e;const b={data:{...this.lov,lovProviderJSON:JSON.stringify(this.lov.lovProviderJSON),lovProvider:this.x2js.js2xml(this.lov.lovProviderJSON)},pagination:this.pagination};(t||this.dependenciesReady)&&(b.dependencies=this.dependenciesList),await this.$http.post("/knowage/restful-services/2.0/lovs/preview",b).then(h=>{h.status===204?(this.store.setError({title:this.$t("common.toast.errorTitle"),msg:this.$t("managers.lovsManagement.syntaxError")}),this.tableModelForTest=[]):(this.dataForPreview=h.data,this.tableModelForTest=h.data.metaData.fields,this.pagination.size=h.data.results,this.previewDialogVisible=s,this.testDialogVisible=!s,this.paramsDialogVisible=t)}).catch(h=>{this.store.setError({title:this.$t("common.toast.errorTitle"),msg:h})})},formatForTest(){var b,h,y,c,p,u,v,g;const e=this.lov.itypeCd,t=C[e];switch(this.lov.lovProviderJSON[t].LOVTYPE||(this.lov.lovProviderJSON[t].LOVTYPE="simple"),this.lov.id||this.setLovProviderJsonValues(t),t){case C.QUERY:this.lov.lovProviderJSON[t].CONNECTION=(b=this.selectedQuery)==null?void 0:b.datasource,this.lov.lovProviderJSON[t].STMT=(h=this.selectedQuery)==null?void 0:h.query;break;case C.SCRIPT:this.lov.lovProviderJSON[t].LANGUAGE=(y=this.selectedScript)==null?void 0:y.language,this.lov.lovProviderJSON[t].SCRIPT=(c=this.selectedScript)==null?void 0:c.text;break;case C.FIX_LOV:this.listForFixLov&&this.listForFixLov.length>1?this.lov.lovProviderJSON[t].ROWS.ROW=this.listForFixLov:this.listForFixLov!=null&&this.listForFixLov.length==1&&(this.lov.lovProviderJSON[t].ROWS.ROW=this.listForFixLov[0]);break;case C.JAVA_CLASS:this.lov.lovProviderJSON[t].JAVA_CLASS_NAME=(p=this.selectedJavaClass)==null?void 0:p.name;break;case C.DATASET:if(this.lov.lovProviderJSON[t].ID=(u=this.selectedDataset)==null?void 0:u.id,this.lov.lovProviderJSON[t].LABEL=(v=this.selectedDataset)==null?void 0:v.label,(g=this.selectedDataset)!=null&&g.id)for(var s=0;s<this.datasources.length;s++)this.datasources[s].id==this.selectedDataset.id&&(this.lov.lovProviderJSON[t].LABEL=this.datasources[s].label)}},setLovProviderJsonValues(e){switch(this.lov.lovProviderJSON={},this.lov.lovProviderJSON[e]={LOVTYPE:"simple"},e){case C.QUERY:case C.DATASET:this.setEmptyLovProviderJSONColumns(e);break;case C.SCRIPT:this.setEmptyLovProviderJSONColumns(e),this.lov.lovProviderJSON[e]["TREE-LEVELS-COLUMNS"]="";break;case C.FIX_LOV:this.lov.lovProviderJSON[e]["VISIBLE-COLUMNS"]="DESCRIPTION",this.lov.lovProviderJSON[e]["INVISIBLE-COLUMNS"]="VALUE",this.lov.lovProviderJSON[e]["DESCRIPTION-COLUMN"]="DESCRIPTION",this.lov.lovProviderJSON[e]["VALUE-COLUMN"]="VALUE",this.lov.lovProviderJSON[e]["TREE-LEVELS-COLUMNS"]="",this.lov.lovProviderJSON[e].ROWS={};break;case C.JAVA_CLASS:this.lov.lovProviderJSON[e]["VISIBLE-COLUMNS"]="VALUE",this.lov.lovProviderJSON[e]["INVISIBLE-COLUMNS"]="VALUE",this.lov.lovProviderJSON[e]["DESCRIPTION-COLUMN"]="VALUE",this.lov.lovProviderJSON[e]["VALUE-COLUMN"]="VALUE",this.lov.lovProviderJSON[e]["TREE-LEVELS-COLUMNS"]=""}},setEmptyLovProviderJSONColumns(e){this.lov.lovProviderJSON[e]["VISIBLE-COLUMNS"]="",this.lov.lovProviderJSON[e]["INVISIBLE-COLUMNS"]="",this.lov.lovProviderJSON[e]["DESCRIPTION-COLUMN"]="",this.lov.lovProviderJSON[e]["VALUE-COLUMN"]=""},buildTestTable(){if(this.lov){const e=this.lov.itypeCd,t=C[e];this.lov.lovProviderJSON[t].LOVTYPE||(this.lov.lovProviderJSON[t].LOVTYPE="simple"),this.treeListTypeModel.LOVTYPE||(this.treeListTypeModel=this.lov.lovProviderJSON[t]),this.setColumnValues(),this.treeListTypeModel&&this.treeListTypeModel.LOVTYPE!="simple"&&this.treeListTypeModel.LOVTYPE!=""&&this.setTreeLovModel()}this.testLovModel=Array.isArray(this.tableModelForTest)?this.tableModelForTest:[],this.setFormatedVisibleValues()},setColumnValues(){var e,t,s,b,h,y,c,p;this.lov.id||this.treeListTypeModel.LOVTYPE!=="simple"?(this.formatedVisibleValues=((e=this.treeListTypeModel["VISIBLE-COLUMNS"])==null?void 0:e.length)>0?this.treeListTypeModel["VISIBLE-COLUMNS"].split(","):[],this.formatedInvisibleValues=[],!this.treeListTypeModel.LOVTYPE||this.treeListTypeModel.LOVTYPE=="simple"?(this.formatedValues=((t=this.treeListTypeModel["VALUE-COLUMN"])==null?void 0:t.length)>0?(s=this.treeListTypeModel["VALUE-COLUMN"])==null?void 0:s.split(","):[],this.formatedDescriptionValues=((b=this.treeListTypeModel["DESCRIPTION-COLUMN"])==null?void 0:b.length)>0?(h=this.treeListTypeModel["DESCRIPTION-COLUMN"])==null?void 0:h.split(","):[]):(this.formatedValues=((y=this.treeListTypeModel["VALUE-COLUMNS"])==null?void 0:y.length)>0?this.treeListTypeModel["VALUE-COLUMNS"].split(","):[],this.formatedDescriptionValues=((c=this.treeListTypeModel["DESCRIPTION-COLUMNS"])==null?void 0:c.length)>0?(p=this.treeListTypeModel["DESCRIPTION-COLUMNS"])==null?void 0:p.split(","):[])):this.treeListTypeModel.LOVTYPE="simple"},setTreeLovModel(){this.testLovTreeModel=[];for(let e=0;e<this.formatedValues.length;e++)this.testLovTreeModel.push({level:this.formatedValues[e],value:this.formatedValues[e],description:this.formatedDescriptionValues[e]})},setFormatedVisibleValues(){const e=[];for(let t=0;t<this.formatedVisibleValues.length;t++)for(let s=0;s<this.testLovModel.length;s++)this.formatedVisibleValues[t]==this.testLovModel[s].name&&e.push(this.testLovModel[s].name);this.formatedVisibleValues=e},async handleSubmit(e){this.formatForSave(),this.testValid&&e&&await this.saveLov()},formatForSave(){let e={},t=this.lov.itypeCd,s=C[t],b=this.lov.lovProviderJSON[s];!this.treeListTypeModel||this.treeListTypeModel.LOVTYPE=="simple"?this.formatSimpleTestTree(b):this.formatAdvancedTestTree(b),b.LOVTYPE=this.treeListTypeModel.LOVTYPE,this.validateLov(b),e[s]=b,this.lov.lovProvider=this.x2js.js2xml(e),this.lov.itypeId=this.setLovInputTypeId(this.lov.itypeCd)},formatSimpleTestTree(e){e["DESCRIPTION-COLUMN"]=this.treeListTypeModel["DESCRIPTION-COLUMN"],e["VALUE-COLUMN"]=this.treeListTypeModel["VALUE-COLUMN"],e["VISIBLE-COLUMNS"]=this.treeListTypeModel["VISIBLE-COLUMNS"];for(let t=0;t<this.testLovModel.length;t++)this.treeListTypeModel["VISIBLE-COLUMNS"].indexOf(this.testLovModel[t].name)===-1&&this.formatedInvisibleValues.push(this.testLovModel[t].name);e["INVISIBLE-COLUMNS"]=this.formatedInvisibleValues.join()},formatAdvancedTestTree(e){delete e["DESCRIPTION-COLUMN"],delete e["VALUE-COLUMN"];const t=[],s=[];for(let b=0;b<this.testLovTreeModel.length;b++)t.push(this.testLovTreeModel[b].description);e["DESCRIPTION-COLUMNS"]=t.join();for(let b=0;b<this.testLovTreeModel.length;b++)s.push(this.testLovTreeModel[b].value);e["VALUE-COLUMNS"]=s.join();for(let b=0;b<this.testLovModel.length;b++)s.indexOf(this.testLovModel[b].name)===-1&&this.formatedInvisibleValues.push(this.testLovModel[b].name);e["INVISIBLE-COLUMNS"]=this.formatedInvisibleValues.join(),e["VISIBLE-COLUMNS"]=this.treeListTypeModel["VISIBLE-COLUMNS"]},setLovInputTypeId(e){switch(e){case"QUERY":return"1";case"SCRIPT":return"2";case"FIX_LOV":return"3";case"JAVA_CLASS":return"4";case"DATASET":return"5"}},validateLov(e){e.LOVTYPE=="simple"&&(!e["VALUE-COLUMN"]||!e["DESCRIPTION-COLUMN"])?(this.store.setError({title:this.$t("common.toast.errorTitle"),msg:this.$t("managers.lovsManagement.emptyField")}),this.testValid=!1):e.LOVTYPE=="tree"&&(!e["VALUE-COLUMNS"]||!e["DESCRIPTION-COLUMNS"])?(this.store.setError({title:this.$t("common.toast.errorTitle"),msg:this.$t("managers.lovsManagement.treeNotDefined")}),this.testValid=!1):this.testValid=!0},async saveLov(){let e="/knowage/restful-services/2.0/lovs/save";this.lov.id&&(this.operation="update",e="/knowage/restful-services/2.0/lovs/"),await this.sendRequest(e).then(t=>{if(t.status==409)this.store.setError({title:this.$t("common.toast.errorTitle"),msg:this.$t("managers.lovsManagement.sameLabelError")});else{this.store.setInfo({title:this.$t("common.toast."+this.operation+"Title"),msg:this.$t("common.toast.success")}),this.$emit("created"),this.testDialogVisible=!1;const s=this.lov.id?this.lov.id:t.data;this.$router.push(`${s}`)}}).catch(t=>{this.store.setError({title:this.$t("common.toast."+this.operation+"Title"),msg:typeof t=="string"?t:""})})},sendRequest(e){return this.operation==="create"?this.$http.post(e,this.lov):this.$http.put(e,this.lov)},onTestSave(e){this.treeListTypeModel=e.treeListTypeModel,this.testLovModel=e.model,this.testLovTreeModel=e.treeModel,this.treeListTypeModel["VISIBLE-COLUMNS"]="";for(let t=0;t<this.testLovModel.length;t++)this.treeListTypeModel["VISIBLE-COLUMNS"]+=this.testLovModel[t].name,this.treeListTypeModel["VISIBLE-COLUMNS"]+=t===this.testLovModel.length-1?"":",";this.treeListTypeModel["VALUE-COLUMNS"]="",this.treeListTypeModel["DESCRIPTION-COLUMNS"]="";for(let t=0;t<this.testLovTreeModel.length;t++)this.treeListTypeModel["VALUE-COLUMNS"]+=this.testLovTreeModel[t].value,this.treeListTypeModel["VALUE-COLUMNS"]+=t===this.testLovTreeModel.length-1?"":",",this.treeListTypeModel["DESCRIPTION-COLUMNS"]+=this.testLovTreeModel[t].description,this.treeListTypeModel["DESCRIPTION-COLUMNS"]+=t===this.testLovTreeModel.length-1?"":",";this.handleSubmit(this.sendSave),this.testDialogVisible=!1,this.dependenciesReady=!1},onTestButtonClick(){this.sendSave=!1,this.checkForDependencies(!1)},async onPreview(){await this.previewLov(J.defaultPagination,!0,!0),this.dependenciesReady=this.dependenciesSet()},dependenciesSet(){let e=!0;return this.dependenciesList.forEach(t=>{t.value||(e=!1)}),e},onTouched(){this.touchedForTest=!0,this.$emit("touched")},onPreviewClose(){this.previewDialogVisible=!1},onParamsDialogClose(){this.paramsDialogVisible=!1,this.dependenciesList=[],this.dependenciesReady=!1},async onTest(){this.dependenciesReady=!0,await this.previewLov(this.pagination,!1,!1),this.buildTestTable()},onTestDialogClose(){this.testDialogVisible=!1,this.dependenciesReady=!1}}});function Ta(e,t,s,b,h,y){const c=r("Button"),p=r("Toolbar"),u=r("LovsManagementQuery"),v=r("LovsManagementScript"),g=r("LovsManagementFixedLovsTable"),d=r("LovsManagementJavaClassInput"),l=r("LovsManagementDataset"),T=r("Card"),R=r("LovsManagementInfoDialog"),Z=r("LovsManagementProfileAttributesList"),H=r("LovsManagementParamsDialog"),ee=r("LovsManagementPreviewDialog"),te=r("LovsManagementTestDialog");return m(),f(D,null,[a(T,{class:"p-m-2"},{header:n(()=>[a(p,{class:"kn-toolbar kn-toolbar--secondary"},{start:n(()=>[i(k(e.toolbarTitle),1)]),end:n(()=>[a(c,{class:"kn-button-sm p-button-text",label:e.$t("managers.lovsManagement.preview"),disabled:e.previewDisabled,onClick:t[0]||(t[0]=x=>e.checkForDependencies(!0))},null,8,["label","disabled"]),a(c,{class:"kn-button-sm p-button-text",label:e.$t("managers.lovsManagement.test"),disabled:e.previewDisabled,onClick:e.onTestButtonClick},null,8,["label","disabled","onClick"]),e.lovType!=="DATASET"?(m(),w(c,{key:0,icon:"fa fa-info-circle",class:"p-button-text p-button-rounded p-button-plain","aria-label":"Info",onClick:t[1]||(t[1]=x=>e.infoDialogVisible=!0)})):S("",!0),a(c,{icon:"fa fa-users",class:"p-button-text p-button-rounded p-button-plain","aria-label":"Profiles",onClick:t[2]||(t[2]=x=>e.profileAttributesDialogVisible=!0)})]),_:1})]),content:n(()=>[e.lovType==="QUERY"?(m(),w(u,{key:0,selectedLov:e.lov,selectedQuery:e.selectedQuery,datasources:e.datasources,codeInput:e.codeInput,onTouched:e.onTouched},null,8,["selectedLov","selectedQuery","datasources","codeInput","onTouched"])):e.lovType==="SCRIPT"?(m(),w(v,{key:1,selectedLov:e.lov,selectedScript:e.selectedScript,listOfScriptTypes:e.listOfScriptTypes,onTouched:e.onTouched},null,8,["selectedLov","selectedScript","listOfScriptTypes","onTouched"])):e.lovType==="FIX_LOV"?(m(),w(g,{key:2,listForFixLov:e.listForFixLov,onTouched:t[3]||(t[3]=x=>e.$emit("touched")),onSorted:t[4]||(t[4]=x=>e.$emit("sorted",x))},null,8,["listForFixLov"])):e.lovType==="JAVA_CLASS"?(m(),w(d,{key:3,selectedJavaClass:e.selectedJavaClass,onTouched:e.onTouched},null,8,["selectedJavaClass","onTouched"])):e.lovType==="DATASET"?(m(),w(l,{key:4,dataset:e.selectedDataset,onSelected:t[5]||(t[5]=x=>e.$emit("selectedDataset",x))},null,8,["dataset"])):S("",!0)]),_:1}),E(a(R,{visible:e.infoDialogVisible,infoTitle:e.infoTitle,lovType:e.lov.itypeCd,onClose:t[6]||(t[6]=x=>e.infoDialogVisible=!1)},null,8,["visible","infoTitle","lovType"]),[[I,e.infoDialogVisible]]),E(a(Z,{visible:e.profileAttributesDialogVisible,profileAttributes:e.profileAttributes,onSelected:t[7]||(t[7]=x=>e.setCodeInput(x)),onClose:t[8]||(t[8]=x=>e.profileAttributesDialogVisible=!1)},null,8,["visible","profileAttributes"]),[[I,e.profileAttributesDialogVisible]]),E(a(H,{visible:e.paramsDialogVisible,dependenciesList:e.dependenciesList,mode:e.paramsDialogMode,onPreview:e.onPreview,onClose:e.onParamsDialogClose,onTest:e.onTest},null,8,["visible","dependenciesList","mode","onPreview","onClose","onTest"]),[[I,e.paramsDialogVisible]]),E(a(ee,{visible:e.previewDialogVisible,dataForPreview:e.dataForPreview,pagination:e.pagination,onClose:e.onPreviewClose,onPageChanged:t[9]||(t[9]=x=>e.previewLov(x,!1,!0))},null,8,["visible","dataForPreview","pagination","onClose"]),[[I,e.previewDialogVisible]]),E(a(te,{visible:e.testDialogVisible,selectedLov:e.lov,testModel:e.treeListTypeModel,testLovModel:e.testLovModel,testLovTreeModel:e.testLovTreeModel,onClose:t[10]||(t[10]=x=>e.onTestDialogClose()),onSave:t[11]||(t[11]=x=>e.onTestSave(x))},null,8,["visible","selectedLov","testModel","testLovModel","testLovTreeModel"]),[[I,e.testDialogVisible]])],64)}var Sa=L(Ca,[["render",Ta]]),C=(e=>(e.SCRIPT="SCRIPTLOV",e.QUERY="QUERY",e.FIX_LOV="FIXLISTLOV",e.JAVA_CLASS="JAVACLASSLOV",e.DATASET="DATASET",e))(C||{}),G=(e=>(e.SCRIPT="SCRIPT",e.QUERY="QUERY",e.FIX_LOV="FIX_LOV",e.JAVA_CLASS="JAVA_CLASS",e.DATASET="DATASET",e))(G||{});const Aa=M({name:"lovs-management-detail",components:{LovsManagementDetailCard:Se,LovsManagementWizardCard:Sa},props:{id:{type:String},lovs:{type:Array}},emits:["touched","created","closed"],data(){return{selectedLov:{},listOfInputTypes:[],listOfScriptTypes:[],datasources:[],profileAttributes:[],selectedQuery:{},selectedScript:{},listForFixLov:[],selectedJavaClass:{},selectedDataset:{},loading:!1,touched:!1,save:!1,x2js:new q,v$:j()}},watch:{async id(){await this.loadPage()}},computed:{saveButtonDisabled(){return this.v$.$invalid||this.emptyRequiredFields()}},async mounted(){await this.loadPage()},methods:{async loadPage(){this.loading=!0,this.id?await this.loadLov():this.selectedLov={lovProvider:{},lovProviderJSON:{}},await this.loadDomainsData(),await this.loadDatasources(),await this.loadProfileAttributes(),this.loading=!1},async loadLov(){await this.$http.get(`/knowage/restful-services/2.0/lovs/${this.id}`).then(e=>this.selectedLov=e.data),this.selectedLov.lovProviderJSON=JSON.parse(this.selectedLov.lovProviderJSON),this.decode(),this.formatLov()},async loadDomainsData(){await this.loadDomainsByType("INPUT_TYPE").then(e=>this.listOfInputTypes=e.data),await this.loadDomainsByType("SCRIPT_TYPE").then(e=>this.listOfScriptTypes=e.data)},loadDomainsByType(e){return this.$http.get(`/knowage/restful-services/domains/listValueDescriptionByType?DOMAIN_TYPE=${e}`)},async loadDatasources(){await this.$http.get("/knowage/restful-services/2.0/datasources/").then(e=>this.datasources=e.data)},async loadProfileAttributes(){await this.$http.get("/knowage/restful-services/2.0/attributes/").then(e=>this.profileAttributes=e.data)},decode(){this.selectedLov.lovProviderJSON.SCRIPTLOV?this.selectedLov.lovProviderJSON.SCRIPTLOV.SCRIPT=this.escapeXml(B(this.selectedLov.lovProviderJSON.SCRIPTLOV.SCRIPT)):this.selectedLov.lovProviderJSON.QUERY&&(this.selectedLov.lovProviderJSON.QUERY.decoded_STMT=this.escapeXml(B(this.selectedLov.lovProviderJSON.QUERY.STMT)))},async formatLov(){"SCRIPTLOV"in this.selectedLov.lovProviderJSON?(this.selectedScript.language=this.selectedLov.lovProviderJSON.SCRIPTLOV.LANGUAGE?this.selectedLov.lovProviderJSON.SCRIPTLOV.LANGUAGE:"groovy",this.selectedScript.text=this.selectedLov.lovProviderJSON.SCRIPTLOV.SCRIPT):"QUERY"in this.selectedLov.lovProviderJSON?(this.selectedQuery.datasource=this.selectedLov.lovProviderJSON.QUERY.CONNECTION,this.selectedQuery.query=this.selectedLov.lovProviderJSON.QUERY.decoded_STMT):"FIXLISTLOV"in this.selectedLov.lovProviderJSON?(this.listForFixLov=[],Array.isArray(this.selectedLov.lovProviderJSON.FIXLISTLOV.ROWS.ROW)?this.listForFixLov=this.selectedLov.lovProviderJSON.FIXLISTLOV.ROWS.ROW:this.listForFixLov.push(this.selectedLov.lovProviderJSON.FIXLISTLOV.ROWS.ROW)):"JAVACLASSLOV"in this.selectedLov.lovProviderJSON?this.selectedJavaClass.name=this.selectedLov.lovProviderJSON.JAVACLASSLOV.JAVA_CLASS_NAME:"DATASET"in this.selectedLov.lovProviderJSON&&await this.$http.get(`/knowage/restful-services/1.0/datasets/dataset/id/${this.selectedLov.lovProviderJSON.DATASET.ID}`).then(e=>{this.selectedDataset=e.data[0]})},escapeXml(e){return e.replace(/'/g,"'").replace(/"/g,'"').replace(/>/g,">").replace(/</g,"<").replace(/&/g,"&").replace(/&apos;/g,"'")},saveLov(){this.save=!this.save},closeTemplate(){const e="/lovs-management";this.touched?this.$confirm.require({message:this.$t("common.toast.unsavedChangesMessage"),header:this.$t("common.toast.unsavedChangesHeader"),icon:"pi pi-exclamation-triangle",accept:()=>{this.touched=!1,this.$emit("closed"),this.$router.push(e)}}):this.$router.push(e)},setTouched(){this.touched=!0,this.$emit("touched")},emptyRequiredFields(){switch(this.selectedLov.itypeCd){case"SCRIPT":return!this.selectedScript.language;case"QUERY":return!this.selectedQuery.datasource;case"JAVA_CLASS":return!this.selectedJavaClass.name;case"DATASET":return!this.selectedDataset.name}return!1},cleanSelections(){this.selectedQuery={datasource:"",query:""},this.selectedScript={language:"",text:""},this.listForFixLov=[],this.selectedJavaClass={name:""},this.selectedDataset={}},setSelectedDataset(e){this.selectedDataset=e},onSort(e){this.listForFixLov=e},async onCreated(){this.$emit("created"),await this.loadPage()}}}),$a={key:1,class:"kn-page-content"},Ea={class:"card"},Va={class:"card"};function Da(e,t,s,b,h,y){const c=r("Button"),p=r("Toolbar"),u=r("ProgressBar"),v=r("LovsManagementDetailCard"),g=r("LovsManagementWizardCard"),d=se("tooltip");return m(),f(D,null,[a(p,{class:"kn-toolbar kn-toolbar--primary p-m-0"},{start:n(()=>[i(k(e.selectedLov.label),1)]),end:n(()=>[E(a(c,{icon:"pi pi-save",class:"p-button-text p-button-rounded p-button-plain",disabled:e.saveButtonDisabled,onClick:e.saveLov,"data-test":"submit-button"},null,8,["disabled","onClick"]),[[d,e.$t("common.save")]]),E(a(c,{icon:"pi pi-times",class:"p-button-text p-button-rounded p-button-plain",onClick:e.closeTemplate,"data-test":"close-button"},null,8,["onClick"]),[[d,e.$t("common.close")]])]),_:1}),e.loading?(m(),w(u,{key:0,mode:"indeterminate",class:"kn-progress-bar"})):(m(),f("div",$a,[o("div",Ea,[a(v,{selectedLov:e.selectedLov,lovs:e.lovs,listOfInputTypes:e.listOfInputTypes,onTouched:e.setTouched,onTypeChanged:e.cleanSelections},null,8,["selectedLov","lovs","listOfInputTypes","onTouched","onTypeChanged"])]),o("div",Va,[e.selectedLov.itypeCd?(m(),w(g,{key:0,selectedLov:e.selectedLov,selectedQuery:e.selectedQuery,selectedScript:e.selectedScript,datasources:e.datasources,profileAttributes:e.profileAttributes,listOfScriptTypes:e.listOfScriptTypes,listForFixLov:e.listForFixLov,selectedJavaClass:e.selectedJavaClass,selectedDataset:e.selectedDataset,save:e.save,previewDisabled:e.saveButtonDisabled,onTouched:e.setTouched,onCreated:t[0]||(t[0]=l=>e.onCreated()),onSelectedDataset:t[1]||(t[1]=l=>e.setSelectedDataset(l)),onSorted:t[2]||(t[2]=l=>e.onSort(l))},null,8,["selectedLov","selectedQuery","selectedScript","datasources","profileAttributes","listOfScriptTypes","listForFixLov","selectedJavaClass","selectedDataset","save","previewDisabled","onTouched"])):S("",!0)])]))],64)}var Ja=L(Aa,[["render",Da]]);export{Ja as default,G as lovItemEnum,C as lovProviderEnum};
//# sourceMappingURL=LovsManagementDetail-f6e619e8.js.map
