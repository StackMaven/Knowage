import{f as M}from"./filterHelper-a723991a.js";import{_ as C,d as A,aj as z,ad as E,a5 as D,n as S,l as _,a6 as f,r as n,y as $,o as c,c as k,h as P,A as I,a as r,f as o,w as i,g as s,t as d,z as U,p as B,b as N}from"./index-1e676509.js";import{s as T}from"./calendar.esm-60a451ba.js";const V=["SCHEDULER","ETL","COMMONJ","DATA_MINING"];var v={eventModel:V};const F=A({name:"events-management",components:{ProgressSpinner:z,Card:E,Dropdown:D,Calendar:T,DataTable:S,Column:_},data(){return{descriptor:v,loading:!1,events:[],eventModel:v.eventModel,startDate:null,endDate:null,selectedEventModel:"",filters:{global:[M]},globalFilterFields:["user","type"],lazyParams:{size:20,paginationStart:0},first:0}},created(){this.getEvents()},methods:{async getEvents(){this.loading=!0;let a=`/knowage/restful-services/2.0/events/?fetchsize=${this.lazyParams.size}&offset=${this.lazyParams.paginationStart}`;this.selectedEventModel!=""&&(a+=`&type=${this.selectedEventModel}`),this.startDate&&(a+=`&startDate=${encodeURIComponent(f(this.startDate).format("YYYY-MM-DD+HH:mm:ss"))}`),this.endDate&&(a+=`&endDate=${encodeURIComponent(f(this.endDate).format("YYYY-MM-DD+HH:mm:ss"))}`),await this.$http.get(a).then(e=>{this.events=e.data.results,this.lazyParams.size=e.data.total,this.lazyParams.paginationStart=e.data.start}).finally(()=>this.loading=!1)},async onPage(a){this.lazyParams={paginationStart:a.first,paginationLimit:a.rows,paginationEnd:a.first+a.rows,size:this.lazyParams.size},await this.getEvents()},async onSearchClicked(){this.first=0,this.lazyParams={size:20,paginationStart:0},await this.getEvents()},setFocusOnSearchButton(){this.$nextTick(()=>{this.$refs["search-button"].$el.focus()})}}}),R=a=>(B("data-v-57caf02e"),a=a(),N(),a),L={class:"kn-page"},Y={class:"p-d-flex p-flex-column kn-flex"},O={id:"input-container",class:"p-d-flex p-flex-column kn-flex"},X={class:"p-fluid p-formgrid p-grid p-m-1"},H={class:"p-float-label p-col"},Q={for:"endDate",class:"kn-material-input-label"},j={class:"p-float-label p-col"},J={for:"endDate",class:"kn-material-input-label"},G={class:"p-field p-float-label p-col"},K={for:"eventModel",class:"kn-material-input-label"},Z={class:"table-header p-d-flex p-ai-center"},q={id:"search-container",class:"p-input-icon-left p-mr-3"},W=R(()=>r("i",{class:"pi pi-search"},null,-1)),aa={id:"noDatasetsFound"},ea={class:"kn-truncated"};function ta(a,e,oa,ra,na,ia){const u=n("ProgressSpinner"),m=n("Toolbar"),p=n("Calendar"),g=n("Dropdown"),h=n("Button"),b=n("Card"),w=n("InputText"),l=n("Column"),x=n("DataTable"),y=$("tooltip");return c(),k("div",L,[a.loading?(c(),P(u,{key:0,class:"kn-progress-spinner","data-test":"progress-spinner"})):I("",!0),r("div",Y,[o(m,{class:"kn-toolbar kn-toolbar--primary"},{start:i(()=>[s(d(a.$t("managers.eventsManagement.title")),1)]),_:1}),r("div",O,[o(b,{class:"p-m-2 events-input-card"},{content:i(()=>[r("form",X,[r("div",H,[o(p,{ref:"test",id:"startDate",class:"kn-material-input",modelValue:a.startDate,"onUpdate:modelValue":e[0]||(e[0]=t=>a.startDate=t),showIcon:!0,onDateSelect:a.setFocusOnSearchButton},null,8,["modelValue","onDateSelect"]),r("label",Q,d(a.$t("kpi.targetDefinition.startDate")),1)]),r("div",j,[o(p,{id:"endDate",class:"kn-material-input",modelValue:a.endDate,"onUpdate:modelValue":e[1]||(e[1]=t=>a.endDate=t),showIcon:!0,onDateSelect:a.setFocusOnSearchButton},null,8,["modelValue","onDateSelect"]),r("label",J,d(a.$t("kpi.targetDefinition.endDate")),1)]),r("span",G,[o(g,{id:"eventModel",class:"kn-material-input",modelValue:a.selectedEventModel,"onUpdate:modelValue":e[2]||(e[2]=t=>a.selectedEventModel=t),options:a.eventModel,onChange:a.setFocusOnSearchButton},null,8,["modelValue","options","onChange"]),r("label",K,d(a.$t("managers.eventsManagement.eventModel")),1)]),o(h,{ref:"search-button",id:"search-button",icon:"pi pi-search",class:"p-button-text kn-button thirdButton",onClick:a.onSearchClicked,"data-test":"search-button"},null,8,["onClick"])])]),_:1}),o(b,{class:"domainCard",style:{height:"calc(100vh - 125px)"}},{content:i(()=>[o(x,{class:"p-datatable-sm kn-table",first:a.first,"onUpdate:first":e[4]||(e[4]=t=>a.first=t),value:a.events,dataKey:"id",paginator:!0,lazy:!0,totalRecords:a.lazyParams.size,paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink",currentPageReportTemplate:a.$t("common.table.footer.paginated",{first:"{first}",last:"{last}",totalRecords:"{totalRecords}"}),rows:20,responsiveLayout:"stack",breakpoint:"960px",scrollable:!0,scrollHeight:"flex",stripedRows:!0,filters:a.filters,"onUpdate:filters":e[5]||(e[5]=t=>a.filters=t),globalFilterFields:a.globalFilterFields,onPage:e[6]||(e[6]=t=>a.onPage(t))},{header:i(()=>[r("div",Z,[r("span",q,[W,o(w,{class:"kn-material-input",modelValue:a.filters.global.value,"onUpdate:modelValue":e[3]||(e[3]=t=>a.filters.global.value=t),placeholder:a.$t("common.search")},null,8,["modelValue","placeholder"])])])]),loading:i(()=>[s(d(a.$t("common.info.dataLoading")),1)]),empty:i(()=>[r("div",aa,d(a.$t("common.info.noDataFound")),1)]),default:i(()=>[o(l,{field:"user",class:"kn-truncated",header:a.$t("managers.eventsManagement.user"),sortable:!0},null,8,["header"]),o(l,{field:"formattedDate",class:"kn-truncated",header:a.$t("cron.date"),sortable:!0},null,8,["header"]),o(l,{field:"type",class:"kn-truncated",header:a.$t("common.type"),sortable:!0},null,8,["header"]),o(l,{header:a.$t("common.description"),class:"kn-truncated",sortable:!0},{body:i(t=>[U((c(),k("span",ea,[s(d(t.data.desc),1)])),[[y,t.data.desc,void 0,{top:!0}]])]),_:1},8,["header"])]),_:1},8,["first","value","totalRecords","currentPageReportTemplate","filters","globalFilterFields"])]),_:1})])])])}var sa=C(F,[["render",ta],["__scopeId","data-v-57caf02e"]]);export{sa as default};
//# sourceMappingURL=EventsManagement-9c399b6d.js.map
