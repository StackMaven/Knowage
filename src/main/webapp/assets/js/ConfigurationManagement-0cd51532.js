import{d as I,i as E,a5 as L,s as D,_ as R,r as l,o as m,h as N,w as s,f as o,a as t,D as d,G as $,t as r,l as S,n as P,X as B,x as v,c as b,g as k,A as T,E as K,B as q,C as H}from"./index-1e676509.js";import{f as p}from"./filterHelper-a723991a.js";import{K as Y,u as z,c as Z}from"./KnValidatonMessages-ebe48c72.js";import{s as j}from"./checkbox.esm-fa6c8259.js";const X=[{name:"SECURITY",value:"SECURITY"},{name:"GENERIC_CONFIGURATION",value:"GENERIC_CONFIGURATION"},{name:"DATE-FORMAT",value:"DATE-FORMAT"},{name:"ORGANIZATIONAL-UNIT",value:"ORGANIZATIONAL-UNIT"},{name:"THEMES",value:"THEMES"},{name:"LANGUAGE_SUPPORTED",value:"LANGUAGE_SUPPORTED"},{name:"SCRIPT_LANGUAGE",value:"SCRIPT_LANGUAGE"},{name:"MAIL",value:"MAIL"},{name:"SOCIAL_CONFIGURATION",value:"SOCIAL_CONFIGURATION"},{name:"IMAGE_GALLERY",value:"IMAGE_GALLERY"},{name:"PYTHON_CONFIGURATION",value:"PYTHON_CONFIGURATION"},{name:"R_CONFIGURATION",value:"R_CONFIGURATION"},{name:"SOLR_CONFIGURATION",value:"SOLR_CONFIGURATION"},{name:"REST_CONFIGURATION",value:"REST_CONFIGURATION"}],J=[{field:"name",header:"managers.configurationManagement.headers.name"},{field:"label",header:"managers.configurationManagement.headers.label"},{field:"category",header:"managers.configurationManagement.headers.category"},{field:"valueCheck",header:"managers.configurationManagement.headers.valueCheck"},{field:"active",header:"managers.configurationManagement.headers.active",style:{width:"10%"}}],Q={style:{width:"60vw"}},W=["label","name","category","value","active"],_=[{name:"True",value:!0},{name:"False",value:!1}],x={insert:{toastTitle:"common.toast.createTitle"},success:"common.toast.success",update:{toastTitle:"common.toast.updateTitle"}},ee={style:{"margin-bottom":"40px"}},ae={iconColumn:{style:{"text-align":"end",width:"5%"}}},te=[{name:"NUM",value:407},{name:"STRING",value:408}];var M={category:X,columns:J,form:Q,globalFilterFields:W,isActive:_,operation:x,pField:ee,table:ae,valueType:te};const oe={configuration:[{fieldName:"label",validators:[{key:"required"},{key:"maximumCharacters",validator:{params:{max:100},type:"maxLength"}},{key:"regex",validator:{type:"extendedAlphanumericRegex"}}]},{fieldName:"name",validators:[{key:"required"},{key:"maximumCharacters",validator:{params:{max:100},type:"maxLength"}},{key:"regex",validator:{type:"extendedAlphanumericRegex"}}]},{fieldName:"description",validators:[{key:"maximumCharacters",validator:{params:{max:500},type:"maxLength"}},{key:"regex",validator:{type:"extendedAlphanumericRegex"}}]},{fieldName:"active",validators:[]},{fieldName:"valueCheck",validators:[]},{fieldName:"category",validators:[{key:"required"}]}]};var A={validations:oe};const ne=I({name:"configuration-management-dialog",components:{Dialog:E,Dropdown:L,Checkbox:j,KnValidationMessages:Y},props:{model:{type:Object,requried:!1}},emits:["close","created"],data(){return{configurationManagementDescriptor:M,configurationManagementValidationDescriptor:A,configuration:{},v$:z(),operation:"insert",dirty:!1,options:[!0,!1]}},validations(){return{configuration:Z("configuration",A.validations.configuration)}},computed:{formHeader(){return this.configuration.id?this.configuration.name:this.$t("managers.configurationManagement.createNewHeader")},buttonDisabled(){return this.v$.$invalid}},setup(){return{store:D()}},mounted(){this.model&&(this.configuration={...this.model})},watch:{model(){this.configuration={...this.model}}},methods:{async handleSubmit(){if(this.v$.$invalid)return;let e="/knowage/restful-services/2.0/configs";this.configuration.id&&(this.operation="update",e+="/"+this.configuration.id),await this.sendRequest(e).then(()=>{this.store.setInfo({title:this.$t(this.configurationManagementDescriptor.operation[this.operation].toastTitle),msg:this.$t(this.configurationManagementDescriptor.operation.success)}),this.$emit("created")})},sendRequest(e){return this.operation==="insert"?this.$http.post(e,this.configuration):this.$http.put(e,this.configuration)},closeTemplate(){this.$emit("close")}}}),ie={class:"p-fluid p-m-5"},le={class:"p-float-label"},se={for:"label",class:"kn-material-input-label"},re={class:"p-float-label"},de={for:"name",class:"kn-material-input-label"},me={class:"p-float-label"},ue={for:"description",class:"kn-material-input-label"},ce={class:"p-float-label"},ge={for:"category",class:"kn-material-input-label"},pe={class:"p-float-label"},fe={for:"description",class:"kn-material-input-label"},ve={class:"p-field-checkbox"},he={for:"isActive"};function $e(e,a,F,O,V,U){const u=l("InputText"),c=l("KnValidationMessages"),y=l("Dropdown"),h=l("Checkbox"),f=l("Button"),C=l("Dialog");return m(),N(C,{visible:!0,modal:!0,class:"kn-dialog--toolbar--primary",header:e.formHeader,closable:!1,style:d(e.configurationManagementDescriptor.form.style)},{footer:s(()=>[o(f,{class:"kn-button kn-button--secondary",label:e.$t("common.close"),onClick:e.closeTemplate},null,8,["label","onClick"]),o(f,{class:"kn-button kn-button--primary",label:e.$t("common.save"),disabled:e.buttonDisabled,onClick:e.handleSubmit},null,8,["label","disabled","onClick"])]),default:s(()=>[t("form",ie,[t("div",{class:"p-field",style:d(e.configurationManagementDescriptor.pField.style)},[t("span",le,[o(u,{id:"label",class:$(["kn-material-input",{"p-invalid":e.v$.configuration.label.$invalid&&e.v$.configuration.label.$dirty}]),type:"text",modelValue:e.v$.configuration.label.$model,"onUpdate:modelValue":a[0]||(a[0]=n=>e.v$.configuration.label.$model=n),modelModifiers:{trim:!0},maxLength:"100",onBlur:a[1]||(a[1]=n=>e.v$.configuration.label.$touch())},null,8,["modelValue","class"]),t("label",se,r(e.$t("managers.configurationManagement.headers.label"))+" * ",1)]),o(c,{vComp:e.v$.configuration.label,additionalTranslateParams:{fieldName:e.$t("managers.configurationManagement.headers.label")}},null,8,["vComp","additionalTranslateParams"])],4),t("div",{class:"p-field",style:d(e.configurationManagementDescriptor.pField.style)},[t("span",re,[o(u,{id:"name",class:$(["kn-material-input",{"p-invalid":e.v$.configuration.name.$invalid&&e.v$.configuration.name.$dirty}]),type:"text",modelValue:e.v$.configuration.name.$model,"onUpdate:modelValue":a[2]||(a[2]=n=>e.v$.configuration.name.$model=n),modelModifiers:{trim:!0},maxLength:"100",onBlur:a[3]||(a[3]=n=>e.v$.configuration.name.$touch())},null,8,["modelValue","class"]),t("label",de,r(e.$t("managers.configurationManagement.headers.name"))+" * ",1)]),o(c,{vComp:e.v$.configuration.name,additionalTranslateParams:{fieldName:e.$t("managers.configurationManagement.headers.name")}},null,8,["vComp","additionalTranslateParams"])],4),t("div",{class:"p-field",style:d(e.configurationManagementDescriptor.pField.style)},[t("span",me,[o(u,{id:"description",class:$(["kn-material-input",{"p-invalid":e.v$.configuration.description.$invalid&&e.v$.configuration.description.$dirty}]),type:"text",modelValue:e.v$.configuration.description.$model,"onUpdate:modelValue":a[4]||(a[4]=n=>e.v$.configuration.description.$model=n),modelModifiers:{trim:!0},maxLength:"500",onBlur:a[5]||(a[5]=n=>e.v$.configuration.description.$touch())},null,8,["modelValue","class"]),t("label",ue,r(e.$t("managers.configurationManagement.headers.description")),1)]),o(c,{vComp:e.v$.configuration.description,additionalTranslateParams:{fieldName:e.$t("managers.configurationManagement.headers.description")}},null,8,["vComp","additionalTranslateParams"])],4),t("div",{class:"p-field",style:d(e.configurationManagementDescriptor.pField.style)},[t("span",ce,[o(y,{id:"category",class:$(["kn-material-input",{"p-invalid":e.v$.configuration.category.$invalid&&e.v$.configuration.category.$dirty}]),modelValue:e.v$.configuration.category.$model,"onUpdate:modelValue":a[6]||(a[6]=n=>e.v$.configuration.category.$model=n),options:e.configurationManagementDescriptor.category,optionLabel:"name",optionValue:"value",onBeforeShow:a[7]||(a[7]=n=>e.v$.configuration.category.$touch())},null,8,["modelValue","class","options"]),t("label",ge,r(e.$t("managers.configurationManagement.headers.category"))+" * ",1)]),o(c,{vComp:e.v$.configuration.category,additionalTranslateParams:{fieldName:e.$t("managers.configurationManagement.headers.category")}},null,8,["vComp","additionalTranslateParams"])],4),t("div",{class:"p-field",style:d(e.configurationManagementDescriptor.pField.style)},[t("span",pe,[o(u,{id:"description",class:"kn-material-input",type:"text",modelValue:e.v$.configuration.valueCheck.$model,"onUpdate:modelValue":a[8]||(a[8]=n=>e.v$.configuration.valueCheck.$model=n),modelModifiers:{trim:!0},onBlur:a[9]||(a[9]=n=>e.v$.configuration.valueCheck.$touch())},null,8,["modelValue"]),t("label",fe,r(e.$t("managers.configurationManagement.headers.valueCheck")),1)])],4),t("div",{class:"p-field",style:d(e.configurationManagementDescriptor.pField.style)},[t("div",ve,[o(h,{id:"isActive",modelValue:e.v$.configuration.active.$model,"onUpdate:modelValue":a[10]||(a[10]=n=>e.v$.configuration.active.$model=n),binary:!0},null,8,["modelValue"]),t("label",he,r(e.$t("managers.configurationManagement.headers.active")),1)])],4)])]),_:1},8,["header","style"])}var be=R(ne,[["render",$e]]);const ye=I({name:"configuration-management",components:{Column:S,DataTable:P,KnFabButton:B,ConfigurationManagementDialog:be},data(){return{configurationManagementDescriptor:M,configurations:[],selectedConfiguration:null,columns:M.columns,formVisible:!1,loading:!1,filters:{global:[p],label:{operator:v.AND,constraints:[p]},name:{operator:v.AND,constraints:[p]},category:{operator:v.AND,constraints:[p]},valueCheck:{operator:v.AND,constraints:[p]},active:{operator:v.AND,constraints:[p]}}}},setup(){return{store:D()}},created(){this.loadConfigurations()},methods:{async loadConfigurations(){this.loading=!0,await this.$http.get("/knowage/restful-services/2.0/configs").then(e=>{this.configurations=e.data}).finally(()=>this.loading=!1)},showDeleteDialog(e){this.$confirm.require({message:this.$t("common.toast.deleteMessage"),header:this.$t("common.toast.deleteConfirmTitle"),icon:"pi pi-exclamation-triangle",accept:()=>this.deleteConfiguration(e)})},async deleteConfiguration(e){await this.$http.delete("/knowage/restful-services/2.0/configs/"+e).then(()=>{this.store.setInfo({title:this.$t("common.toast.deleteTitle"),msg:this.$t("common.toast.deleteSuccess")}),this.loadConfigurations()})},showForm(e){e&&(this.selectedConfiguration=e.data),this.formVisible=!0},closeForm(){this.selectedConfiguration=null,this.formVisible=!1},reload(){this.formVisible=!1,this.loadConfigurations()}}}),Ce={class:"kn-page"},ke={class:"kn-page-content p-grid p-m-0"},Te={key:0,class:"p-col"},Ne={class:"table-header"},Me={class:"p-input-icon-left"},Ae=t("i",{class:"pi pi-search"},null,-1),Ie=["title"],De={key:1};function Re(e,a,F,O,V,U){const u=l("KnFabButton"),c=l("Toolbar"),y=l("ProgressBar"),h=l("InputText"),f=l("Column"),C=l("Button"),n=l("DataTable"),G=l("ConfigurationManagementDialog");return m(),b("div",Ce,[o(c,{class:"kn-toolbar kn-toolbar--primary"},{start:s(()=>[k(r(e.$t("managers.configurationManagement.title")),1)]),end:s(()=>[o(u,{icon:"fas fa-plus",onClick:a[0]||(a[0]=i=>e.showForm()),"data-test":"open-form-button"})]),_:1}),e.loading?(m(),N(y,{key:0,mode:"indeterminate",class:"kn-progress-bar","data-test":"progress-bar"})):T("",!0),t("div",ke,[e.loading?T("",!0):(m(),b("div",Te,[o(n,{value:e.configurations,paginator:!0,loading:e.loading,rows:20,class:"p-datatable-sm kn-table",dataKey:"id",filters:e.filters,"onUpdate:filters":a[2]||(a[2]=i=>e.filters=i),filterDisplay:"menu",globalFilterFields:e.configurationManagementDescriptor.globalFilterFields,rowsPerPageOptions:[10,15,20],responsiveLayout:"stack",breakpoint:"960px",currentPageReportTemplate:e.$t("common.table.footer.paginated",{first:"{first}",last:"{last}",totalRecords:"{totalRecords}"}),"data-test":"configurations-table",selection:e.selectedConfiguration,"onUpdate:selection":a[3]||(a[3]=i=>e.selectedConfiguration=i),selectionMode:"single",onRowSelect:e.showForm},K({header:s(()=>[t("div",Ne,[t("span",Me,[Ae,o(h,{class:"kn-material-input",type:"text",modelValue:e.filters.global.value,"onUpdate:modelValue":a[1]||(a[1]=i=>e.filters.global.value=i),placeholder:e.$t("common.search"),badge:"0","data-test":"search-input"},null,8,["modelValue","placeholder"])])])]),empty:s(()=>[k(r(e.$t("common.info.noDataFound")),1)]),default:s(()=>[(m(!0),b(q,null,H(e.columns,i=>(m(),N(f,{field:i.field,header:e.$t(i.header),key:i.field,sortable:!0,style:d([i.style,[i.field=="valueCheck"?"max-width: 200px":""]]),class:"kn-truncated"},{filter:s(({filterModel:g})=>[o(h,{type:"text",modelValue:g.value,"onUpdate:modelValue":w=>g.value=w,class:"p-column-filter"},null,8,["modelValue","onUpdate:modelValue"])]),body:s(g=>[t("span",{title:g.data[i.field]},r(g.data[i.field]),9,Ie)]),_:2},1032,["field","header","style"]))),128)),o(f,{style:d(e.configurationManagementDescriptor.table.iconColumn.style),onRowClick:i=>!1},{body:s(i=>[o(C,{icon:"pi pi-trash",class:"p-button-link",onClick:g=>e.showDeleteDialog(i.data.id),"data-test":"delete-button"},null,8,["onClick"])]),_:1},8,["style"])]),_:2},[e.loading?{name:"loading",fn:s(()=>[k(r(e.$t("common.info.dataLoading")),1)])}:void 0]),1032,["value","loading","filters","globalFilterFields","currentPageReportTemplate","selection","onRowSelect"])])),e.formVisible?(m(),b("div",De,[o(G,{model:e.selectedConfiguration,onCreated:e.reload,onClose:e.closeForm,"data-test":"configuration-form"},null,8,["model","onCreated","onClose"])])):T("",!0)])])}var Ge=R(ye,[["render",Re]]);export{Ge as default};
//# sourceMappingURL=ConfigurationManagement-0cd51532.js.map
